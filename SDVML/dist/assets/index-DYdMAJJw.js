import{D as ye,E as nt,S as rt,b as Ne,T as st,k as ze,n as it,e as ot,f as at,g as Be,h as $e,i as ct,j as ut,C as Oe,L as lt,l as ht,R as dt,o as We,m as Te,p as Ue,F as me,q as Ge,s as Le,t as pt,U as gt,u as ft,I as qe,v as mt,w as _t,x as Ve,y as He,z as kt,A as Ke,B as Qe,G as yt,H as Q,J as bt,K as St,N as Tt,O as Ce,P as Je,Q as vt,V as wt,W as Ct,X as Rt,Y as De,Z as Lt,_ as At,$ as It,a0 as xt,a1 as Pt,a2 as Mt,a3 as Xe,a4 as Et,a5 as Nt,a6 as Ye,a7 as Ot,a8 as Gt,a9 as Dt,aa as Ft,ab as jt,ac as zt}from"./wrapper-DsmH3jQB.js";function Ze(G,g){for(var T=0;T<g.length;T++){const R=g[T];if(typeof R!="string"&&!Array.isArray(R)){for(const x in R)if(x!=="default"&&!(x in G)){const C=Object.getOwnPropertyDescriptor(R,x);C&&Object.defineProperty(G,x,C.get?C:{enumerable:!0,get:()=>R[x]})}}}return Object.freeze(Object.defineProperty(G,Symbol.toStringTag,{value:"Module"}))}function xe(G,g,T,R){var x=arguments.length,C=x<3?g:R===null?R=Object.getOwnPropertyDescriptor(g,T):R,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(G,g,T,R);else for(var d=G.length-1;d>=0;d--)(r=G[d])&&(C=(x<3?r(C):x>3?r(g,T,C):r(g,T))||C);return x>3&&C&&Object.defineProperty(g,T,C),C}function J(G,g){return function(T,R){g(T,R,G)}}class Bt extends ye{constructor(g,T,R,x,C,r,d){super(),this._grammar=g,this._initialState=T,this._containsEmbeddedLanguages=R,this._createBackgroundTokenizer=x,this._backgroundTokenizerShouldOnlyVerifyTokens=C,this._reportTokenizationTime=r,this._reportSlowTokenization=d,this._seenLanguages=[],this._onDidEncounterLanguage=this._register(new nt),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event}get backgroundTokenizerShouldOnlyVerifyTokens(){return this._backgroundTokenizerShouldOnlyVerifyTokens()}getInitialState(){return this._initialState}tokenize(g,T,R){throw new Error("Not supported!")}createBackgroundTokenizer(g,T){if(this._createBackgroundTokenizer)return this._createBackgroundTokenizer(g,T)}tokenizeEncoded(g,T,R){const x=Math.random()*1e4<1,C=this._reportSlowTokenization||x,r=C?new rt(!0):void 0,d=this._grammar.tokenizeLine2(g,R,500);if(C){const n=r.elapsed();(x||n>32)&&this._reportTokenizationTime(n,g.length,x)}if(d.stoppedEarly)return console.warn(`Time limit reached when tokenizing line: ${g.substring(0,100)}`),new Ne(d.tokens,R);if(this._containsEmbeddedLanguages){const n=this._seenLanguages,k=d.tokens;for(let v=0,u=k.length>>>1;v<u;v++){const S=k[(v<<1)+1],L=st.getLanguageId(S);n[L]||(n[L]=!0,this._onDidEncounterLanguage.fire(L))}}let h;return R.equals(d.ruleStack)?h=R:h=d.ruleStack,new Ne(d.tokens,h)}}class $t extends ye{get backgroundTokenizerShouldOnlyVerifyTokens(){return this._actual.backgroundTokenizerShouldOnlyVerifyTokens}constructor(g,T,R){super(),this._encodedLanguageId=g,this._actual=T,this._maxTokenizationLineLength=R,this._register(ze(this._maxTokenizationLineLength))}getInitialState(){return this._actual.getInitialState()}tokenize(g,T,R){throw new Error("Not supported!")}tokenizeEncoded(g,T,R){return g.length>=this._maxTokenizationLineLength.get()?it(this._encodedLanguageId,R):this._actual.tokenizeEncoded(g,T,R)}createBackgroundTokenizer(g,T){if(this._actual.createBackgroundTokenizer)return this._actual.createBackgroundTokenizer(g,T)}}class Wt{constructor(g){this.edits=g.slice().sort(ot(T=>T.offset,at))}applyToArray(g){for(let T=this.edits.length-1;T>=0;T--){const R=this.edits[T];g.splice(R.offset,R.length,...new Array(R.newLength))}}}class Ut{constructor(g,T,R){this.offset=g,this.length=T,this.newLength=R}toString(){return`[${this.offset}, +${this.length}) -> +${this.newLength}}`}}class ve{static fromMany(g){const T=g.map(R=>new ve(R));return new qt(T)}constructor(g){this.transformation=g,this.idx=0,this.offset=0}transform(g){let T=this.transformation.edits[this.idx];for(;T&&T.offset+T.length<=g;)this.offset+=T.newLength-T.length,this.idx++,T=this.transformation.edits[this.idx];if(!(T&&T.offset<=g))return g+this.offset}}class qt{constructor(g){this.transformers=g}transform(g){for(const T of this.transformers){const R=T.transform(g);if(R===void 0)return;g=R}return g}}var et={exports:{}};(function(G,g){var T={};(function(R,x){G.exports=x()})($e,function(){return(()=>{var R={350:(C,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UseOnigurumaFindOptions=r.DebugFlags=void 0,r.DebugFlags={InDebugMode:typeof process<"u"&&!!T.VSCODE_TEXTMATE_DEBUG},r.UseOnigurumaFindOptions=!1},442:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyStateStackDiff=r.diffStateStacksRefEq=void 0;const h=d(391);r.diffStateStacksRefEq=function(n,k){let v=0;const u=[];let S=n,L=k;for(;S!==L;)S&&(!L||S.depth>=L.depth)?(v++,S=S.parent):(u.push(L.toStateStackFrame()),L=L.parent);return{pops:v,newFrames:u.reverse()}},r.applyStateStackDiff=function(n,k){let v=n;for(let u=0;u<k.pops;u++)v=v.parent;for(const u of k.newFrames)v=h.StateStackImpl.pushFrame(v,u);return v}},36:(C,r)=>{var d;Object.defineProperty(r,"__esModule",{value:!0}),r.toOptionalTokenType=r.EncodedTokenAttributes=void 0,(d=r.EncodedTokenAttributes||(r.EncodedTokenAttributes={})).toBinaryStr=function(h){let n=h.toString(2);for(;n.length<32;)n="0"+n;return n},d.print=function(h){const n=d.getLanguageId(h),k=d.getTokenType(h),v=d.getFontStyle(h),u=d.getForeground(h),S=d.getBackground(h);console.log({languageId:n,tokenType:k,fontStyle:v,foreground:u,background:S})},d.getLanguageId=function(h){return(255&h)>>>0},d.getTokenType=function(h){return(768&h)>>>8},d.containsBalancedBrackets=function(h){return(1024&h)!=0},d.getFontStyle=function(h){return(30720&h)>>>11},d.getForeground=function(h){return(16744448&h)>>>15},d.getBackground=function(h){return(4278190080&h)>>>24},d.set=function(h,n,k,v,u,S,L){let y=d.getLanguageId(h),w=d.getTokenType(h),_=d.containsBalancedBrackets(h)?1:0,m=d.getFontStyle(h),c=d.getForeground(h),f=d.getBackground(h);return n!==0&&(y=n),k!==8&&(w=k),v!==null&&(_=v?1:0),u!==-1&&(m=u),S!==0&&(c=S),L!==0&&(f=L),(y<<0|w<<8|_<<10|m<<11|c<<15|f<<24)>>>0},r.toOptionalTokenType=function(h){return h}},996:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BasicScopeAttributesProvider=r.BasicScopeAttributes=void 0;const h=d(878);class n{constructor(S,L){this.languageId=S,this.tokenType=L}}r.BasicScopeAttributes=n;class k{constructor(S,L){this._getBasicScopeAttributes=new h.CachedFn(y=>{const w=this._scopeToLanguage(y),_=this._toStandardTokenType(y);return new n(w,_)}),this._defaultAttributes=new n(S,8),this._embeddedLanguagesMatcher=new v(Object.entries(L||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(S){return S===null?k._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(S)}_scopeToLanguage(S){return this._embeddedLanguagesMatcher.match(S)||0}_toStandardTokenType(S){const L=S.match(k.STANDARD_TOKEN_TYPE_REGEXP);if(!L)return 8;switch(L[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}r.BasicScopeAttributesProvider=k,k._NULL_SCOPE_METADATA=new n(0,0),k.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class v{constructor(S){if(S.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(S);const L=S.map(([y,w])=>h.escapeRegExpCharacters(y));L.sort(),L.reverse(),this.scopesRegExp=new RegExp(`^((${L.join(")|(")}))($|\\.)`,"")}}match(S){if(!this.scopesRegExp)return;const L=S.match(this.scopesRegExp);return L?this.values.get(L[1]):void 0}}},947:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.LineTokens=r.BalancedBracketSelectors=r.StateStackImpl=r.AttributedScopeStack=r.Grammar=r.createGrammar=void 0;const h=d(350),n=d(36),k=d(736),v=d(44),u=d(792),S=d(583),L=d(878),y=d(996),w=d(47);function _(i,t,o,l,b){const A=k.createMatchers(t,m),P=u.RuleFactory.getCompiledRuleId(o,l,b.repository);for(const E of A)i.push({debugSelector:t,matcher:E.matcher,ruleId:P,grammar:b,priority:E.priority})}function m(i,t){if(t.length<i.length)return!1;let o=0;return i.every(l=>{for(let b=o;b<t.length;b++)if(c(t[b],l))return o=b+1,!0;return!1})}function c(i,t){if(!i)return!1;if(i===t)return!0;const o=t.length;return i.length>o&&i.substr(0,o)===t&&i[o]==="."}r.createGrammar=function(i,t,o,l,b,A,P,E){return new f(i,t,o,l,b,A,P,E)};class f{constructor(t,o,l,b,A,P,E,N){if(this._rootScopeName=t,this.balancedBracketSelectors=P,this._onigLib=N,this._basicScopeAttributesProvider=new y.BasicScopeAttributesProvider(l,b),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=E,this._grammar=p(o,null),this._injections=null,this._tokenTypeMatchers=[],A)for(const V of Object.keys(A)){const B=k.createMatchers(V,m);for(const D of B)this._tokenTypeMatchers.push({matcher:D.matcher,type:A[V]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const t of this._ruleId2desc)t&&t.dispose()}createOnigScanner(t){return this._onigLib.createOnigScanner(t)}createOnigString(t){return this._onigLib.createOnigString(t)}getMetadataForScope(t){return this._basicScopeAttributesProvider.getBasicScopeAttributes(t)}_collectInjections(){const t=[],o=this._rootScopeName,l=(b=>b===this._rootScopeName?this._grammar:this.getExternalGrammar(b))(o);if(l){const b=l.injections;if(b)for(let P in b)_(t,P,b[P],this,l);const A=this._grammarRepository.injections(o);A&&A.forEach(P=>{const E=this.getExternalGrammar(P);if(E){const N=E.injectionSelector;N&&_(t,N,E,this,E)}})}return t.sort((b,A)=>b.priority-A.priority),t}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),h.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(const t of this._injections)console.log(`  - ${t.debugSelector}`)}return this._injections}registerRule(t){const o=++this._lastRuleId,l=t(u.ruleIdFromNumber(o));return this._ruleId2desc[o]=l,l}getRule(t){return this._ruleId2desc[u.ruleIdToNumber(t)]}getExternalGrammar(t,o){if(this._includedGrammars[t])return this._includedGrammars[t];if(this._grammarRepository){const l=this._grammarRepository.lookup(t);if(l)return this._includedGrammars[t]=p(l,o&&o.$base),this._includedGrammars[t]}}tokenizeLine(t,o,l=0){const b=this._tokenize(t,o,!1,l);return{tokens:b.lineTokens.getResult(b.ruleStack,b.lineLength),ruleStack:b.ruleStack,stoppedEarly:b.stoppedEarly}}tokenizeLine2(t,o,l=0){const b=this._tokenize(t,o,!0,l);return{tokens:b.lineTokens.getBinaryResult(b.ruleStack,b.lineLength),ruleStack:b.ruleStack,stoppedEarly:b.stoppedEarly}}_tokenize(t,o,l,b){let A;if(this._rootId===-1&&(this._rootId=u.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),o&&o!==e.NULL)A=!1,o.reset();else{A=!0;const B=this._basicScopeAttributesProvider.getDefaultAttributes(),D=this.themeProvider.getDefaults(),z=n.EncodedTokenAttributes.set(0,B.languageId,B.tokenType,null,D.fontStyle,D.foregroundId,D.backgroundId),X=this.getRule(this._rootId).getName(null,null);let H;H=X?a.createRootAndLookUpScopeName(X,z,this):a.createRoot("unknown",z),o=new e(null,this._rootId,-1,-1,!1,null,H,H)}t+=`
`;const P=this.createOnigString(t),E=P.content.length,N=new s(l,t,this._tokenTypeMatchers,this.balancedBracketSelectors),V=w._tokenizeString(this,P,A,0,o,N,!0,b);return v.disposeOnigString(P),{lineLength:E,lineTokens:N,ruleStack:V.stack,stoppedEarly:V.stoppedEarly}}}function p(i,t){return(i=L.clone(i)).repository=i.repository||{},i.repository.$self={$vscodeTextmateLocation:i.$vscodeTextmateLocation,patterns:i.patterns,name:i.scopeName},i.repository.$base=t||i.repository.$self,i}r.Grammar=f;class a{constructor(t,o,l){this.parent=t,this.scopePath=o,this.tokenAttributes=l}static fromExtension(t,o){let l=t,b=t?.scopePath??null;for(const A of o)b=S.ScopeStack.push(b,A.scopeNames),l=new a(l,b,A.encodedTokenAttributes);return l}static createRoot(t,o){return new a(null,new S.ScopeStack(null,t),o)}static createRootAndLookUpScopeName(t,o,l){const b=l.getMetadataForScope(t),A=new S.ScopeStack(null,t),P=l.themeProvider.themeMatch(A),E=a.mergeAttributes(o,b,P);return new a(null,A,E)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(t){return a.equals(this,t)}static equals(t,o){for(;;){if(t===o||!t&&!o)return!0;if(!t||!o||t.scopeName!==o.scopeName||t.tokenAttributes!==o.tokenAttributes)return!1;t=t.parent,o=o.parent}}static mergeAttributes(t,o,l){let b=-1,A=0,P=0;return l!==null&&(b=l.fontStyle,A=l.foregroundId,P=l.backgroundId),n.EncodedTokenAttributes.set(t,o.languageId,o.tokenType,null,b,A,P)}pushAttributed(t,o){if(t===null)return this;if(t.indexOf(" ")===-1)return a._pushAttributed(this,t,o);const l=t.split(/ /g);let b=this;for(const A of l)b=a._pushAttributed(b,A,o);return b}static _pushAttributed(t,o,l){const b=l.getMetadataForScope(o),A=t.scopePath.push(o),P=l.themeProvider.themeMatch(A),E=a.mergeAttributes(t.tokenAttributes,b,P);return new a(t,A,E)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(t){const o=[];let l=this;for(;l&&l!==t;)o.push({encodedTokenAttributes:l.tokenAttributes,scopeNames:l.scopePath.getExtensionIfDefined(l.parent?.scopePath??null)}),l=l.parent;return l===t?o.reverse():void 0}}r.AttributedScopeStack=a;class e{constructor(t,o,l,b,A,P,E,N){this.parent=t,this.ruleId=o,this.beginRuleCapturedEOL=A,this.endRule=P,this.nameScopesList=E,this.contentNameScopesList=N,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=l,this._anchorPos=b}equals(t){return t!==null&&e._equals(this,t)}static _equals(t,o){return t===o||!!this._structuralEquals(t,o)&&a.equals(t.contentNameScopesList,o.contentNameScopesList)}static _structuralEquals(t,o){for(;;){if(t===o||!t&&!o)return!0;if(!t||!o||t.depth!==o.depth||t.ruleId!==o.ruleId||t.endRule!==o.endRule)return!1;t=t.parent,o=o.parent}}clone(){return this}static _reset(t){for(;t;)t._enterPos=-1,t._anchorPos=-1,t=t.parent}reset(){e._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(t,o,l,b,A,P,E){return new e(this,t,o,l,b,A,P,E)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(t){return t.getRule(this.ruleId)}toString(){const t=[];return this._writeString(t,0),"["+t.join(",")+"]"}_writeString(t,o){return this.parent&&(o=this.parent._writeString(t,o)),t[o++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,o}withContentNameScopesList(t){return this.contentNameScopesList===t?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,t)}withEndRule(t){return this.endRule===t?this:new e(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,t,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(t){let o=this;for(;o&&o._enterPos===t._enterPos;){if(o.ruleId===t.ruleId)return!0;o=o.parent}return!1}toStateStackFrame(){return{ruleId:u.ruleIdToNumber(this.ruleId),beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(t,o){const l=a.fromExtension(t?.nameScopesList??null,o.nameScopesList);return new e(t,u.ruleIdFromNumber(o.ruleId),o.enterPos??-1,o.anchorPos??-1,o.beginRuleCapturedEOL,o.endRule,l,a.fromExtension(l,o.contentNameScopesList))}}r.StateStackImpl=e,e.NULL=new e(null,0,0,0,!1,null,null,null),r.BalancedBracketSelectors=class{constructor(i,t){this.allowAny=!1,this.balancedBracketScopes=i.flatMap(o=>o==="*"?(this.allowAny=!0,[]):k.createMatchers(o,m).map(l=>l.matcher)),this.unbalancedBracketScopes=t.flatMap(o=>k.createMatchers(o,m).map(l=>l.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(i){for(const t of this.unbalancedBracketScopes)if(t(i))return!1;for(const t of this.balancedBracketScopes)if(t(i))return!0;return this.allowAny}};class s{constructor(t,o,l,b){this.balancedBracketSelectors=b,this._emitBinaryTokens=t,this._tokenTypeOverrides=l,h.DebugFlags.InDebugMode?this._lineText=o:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(t,o){this.produceFromScopes(t.contentNameScopesList,o)}produceFromScopes(t,o){if(this._lastTokenEndIndex>=o)return;if(this._emitBinaryTokens){let b=t?.tokenAttributes??0,A=!1;if(this.balancedBracketSelectors?.matchesAlways&&(A=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const P=t?.getScopeNames()??[];for(const E of this._tokenTypeOverrides)E.matcher(P)&&(b=n.EncodedTokenAttributes.set(b,0,n.toOptionalTokenType(E.type),null,-1,0,0));this.balancedBracketSelectors&&(A=this.balancedBracketSelectors.match(P))}if(A&&(b=n.EncodedTokenAttributes.set(b,0,8,A,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===b)return void(this._lastTokenEndIndex=o);if(h.DebugFlags.InDebugMode){const P=t?.getScopeNames()??[];console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,o).replace(/\n$/,"\\n")+"|");for(let E=0;E<P.length;E++)console.log("      * "+P[E])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(b),void(this._lastTokenEndIndex=o)}const l=t?.getScopeNames()??[];if(h.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,o).replace(/\n$/,"\\n")+"|");for(let b=0;b<l.length;b++)console.log("      * "+l[b])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:o,scopes:l}),this._lastTokenEndIndex=o}getResult(t,o){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===o-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,o),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(t,o){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===o-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,o),this._binaryTokens[this._binaryTokens.length-2]=0);const l=new Uint32Array(this._binaryTokens.length);for(let b=0,A=this._binaryTokens.length;b<A;b++)l[b]=this._binaryTokens[b];return l}}r.LineTokens=s},965:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseInclude=r.TopLevelRepositoryReference=r.TopLevelReference=r.RelativeReference=r.SelfReference=r.BaseReference=r.ScopeDependencyProcessor=r.ExternalReferenceCollector=r.TopLevelRepositoryRuleReference=r.TopLevelRuleReference=void 0;const h=d(878);class n{constructor(e){this.scopeName=e}toKey(){return this.scopeName}}r.TopLevelRuleReference=n;class k{constructor(e,s){this.scopeName=e,this.ruleName=s}toKey(){return`${this.scopeName}#${this.ruleName}`}}r.TopLevelRepositoryRuleReference=k;class v{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(e){const s=e.toKey();this._seenReferenceKeys.has(s)||(this._seenReferenceKeys.add(s),this._references.push(e))}}function u(a,e,s,i){const t=s.lookup(a.scopeName);if(!t){if(a.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const o=s.lookup(e);a instanceof n?L({baseGrammar:o,selfGrammar:t},i):S(a.ruleName,{baseGrammar:o,selfGrammar:t,repository:t.repository},i);const l=s.injections(a.scopeName);if(l)for(const b of l)i.add(new n(b))}function S(a,e,s){e.repository&&e.repository[a]&&y([e.repository[a]],e,s)}function L(a,e){a.selfGrammar.patterns&&Array.isArray(a.selfGrammar.patterns)&&y(a.selfGrammar.patterns,{...a,repository:a.selfGrammar.repository},e),a.selfGrammar.injections&&y(Object.values(a.selfGrammar.injections),{...a,repository:a.selfGrammar.repository},e)}function y(a,e,s){for(const i of a){if(s.visitedRule.has(i))continue;s.visitedRule.add(i);const t=i.repository?h.mergeObjects({},e.repository,i.repository):e.repository;Array.isArray(i.patterns)&&y(i.patterns,{...e,repository:t},s);const o=i.include;if(!o)continue;const l=p(o);switch(l.kind){case 0:L({...e,selfGrammar:e.baseGrammar},s);break;case 1:L(e,s);break;case 2:S(l.ruleName,{...e,repository:t},s);break;case 3:case 4:const b=l.scopeName===e.selfGrammar.scopeName?e.selfGrammar:l.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(b){const A={baseGrammar:e.baseGrammar,selfGrammar:b,repository:t};l.kind===4?S(l.ruleName,A,s):L(A,s)}else l.kind===4?s.add(new k(l.scopeName,l.ruleName)):s.add(new n(l.scopeName))}}}r.ExternalReferenceCollector=v,r.ScopeDependencyProcessor=class{constructor(a,e){this.repo=a,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new n(this.initialScopeName)]}processQueue(){const a=this.Q;this.Q=[];const e=new v;for(const s of a)u(s,this.initialScopeName,this.repo,e);for(const s of e.references)if(s instanceof n){if(this.seenFullScopeRequests.has(s.scopeName))continue;this.seenFullScopeRequests.add(s.scopeName),this.Q.push(s)}else{if(this.seenFullScopeRequests.has(s.scopeName)||this.seenPartialScopeRequests.has(s.toKey()))continue;this.seenPartialScopeRequests.add(s.toKey()),this.Q.push(s)}}};class w{constructor(){this.kind=0}}r.BaseReference=w;class _{constructor(){this.kind=1}}r.SelfReference=_;class m{constructor(e){this.ruleName=e,this.kind=2}}r.RelativeReference=m;class c{constructor(e){this.scopeName=e,this.kind=3}}r.TopLevelReference=c;class f{constructor(e,s){this.scopeName=e,this.ruleName=s,this.kind=4}}function p(a){if(a==="$base")return new w;if(a==="$self")return new _;const e=a.indexOf("#");if(e===-1)return new c(a);if(e===0)return new m(a.substring(1));{const s=a.substring(0,e),i=a.substring(e+1);return new f(s,i)}}r.TopLevelRepositoryReference=f,r.parseInclude=p},391:function(C,r,d){var h=this&&this.__createBinding||(Object.create?function(k,v,u,S){S===void 0&&(S=u),Object.defineProperty(k,S,{enumerable:!0,get:function(){return v[u]}})}:function(k,v,u,S){S===void 0&&(S=u),k[S]=v[u]}),n=this&&this.__exportStar||function(k,v){for(var u in k)u==="default"||Object.prototype.hasOwnProperty.call(v,u)||h(v,k,u)};Object.defineProperty(r,"__esModule",{value:!0}),n(d(947),r)},47:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.LocalStackElement=r._tokenizeString=void 0;const h=d(350),n=d(44),k=d(792),v=d(878);class u{constructor(f,p){this.stack=f,this.stoppedEarly=p}}function S(c,f,p,a,e,s,i,t){const o=f.content.length;let l=!1,b=-1;if(i){const E=function(N,V,B,D,z,X){let H=z.beginRuleCapturedEOL?0:-1;const j=[];for(let F=z;F;F=F.pop()){const $=F.getRule(N);$ instanceof k.BeginWhileRule&&j.push({rule:$,stack:F})}for(let F=j.pop();F;F=j.pop()){const{ruleScanner:$,findOptions:ie}=y(F.rule,N,F.stack.endRule,B,D===H),I=$.findNextMatchSync(V,D,ie);if(h.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log($.toString())),!I){h.DebugFlags.InDebugMode&&console.log("  popping "+F.rule.debugName+" - "+F.rule.debugWhileRegExp),z=F.stack.pop();break}if(I.ruleId!==k.whileRuleId){z=F.stack.pop();break}I.captureIndices&&I.captureIndices.length&&(X.produce(F.stack,I.captureIndices[0].start),_(N,V,B,F.stack,X,F.rule.whileCaptures,I.captureIndices),X.produce(F.stack,I.captureIndices[0].end),H=I.captureIndices[0].end,I.captureIndices[0].end>D&&(D=I.captureIndices[0].end,B=!1))}return{stack:z,linePos:D,anchorPosition:H,isFirstLine:B}}(c,f,p,a,e,s);e=E.stack,a=E.linePos,p=E.isFirstLine,b=E.anchorPosition}const A=Date.now();for(;!l;){if(t!==0&&Date.now()-A>t)return new u(e,!0);P()}return new u(e,!1);function P(){h.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${a}: |${f.content.substr(a).replace(/\n$/,"\\n")}|`));const E=function(D,z,X,H,j,F){const $=function(ne,oe,_e,he,ue,ge){const de=ue.getRule(ne),{ruleScanner:pe,findOptions:se}=L(de,ne,ue.endRule,_e,he===ge);let ae=0;h.DebugFlags.InDebugMode&&(ae=v.performanceNow());const te=pe.findNextMatchSync(oe,he,se);if(h.DebugFlags.InDebugMode){const M=v.performanceNow()-ae;M>5&&console.warn(`Rule ${de.debugName} (${de.id}) matching took ${M} against '${oe}'`),console.log(`  scanning for (linePos: ${he}, anchorPosition: ${ge})`),console.log(pe.toString()),te&&console.log(`matched rule id: ${te.ruleId} from ${te.captureIndices[0].start} to ${te.captureIndices[0].end}`)}return te?{captureIndices:te.captureIndices,matchedRuleId:te.ruleId}:null}(D,z,X,H,j,F),ie=D.getInjections();if(ie.length===0)return $;const I=function(ne,oe,_e,he,ue,ge,de){let pe,se=Number.MAX_VALUE,ae=null,te=0;const M=ge.contentNameScopesList.getScopeNames();for(let O=0,Y=ne.length;O<Y;O++){const ee=ne[O];if(!ee.matcher(M))continue;const U=oe.getRule(ee.ruleId),{ruleScanner:q,findOptions:Z}=L(U,oe,null,he,ue===de),re=q.findNextMatchSync(_e,ue,Z);if(!re)continue;h.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${ee.debugSelector}`),console.log(q.toString()));const ce=re.captureIndices[0].start;if(!(ce>=se)&&(se=ce,ae=re.captureIndices,pe=re.ruleId,te=ee.priority,se===ue))break}return ae?{priorityMatch:te===-1,captureIndices:ae,matchedRuleId:pe}:null}(ie,D,z,X,H,j,F);if(!I)return $;if(!$)return I;const K=$.captureIndices[0].start,W=I.captureIndices[0].start;return W<K||I.priorityMatch&&W===K?I:$}(c,f,p,a,e,b);if(!E)return h.DebugFlags.InDebugMode&&console.log("  no more matches."),s.produce(e,o),void(l=!0);const N=E.captureIndices,V=E.matchedRuleId,B=!!(N&&N.length>0)&&N[0].end>a;if(V===k.endRuleId){const D=e.getRule(c);h.DebugFlags.InDebugMode&&console.log("  popping "+D.debugName+" - "+D.debugEndRegExp),s.produce(e,N[0].start),e=e.withContentNameScopesList(e.nameScopesList),_(c,f,p,e,s,D.endCaptures,N),s.produce(e,N[0].end);const z=e;if(e=e.parent,b=z.getAnchorPos(),!B&&z.getEnterPos()===a)return h.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),e=z,s.produce(e,o),void(l=!0)}else{const D=c.getRule(V);s.produce(e,N[0].start);const z=e,X=D.getName(f.content,N),H=e.contentNameScopesList.pushAttributed(X,c);if(e=e.push(V,a,b,N[0].end===o,null,H,H),D instanceof k.BeginEndRule){const j=D;h.DebugFlags.InDebugMode&&console.log("  pushing "+j.debugName+" - "+j.debugBeginRegExp),_(c,f,p,e,s,j.beginCaptures,N),s.produce(e,N[0].end),b=N[0].end;const F=j.getContentName(f.content,N),$=H.pushAttributed(F,c);if(e=e.withContentNameScopesList($),j.endHasBackReferences&&(e=e.withEndRule(j.getEndWithResolvedBackReferences(f.content,N))),!B&&z.hasSameRuleAs(e))return h.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,o),void(l=!0)}else if(D instanceof k.BeginWhileRule){const j=D;h.DebugFlags.InDebugMode&&console.log("  pushing "+j.debugName),_(c,f,p,e,s,j.beginCaptures,N),s.produce(e,N[0].end),b=N[0].end;const F=j.getContentName(f.content,N),$=H.pushAttributed(F,c);if(e=e.withContentNameScopesList($),j.whileHasBackReferences&&(e=e.withEndRule(j.getWhileWithResolvedBackReferences(f.content,N))),!B&&z.hasSameRuleAs(e))return h.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,o),void(l=!0)}else{const j=D;if(h.DebugFlags.InDebugMode&&console.log("  matched "+j.debugName+" - "+j.debugMatchRegExp),_(c,f,p,e,s,j.captures,N),s.produce(e,N[0].end),e=e.pop(),!B)return h.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),e=e.safePop(),s.produce(e,o),void(l=!0)}}N[0].end>a&&(a=N[0].end,p=!1)}}function L(c,f,p,a,e){return h.UseOnigurumaFindOptions?{ruleScanner:c.compile(f,p),findOptions:w(a,e)}:{ruleScanner:c.compileAG(f,p,a,e),findOptions:0}}function y(c,f,p,a,e){return h.UseOnigurumaFindOptions?{ruleScanner:c.compileWhile(f,p),findOptions:w(a,e)}:{ruleScanner:c.compileWhileAG(f,p,a,e),findOptions:0}}function w(c,f){let p=0;return c||(p|=1),f||(p|=4),p}function _(c,f,p,a,e,s,i){if(s.length===0)return;const t=f.content,o=Math.min(s.length,i.length),l=[],b=i[0].end;for(let A=0;A<o;A++){const P=s[A];if(P===null)continue;const E=i[A];if(E.length===0)continue;if(E.start>b)break;for(;l.length>0&&l[l.length-1].endPos<=E.start;)e.produceFromScopes(l[l.length-1].scopes,l[l.length-1].endPos),l.pop();if(l.length>0?e.produceFromScopes(l[l.length-1].scopes,E.start):e.produce(a,E.start),P.retokenizeCapturedWithRuleId){const V=P.getName(t,i),B=a.contentNameScopesList.pushAttributed(V,c),D=P.getContentName(t,i),z=B.pushAttributed(D,c),X=a.push(P.retokenizeCapturedWithRuleId,E.start,-1,!1,null,B,z),H=c.createOnigString(t.substring(0,E.end));S(c,H,p&&E.start===0,E.start,X,e,!1,0),n.disposeOnigString(H);continue}const N=P.getName(t,i);if(N!==null){const V=(l.length>0?l[l.length-1].scopes:a.contentNameScopesList).pushAttributed(N,c);l.push(new m(V,E.end))}}for(;l.length>0;)e.produceFromScopes(l[l.length-1].scopes,l[l.length-1].endPos),l.pop()}r._tokenizeString=S;class m{constructor(f,p){this.scopes=f,this.endPos=p}}r.LocalStackElement=m},974:(C,r)=>{function d(v,u){throw new Error("Near offset "+v.pos+": "+u+" ~~~"+v.source.substr(v.pos,50)+"~~~")}Object.defineProperty(r,"__esModule",{value:!0}),r.parseJSON=void 0,r.parseJSON=function(v,u,S){let L=new h(v),y=new n,w=0,_=null,m=[],c=[];function f(){m.push(w),c.push(_)}function p(){w=m.pop(),_=c.pop()}function a(e){d(L,e)}for(;k(L,y);){if(w===0){if(_!==null&&a("too many constructs in root"),y.type===3){_={},S&&(_.$vscodeTextmateLocation=y.toLocation(u)),f(),w=1;continue}if(y.type===2){_=[],f(),w=4;continue}a("unexpected token in root")}if(w===2){if(y.type===5){p();continue}if(y.type===7){w=3;continue}a("expected , or }")}if(w===1||w===3){if(w===1&&y.type===5){p();continue}if(y.type===1){let e=y.value;if(k(L,y)&&y.type===6||a("expected colon"),k(L,y)||a("expected value"),w=2,y.type===1){_[e]=y.value;continue}if(y.type===8){_[e]=null;continue}if(y.type===9){_[e]=!0;continue}if(y.type===10){_[e]=!1;continue}if(y.type===11){_[e]=parseFloat(y.value);continue}if(y.type===2){let s=[];_[e]=s,f(),w=4,_=s;continue}if(y.type===3){let s={};S&&(s.$vscodeTextmateLocation=y.toLocation(u)),_[e]=s,f(),w=1,_=s;continue}}a("unexpected token in dict")}if(w===5){if(y.type===4){p();continue}if(y.type===7){w=6;continue}a("expected , or ]")}if(w===4||w===6){if(w===4&&y.type===4){p();continue}if(w=5,y.type===1){_.push(y.value);continue}if(y.type===8){_.push(null);continue}if(y.type===9){_.push(!0);continue}if(y.type===10){_.push(!1);continue}if(y.type===11){_.push(parseFloat(y.value));continue}if(y.type===2){let e=[];_.push(e),f(),w=4,_=e;continue}if(y.type===3){let e={};S&&(e.$vscodeTextmateLocation=y.toLocation(u)),_.push(e),f(),w=1,_=e;continue}a("unexpected token in array")}a("unknown state")}return c.length!==0&&a("unclosed constructs"),_};class h{constructor(u){this.source=u,this.pos=0,this.len=u.length,this.line=1,this.char=0}}class n{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(u){return{filename:u,line:this.line,char:this.char}}}function k(v,u){u.value=null,u.type=0,u.offset=-1,u.len=-1,u.line=-1,u.char=-1;let S,L=v.source,y=v.pos,w=v.len,_=v.line,m=v.char;for(;;){if(y>=w)return!1;if(S=L.charCodeAt(y),S!==32&&S!==9&&S!==13){if(S!==10)break;y++,_++,m=0}else y++,m++}if(u.offset=y,u.line=_,u.char=m,S===34){for(u.type=1,y++,m++;;){if(y>=w)return!1;if(S=L.charCodeAt(y),y++,m++,S!==92){if(S===34)break}else y++,m++}u.value=L.substring(u.offset+1,y-1).replace(/\\u([0-9A-Fa-f]{4})/g,(c,f)=>String.fromCodePoint(parseInt(f,16))).replace(/\\(.)/g,(c,f)=>{switch(f){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:d(v,"invalid escape sequence")}throw new Error("unreachable")})}else if(S===91)u.type=2,y++,m++;else if(S===123)u.type=3,y++,m++;else if(S===93)u.type=4,y++,m++;else if(S===125)u.type=5,y++,m++;else if(S===58)u.type=6,y++,m++;else if(S===44)u.type=7,y++,m++;else if(S===110){if(u.type=8,y++,m++,S=L.charCodeAt(y),S!==117||(y++,m++,S=L.charCodeAt(y),S!==108)||(y++,m++,S=L.charCodeAt(y),S!==108))return!1;y++,m++}else if(S===116){if(u.type=9,y++,m++,S=L.charCodeAt(y),S!==114||(y++,m++,S=L.charCodeAt(y),S!==117)||(y++,m++,S=L.charCodeAt(y),S!==101))return!1;y++,m++}else if(S===102){if(u.type=10,y++,m++,S=L.charCodeAt(y),S!==97||(y++,m++,S=L.charCodeAt(y),S!==108)||(y++,m++,S=L.charCodeAt(y),S!==115)||(y++,m++,S=L.charCodeAt(y),S!==101))return!1;y++,m++}else for(u.type=11;;){if(y>=w)return!1;if(S=L.charCodeAt(y),!(S===46||S>=48&&S<=57||S===101||S===69||S===45||S===43))break;y++,m++}return u.len=y-u.offset,u.value===null&&(u.value=L.substr(u.offset,u.len)),v.pos=y,v.line=_,v.char=m,!0}},787:function(C,r,d){var h=this&&this.__createBinding||(Object.create?function(w,_,m,c){c===void 0&&(c=m),Object.defineProperty(w,c,{enumerable:!0,get:function(){return _[m]}})}:function(w,_,m,c){c===void 0&&(c=m),w[c]=_[m]}),n=this&&this.__exportStar||function(w,_){for(var m in w)m==="default"||Object.prototype.hasOwnProperty.call(_,m)||h(_,w,m)};Object.defineProperty(r,"__esModule",{value:!0}),r.applyStateStackDiff=r.diffStateStacksRefEq=r.parseRawGrammar=r.INITIAL=r.Registry=void 0;const k=d(391),v=d(50),u=d(652),S=d(583),L=d(965),y=d(442);Object.defineProperty(r,"applyStateStackDiff",{enumerable:!0,get:function(){return y.applyStateStackDiff}}),Object.defineProperty(r,"diffStateStacksRefEq",{enumerable:!0,get:function(){return y.diffStateStacksRefEq}}),n(d(44),r),r.Registry=class{constructor(w){this._options=w,this._syncRegistry=new u.SyncRegistry(S.Theme.createFromRawTheme(w.theme,w.colorMap),w.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(w,_){this._syncRegistry.setTheme(S.Theme.createFromRawTheme(w,_))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(w,_,m){return this.loadGrammarWithConfiguration(w,_,{embeddedLanguages:m})}loadGrammarWithConfiguration(w,_,m){return this._loadGrammar(w,_,m.embeddedLanguages,m.tokenTypes,new k.BalancedBracketSelectors(m.balancedBracketSelectors||[],m.unbalancedBracketSelectors||[]))}loadGrammar(w){return this._loadGrammar(w,0,null,null,null)}async _loadGrammar(w,_,m,c,f){const p=new L.ScopeDependencyProcessor(this._syncRegistry,w);for(;p.Q.length>0;)await Promise.all(p.Q.map(a=>this._loadSingleGrammar(a.scopeName))),p.processQueue();return this._grammarForScopeName(w,_,m,c,f)}async _loadSingleGrammar(w){return this._ensureGrammarCache.has(w)||this._ensureGrammarCache.set(w,this._doLoadSingleGrammar(w)),this._ensureGrammarCache.get(w)}async _doLoadSingleGrammar(w){const _=await this._options.loadGrammar(w);if(_){const m=typeof this._options.getInjections=="function"?this._options.getInjections(w):void 0;this._syncRegistry.addGrammar(_,m)}}async addGrammar(w,_=[],m=0,c=null){return this._syncRegistry.addGrammar(w,_),await this._grammarForScopeName(w.scopeName,m,c)}_grammarForScopeName(w,_=0,m=null,c=null,f=null){return this._syncRegistry.grammarForScopeName(w,_,m,c,f)}},r.INITIAL=k.StateStackImpl.NULL,r.parseRawGrammar=v.parseRawGrammar},736:(C,r)=>{function d(h){return!!h&&!!h.match(/[\w\.:]+/)}Object.defineProperty(r,"__esModule",{value:!0}),r.createMatchers=void 0,r.createMatchers=function(h,n){const k=[],v=function(y){let w=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,_=w.exec(y);return{next:()=>{if(!_)return null;const m=_[0];return _=w.exec(y),m}}}(h);let u=v.next();for(;u!==null;){let y=0;if(u.length===2&&u.charAt(1)===":"){switch(u.charAt(0)){case"R":y=1;break;case"L":y=-1;break;default:console.log(`Unknown priority ${u} in scope selector`)}u=v.next()}let w=L();if(k.push({matcher:w,priority:y}),u!==",")break;u=v.next()}return k;function S(){if(u==="-"){u=v.next();const y=S();return w=>!!y&&!y(w)}if(u==="("){u=v.next();const y=function(){const w=[];let _=L();for(;_&&(w.push(_),u==="|"||u===",");){do u=v.next();while(u==="|"||u===",");_=L()}return m=>w.some(c=>c(m))}();return u===")"&&(u=v.next()),y}if(d(u)){const y=[];do y.push(u),u=v.next();while(d(u));return w=>n(y,w)}return null}function L(){const y=[];let w=S();for(;w;)y.push(w),w=S();return _=>y.every(m=>m(_))}}},44:(C,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.disposeOnigString=void 0,r.disposeOnigString=function(d){typeof d.dispose=="function"&&d.dispose()}},50:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseRawGrammar=void 0;const h=d(69),n=d(350),k=d(974);r.parseRawGrammar=function(v,u=null){return u!==null&&/\.json$/.test(u)?(S=v,L=u,n.DebugFlags.InDebugMode?k.parseJSON(S,L,!0):JSON.parse(S)):function(y,w){return n.DebugFlags.InDebugMode?h.parseWithLocation(y,w,"$vscodeTextmateLocation"):h.parsePLIST(y)}(v,u);var S,L}},69:(C,r)=>{function d(h,n,k){const v=h.length;let u=0,S=1,L=0;function y(I){if(k===null)u+=I;else for(;I>0;)h.charCodeAt(u)===10?(u++,S++,L=0):(u++,L++),I--}function w(I){k===null?u=I:y(I-u)}function _(){for(;u<v;){let I=h.charCodeAt(u);if(I!==32&&I!==9&&I!==13&&I!==10)break;y(1)}}function m(I){return h.substr(u,I.length)===I&&(y(I.length),!0)}function c(I){let K=h.indexOf(I,u);w(K!==-1?K+I.length:v)}function f(I){let K=h.indexOf(I,u);if(K!==-1){let W=h.substring(u,K);return w(K+I.length),W}{let W=h.substr(u);return w(v),W}}v>0&&h.charCodeAt(0)===65279&&(u=1);let p=0,a=null,e=[],s=[],i=null;function t(I,K){e.push(p),s.push(a),p=I,a=K}function o(){if(e.length===0)return l("illegal state stack");p=e.pop(),a=s.pop()}function l(I){throw new Error("Near offset "+u+": "+I+" ~~~"+h.substr(u,50)+"~~~")}const b=function(){if(i===null)return l("missing <key>");let I={};k!==null&&(I[k]={filename:n,line:S,char:L}),a[i]=I,i=null,t(1,I)},A=function(){if(i===null)return l("missing <key>");let I=[];a[i]=I,i=null,t(2,I)},P=function(){let I={};k!==null&&(I[k]={filename:n,line:S,char:L}),a.push(I),t(1,I)},E=function(){let I=[];a.push(I),t(2,I)};function N(){if(p!==1)return l("unexpected </dict>");o()}function V(){return p===1||p!==2?l("unexpected </array>"):void o()}function B(I){if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function D(I){if(isNaN(I))return l("cannot parse float");if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function z(I){if(isNaN(I))return l("cannot parse integer");if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function X(I){if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function H(I){if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function j(I){if(p===1){if(i===null)return l("missing <key>");a[i]=I,i=null}else p===2?a.push(I):a=I}function F(){let I=f(">"),K=!1;return I.charCodeAt(I.length-1)===47&&(K=!0,I=I.substring(0,I.length-1)),{name:I.trim(),isClosed:K}}function $(I){if(I.isClosed)return"";let K=f("</");return c(">"),K.replace(/&#([0-9]+);/g,function(W,ne){return String.fromCodePoint(parseInt(ne,10))}).replace(/&#x([0-9a-f]+);/g,function(W,ne){return String.fromCodePoint(parseInt(ne,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function(W){switch(W){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return W})}for(;u<v&&(_(),!(u>=v));){const I=h.charCodeAt(u);if(y(1),I!==60)return l("expected <");if(u>=v)return l("unexpected end of input");const K=h.charCodeAt(u);if(K===63){y(1),c("?>");continue}if(K===33){if(y(1),m("--")){c("-->");continue}c(">");continue}if(K===47){if(y(1),_(),m("plist")){c(">");continue}if(m("dict")){c(">"),N();continue}if(m("array")){c(">"),V();continue}return l("unexpected closed tag")}let W=F();switch(W.name){case"dict":p===1?b():p===2?P():(a={},k!==null&&(a[k]={filename:n,line:S,char:L}),t(1,a)),W.isClosed&&N();continue;case"array":p===1?A():p===2?E():(a=[],t(2,a)),W.isClosed&&V();continue;case"key":ie=$(W),p!==1?l("unexpected <key>"):i!==null?l("too many <key>"):i=ie;continue;case"string":B($(W));continue;case"real":D(parseFloat($(W)));continue;case"integer":z(parseInt($(W),10));continue;case"date":X(new Date($(W)));continue;case"data":H($(W));continue;case"true":$(W),j(!0);continue;case"false":$(W),j(!1);continue}if(!/^plist/.test(W.name))return l("unexpected opened tag "+W.name)}var ie;return a}Object.defineProperty(r,"__esModule",{value:!0}),r.parsePLIST=r.parseWithLocation=void 0,r.parseWithLocation=function(h,n,k){return d(h,n,k)},r.parsePLIST=function(h){return d(h,null,null)}},652:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SyncRegistry=void 0;const h=d(391);r.SyncRegistry=class{constructor(n,k){this._onigLibPromise=k,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=n}dispose(){for(const n of this._grammars.values())n.dispose()}setTheme(n){this._theme=n}getColorMap(){return this._theme.getColorMap()}addGrammar(n,k){this._rawGrammars.set(n.scopeName,n),k&&this._injectionGrammars.set(n.scopeName,k)}lookup(n){return this._rawGrammars.get(n)}injections(n){return this._injectionGrammars.get(n)}getDefaults(){return this._theme.getDefaults()}themeMatch(n){return this._theme.match(n)}async grammarForScopeName(n,k,v,u,S){if(!this._grammars.has(n)){let L=this._rawGrammars.get(n);if(!L)return null;this._grammars.set(n,h.createGrammar(n,L,k,v,u,S,this,await this._onigLibPromise))}return this._grammars.get(n)}}},792:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CompiledRule=r.RegExpSourceList=r.RegExpSource=r.RuleFactory=r.BeginWhileRule=r.BeginEndRule=r.IncludeOnlyRule=r.MatchRule=r.CaptureRule=r.Rule=r.ruleIdToNumber=r.ruleIdFromNumber=r.whileRuleId=r.endRuleId=void 0;const h=d(878),n=d(965),k=/\\(\d+)/,v=/\\(\d+)/g;r.endRuleId=-1,r.whileRuleId=-2,r.ruleIdFromNumber=function(a){return a},r.ruleIdToNumber=function(a){return a};class u{constructor(e,s,i,t){this.$location=e,this.id=s,this._name=i||null,this._nameIsCapturing=h.RegexSource.hasCaptures(this._name),this._contentName=t||null,this._contentNameIsCapturing=h.RegexSource.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${h.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,s){return this._nameIsCapturing&&this._name!==null&&e!==null&&s!==null?h.RegexSource.replaceCaptures(this._name,e,s):this._name}getContentName(e,s){return this._contentNameIsCapturing&&this._contentName!==null?h.RegexSource.replaceCaptures(this._contentName,e,s):this._contentName}}r.Rule=u;class S extends u{constructor(e,s,i,t,o){super(e,s,i,t),this.retokenizeCapturedWithRuleId=o}dispose(){}collectPatterns(e,s){throw new Error("Not supported!")}compile(e,s){throw new Error("Not supported!")}compileAG(e,s,i,t){throw new Error("Not supported!")}}r.CaptureRule=S;class L extends u{constructor(e,s,i,t,o){super(e,s,i,null),this._match=new c(t,this.id),this.captures=o,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(e,s){s.push(this._match)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new f,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}r.MatchRule=L;class y extends u{constructor(e,s,i,t,o){super(e,s,i,t),this.patterns=o.patterns,this.hasMissingPatterns=o.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(e,s){for(const i of this.patterns)e.getRule(i).collectPatterns(e,s)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new f,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}r.IncludeOnlyRule=y;class w extends u{constructor(e,s,i,t,o,l,b,A,P,E){super(e,s,i,t),this._begin=new c(o,this.id),this.beginCaptures=l,this._end=new c(b||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=A,this.applyEndPatternLast=P||!1,this.patterns=E.patterns,this.hasMissingPatterns=E.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(e,s){return this._end.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e,s).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e,s).compileAG(e,i,t)}_getCachedCompiledPatterns(e,s){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new f;for(const i of this.patterns)e.getRule(i).collectPatterns(e,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,s):this._cachedCompiledPatterns.setSource(0,s)),this._cachedCompiledPatterns}}r.BeginEndRule=w;class _ extends u{constructor(e,s,i,t,o,l,b,A,P){super(e,s,i,t),this._begin=new c(o,this.id),this.beginCaptures=l,this.whileCaptures=A,this._while=new c(b,r.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=P.patterns,this.hasMissingPatterns=P.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(e,s){return this._while.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,i,t){return this._getCachedCompiledPatterns(e).compileAG(e,i,t)}_getCachedCompiledPatterns(e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new f;for(const s of this.patterns)e.getRule(s).collectPatterns(e,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(e,s){return this._getCachedCompiledWhilePatterns(e,s).compile(e)}compileWhileAG(e,s,i,t){return this._getCachedCompiledWhilePatterns(e,s).compileAG(e,i,t)}_getCachedCompiledWhilePatterns(e,s){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new f,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,s||"￿"),this._cachedCompiledWhilePatterns}}r.BeginWhileRule=_;class m{static createCaptureRule(e,s,i,t,o){return e.registerRule(l=>new S(s,l,i,t,o))}static getCompiledRuleId(e,s,i){return e.id||s.registerRule(t=>{if(e.id=t,e.match)return new L(e.$vscodeTextmateLocation,e.id,e.name,e.match,m._compileCaptures(e.captures,s,i));if(e.begin===void 0){e.repository&&(i=h.mergeObjects({},i,e.repository));let o=e.patterns;return o===void 0&&e.include&&(o=[{include:e.include}]),new y(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,m._compilePatterns(o,s,i))}return e.while?new _(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,m._compileCaptures(e.beginCaptures||e.captures,s,i),e.while,m._compileCaptures(e.whileCaptures||e.captures,s,i),m._compilePatterns(e.patterns,s,i)):new w(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,m._compileCaptures(e.beginCaptures||e.captures,s,i),e.end,m._compileCaptures(e.endCaptures||e.captures,s,i),e.applyEndPatternLast,m._compilePatterns(e.patterns,s,i))}),e.id}static _compileCaptures(e,s,i){let t=[];if(e){let o=0;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const b=parseInt(l,10);b>o&&(o=b)}for(let l=0;l<=o;l++)t[l]=null;for(const l in e){if(l==="$vscodeTextmateLocation")continue;const b=parseInt(l,10);let A=0;e[l].patterns&&(A=m.getCompiledRuleId(e[l],s,i)),t[b]=m.createCaptureRule(s,e[l].$vscodeTextmateLocation,e[l].name,e[l].contentName,A)}}return t}static _compilePatterns(e,s,i){let t=[];if(e)for(let o=0,l=e.length;o<l;o++){const b=e[o];let A=-1;if(b.include){const P=n.parseInclude(b.include);switch(P.kind){case 0:case 1:A=m.getCompiledRuleId(i[b.include],s,i);break;case 2:let E=i[P.ruleName];E&&(A=m.getCompiledRuleId(E,s,i));break;case 3:case 4:const N=P.scopeName,V=P.kind===4?P.ruleName:null,B=s.getExternalGrammar(N,i);if(B)if(V){let D=B.repository[V];D&&(A=m.getCompiledRuleId(D,s,B.repository))}else A=m.getCompiledRuleId(B.repository.$self,s,B.repository)}}else A=m.getCompiledRuleId(b,s,i);if(A!==-1){const P=s.getRule(A);let E=!1;if((P instanceof y||P instanceof w||P instanceof _)&&P.hasMissingPatterns&&P.patterns.length===0&&(E=!0),E)continue;t.push(A)}}return{patterns:t,hasMissingPatterns:(e?e.length:0)!==t.length}}}r.RuleFactory=m;class c{constructor(e,s){if(e){const i=e.length;let t=0,o=[],l=!1;for(let b=0;b<i;b++)if(e.charAt(b)==="\\"&&b+1<i){const A=e.charAt(b+1);A==="z"?(o.push(e.substring(t,b)),o.push("$(?!\\n)(?<!\\n)"),t=b+2):A!=="A"&&A!=="G"||(l=!0),b++}this.hasAnchor=l,t===0?this.source=e:(o.push(e.substring(t,i)),this.source=o.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=s,this.hasBackReferences=k.test(this.source)}clone(){return new c(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,s){let i=s.map(t=>e.substring(t.start,t.end));return v.lastIndex=0,this.source.replace(v,(t,o)=>h.escapeRegExpCharacters(i[parseInt(o,10)]||""))}_buildAnchorCache(){let e,s,i,t,o=[],l=[],b=[],A=[];for(e=0,s=this.source.length;e<s;e++)i=this.source.charAt(e),o[e]=i,l[e]=i,b[e]=i,A[e]=i,i==="\\"&&e+1<s&&(t=this.source.charAt(e+1),t==="A"?(o[e+1]="￿",l[e+1]="￿",b[e+1]="A",A[e+1]="A"):t==="G"?(o[e+1]="￿",l[e+1]="G",b[e+1]="￿",A[e+1]="G"):(o[e+1]=t,l[e+1]=t,b[e+1]=t,A[e+1]=t),e++);return{A0_G0:o.join(""),A0_G1:l.join(""),A1_G0:b.join(""),A1_G1:A.join("")}}resolveAnchors(e,s){return this.hasAnchor&&this._anchorCache?e?s?this._anchorCache.A1_G1:this._anchorCache.A1_G0:s?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}r.RegExpSource=c;class f{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,s){this._items[e].source!==s&&(this._disposeCaches(),this._items[e].setSource(s))}compile(e){if(!this._cached){let s=this._items.map(i=>i.source);this._cached=new p(e,s,this._items.map(i=>i.ruleId))}return this._cached}compileAG(e,s,i){return this._hasAnchors?s?i?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,s,i)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,s,i)),this._anchorCache.A1_G0):i?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,s,i)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,s,i)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,s,i){let t=this._items.map(o=>o.resolveAnchors(s,i));return new p(e,t,this._items.map(o=>o.ruleId))}}r.RegExpSourceList=f;class p{constructor(e,s,i){this.regExps=s,this.rules=i,this.scanner=e.createOnigScanner(s)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let s=0,i=this.rules.length;s<i;s++)e.push("   - "+this.rules[s]+": "+this.regExps[s]);return e.join(`
`)}findNextMatchSync(e,s,i){const t=this.scanner.findNextMatchSync(e,s,i);return t?{ruleId:this.rules[t.index],captureIndices:t.captureIndices}:null}}r.CompiledRule=p},583:(C,r,d)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ThemeTrieElement=r.ThemeTrieElementRule=r.ColorMap=r.fontStyleToString=r.ParsedThemeRule=r.parseTheme=r.StyleAttributes=r.ScopeStack=r.Theme=void 0;const h=d(878);class n{constructor(c,f,p){this._colorMap=c,this._defaults=f,this._root=p,this._cachedMatchRoot=new h.CachedFn(a=>this._root.match(a))}static createFromRawTheme(c,f){return this.createFromParsedTheme(S(c),f)}static createFromParsedTheme(c,f){return function(p,a){p.sort((b,A)=>{let P=h.strcmp(b.scope,A.scope);return P!==0?P:(P=h.strArrCmp(b.parentScopes,A.parentScopes),P!==0?P:b.index-A.index)});let e=0,s="#000000",i="#ffffff";for(;p.length>=1&&p[0].scope==="";){let b=p.shift();b.fontStyle!==-1&&(e=b.fontStyle),b.foreground!==null&&(s=b.foreground),b.background!==null&&(i=b.background)}let t=new y(a),o=new u(e,t.getId(s),t.getId(i)),l=new _(new w(0,null,-1,0,0),[]);for(let b=0,A=p.length;b<A;b++){let P=p[b];l.insert(0,P.scope,P.parentScopes,P.fontStyle,t.getId(P.foreground),t.getId(P.background))}return new n(t,o,l)}(c,f)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(c){if(c===null)return this._defaults;const f=c.scopeName,p=this._cachedMatchRoot.get(f).find(a=>function(e,s){if(s===null)return!0;let i=0,t=s[i];for(;e;){if(v(e.scopeName,t)){if(i++,i===s.length)return!0;t=s[i]}e=e.parent}return!1}(c.parent,a.parentScopes));return p?new u(p.fontStyle,p.foreground,p.background):null}}r.Theme=n;class k{constructor(c,f){this.parent=c,this.scopeName=f}static push(c,f){for(const p of f)c=new k(c,p);return c}static from(...c){let f=null;for(let p=0;p<c.length;p++)f=new k(f,c[p]);return f}push(c){return new k(this,c)}getSegments(){let c=this;const f=[];for(;c;)f.push(c.scopeName),c=c.parent;return f.reverse(),f}toString(){return this.getSegments().join(" ")}extends(c){return this===c||this.parent!==null&&this.parent.extends(c)}getExtensionIfDefined(c){const f=[];let p=this;for(;p&&p!==c;)f.push(p.scopeName),p=p.parent;return p===c?f.reverse():void 0}}function v(m,c){return c===m||m.startsWith(c)&&m[c.length]==="."}r.ScopeStack=k;class u{constructor(c,f,p){this.fontStyle=c,this.foregroundId=f,this.backgroundId=p}}function S(m){if(!m)return[];if(!m.settings||!Array.isArray(m.settings))return[];let c=m.settings,f=[],p=0;for(let a=0,e=c.length;a<e;a++){let s,i=c[a];if(!i.settings)continue;if(typeof i.scope=="string"){let b=i.scope;b=b.replace(/^[,]+/,""),b=b.replace(/[,]+$/,""),s=b.split(",")}else s=Array.isArray(i.scope)?i.scope:[""];let t=-1;if(typeof i.settings.fontStyle=="string"){t=0;let b=i.settings.fontStyle.split(" ");for(let A=0,P=b.length;A<P;A++)switch(b[A]){case"italic":t|=1;break;case"bold":t|=2;break;case"underline":t|=4;break;case"strikethrough":t|=8}}let o=null;typeof i.settings.foreground=="string"&&h.isValidHexColor(i.settings.foreground)&&(o=i.settings.foreground);let l=null;typeof i.settings.background=="string"&&h.isValidHexColor(i.settings.background)&&(l=i.settings.background);for(let b=0,A=s.length;b<A;b++){let P=s[b].trim().split(" "),E=P[P.length-1],N=null;P.length>1&&(N=P.slice(0,P.length-1),N.reverse()),f[p++]=new L(E,N,a,t,o,l)}}return f}r.StyleAttributes=u,r.parseTheme=S;class L{constructor(c,f,p,a,e,s){this.scope=c,this.parentScopes=f,this.index=p,this.fontStyle=a,this.foreground=e,this.background=s}}r.ParsedThemeRule=L,r.fontStyleToString=function(m){if(m===-1)return"not set";let c="";return 1&m&&(c+="italic "),2&m&&(c+="bold "),4&m&&(c+="underline "),8&m&&(c+="strikethrough "),c===""&&(c="none"),c.trim()};class y{constructor(c){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(c)){this._isFrozen=!0;for(let f=0,p=c.length;f<p;f++)this._color2id[c[f]]=f,this._id2color[f]=c[f]}else this._isFrozen=!1}getId(c){if(c===null)return 0;c=c.toUpperCase();let f=this._color2id[c];if(f)return f;if(this._isFrozen)throw new Error(`Missing color in color map - ${c}`);return f=++this._lastColorId,this._color2id[c]=f,this._id2color[f]=c,f}getColorMap(){return this._id2color.slice(0)}}r.ColorMap=y;class w{constructor(c,f,p,a,e){this.scopeDepth=c,this.parentScopes=f,this.fontStyle=p,this.foreground=a,this.background=e}clone(){return new w(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(c){let f=[];for(let p=0,a=c.length;p<a;p++)f[p]=c[p].clone();return f}acceptOverwrite(c,f,p,a){this.scopeDepth>c?console.log("how did this happen?"):this.scopeDepth=c,f!==-1&&(this.fontStyle=f),p!==0&&(this.foreground=p),a!==0&&(this.background=a)}}r.ThemeTrieElementRule=w;class _{constructor(c,f=[],p={}){this._mainRule=c,this._children=p,this._rulesWithParentScopes=f}static _sortBySpecificity(c){return c.length===1||c.sort(this._cmpBySpecificity),c}static _cmpBySpecificity(c,f){if(c.scopeDepth===f.scopeDepth){const p=c.parentScopes,a=f.parentScopes;let e=p===null?0:p.length,s=a===null?0:a.length;if(e===s)for(let i=0;i<e;i++){const t=p[i].length,o=a[i].length;if(t!==o)return o-t}return s-e}return f.scopeDepth-c.scopeDepth}match(c){if(c==="")return _._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let f,p,a=c.indexOf(".");return a===-1?(f=c,p=""):(f=c.substring(0,a),p=c.substring(a+1)),this._children.hasOwnProperty(f)?this._children[f].match(p):_._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(c,f,p,a,e,s){if(f==="")return void this._doInsertHere(c,p,a,e,s);let i,t,o,l=f.indexOf(".");l===-1?(i=f,t=""):(i=f.substring(0,l),t=f.substring(l+1)),this._children.hasOwnProperty(i)?o=this._children[i]:(o=new _(this._mainRule.clone(),w.cloneArr(this._rulesWithParentScopes)),this._children[i]=o),o.insert(c+1,t,p,a,e,s)}_doInsertHere(c,f,p,a,e){if(f!==null){for(let s=0,i=this._rulesWithParentScopes.length;s<i;s++){let t=this._rulesWithParentScopes[s];if(h.strArrCmp(t.parentScopes,f)===0)return void t.acceptOverwrite(c,p,a,e)}p===-1&&(p=this._mainRule.fontStyle),a===0&&(a=this._mainRule.foreground),e===0&&(e=this._mainRule.background),this._rulesWithParentScopes.push(new w(c,f,p,a,e))}else this._mainRule.acceptOverwrite(c,p,a,e)}}r.ThemeTrieElement=_},878:(C,r)=>{function d(k){return Array.isArray(k)?function(v){let u=[];for(let S=0,L=v.length;S<L;S++)u[S]=d(v[S]);return u}(k):typeof k=="object"?function(v){let u={};for(let S in v)u[S]=d(v[S]);return u}(k):k}Object.defineProperty(r,"__esModule",{value:!0}),r.performanceNow=r.CachedFn=r.escapeRegExpCharacters=r.isValidHexColor=r.strArrCmp=r.strcmp=r.RegexSource=r.basename=r.mergeObjects=r.clone=void 0,r.clone=function(k){return d(k)},r.mergeObjects=function(k,...v){return v.forEach(u=>{for(let S in u)k[S]=u[S]}),k},r.basename=function k(v){const u=~v.lastIndexOf("/")||~v.lastIndexOf("\\");return u===0?v:~u==v.length-1?k(v.substring(0,v.length-1)):v.substr(1+~u)};let h=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function n(k,v){return k<v?-1:k>v?1:0}r.RegexSource=class{static hasCaptures(k){return k!==null&&(h.lastIndex=0,h.test(k))}static replaceCaptures(k,v,u){return k.replace(h,(S,L,y,w)=>{let _=u[parseInt(L||y,10)];if(!_)return S;{let m=v.substring(_.start,_.end);for(;m[0]===".";)m=m.substring(1);switch(w){case"downcase":return m.toLowerCase();case"upcase":return m.toUpperCase();default:return m}}})}},r.strcmp=n,r.strArrCmp=function(k,v){if(k===null&&v===null)return 0;if(!k)return-1;if(!v)return 1;let u=k.length,S=v.length;if(u===S){for(let L=0;L<u;L++){let y=n(k[L],v[L]);if(y!==0)return y}return 0}return u-S},r.isValidHexColor=function(k){return!!(/^#[0-9a-f]{6}$/i.test(k)||/^#[0-9a-f]{8}$/i.test(k)||/^#[0-9a-f]{3}$/i.test(k)||/^#[0-9a-f]{4}$/i.test(k))},r.escapeRegExpCharacters=function(k){return k.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},r.CachedFn=class{constructor(k){this.fn=k,this.cache=new Map}get(k){if(this.cache.has(k))return this.cache.get(k);const v=this.fn(k);return this.cache.set(k,v),v}},r.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},x={};return function C(r){var d=x[r];if(d!==void 0)return d.exports;var h=x[r]={exports:{}};return R[r].call(h.exports,h,h.exports,C),h.exports}(787)})()})})(et);var we=et.exports;const Vt=Be(we),Ht=Ze({__proto__:null,default:Vt},[we]);class Pe extends ye{static{this._id=0}constructor(g,T,R,x,C,r){super(),this._model=g,this._worker=T,this._languageIdCodec=R,this._backgroundTokenizationStore=x,this._configurationService=C,this._maxTokenizationLineLength=r,this.controllerId=Pe._id++,this._pendingChanges=[],this._states=new ct,this._loggingEnabled=Kt("editor.experimental.asyncTokenizationLogging",!1,this._configurationService),this._register(ze(this._loggingEnabled)),this._register(this._model.onDidChangeContent(n=>{this._shouldLog&&console.log("model change",{fileName:this._model.uri.fsPath.split("\\").pop(),changes:Re(n.changes)}),this._worker.acceptModelChanged(this.controllerId,n),this._pendingChanges.push(n)})),this._register(this._model.onDidChangeLanguage(n=>{const k=this._model.getLanguageId(),v=this._languageIdCodec.encodeLanguageId(k);this._worker.acceptModelLanguageChanged(this.controllerId,k,v)}));const d=this._model.getLanguageId(),h=this._languageIdCodec.encodeLanguageId(d);this._worker.acceptNewModel({uri:this._model.uri,versionId:this._model.getVersionId(),lines:this._model.getLinesContent(),EOL:this._model.getEOL(),languageId:d,encodedLanguageId:h,maxTokenizationLineLength:this._maxTokenizationLineLength.get(),controllerId:this.controllerId}),this._register(ut(n=>{const k=this._maxTokenizationLineLength.read(n);this._worker.acceptMaxTokenizationLineLength(this.controllerId,k)}))}dispose(){super.dispose(),this._worker.acceptRemovedModel(this.controllerId)}requestTokens(g,T){this._worker.retokenize(this.controllerId,g,T)}async setTokensAndStates(g,T,R,x){if(this.controllerId!==g)return;let C=Oe.deserialize(new Uint8Array(R));if(this._shouldLog&&console.log("received background tokenization result",{fileName:this._model.uri.fsPath.split("\\").pop(),updatedTokenLines:C.map(d=>d.getLineRange()).join(" & "),updatedStateLines:x.map(d=>new lt(d.startLineNumber,d.startLineNumber+d.stateDeltas.length).toString()).join(" & ")}),this._shouldLog){const d=this._pendingChanges.filter(h=>h.versionId<=T).map(h=>h.changes).map(h=>Re(h)).join(" then ");console.log("Applying changes to local states",d)}for(;this._pendingChanges.length>0&&this._pendingChanges[0].versionId<=T;){const d=this._pendingChanges.shift();this._states.acceptChanges(d.changes)}if(this._pendingChanges.length>0){if(this._shouldLog){const n=this._pendingChanges.map(k=>k.changes).map(k=>Re(k)).join(" then ");console.log("Considering non-processed changes",n)}const d=ve.fromMany(this._pendingChanges.map(n=>Fe(n.changes))),h=new Oe;for(const n of C)for(let k=n.startLineNumber;k<=n.endLineNumber;k++)d.transform(k-1)!==void 0&&h.add(k,n.getLineTokens(k));C=h.finalize();for(const n of this._pendingChanges)for(const k of n.changes)for(let v=0;v<C.length;v++)C[v].applyEdit(k.range,k.text)}const r=ve.fromMany(this._pendingChanges.map(d=>Fe(d.changes)));(!this._applyStateStackDiffFn||!this._initialState)&&(this._applyStateStackDiffFn=we.applyStateStackDiff,this._initialState=we.INITIAL);for(const d of x){let h=d.startLineNumber<=1?this._initialState:this._states.getEndState(d.startLineNumber-1);for(let n=0;n<d.stateDeltas.length;n++){const k=d.stateDeltas[n];let v;k?(v=this._applyStateStackDiffFn(h,k),this._states.setEndState(d.startLineNumber+n,v)):v=this._states.getEndState(d.startLineNumber+n);const u=r.transform(d.startLineNumber+n-1);u!==void 0&&this._backgroundTokenizationStore.setEndState(u+1,v),d.startLineNumber+n>=this._model.getLineCount()-1&&this._backgroundTokenizationStore.backgroundTokenizationFinished(),h=v}}this._backgroundTokenizationStore.setTokens(C)}get _shouldLog(){return this._loggingEnabled.get()}}function Fe(G){return new Wt(G.map(g=>new Ut(g.range.startLineNumber-1,g.range.endLineNumber-g.range.startLineNumber+1,ht(g.text)[0]+1)))}function Re(G){return G.map(g=>dt.lift(g.range).toString()+" => "+g.text).join(" & ")}function Kt(G,g,T){return We(R=>T.onDidChangeConfiguration(x=>{x.affectsConfiguration(G)&&R(x)}),()=>T.getValue(G)??g)}var be;let Ae=class{static{be=this}static{this._reportedMismatchingTokens=!1}constructor(g,T,R,x,C,r,d,h,n,k){this._reportTokenizationTime=g,this._shouldTokenizeAsync=T,this._extensionResourceLoaderService=R,this._modelService=x,this._languageConfigurationService=C,this._configurationService=r,this._languageService=d,this._environmentService=h,this._notificationService=n,this._telemetryService=k,this._workerProxyPromise=null,this._worker=null,this._workerProxy=null,this._workerTokenizerControllers=new Map,this._currentTheme=null,this._currentTokenColorMap=null,this._grammarDefinitions=[]}dispose(){this._disposeWorker()}createBackgroundTokenizer(g,T,R){if(!this._shouldTokenizeAsync()||g.isTooLargeForSyncing())return;const x=new Te,C=this._getWorkerProxy().then(r=>{if(x.isDisposed||!r)return;const d={controller:void 0,worker:this._worker};return x.add(Qt(g,()=>{const h=new Pe(g,r,this._languageService.languageIdCodec,T,this._configurationService,R);return d.controller=h,this._workerTokenizerControllers.set(h.controllerId,h),ft(()=>{d.controller=void 0,this._workerTokenizerControllers.delete(h.controllerId),h.dispose()})})),d});return{dispose(){x.dispose()},requestTokens:async(r,d)=>{const h=await C;h?.controller&&h.worker===this._worker&&h.controller.requestTokens(r,d)},reportMismatchingTokens:r=>{be._reportedMismatchingTokens||(be._reportedMismatchingTokens=!0,this._notificationService.error({message:"Async Tokenization Token Mismatch in line "+r,name:"Async Tokenization Token Mismatch"}),this._telemetryService.publicLog2("asyncTokenizationMismatchingTokens",{}))}}}setGrammarDefinitions(g){this._grammarDefinitions=g,this._disposeWorker()}acceptTheme(g,T){this._currentTheme=g,this._currentTokenColorMap=T,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap)}_getWorkerProxy(){return this._workerProxyPromise||(this._workerProxyPromise=this._createWorkerProxy()),this._workerProxyPromise}async _createWorkerProxy(){const g=`${Le}/vscode-textmate`,T=`${Ge}/vscode-textmate`,R=`${Le}/vscode-oniguruma`,x=`${Ge}/vscode-oniguruma`,C=this._environmentService.isBuilt&&!Ue,r=C?T:g,d=C?x:R,h=`${r}/release/main.js`,n=`${d}/release/main.js`,k=`${d}/release/onig.wasm`,v=me.asBrowserUri(h).toString(!0),u={grammarDefinitions:this._grammarDefinitions,textmateMainUri:v,onigurumaMainUri:me.asBrowserUri(n).toString(!0),onigurumaWASMUri:me.asBrowserUri(k).toString(!0)},S={readFile:async w=>{const _=gt.revive(w);return this._extensionResourceLoaderService.readExtensionResource(_)},setTokensAndStates:async(w,_,m,c)=>{const f=this._workerTokenizerControllers.get(w);f&&f.setTokensAndStates(w,_,m,c)},reportTokenizationTime:(w,_,m,c,f)=>{this._reportTokenizationTime(w,_,m,c,f)}},L=this._worker=pt(this._modelService,this._languageConfigurationService,{createData:u,label:"textMateWorker",moduleId:"vs/workbench/services/textMate/browser/backgroundTokenization/worker/textMateTokenizationWorker.worker",host:S}),y=await L.getProxy();return this._worker!==L?null:(this._workerProxy=y,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap),y)}_disposeWorker(){for(const g of this._workerTokenizerControllers.values())g.dispose();this._workerTokenizerControllers.clear(),this._worker&&(this._worker.dispose(),this._worker=null),this._workerProxy=null,this._workerProxyPromise=null}};Ae=be=xe([J(2,qe),J(3,mt),J(4,_t),J(5,Ve),J(6,He),J(7,kt),J(8,Ke),J(9,Qe)],Ae);function Qt(G,g){const T=new Te,R=T.add(new Te);function x(){G.isAttachedToEditor()?R.add(g()):R.clear()}return x(),T.add(G.onDidChangeAttached(()=>{x()})),T}class Jt{constructor(){this._scopeNameToLanguageRegistration=Object.create(null)}reset(){this._scopeNameToLanguageRegistration=Object.create(null)}register(g){this._scopeNameToLanguageRegistration[g.scopeName]=g}getGrammarDefinition(g){return this._scopeNameToLanguageRegistration[g]||null}}const Se="No TM Grammar registered for this language.";class Xt extends ye{constructor(g,T,R,x){super(),this._host=g,this._initialState=R.INITIAL,this._scopeRegistry=new Jt,this._injections={},this._injectedEmbeddedLanguages={},this._languageToScope=new Map,this._grammarRegistry=this._register(new R.Registry({onigLib:x,loadGrammar:async C=>{const r=this._scopeRegistry.getGrammarDefinition(C);if(!r)return this._host.logTrace(`No grammar found for scope ${C}`),null;const d=r.location;try{const h=await this._host.readFile(d);return R.parseRawGrammar(h,d.path)}catch(h){return this._host.logError(`Unable to load and parse grammar for scope ${C} from ${d}`,h),null}},getInjections:C=>{const r=C.split(".");let d=[];for(let h=1;h<=r.length;h++){const n=r.slice(0,h).join(".");d=[...d,...this._injections[n]||[]]}return d}}));for(const C of T){if(this._scopeRegistry.register(C),C.injectTo){for(const r of C.injectTo){let d=this._injections[r];d||(this._injections[r]=d=[]),d.push(C.scopeName)}if(C.embeddedLanguages)for(const r of C.injectTo){let d=this._injectedEmbeddedLanguages[r];d||(this._injectedEmbeddedLanguages[r]=d=[]),d.push(C.embeddedLanguages)}}C.language&&this._languageToScope.set(C.language,C.scopeName)}}has(g){return this._languageToScope.has(g)}setTheme(g,T){this._grammarRegistry.setTheme(g,T)}getColorMap(){return this._grammarRegistry.getColorMap()}async createGrammar(g,T){const R=this._languageToScope.get(g);if(typeof R!="string")throw new Error(Se);const x=this._scopeRegistry.getGrammarDefinition(R);if(!x)throw new Error(Se);const C=x.embeddedLanguages;if(this._injectedEmbeddedLanguages[R]){const h=this._injectedEmbeddedLanguages[R];for(const n of h)for(const k of Object.keys(n))C[k]=n[k]}const r=Object.keys(C).length>0;let d;try{d=await this._grammarRegistry.loadGrammarWithConfiguration(R,T,{embeddedLanguages:C,tokenTypes:x.tokenTypes,balancedBracketSelectors:x.balancedBracketSelectors,unbalancedBracketSelectors:x.unbalancedBracketSelectors})}catch(h){throw h.message&&h.message.startsWith("No grammar provided for")?new Error(Se):h}return{languageId:g,grammar:d,initialState:this._initialState,containsEmbeddedLanguages:r,sourceExtensionId:x.sourceExtensionId}}}const le=yt.registerExtensionPoint({extensionPoint:"grammars",deps:[bt],jsonSchema:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars","Contributes textmate tokenizers."),type:"array",defaultSnippets:[{body:[{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}}],properties:{language:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.language","Language identifier for which this syntax is contributed to."),type:"string"},scopeName:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.scopeName","Textmate scope name used by the tmLanguage file."),type:"string"},path:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.path","Path of the tmLanguage file. The path is relative to the extension folder and typically starts with './syntaxes/'."),type:"string"},embeddedLanguages:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.embeddedLanguages","A map of scope name to language id if this grammar contains embedded languages."),type:"object"},tokenTypes:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.tokenTypes","A map of scope name to token types."),type:"object",additionalProperties:{enum:["string","comment","other"]}},injectTo:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.injectTo","List of language scope names to which this grammar is injected to."),type:"array",items:{type:"string"}},balancedBracketScopes:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.balancedBracketScopes","Defines which scope names contain balanced brackets."),type:"array",items:{type:"string"},default:["*"]},unbalancedBracketScopes:{description:Q("vs/workbench/services/textMate/common/TMGrammars","vscode.extension.contributes.grammars.unbalancedBracketScopes","Defines which scope names do not contain balanced brackets."),type:"array",items:{type:"string"},default:[]}},required:["scopeName","path"]}}});var tt={exports:{}};(function(G,g){(function(T,R){G.exports=R()})($e,()=>{return T={770:function(x,C,r){var d=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(C,"__esModule",{value:!0}),C.setDefaultDebugCall=C.createOnigScanner=C.createOnigString=C.loadWASM=C.OnigScanner=C.OnigString=void 0;const h=d(r(418));let n=null,k=!1;class v{static _utf8ByteLength(_){let m=0;for(let c=0,f=_.length;c<f;c++){const p=_.charCodeAt(c);let a=p,e=!1;if(p>=55296&&p<=56319&&c+1<f){const s=_.charCodeAt(c+1);s>=56320&&s<=57343&&(a=65536+(p-55296<<10)|s-56320,e=!0)}m+=a<=127?1:a<=2047?2:a<=65535?3:4,e&&c++}return m}constructor(_){const m=_.length,c=v._utf8ByteLength(_),f=c!==m,p=f?new Uint32Array(m+1):null;f&&(p[m]=c);const a=f?new Uint32Array(c+1):null;f&&(a[c]=m);const e=new Uint8Array(c);let s=0;for(let i=0;i<m;i++){const t=_.charCodeAt(i);let o=t,l=!1;if(t>=55296&&t<=56319&&i+1<m){const b=_.charCodeAt(i+1);b>=56320&&b<=57343&&(o=65536+(t-55296<<10)|b-56320,l=!0)}f&&(p[i]=s,l&&(p[i+1]=s),o<=127?a[s+0]=i:o<=2047?(a[s+0]=i,a[s+1]=i):o<=65535?(a[s+0]=i,a[s+1]=i,a[s+2]=i):(a[s+0]=i,a[s+1]=i,a[s+2]=i,a[s+3]=i)),o<=127?e[s++]=o:o<=2047?(e[s++]=192|(1984&o)>>>6,e[s++]=128|(63&o)>>>0):o<=65535?(e[s++]=224|(61440&o)>>>12,e[s++]=128|(4032&o)>>>6,e[s++]=128|(63&o)>>>0):(e[s++]=240|(1835008&o)>>>18,e[s++]=128|(258048&o)>>>12,e[s++]=128|(4032&o)>>>6,e[s++]=128|(63&o)>>>0),l&&i++}this.utf16Length=m,this.utf8Length=c,this.utf16Value=_,this.utf8Value=e,this.utf16OffsetToUtf8=p,this.utf8OffsetToUtf16=a}createString(_){const m=_._omalloc(this.utf8Length);return _.HEAPU8.set(this.utf8Value,m),m}}class u{constructor(_){if(this.id=++u.LAST_ID,!n)throw new Error("Must invoke loadWASM first.");this._onigBinding=n,this.content=_;const m=new v(_);this.utf16Length=m.utf16Length,this.utf8Length=m.utf8Length,this.utf16OffsetToUtf8=m.utf16OffsetToUtf8,this.utf8OffsetToUtf16=m.utf8OffsetToUtf16,this.utf8Length<1e4&&!u._sharedPtrInUse?(u._sharedPtr||(u._sharedPtr=n._omalloc(1e4)),u._sharedPtrInUse=!0,n.HEAPU8.set(m.utf8Value,u._sharedPtr),this.ptr=u._sharedPtr):this.ptr=m.createString(n)}convertUtf8OffsetToUtf16(_){return this.utf8OffsetToUtf16?_<0?0:_>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[_]:_}convertUtf16OffsetToUtf8(_){return this.utf16OffsetToUtf8?_<0?0:_>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[_]:_}dispose(){this.ptr===u._sharedPtr?u._sharedPtrInUse=!1:this._onigBinding._ofree(this.ptr)}}C.OnigString=u,u.LAST_ID=0,u._sharedPtr=0,u._sharedPtrInUse=!1;class S{constructor(_){if(!n)throw new Error("Must invoke loadWASM first.");const m=[],c=[];for(let e=0,s=_.length;e<s;e++){const i=new v(_[e]);m[e]=i.createString(n),c[e]=i.utf8Length}const f=n._omalloc(4*_.length);n.HEAPU32.set(m,f/4);const p=n._omalloc(4*_.length);n.HEAPU32.set(c,p/4);const a=n._createOnigScanner(f,p,_.length);for(let e=0,s=_.length;e<s;e++)n._ofree(m[e]);n._ofree(p),n._ofree(f),a===0&&function(e){throw new Error(e.UTF8ToString(e._getLastOnigError()))}(n),this._onigBinding=n,this._ptr=a}dispose(){this._onigBinding._freeOnigScanner(this._ptr)}findNextMatchSync(_,m,c){let f=k,p=0;if(typeof c=="number"?(8&c&&(f=!0),p=c):typeof c=="boolean"&&(f=c),typeof _=="string"){_=new u(_);const a=this._findNextMatchSync(_,m,f,p);return _.dispose(),a}return this._findNextMatchSync(_,m,f,p)}_findNextMatchSync(_,m,c,f){const p=this._onigBinding;let a;if(a=c?p._findNextOnigScannerMatchDbg(this._ptr,_.id,_.ptr,_.utf8Length,_.convertUtf16OffsetToUtf8(m),f):p._findNextOnigScannerMatch(this._ptr,_.id,_.ptr,_.utf8Length,_.convertUtf16OffsetToUtf8(m),f),a===0)return null;const e=p.HEAPU32;let s=a/4;const i=e[s++],t=e[s++];let o=[];for(let l=0;l<t;l++){const b=_.convertUtf8OffsetToUtf16(e[s++]),A=_.convertUtf8OffsetToUtf16(e[s++]);o[l]={start:b,end:A,length:A-b}}return{index:i,captureIndices:o}}}C.OnigScanner=S;let L=!1,y=null;C.loadWASM=function(w){if(L)return y;let _,m,c,f;if(L=!0,function(p){return typeof p.instantiator=="function"}(w))_=w.instantiator,m=w.print;else{let p;(function(a){return a.data!==void 0})(w)?(p=w.data,m=w.print):p=w,_=function(a){return typeof Response<"u"&&a instanceof Response}(p)?typeof WebAssembly.instantiateStreaming=="function"?function(a){return e=>WebAssembly.instantiateStreaming(a,e)}(p):function(a){return async e=>{const s=await a.arrayBuffer();return WebAssembly.instantiate(s,e)}}(p):function(a){return e=>WebAssembly.instantiate(a,e)}(p)}return y=new Promise((p,a)=>{c=p,f=a}),function(p,a,e,s){(0,h.default)({print:a,instantiateWasm:(i,t)=>{if(typeof performance>"u"){const o=()=>Date.now();i.env.emscripten_get_now=o,i.wasi_snapshot_preview1.emscripten_get_now=o}return p(i).then(o=>t(o.instance),s),{}}}).then(i=>{n=i,e()})}(_,m,c,f),y},C.createOnigString=function(w){return new u(w)},C.createOnigScanner=function(w){return new S(w)},C.setDefaultDebugCall=function(w){k=w}},418:x=>{var C=(typeof document<"u"&&document.currentScript&&document.currentScript.src,function(r){var d,h,n=(r=r||{})!==void 0?r:{};n.ready=new Promise(function(M,O){d=M,h=O});var k,v=Object.assign({},n),u="";function S(M){return n.locateFile?n.locateFile(M,u):u+M}k=function(M){let O;return typeof readbuffer=="function"?new Uint8Array(readbuffer(M)):(O=read(M,"binary"),c(typeof O=="object"),O)},typeof scriptArgs<"u"&&scriptArgs,typeof onig_print<"u"&&(typeof console>"u"&&(console={}),console.log=onig_print,console.warn=console.error=typeof printErr<"u"?printErr:onig_print);var L,y,w=n.print||console.log.bind(console),_=n.printErr||console.warn.bind(console);Object.assign(n,v),v=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&n.quit,n.wasmBinary&&(L=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&j("no native wasm support detected");var m=!1;function c(M,O){M||j(O)}var f,p,a,e=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function s(M,O,Y){for(var ee=O+Y,U=O;M[U]&&!(U>=ee);)++U;if(U-O>16&&M.buffer&&e)return e.decode(M.subarray(O,U));for(var q="";O<U;){var Z=M[O++];if(128&Z){var re=63&M[O++];if((224&Z)!=192){var ce=63&M[O++];if((Z=(240&Z)==224?(15&Z)<<12|re<<6|ce:(7&Z)<<18|re<<12|ce<<6|63&M[O++])<65536)q+=String.fromCharCode(Z);else{var Ee=Z-65536;q+=String.fromCharCode(55296|Ee>>10,56320|1023&Ee)}}else q+=String.fromCharCode((31&Z)<<6|re)}else q+=String.fromCharCode(Z)}return q}function i(M,O){return M?s(p,M,O):""}function t(M){f=M,n.HEAP8=new Int8Array(M),n.HEAP16=new Int16Array(M),n.HEAP32=new Int32Array(M),n.HEAPU8=p=new Uint8Array(M),n.HEAPU16=new Uint16Array(M),n.HEAPU32=a=new Uint32Array(M),n.HEAPF32=new Float32Array(M),n.HEAPF64=new Float64Array(M)}n.INITIAL_MEMORY;var o=[],l=[],b=[];function A(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)N(n.preRun.shift());oe(o)}function P(){oe(l)}function E(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)B(n.postRun.shift());oe(b)}function N(M){o.unshift(M)}function V(M){l.unshift(M)}function B(M){b.unshift(M)}var D=0,z=null;function X(M){D++,n.monitorRunDependencies&&n.monitorRunDependencies(D)}function H(M){if(D--,n.monitorRunDependencies&&n.monitorRunDependencies(D),D==0&&z){var O=z;z=null,O()}}function j(M){n.onAbort&&n.onAbort(M),_(M="Aborted("+M+")"),m=!0,M+=". Build with -sASSERTIONS for more info.";var O=new WebAssembly.RuntimeError(M);throw h(O),O}var F,$,ie="data:application/octet-stream;base64,";function I(M){return M.startsWith(ie)}function K(M){try{if(M==F&&L)return new Uint8Array(L);if(k)return k(M);throw"both async and sync fetching of the wasm failed"}catch(O){j(O)}}function W(){return Promise.resolve().then(function(){return K(F)})}function ne(){var M={env:ae,wasi_snapshot_preview1:ae};function O(U,q){var Z=U.exports;n.asm=Z,t((y=n.asm.memory).buffer),n.asm.__indirect_function_table,V(n.asm.__wasm_call_ctors),H()}function Y(U){O(U.instance)}function ee(U){return W().then(function(q){return WebAssembly.instantiate(q,M)}).then(function(q){return q}).then(U,function(q){_("failed to asynchronously prepare wasm: "+q),j(q)})}if(X(),n.instantiateWasm)try{return n.instantiateWasm(M,O)}catch(U){_("Module.instantiateWasm callback failed with error: "+U),h(U)}return(L||typeof WebAssembly.instantiateStreaming!="function"||I(F)||typeof fetch!="function"?ee(Y):fetch(F,{credentials:"same-origin"}).then(function(U){return WebAssembly.instantiateStreaming(U,M).then(Y,function(q){return _("wasm streaming compile failed: "+q),_("falling back to ArrayBuffer instantiation"),ee(Y)})})).catch(h),{}}function oe(M){for(;M.length>0;)M.shift()(n)}function _e(M,O,Y){p.copyWithin(M,O,O+Y)}function he(M){try{return y.grow(M-f.byteLength+65535>>>16),t(y.buffer),1}catch{}}function ue(M){var O,Y=p.length,ee=2147483648;if((M>>>=0)>ee)return!1;for(var U=1;U<=4;U*=2){var q=Y*(1+.2/U);if(q=Math.min(q,M+100663296),he(Math.min(ee,(O=Math.max(M,q))+(65536-O%65536)%65536)))return!0}return!1}I(F="onig.wasm")||(F=S(F)),$=typeof dateNow<"u"?dateNow:()=>performance.now();var ge=[null,[],[]];function de(M,O){var Y=ge[M];O===0||O===10?((M===1?w:_)(s(Y,0)),Y.length=0):Y.push(O)}function pe(M,O,Y,ee){for(var U=0,q=0;q<Y;q++){var Z=a[O>>2],re=a[O+4>>2];O+=8;for(var ce=0;ce<re;ce++)de(M,p[Z+ce]);U+=re}return a[ee>>2]=U,0}var se,ae={emscripten_get_now:$,emscripten_memcpy_big:_e,emscripten_resize_heap:ue,fd_write:pe};function te(M){function O(){se||(se=!0,n.calledRun=!0,m||(P(),d(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),E()))}D>0||(A(),D>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),O()},1)):O()))}if(ne(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.__errno_location).apply(null,arguments)},n._omalloc=function(){return(n._omalloc=n.asm.omalloc).apply(null,arguments)},n._ofree=function(){return(n._ofree=n.asm.ofree).apply(null,arguments)},n._getLastOnigError=function(){return(n._getLastOnigError=n.asm.getLastOnigError).apply(null,arguments)},n._createOnigScanner=function(){return(n._createOnigScanner=n.asm.createOnigScanner).apply(null,arguments)},n._freeOnigScanner=function(){return(n._freeOnigScanner=n.asm.freeOnigScanner).apply(null,arguments)},n._findNextOnigScannerMatch=function(){return(n._findNextOnigScannerMatch=n.asm.findNextOnigScannerMatch).apply(null,arguments)},n._findNextOnigScannerMatchDbg=function(){return(n._findNextOnigScannerMatchDbg=n.asm.findNextOnigScannerMatchDbg).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.dynCall_jiji).apply(null,arguments)},n.UTF8ToString=i,z=function M(){se||te(),se||(z=M)},n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return te(),r.ready});x.exports=C}},R={},function x(C){var r=R[C];if(r!==void 0)return r.exports;var d=R[C]={exports:{}};return T[C].call(d.exports,d,d.exports,x),d.exports}(770);var T,R})})(tt);var Me=tt.exports;const Yt=Be(Me),Zt=Ze({__proto__:null,default:Yt},[Me]);var fe;let Ie=class extends ye{static{fe=this}static{this.reportTokenizationTimeCounter={sync:0,async:0}}constructor(g,T,R,x,C,r,d,h,n,k){super(),this._languageService=g,this._themeService=T,this._extensionResourceLoaderService=R,this._notificationService=x,this._logService=C,this._configurationService=r,this._progressService=d,this._environmentService=h,this._instantiationService=n,this._telemetryService=k,this._createdModes=[],this._encounteredLanguages=[],this._debugMode=!1,this._debugModePrintFunc=()=>{},this._grammarDefinitions=null,this._grammarFactory=null,this._tokenizersRegistrations=new Te,this._currentTheme=null,this._currentTokenColorMap=null,this._threadedBackgroundTokenizerFactory=this._instantiationService.createInstance(Ae,(v,u,S,L,y)=>this._reportTokenizationTime(v,u,S,L,!0,y),()=>this.getAsyncTokenizationEnabled()),this._vscodeOniguruma=null,this._styleElement=St(),this._styleElement.className="vscode-tokens-styles",le.setHandler(v=>this._handleGrammarsExtPoint(v)),this._updateTheme(this._themeService.getColorTheme(),!0),this._register(this._themeService.onDidColorThemeChange(()=>{this._updateTheme(this._themeService.getColorTheme(),!1)})),this._languageService.onDidRequestRichLanguageFeatures(v=>{this._createdModes.push(v)})}getAsyncTokenizationEnabled(){return!!this._configurationService.getValue("editor.experimental.asyncTokenization")}getAsyncTokenizationVerification(){return!!this._configurationService.getValue("editor.experimental.asyncTokenizationVerification")}_handleGrammarsExtPoint(g){this._grammarDefinitions=null,this._grammarFactory&&(this._grammarFactory.dispose(),this._grammarFactory=null),this._tokenizersRegistrations.clear(),this._grammarDefinitions=[];for(const T of g){const R=T.value;for(const x of R){const C=this._validateGrammarDefinition(T,x);if(C&&(this._grammarDefinitions.push(C),C.language)){const r=new Tt(()=>this._createTokenizationSupport(C.language));this._tokenizersRegistrations.add(r),this._tokenizersRegistrations.add(Ce.registerFactory(C.language,r))}}}this._threadedBackgroundTokenizerFactory.setGrammarDefinitions(this._grammarDefinitions);for(const T of this._createdModes)Ce.getOrCreate(T)}_validateGrammarDefinition(g,T){if(!nn(g.description.extensionLocation,T,g.collector,this._languageService))return null;const R=Je(g.description.extensionLocation,T.path),x=Object.create(null);if(T.embeddedLanguages){const h=Object.keys(T.embeddedLanguages);for(let n=0,k=h.length;n<k;n++){const v=h[n],u=T.embeddedLanguages[v];typeof u=="string"&&this._languageService.isRegisteredLanguageId(u)&&(x[v]=this._languageService.languageIdCodec.encodeLanguageId(u))}}const C=Object.create(null);if(T.tokenTypes){const h=Object.keys(T.tokenTypes);for(const n of h)switch(T.tokenTypes[n]){case"string":C[n]=2;break;case"other":C[n]=0;break;case"comment":C[n]=1;break}}const r=T.language&&this._languageService.isRegisteredLanguageId(T.language)?T.language:null;function d(h,n){return!Array.isArray(h)||!h.every(k=>typeof k=="string")?n:h}return{location:R,language:r||void 0,scopeName:T.scopeName,embeddedLanguages:x,tokenTypes:C,injectTo:T.injectTo,balancedBracketSelectors:d(T.balancedBracketScopes,["*"]),unbalancedBracketSelectors:d(T.unbalancedBracketScopes,[]),sourceExtensionId:g.description.id}}startDebugMode(g,T){if(this._debugMode){this._notificationService.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","alreadyDebugging","Already Logging."));return}this._debugModePrintFunc=g,this._debugMode=!0,this._debugMode&&this._progressService.withProgress({location:15,buttons:[Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","stop","Stop")]},R=>(R.report({message:Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","progress1","Preparing to log TM Grammar parsing. Press Stop when finished.")}),this._getVSCodeOniguruma().then(x=>(x.setDefaultDebugCall(!0),R.report({message:Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","progress2","Now logging TM Grammar parsing. Press Stop when finished.")}),new Promise((C,r)=>{})))),R=>{this._getVSCodeOniguruma().then(x=>{this._debugModePrintFunc=()=>{},this._debugMode=!1,x.setDefaultDebugCall(!1),T()})})}_canCreateGrammarFactory(){return!!this._grammarDefinitions}async _getOrCreateGrammarFactory(){if(this._grammarFactory)return this._grammarFactory;const g=await this._getVSCodeOniguruma(),T=Promise.resolve({createOnigScanner:R=>g.createOnigScanner(R),createOnigString:R=>g.createOnigString(R)});return this._grammarFactory?this._grammarFactory:(this._grammarFactory=new Xt({logTrace:R=>this._logService.trace(R),logError:(R,x)=>this._logService.error(R,x),readFile:R=>this._extensionResourceLoaderService.readExtensionResource(R)},this._grammarDefinitions||[],Ht,T),this._updateTheme(this._themeService.getColorTheme(),!0),this._grammarFactory)}async _createTokenizationSupport(g){if(!this._languageService.isRegisteredLanguageId(g)||!this._canCreateGrammarFactory())return null;try{const T=await this._getOrCreateGrammarFactory();if(!T.has(g))return null;const R=this._languageService.languageIdCodec.encodeLanguageId(g),x=await T.createGrammar(g,R);if(!x.grammar)return null;const C=rn("editor.maxTokenizationLineLength",g,-1,this._configurationService),r=new Bt(x.grammar,x.initialState,x.containsEmbeddedLanguages,(d,h)=>this._threadedBackgroundTokenizerFactory.createBackgroundTokenizer(d,h,C),()=>this.getAsyncTokenizationVerification(),(d,h,n)=>{this._reportTokenizationTime(d,g,x.sourceExtensionId,h,!1,n)},!0);return r.onDidEncounterLanguage(d=>{if(!this._encounteredLanguages[d]){const h=this._languageService.languageIdCodec.decodeLanguageId(d);this._encounteredLanguages[d]=!0,this._languageService.requestBasicLanguageFeatures(h)}}),new $t(R,r,C)}catch(T){return T.message&&T.message===Se||vt(T),null}}_updateTheme(g,T){if(!T&&this._currentTheme&&this._currentTokenColorMap&&tn(this._currentTheme.settings,g.tokenColors)&&wt(this._currentTokenColorMap,g.tokenColorMap))return;this._currentTheme={name:g.label,settings:g.tokenColors},this._currentTokenColorMap=g.tokenColorMap,this._grammarFactory?.setTheme(this._currentTheme,this._currentTokenColorMap);const R=en(this._currentTokenColorMap),x=Ct(R);this._styleElement.textContent=x,Ce.setColorMap(R),this._currentTheme&&this._currentTokenColorMap&&this._threadedBackgroundTokenizerFactory.acceptTheme(this._currentTheme,this._currentTokenColorMap)}async createTokenizer(g){if(!this._languageService.isRegisteredLanguageId(g))return null;const T=await this._getOrCreateGrammarFactory();if(!T.has(g))return null;const R=this._languageService.languageIdCodec.encodeLanguageId(g),{grammar:x}=await T.createGrammar(g,R);return x}_getVSCodeOniguruma(){return this._vscodeOniguruma||(this._vscodeOniguruma=(async()=>{const g=await this._loadVSCodeOnigurumaWASM();return await Me.loadWASM({data:g,print:T=>{this._debugModePrintFunc(T)}}),Zt})()),this._vscodeOniguruma}async _loadVSCodeOnigurumaWASM(){return Ue?await(await fetch(me.asBrowserUri("vscode-oniguruma/../onig.wasm").toString(!0))).arrayBuffer():await fetch(this._environmentService.isBuilt?me.asBrowserUri(`${Rt}/vscode-oniguruma/release/onig.wasm`).toString(!0):me.asBrowserUri(`${Le}/vscode-oniguruma/release/onig.wasm`).toString(!0))}_reportTokenizationTime(g,T,R,x,C,r){const d=C?"async":"sync";fe.reportTokenizationTimeCounter[d]>50||(fe.reportTokenizationTimeCounter[d]===0&&setTimeout(()=>{fe.reportTokenizationTimeCounter[d]=0},1e3*60*60),fe.reportTokenizationTimeCounter[d]++,this._telemetryService.publicLog2("editor.tokenizedLine",{timeMs:g,languageId:T,lineLength:x,fromWorker:C,sourceExtensionId:R,isRandomSample:r,tokenizationSetting:this.getAsyncTokenizationEnabled()?this.getAsyncTokenizationVerification()?2:1:0}))}};Ie=fe=xe([J(0,He),J(1,It),J(2,qe),J(3,Ke),J(4,xt),J(5,Ve),J(6,Pt),J(7,Mt),J(8,Xe),J(9,Qe)],Ie);function en(G){const g=[null];for(let T=1,R=G.length;T<R;T++)g[T]=At.fromHex(G[T]);return g}function tn(G,g){if(!g||!G||g.length!==G.length)return!1;for(let T=g.length-1;T>=0;T--){const R=g[T],x=G[T];if(R.scope!==x.scope)return!1;const C=R.settings,r=x.settings;if(C&&r){if(C.fontStyle!==r.fontStyle||C.foreground!==r.foreground||C.background!==r.background)return!1}else if(!C||!r)return!1}return!0}function nn(G,g,T,R){if(g.language&&(typeof g.language!="string"||!R.isRegisteredLanguageId(g.language)))return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.language","Unknown language in `contributes.{0}.language`. Provided value: {1}",le.name,String(g.language))),!1;if(!g.scopeName||typeof g.scopeName!="string")return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.scopeName","Expected string in `contributes.{0}.scopeName`. Provided value: {1}",le.name,String(g.scopeName))),!1;if(!g.path||typeof g.path!="string")return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.path.0","Expected string in `contributes.{0}.path`. Provided value: {1}",le.name,String(g.path))),!1;if(g.injectTo&&(!Array.isArray(g.injectTo)||g.injectTo.some(C=>typeof C!="string")))return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.injectTo","Invalid value in `contributes.{0}.injectTo`. Must be an array of language scope names. Provided value: {1}",le.name,JSON.stringify(g.injectTo))),!1;if(g.embeddedLanguages&&!De(g.embeddedLanguages))return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.embeddedLanguages","Invalid value in `contributes.{0}.embeddedLanguages`. Must be an object map from scope name to language. Provided value: {1}",le.name,JSON.stringify(g.embeddedLanguages))),!1;if(g.tokenTypes&&!De(g.tokenTypes))return T.error(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.tokenTypes","Invalid value in `contributes.{0}.tokenTypes`. Must be an object map from scope name to token type. Provided value: {1}",le.name,JSON.stringify(g.tokenTypes))),!1;const x=Je(G,g.path);return Lt(x,G)||T.warn(Q("vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl","invalid.path.1","Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",le.name,x.path,G.path)),!0}function rn(G,g,T,R){return We(x=>R.onDidChangeConfiguration(C=>{C.affectsConfiguration(G,{overrideIdentifier:g})&&x(C)}),()=>R.getValue(G,{overrideIdentifier:g})??T)}const je=new URL("/assets/onig-Du5pRr7Y.wasm",import.meta.url).href;Ot({"vscode-oniguruma/../onig.wasm":je,"vs/../../node_modules/vscode-oniguruma/release/onig.wasm":je});Gt(async G=>{G.get(jt).when(2).then(()=>{zt.get(Ye)})});let ke=class{constructor(g){this.instantiationService=g,this.instantiationService.createInstance(Ft)}};ke.ID="workbench.contrib.extensionPoints.textmate";ke=xe([J(0,Xe)],ke);Dt(ke.ID,ke,1);function un(){return{...Nt(),[Ye.toString()]:new Et(Ie,[],!1)}}export{Ye as ITextMateTokenizationService,un as default};
