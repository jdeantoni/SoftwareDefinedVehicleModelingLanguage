(function(){"use strict";class ui{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}let $y=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Pn.isErrorNoTelemetry(e)?new Pn(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const oh=new $y;function ah(r){oh.setUnexpectedErrorHandler(r)}function Zi(r){gr(r)||oh.onUnexpectedError(r)}function ch(r){gr(r)||oh.onUnexpectedExternalError(r)}function Mc(r){if(r instanceof Error){const{name:e,message:t}=r,i=r.stacktrace||r.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:Pn.isErrorNoTelemetry(r)}}return r}const Hc="Canceled";function gr(r){return r instanceof mr?!0:r instanceof Error&&r.name===Hc&&r.message===Hc}class mr extends Error{constructor(){super(Hc),this.name=this.message}}function L1(){const r=new Error(Hc);return r.name=r.message,r}function be(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function lh(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}class vr extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class Ny extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}}class uh extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class Pn extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof Pn)return e;const t=new Pn;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}function Fy(r,e,t=0,i=r.length){let n=t,s=i;for(;n<s;){const o=Math.floor((n+s)/2);e(r[o])?n=o+1:s=o}return n-1}class O1{static{this.assertInvariants=!1}constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(O1.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=Fy(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}}function Tn(r,e,t=(i,n)=>i===n){if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function My(r,e){const t=[];let i;for(const n of r.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function $1(r,e,t){const i=[];function n(a,c,l){if(c===0&&l.length===0)return;const u=i[i.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):i.push({start:a,deleteCount:c,toInsert:l})}let s=0,o=0;for(;;){if(s===r.length){n(s,0,e.slice(o));break}if(o===e.length){n(s,r.length-s,[]);break}const a=r[s],c=e[o],l=t(a,c);l===0?(s+=1,o+=1):l<0?(n(s,1,[]),s+=1):l>0&&(n(s,0,[c]),o+=1)}return i}function Hy(r,e,t){const i=$1(r,e,t),n=[],s=[];for(const o of i)n.push(...r.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:n,added:s}}function Mt(r){return r.filter(e=>!!e)}function Uy(r){let e=0;for(let t=0;t<r.length;t++)r[t]&&(r[e]=r[t],e+=1);r.length=e}function dh(r){return!Array.isArray(r)||r.length===0}function Ho(r){return Array.isArray(r)&&r.length>0}function gs(r,e=t=>t){const t=new Set;return r.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function Uc(r){return[].concat(...r)}function N1(r,e){let t;t=Math.random;for(let i=r.length-1;i>0;i-=1){const n=Math.floor(t()*(i+1)),s=r[i];r[i]=r[n],r[n]=s}}function Uo(r,e){return Array.isArray(r)?r.map(e):e(r)}function Bo(r){return Array.isArray(r)?r:[r]}var hh;(function(r){function e(s){return s<0}r.isLessThan=e;function t(s){return s<=0}r.isLessThanOrEqual=t;function i(s){return s>0}r.isGreaterThan=i;function n(s){return s===0}r.isNeitherLessOrGreaterThan=n,r.greaterThan=1,r.lessThan=-1,r.neitherLessOrGreaterThan=0})(hh||(hh={}));function By(r,e){return(t,i)=>e(r(t),r(i))}const Wy=(r,e)=>r-e;class Bc{static{this.empty=new Bc(e=>{})}constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Bc(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new Bc(t=>this.iterate(i=>t(e(i))))}some(e){let t=!1;return this.iterate(i=>(t=e(i),!t)),t}findFirst(e){let t;return this.iterate(i=>e(i)?(t=i,!1):!0),t}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||hh.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}}function F1(r,e){const t=Object.create(null);for(const i of r){const n=e(i);let s=t[n];s||(s=t[n]=[]),s.push(i)}return t}function Vy(r,e){const t=[],i=[];for(const n of r)e.has(n)||t.push(n);for(const n of e)r.has(n)||i.push(n);return{removed:t,added:i}}var M1,H1,U1;function zy(r,e,t){let i=r.get(e);return i===void 0&&(i=t,r.set(e,i)),i}class qy{constructor(e,t){this.uri=e,this.value=t}}function jy(r){return Array.isArray(r)}class it{static{this.defaultToKey=e=>e.toString()}constructor(e,t){if(this[M1]="ResourceMap",e instanceof it)this.map=new Map(e.map),this.toKey=t??it.defaultToKey;else if(jy(e)){this.map=new Map,this.toKey=t??it.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??it.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new qy(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(M1=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}}class B1{constructor(e,t){this[H1]="ResourceSet",!e||typeof e=="function"?this._map=new it(e):(this._map=new it(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(H1=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class Gy{constructor(){this[U1]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}[(U1=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class W1 extends Gy{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}class V1{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}function fh(r,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=r.apply(t,arguments)),n}}var _r;(function(r){function e(D){return D&&typeof D=="object"&&typeof D[Symbol.iterator]=="function"}r.is=e;const t=Object.freeze([]);function i(){return t}r.empty=i;function*n(D){yield D}r.single=n;function s(D){return e(D)?D:n(D)}r.wrap=s;function o(D){return D||t}r.from=o;function*a(D){for(let U=D.length-1;U>=0;U--)yield D[U]}r.reverse=a;function c(D){return!D||D[Symbol.iterator]().next().done===!0}r.isEmpty=c;function l(D){return D[Symbol.iterator]().next().value}r.first=l;function u(D,U){for(const R of D)if(U(R))return!0;return!1}r.some=u;function h(D,U){for(const R of D)if(U(R))return R}r.find=h;function*f(D,U){for(const R of D)U(R)&&(yield R)}r.filter=f;function*d(D,U){let R=0;for(const H of D)yield U(H,R++)}r.map=d;function*_(...D){for(const U of D)yield*U}r.concat=_;function w(D,U,R){let H=R;for(const le of D)H=U(H,le);return H}r.reduce=w;function*x(D,U,R=D.length){for(U<0&&(U+=D.length),R<0?R+=D.length:R>D.length&&(R=D.length);U<R;U++)yield D[U]}r.slice=x;function k(D,U=Number.POSITIVE_INFINITY){const R=[];if(U===0)return[R,D];const H=D[Symbol.iterator]();for(let le=0;le<U;le++){const ie=H.next();if(ie.done)return[R,r.empty()];R.push(ie.value)}return[R,{[Symbol.iterator](){return H}}]}r.consume=k;async function S(D){const U=[];for await(const R of D)U.push(R);return Promise.resolve(U)}r.asyncToArray=S})(_r||(_r={}));class z1{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let t=this.livingDisposables.get(e);return t||(t={parent:null,source:null,isSingleton:!1,value:e,idx:z1.idx++},this.livingDisposables.set(e,t)),t}trackDisposable(e){const t=this.getDisposableData(e);t.source||(t.source=new Error().stack)}setParent(e,t){const i=this.getDisposableData(e);i.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){const i=t.get(e);if(i)return i;const n=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,n),n}getTrackedDisposables(){const e=new Map;return[...this.livingDisposables.entries()].filter(([,i])=>i.source!==null&&!this.getRootParent(i,e).isSingleton).flatMap(([i])=>i)}computeLeakingDisposables(e=10,t){let i;if(t)i=t;else{const c=new Map,l=[...this.livingDisposables.values()].filter(h=>h.source!==null&&!this.getRootParent(h,c).isSingleton);if(l.length===0)return;const u=new Set(l.map(h=>h.value));if(i=l.filter(h=>!(h.parent&&u.has(h.parent))),i.length===0)throw new Error("There are cyclic diposable chains!")}if(!i)return;function n(c){function l(h,f){for(;h.length>0&&f.some(d=>typeof d=="string"?d===h[0]:h[0].match(d));)h.shift()}const u=c.source.split(`
`).map(h=>h.trim().replace("at ","")).filter(h=>h!=="");return l(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const s=new V1;for(const c of i){const l=n(c);for(let u=0;u<=l.length;u++)s.add(l.slice(0,u).join(`
`),c)}i.sort(By(c=>c.idx,Wy));let o="",a=0;for(const c of i.slice(0,e)){a++;const l=n(c),u=[];for(let h=0;h<l.length;h++){let f=l[h];f=`(shared with ${s.get(l.slice(0,h+1).join(`
`)).size}/${i.length} leaks) at ${f}`;const _=s.get(l.slice(0,h).join(`
`)),w=F1([..._].map(x=>n(x)[h]),x=>x);delete w[l[h]];for(const[x,k]of Object.entries(w))u.unshift(`    - stacktraces of ${k.length} other leaks continue with ${x}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${i.length}: ${c.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return i.length>e&&(o+=`


... and ${i.length-e} more leaking disposables

`),{leaks:i,details:o}}}function k7(r){return r}function D7(r,e){}function wr(r){if(_r.is(r)){const e=[];for(const t of r)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function q1(...r){return Te(()=>wr(r))}function Te(r){return{dispose:fh(()=>{r()})}}class Pe{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{wr(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Pe.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}}let Me=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new Pe,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};class ms{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class j1{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{wr(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const Wc=typeof Buffer<"u",Qy=new ui(()=>new Uint8Array(256));let ph,gh;class he{static alloc(e){return Wc?new he(Buffer.allocUnsafe(e)):new he(new Uint8Array(e))}static wrap(e){return Wc&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new he(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&Wc?new he(Buffer.from(e)):(ph||(ph=new TextEncoder),new he(ph.encode(e)))}static fromByteArray(e){const t=he.alloc(e.length);for(let i=0,n=e.length;i<n;i++)t.buffer[i]=e[i];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}const i=he.alloc(t);let n=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];i.set(a,n),n+=a.byteLength}return i}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){const e=he.alloc(this.byteLength);return e.set(this),e}toString(){return Wc?this.buffer.toString():(gh||(gh=new TextDecoder),gh.decode(this.buffer))}slice(e,t){return new he(this.buffer.subarray(e,t))}set(e,t){if(e instanceof he)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Vc(this.buffer,e)}writeUInt32BE(e,t){zc(this.buffer,e,t)}readUInt32LE(e){return Yy(this.buffer,e)}writeUInt32LE(e,t){Zy(this.buffer,e,t)}readUInt8(e){return e2(this.buffer,e)}writeUInt8(e,t){t2(this.buffer,e,t)}indexOf(e,t=0){return Ky(this.buffer,e instanceof he?e.buffer:e,t)}}function Ky(r,e,t=0){const i=e.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(e[0]);if(i>n-t)return-1;const s=Qy.value;s.fill(e.length);for(let l=0;l<e.length;l++)s[e[l]]=e.length-l-1;let o=t+e.length-1,a=o,c=-1;for(;o<n;)if(r[o]===e[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(e.length-a,s[r[o]]),a=e.length-1;return c}function Jy(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0}function Xy(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255}function Vc(r,e){return r[e]*2**24+r[e+1]*2**16+r[e+2]*2**8+r[e+3]}function zc(r,e,t){r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e}function Yy(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0|r[e+2]<<16>>>0|r[e+3]<<24>>>0}function Zy(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255,e=e>>>8,r[t+2]=e&255,e=e>>>8,r[t+3]=e&255}function e2(r,e){return r[e]}function t2(r,e,t){r[t]=e}function i2(r){let e=0,t=0,i=0;const n=new Uint8Array(Math.floor(r.length/4*3)),s=a=>{switch(t){case 3:n[i++]=e|a,t=0;break;case 2:n[i++]=e|a>>>2,e=a<<6,t=3;break;case 1:n[i++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<r.length;a++){const c=r.charCodeAt(a);if(c>=65&&c<=90)s(c-65);else if(c>=97&&c<=122)s(c-97+26);else if(c>=48&&c<=57)s(c-48+52);else if(c===43||c===45)s(62);else if(c===47||c===95)s(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}const o=i;for(;t>0;)s(0);return he.wrap(n).slice(0,o)}const n2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function G1({buffer:r},e=!0,t=!1){const i=t?r2:n2;let n="";const s=r.byteLength%3;let o=0;for(;o<r.byteLength-s;o+=3){const a=r[o+0],c=r[o+1],l=r[o+2];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[(c<<2|l>>>6)&63],n+=i[l&63]}if(s===1){const a=r[o+0];n+=i[a>>>2],n+=i[a<<4&63],e&&(n+="==")}else if(s===2){const a=r[o+0],c=r[o+1];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[c<<2&63],e&&(n+="=")}return n}let at=class sh{static{this.Undefined=new sh(void 0)}constructor(e){this.element=e,this.next=sh.Undefined,this.prev=sh.Undefined}};class Wo{constructor(){this._first=at.Undefined,this._last=at.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===at.Undefined}clear(){let e=this._first;for(;e!==at.Undefined;){const t=e.next;e.prev=at.Undefined,e.next=at.Undefined,e=t}this._first=at.Undefined,this._last=at.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new at(e);if(this._first===at.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==at.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==at.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==at.Undefined&&e.next!==at.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===at.Undefined&&e.next===at.Undefined?(this._first=at.Undefined,this._last=at.Undefined):e.next===at.Undefined?(this._last=this._last.prev,this._last.next=at.Undefined):e.prev===at.Undefined&&(this._first=this._first.next,this._first.prev=at.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==at.Undefined;)yield e.element,e=e.next}}const s2=globalThis.performance&&typeof globalThis.performance.now=="function";class en{static create(e){return new en(e)}constructor(e){this._now=s2&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var ht;(function(r){r.None=()=>Me.None;function e(z,B){return h(z,()=>{},0,void 0,!0,void 0,B)}r.defer=e;function t(z){return(B,J=null,V)=>{let re=!1,de;return de=z(oe=>{if(!re)return de?de.dispose():re=!0,B.call(J,oe)},null,V),re&&de.dispose(),de}}r.once=t;function i(z,B,J){return l((V,re=null,de)=>z(oe=>V.call(re,B(oe)),null,de),J)}r.map=i;function n(z,B,J){return l((V,re=null,de)=>z(oe=>{B(oe),V.call(re,oe)},null,de),J)}r.forEach=n;function s(z,B,J){return l((V,re=null,de)=>z(oe=>B(oe)&&V.call(re,oe),null,de),J)}r.filter=s;function o(z){return z}r.signal=o;function a(...z){return(B,J=null,V)=>{const re=q1(...z.map(de=>de(oe=>B.call(J,oe))));return u(re,V)}}r.any=a;function c(z,B,J,V){let re=J;return i(z,de=>(re=B(re,de),re),V)}r.reduce=c;function l(z,B){let J;const V={onWillAddFirstListener(){J=z(re.fire,re)},onDidRemoveLastListener(){J?.dispose()}},re=new P(V);return B?.add(re),re.event}function u(z,B){return B instanceof Array?B.push(z):B&&B.add(z),z}function h(z,B,J=100,V=!1,re=!1,de,oe){let Ke,Je,wt,Ft=0,bt;const st={leakWarningThreshold:de,onWillAddFirstListener(){Ke=z(ci=>{Ft++,Je=B(Je,ci),V&&!wt&&(lt.fire(Je),Je=void 0),bt=()=>{const kt=Je;Je=void 0,wt=void 0,(!V||Ft>1)&&lt.fire(kt),Ft=0},typeof J=="number"?(clearTimeout(wt),wt=setTimeout(bt,J)):wt===void 0&&(wt=0,queueMicrotask(bt))})},onWillRemoveListener(){re&&Ft>0&&bt?.()},onDidRemoveLastListener(){bt=void 0,Ke.dispose()}},lt=new P(st);return oe?.add(lt),lt.event}r.debounce=h;function f(z,B=0,J){return r.debounce(z,(V,re)=>V?(V.push(re),V):[re],B,void 0,!0,void 0,J)}r.accumulate=f;function d(z,B=(V,re)=>V===re,J){let V=!0,re;return s(z,de=>{const oe=V||!B(de,re);return V=!1,re=de,oe},J)}r.latch=d;function _(z,B,J){return[r.filter(z,B,J),r.filter(z,V=>!B(V),J)]}r.split=_;function w(z,B=!1,J=[],V){let re=J.slice(),de=z(Je=>{re?re.push(Je):Ke.fire(Je)});V&&V.add(de);const oe=()=>{re?.forEach(Je=>Ke.fire(Je)),re=null},Ke=new P({onWillAddFirstListener(){de||(de=z(Je=>Ke.fire(Je)),V&&V.add(de))},onDidAddFirstListener(){re&&(B?setTimeout(oe):oe())},onDidRemoveLastListener(){de&&de.dispose(),de=null}});return V&&V.add(Ke),Ke.event}r.buffer=w;function x(z,B){return(V,re,de)=>{const oe=B(new S);return z(function(Ke){const Je=oe.evaluate(Ke);Je!==k&&V.call(re,Je)},void 0,de)}}r.chain=x;const k=Symbol("HaltChainable");class S{constructor(){this.steps=[]}map(B){return this.steps.push(B),this}forEach(B){return this.steps.push(J=>(B(J),J)),this}filter(B){return this.steps.push(J=>B(J)?J:k),this}reduce(B,J){let V=J;return this.steps.push(re=>(V=B(V,re),V)),this}latch(B=(J,V)=>J===V){let J=!0,V;return this.steps.push(re=>{const de=J||!B(re,V);return J=!1,V=re,de?re:k}),this}evaluate(B){for(const J of this.steps)if(B=J(B),B===k)break;return B}}function D(z,B,J=V=>V){const V=(...Ke)=>oe.fire(J(...Ke)),re=()=>z.on(B,V),de=()=>z.removeListener(B,V),oe=new P({onWillAddFirstListener:re,onDidRemoveLastListener:de});return oe.event}r.fromNodeEventEmitter=D;function U(z,B,J=V=>V){const V=(...Ke)=>oe.fire(J(...Ke)),re=()=>z.addEventListener(B,V),de=()=>z.removeEventListener(B,V),oe=new P({onWillAddFirstListener:re,onDidRemoveLastListener:de});return oe.event}r.fromDOMEventEmitter=U;function R(z){return new Promise(B=>t(z)(B))}r.toPromise=R;function H(z){const B=new P;return z.then(J=>{B.fire(J)},()=>{B.fire(void 0)}).finally(()=>{B.dispose()}),B.event}r.fromPromise=H;function le(z,B,J){return B(J),z(V=>B(V))}r.runAndSubscribe=le;class ie{constructor(B,J){this._observable=B,this._counter=0,this._hasChanged=!1;const V={onWillAddFirstListener:()=>{B.addObserver(this)},onDidRemoveLastListener:()=>{B.removeObserver(this)}};this.emitter=new P(V),J&&J.add(this.emitter)}beginUpdate(B){this._counter++}handlePossibleChange(B){}handleChange(B,J){this._hasChanged=!0}endUpdate(B){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function fe(z,B){return new ie(z,B).emitter.event}r.fromObservable=fe;function we(z){return(B,J,V)=>{let re=0,de=!1;const oe={beginUpdate(){re++},endUpdate(){re--,re===0&&(z.reportChanges(),de&&(de=!1,B.call(J)))},handlePossibleChange(){},handleChange(){de=!0}};z.addObserver(oe),z.reportChanges();const Ke={dispose(){z.removeObserver(oe)}};return V instanceof Pe?V.add(Ke):Array.isArray(V)&&V.push(Ke),Ke}}r.fromObservableLight=we})(ht||(ht={}));class qc{static{this.all=new Set}static{this._idPool=0}constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${qc._idPool++}`,qc.all.add(this)}start(e){this._stopWatch=new en,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}}let o2=-1;class a2{constructor(e,t=Math.random().toString(18).slice(2,5)){this.threshold=e,this.name=t,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let s,o=0;for(const[a,c]of this._stacks)(!s||o<c)&&(s=a,o=c);console.warn(`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`),console.warn(s)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}}class mh{static create(){return new mh(new Error().stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}let c2=0;class jc{constructor(e){this.value=e,this.id=c2++}}const l2=2,u2=(r,e)=>{if(r instanceof jc)e(r);else for(let t=0;t<r.length;t++){const i=r[t];i&&e(i)}};class P{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new a2(this._options?.leakWarningThreshold??o2):void 0,this._perfMon=this._options?._profName?new qc(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Me.None;if(this._disposed)return Me.None;t&&(e=e.bind(t));const n=new jc(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=mh.create(),s=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof jc?(this._deliveryQueue??=new d2,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;const o=Te(()=>{s?.(),this._removeListener(n)});return i instanceof Pe?i.add(o):Array.isArray(i)&&i.push(o),o},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*l2<=t.length){let s=0;for(let o=0;o<t.length;o++)t[o]?t[s++]=t[o]:n&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=s}}_deliver(e,t){if(!e)return;const i=this._options?.onListenerError||Zi;if(!i){e.value(t);return}try{e.value(t)}catch(n){i(n)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof jc)this._deliver(this._listeners,e);else{const t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}}class d2{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class Vo extends P{async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Wo),u2(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[n,s]=this._asyncDeliveryQueue.shift(),o=[],a={...s,token:t,waitUntil:c=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");i&&(c=i(c,n)),o.push(c)}};try{n(a)}catch(c){Zi(c);continue}await Promise.allSettled(o).then(c=>{for(const l of c)l.status==="rejected"&&Zi(l.reason)})}}}class h2 extends P{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new Wo,this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class f2 extends h2{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}var zo;(function(r){r[r.Desktop=1]="Desktop",r[r.Web=2]="Web"})(zo||(zo={}));function Q1(r){const e=he.alloc(1);switch(r){case 0:e.writeUInt8(1,0);break;case 1:e.writeUInt8(2,0);break;case 2:e.writeUInt8(3,0);break}return e}function p2(r,e){if(r.byteLength!==1)return!1;switch(r.readUInt8(0)){case 1:return e===0;case 2:return e===1;case 3:return e===2;default:return!1}}const ti=r=>{performance.mark(r)},g2=()=>{let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const e=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(const t of performance.getEntriesByType("mark"))e.push({name:t.name,startTime:Math.round(r+t.startTime)});return e};let m2=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function vh(r,e){let t;return e.length===0?t=r:t=r.replace(/\{(\d+)\}/g,(i,n)=>{const s=n[0],o=e[s];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),m2&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}let v2,K1={};function g(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(K1[r]??{})[n]??t;return vh(s,i)}function J1(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(K1[r]??{})[n]??t;return{value:vh(s,i),original:vh(t,i)}}function _2(r){return v2}const br="en";let Gc=!1,Qc=!1,_h=!1,X1=!1,wh=!1,Y1=!1,Z1=!1,Kc,Jc=br,ev=br,tn;const nn=globalThis;let _i;typeof nn.vscode<"u"&&typeof nn.vscode.process<"u"?_i=nn.vscode.process:typeof process<"u"&&(_i=process);const w2=typeof _i?.versions?.electron=="string"&&_i?.type==="renderer";if(typeof _i=="object"){Gc=_i.platform==="win32",Qc=_i.platform==="darwin",_h=_i.platform==="linux",Z1=!!_i.env.CI||!!_i.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Kc=br,Jc=br;const r=_i.env.VSCODE_NLS_CONFIG;if(r)try{const e=JSON.parse(r),t=e.availableLanguages["*"];Kc=e.locale,ev=e.osLocale,Jc=t||br}catch{}X1=!0}else typeof navigator=="object"&&!w2?(tn=navigator.userAgent,Gc=tn.indexOf("Windows")>=0,Qc=tn.indexOf("Macintosh")>=0,Y1=(tn.indexOf("Macintosh")>=0||tn.indexOf("iPad")>=0||tn.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_h=tn.indexOf("Linux")>=0,tn?.indexOf("Mobi")>=0,wh=!0,_2(g("vs/base/common/platform",{key:"ensureLoaderPluginIsLoaded"},"_")),Kc=br,Jc=Kc,ev=navigator.language):console.error("Unable to resolve platform.");var tv;(function(r){r[r.Web=0]="Web",r[r.Mac=1]="Mac",r[r.Linux=2]="Linux",r[r.Windows=3]="Windows"})(tv||(tv={}));function b2(r){switch(r){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}const Gt=Gc,wi=Qc,An=_h,y2=X1,bh=wh,qo=wh&&typeof nn.importScripts=="function",x2=qo?nn.origin:void 0,yr=Z1,$i=tn,Rn=Jc;var iv;(function(r){function e(){return Rn}r.value=e;function t(){return Rn.length===2?Rn==="en":Rn.length>=3?Rn[0]==="e"&&Rn[1]==="n"&&Rn[2]==="-":!1}r.isDefaultVariant=t;function i(){return Rn==="en"}r.isDefault=i})(iv||(iv={}));const C2=typeof nn.postMessage=="function"&&!nn.importScripts,nv=(()=>{if(C2){const r=[];nn.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){const s=r[i];if(s.id===t.data.vscodeScheduleAsyncWork){r.splice(i,1),s.callback();return}}});let e=0;return t=>{const i=++e;r.push({id:i,callback:t}),nn.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();var rv;(function(r){r[r.Windows=1]="Windows",r[r.Macintosh=2]="Macintosh",r[r.Linux=3]="Linux"})(rv||(rv={}));const S2=Qc||Y1?2:Gc?1:3;let sv=!0,ov=!1;function av(){if(!ov){ov=!0;const r=new Uint8Array(2);r[0]=1,r[1]=2,sv=new Uint16Array(r.buffer)[0]===513}return sv}const cv=!!($i&&$i.indexOf("Chrome")>=0),E2=!!($i&&$i.indexOf("Firefox")>=0),k2=!!(!cv&&$i&&$i.indexOf("Safari")>=0),D2=!!($i&&$i.indexOf("Edg/")>=0);$i&&$i.indexOf("Android")>=0;var lv={};let xr;const yh=globalThis.vscode;if(typeof yh<"u"&&typeof yh.process<"u"){const r=yh.process;xr={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"?xr={get platform(){return process.platform},get arch(){return process.arch},get env(){return lv},cwd(){return lv.VSCODE_CWD||process.cwd()}}:xr={get platform(){return Gt?"win32":wi?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const vs=xr.cwd,xh=xr.env,I2=xr.platform;xr.arch;const P2=65,T2=97,A2=90,R2=122,Ln=46,St=47,Qt=92,On=58,L2=63;class uv extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function O2(r,e){if(r===null||typeof r!="object")throw new uv(e,"Object",r)}function ut(r,e){if(typeof r!="string")throw new uv(e,"string",r)}const di=I2==="win32";function Se(r){return r===St||r===Qt}function Ch(r){return r===St}function $n(r){return r>=P2&&r<=A2||r>=T2&&r<=R2}function Xc(r,e,t,i){let n="",s=0,o=-1,a=0,c=0;for(let l=0;l<=r.length;++l){if(l<r.length)c=r.charCodeAt(l);else{if(i(c))break;c=St}if(i(c)){if(!(o===l-1||a===1))if(a===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==Ln||n.charCodeAt(n.length-2)!==Ln){if(n.length>2){const u=n.lastIndexOf(t);u===-1?(n="",s=0):(n=n.slice(0,u),s=n.length-1-n.lastIndexOf(t)),o=l,a=0;continue}else if(n.length!==0){n="",s=0,o=l,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",s=2)}else n.length>0?n+=`${t}${r.slice(o+1,l)}`:n=r.slice(o+1,l),s=l-o-1;o=l,a=0}else c===Ln&&a!==-1?++a:a=-1}return n}function dv(r,e){O2(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${r}${i}`:i}const mt={resolve(...r){let e="",t="",i=!1;for(let n=r.length-1;n>=-1;n--){let s;if(n>=0){if(s=r[n],ut(s,"path"),s.length===0)continue}else e.length===0?s=vs():(s=xh[`=${e}`]||vs(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===Qt)&&(s=`${e}\\`));const o=s.length;let a=0,c="",l=!1;const u=s.charCodeAt(0);if(o===1)Se(u)&&(a=1,l=!0);else if(Se(u))if(l=!0,Se(s.charCodeAt(1))){let h=2,f=h;for(;h<o&&!Se(s.charCodeAt(h));)h++;if(h<o&&h!==f){const d=s.slice(f,h);for(f=h;h<o&&Se(s.charCodeAt(h));)h++;if(h<o&&h!==f){for(f=h;h<o&&!Se(s.charCodeAt(h));)h++;(h===o||h!==f)&&(c=`\\\\${d}\\${s.slice(f,h)}`,a=h)}}}else a=1;else $n(u)&&s.charCodeAt(1)===On&&(c=s.slice(0,2),a=2,o>2&&Se(s.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(e.length>0){if(c.toLowerCase()!==e.toLowerCase())continue}else e=c;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=l,l&&e.length>0)break}return t=Xc(t,!i,"\\",Se),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){ut(r,"path");const e=r.length;if(e===0)return".";let t=0,i,n=!1;const s=r.charCodeAt(0);if(e===1)return Ch(s)?"\\":r;if(Se(s))if(n=!0,Se(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!Se(r.charCodeAt(a));)a++;if(a<e&&a!==c){const l=r.slice(c,a);for(c=a;a<e&&Se(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!Se(r.charCodeAt(a));)a++;if(a===e)return`\\\\${l}\\${r.slice(c)}\\`;a!==c&&(i=`\\\\${l}\\${r.slice(c,a)}`,t=a)}}}else t=1;else $n(s)&&r.charCodeAt(1)===On&&(i=r.slice(0,2),t=2,e>2&&Se(r.charCodeAt(2))&&(n=!0,t=3));let o=t<e?Xc(r.slice(t),!n,"\\",Se):"";return o.length===0&&!n&&(o="."),o.length>0&&Se(r.charCodeAt(e-1))&&(o+="\\"),i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(r){ut(r,"path");const e=r.length;if(e===0)return!1;const t=r.charCodeAt(0);return Se(t)||e>2&&$n(t)&&r.charCodeAt(1)===On&&Se(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let s=0;s<r.length;++s){const o=r[s];ut(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Se(t.charCodeAt(0))){++n;const s=t.length;s>1&&Se(t.charCodeAt(1))&&(++n,s>2&&(Se(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Se(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return mt.normalize(e)},relative(r,e){if(ut(r,"from"),ut(e,"to"),r===e)return"";const t=mt.resolve(r),i=mt.resolve(e);if(t===i||(r=t.toLowerCase(),e=i.toLowerCase(),r===e))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===Qt;)n++;let s=r.length;for(;s-1>n&&r.charCodeAt(s-1)===Qt;)s--;const o=s-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===Qt;)a++;let c=e.length;for(;c-1>a&&e.charCodeAt(c-1)===Qt;)c--;const l=c-a,u=o<l?o:l;let h=-1,f=0;for(;f<u;f++){const _=r.charCodeAt(n+f);if(_!==e.charCodeAt(a+f))break;_===Qt&&(h=f)}if(f!==u){if(h===-1)return i}else{if(l>u){if(e.charCodeAt(a+f)===Qt)return i.slice(a+f+1);if(f===2)return i.slice(a+f)}o>u&&(r.charCodeAt(n+f)===Qt?h=f:f===2&&(h=3)),h===-1&&(h=0)}let d="";for(f=n+h+1;f<=s;++f)(f===s||r.charCodeAt(f)===Qt)&&(d+=d.length===0?"..":"\\..");return a+=h,d.length>0?`${d}${i.slice(a,c)}`:(i.charCodeAt(a)===Qt&&++a,i.slice(a,c))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;const e=mt.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Qt){if(e.charCodeAt(1)===Qt){const t=e.charCodeAt(2);if(t!==L2&&t!==Ln)return`\\\\?\\UNC\\${e.slice(2)}`}}else if($n(e.charCodeAt(0))&&e.charCodeAt(1)===On&&e.charCodeAt(2)===Qt)return`\\\\?\\${e}`;return r},dirname(r){ut(r,"path");const e=r.length;if(e===0)return".";let t=-1,i=0;const n=r.charCodeAt(0);if(e===1)return Se(n)?r:".";if(Se(n)){if(t=i=1,Se(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!Se(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&Se(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!Se(r.charCodeAt(a));)a++;if(a===e)return r;a!==c&&(t=i=a+1)}}}}else $n(n)&&r.charCodeAt(1)===On&&(t=e>2&&Se(r.charCodeAt(2))?3:2,i=t);let s=-1,o=!0;for(let a=e-1;a>=i;--a)if(Se(r.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return r.slice(0,s)},basename(r,e){e!==void 0&&ut(e,"ext"),ut(r,"path");let t=0,i=-1,n=!0,s;if(r.length>=2&&$n(r.charCodeAt(0))&&r.charCodeAt(1)===On&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=t;--s){const c=r.charCodeAt(s);if(Se(c)){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=t;--s)if(Se(r.charCodeAt(s))){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){ut(r,"path");let e=0,t=-1,i=0,n=-1,s=!0,o=0;r.length>=2&&r.charCodeAt(1)===On&&$n(r.charCodeAt(0))&&(e=i=2);for(let a=r.length-1;a>=e;--a){const c=r.charCodeAt(a);if(Se(c)){if(!s){i=a+1;break}continue}n===-1&&(s=!1,n=a+1),c===Ln?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":r.slice(t,n)},format:dv.bind(null,"\\"),parse(r){ut(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.length;let i=0,n=r.charCodeAt(0);if(t===1)return Se(n)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Se(n)){if(i=1,Se(r.charCodeAt(1))){let h=2,f=h;for(;h<t&&!Se(r.charCodeAt(h));)h++;if(h<t&&h!==f){for(f=h;h<t&&Se(r.charCodeAt(h));)h++;if(h<t&&h!==f){for(f=h;h<t&&!Se(r.charCodeAt(h));)h++;h===t?i=h:h!==f&&(i=h+1)}}}}else if($n(n)&&r.charCodeAt(1)===On){if(t<=2)return e.root=e.dir=r,e;if(i=2,Se(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;i=3}}i>0&&(e.root=r.slice(0,i));let s=-1,o=i,a=-1,c=!0,l=r.length-1,u=0;for(;l>=i;--l){if(n=r.charCodeAt(l),Se(n)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),n===Ln?s===-1?s=l:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?e.base=e.name=r.slice(o,a):(e.name=r.slice(o,s),e.base=r.slice(o,a),e.ext=r.slice(s,a))),o>0&&o!==i?e.dir=r.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},$2=(()=>{if(di){const r=/\\/g;return()=>{const e=vs().replace(r,"/");return e.slice(e.indexOf("/"))}}return()=>vs()})(),$e={resolve(...r){let e="",t=!1;for(let i=r.length-1;i>=-1&&!t;i--){const n=i>=0?r[i]:$2();ut(n,"path"),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===St)}return e=Xc(e,!t,"/",Ch),t?`/${e}`:e.length>0?e:"."},normalize(r){if(ut(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===St,t=r.charCodeAt(r.length-1)===St;return r=Xc(r,!e,"/",Ch),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return ut(r,"path"),r.length>0&&r.charCodeAt(0)===St},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];ut(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":$e.normalize(e)},relative(r,e){if(ut(r,"from"),ut(e,"to"),r===e||(r=$e.resolve(r),e=$e.resolve(e),r===e))return"";const t=1,i=r.length,n=i-t,s=1,o=e.length-s,a=n<o?n:o;let c=-1,l=0;for(;l<a;l++){const h=r.charCodeAt(t+l);if(h!==e.charCodeAt(s+l))break;h===St&&(c=l)}if(l===a)if(o>a){if(e.charCodeAt(s+l)===St)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else n>a&&(r.charCodeAt(t+l)===St?c=l:l===0&&(c=0));let u="";for(l=t+c+1;l<=i;++l)(l===i||r.charCodeAt(l)===St)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(s+c)}`},toNamespacedPath(r){return r},dirname(r){if(ut(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===St;let t=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===St){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&ut(e,"ext"),ut(r,"path");let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const c=r.charCodeAt(s);if(c===St){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===St){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){ut(r,"path");let e=-1,t=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===St){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===Ln?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":r.slice(e,i)},format:dv.bind(null,"/"),parse(r){ut(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.charCodeAt(0)===St;let i;t?(e.root="/",i=1):i=0;let n=-1,s=0,o=-1,a=!0,c=r.length-1,l=0;for(;c>=i;--c){const u=r.charCodeAt(c);if(u===St){if(!a){s=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===Ln?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1)}if(o!==-1){const u=s===0&&t?1:s;n===-1||l===0||l===1&&n===o-1&&n===s+1?e.base=e.name=r.slice(u,o):(e.name=r.slice(u,n),e.base=r.slice(u,o),e.ext=r.slice(n,o))}return s>0?e.dir=r.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};$e.win32=mt.win32=mt,$e.posix=mt.posix=$e;const _s=di?mt.normalize:$e.normalize,Sh=di?mt.isAbsolute:$e.isAbsolute,hv=di?mt.join:$e.join,N2=di?mt.resolve:$e.resolve,jo=di?mt.relative:$e.relative,Cr=di?mt.dirname:$e.dirname,Kt=di?mt.basename:$e.basename,Eh=di?mt.extname:$e.extname;di?mt.parse:$e.parse;const bi=di?mt.sep:$e.sep;di?mt.delimiter:$e.delimiter;const F2=/^\w[\w\d+.-]*$/,M2=/^\//,H2=/^\/\//;function U2(r,e){if(!r.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!F2.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!M2.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(H2.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function B2(r,e){return!r&&!e?"file":r}function W2(r,e){switch(r){case"https":case"http":case"file":e?e[0]!==yi&&(e=yi+e):e=yi;break}return e}const Xe="",yi="/",V2=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class b{static isUri(e){return e instanceof b?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||Xe,this.authority=e.authority||Xe,this.path=e.path||Xe,this.query=e.query||Xe,this.fragment=e.fragment||Xe):(this.scheme=B2(e,o),this.authority=t||Xe,this.path=W2(this.scheme,i||Xe),this.query=n||Xe,this.fragment=s||Xe,U2(this,o))}get fsPath(){return Yc(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Xe),i===void 0?i=this.authority:i===null&&(i=Xe),n===void 0?n=this.path:n===null&&(n=Xe),s===void 0?s=this.query:s===null&&(s=Xe),o===void 0?o=this.fragment:o===null&&(o=Xe),t===this.scheme&&i===this.authority&&n===this.path&&s===this.query&&o===this.fragment?this:new ws(t,i,n,s,o)}static parse(e,t=!1){const i=V2.exec(e);return i?new ws(i[2]||Xe,Zc(i[4]||Xe),Zc(i[5]||Xe),Zc(i[7]||Xe),Zc(i[9]||Xe),t):new ws(Xe,Xe,Xe,Xe,Xe)}static file(e){let t=Xe;if(Gt&&(e=e.replace(/\\/g,yi)),e[0]===yi&&e[1]===yi){const i=e.indexOf(yi,2);i===-1?(t=e.substring(2),e=yi):(t=e.substring(2,i),e=e.substring(i)||yi)}return new ws("file",t,e,Xe,Xe)}static from(e,t){return new ws(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return Gt&&e.scheme==="file"?i=b.file(mt.join(Yc(e,!0),...t)).path:i=$e.join(e.path,...t),e.with({path:i})}toString(e=!1){return Dh(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof b)return e;{const t=new ws(e);return t._formatted=e.external??null,t._fsPath=e._sep===fv?e.fsPath??null:null,t}}else return e}}function kh(r){return!r||typeof r!="object"?!1:typeof r.scheme=="string"&&(typeof r.authority=="string"||typeof r.authority>"u")&&(typeof r.path=="string"||typeof r.path>"u")&&(typeof r.query=="string"||typeof r.query>"u")&&(typeof r.fragment=="string"||typeof r.fragment>"u")}const fv=Gt?1:void 0;class ws extends b{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=Yc(this,!1)),this._fsPath}toString(e=!1){return e?Dh(this,!0):(this._formatted||(this._formatted=Dh(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=fv),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const pv={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function gv(r,e,t){let i,n=-1;for(let s=0;s<r.length;s++){const o=r.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i!==void 0&&(i+=r.charAt(s));else{i===void 0&&(i=r.substr(0,s));const a=pv[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i+=a):n===-1&&(n=s)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function z2(r){let e;for(let t=0;t<r.length;t++){const i=r.charCodeAt(t);i===35||i===63?(e===void 0&&(e=r.substr(0,t)),e+=pv[i]):e!==void 0&&(e+=r[t])}return e!==void 0?e:r}function Yc(r,e){let t;return r.authority&&r.path.length>1&&r.scheme==="file"?t=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?e?t=r.path.substr(1):t=r.path[1].toLowerCase()+r.path.substr(2):t=r.path,Gt&&(t=t.replace(/\//g,"\\")),t}function Dh(r,e){const t=e?z2:gv;let i="",{scheme:n,authority:s,path:o,query:a,fragment:c}=r;if(n&&(i+=n,i+=":"),(s||n==="file")&&(i+=yi,i+=yi),s){let l=s.indexOf("@");if(l!==-1){const u=s.substr(0,l);s=s.substr(l+1),l=u.lastIndexOf(":"),l===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,l),!1,!1),i+=":",i+=t(u.substr(l+1),!1,!0)),i+="@"}s=s.toLowerCase(),l=s.lastIndexOf(":"),l===-1?i+=t(s,!1,!0):(i+=t(s.substr(0,l),!1,!0),i+=s.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),c&&(i+="#",i+=e?c:gv(c,!1,!1)),i}function mv(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+mv(r.substr(3)):r}}const vv=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Zc(r){return r.match(vv)?r.replace(vv,e=>mv(e)):r}class el{static{this.count=0}constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++el.count}}const _v=[];function L(r){const e=new el(r);return _v[e.nid]=e,e}function tl(r){return _v[r].sid}class Ni{constructor(e){this.value=e}}var wv;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(wv||(wv={}));var bv;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(bv||(bv={}));var Ih;(function(r){r[r.None=0]="None",r[r.Process=1]="Process",r[r.Output=2]="Output"})(Ih||(Ih={}));const j={MainThreadAuthentication:L("MainThreadAuthentication"),MainThreadBulkEdits:L("MainThreadBulkEdits"),MainThreadChatProvider:L("MainThreadChatProvider"),MainThreadChatAgents2:L("MainThreadChatAgents2"),MainThreadChatVariables:L("MainThreadChatVariables"),MainThreadClipboard:L("MainThreadClipboard"),MainThreadCommands:L("MainThreadCommands"),MainThreadComments:L("MainThreadComments"),MainThreadConfiguration:L("MainThreadConfiguration"),MainThreadConsole:L("MainThreadConsole"),MainThreadDebugService:L("MainThreadDebugService"),MainThreadDecorations:L("MainThreadDecorations"),MainThreadDiagnostics:L("MainThreadDiagnostics"),MainThreadDialogs:L("MainThreadDiaglogs"),MainThreadDocuments:L("MainThreadDocuments"),MainThreadDocumentContentProviders:L("MainThreadDocumentContentProviders"),MainThreadTextEditors:L("MainThreadTextEditors"),MainThreadEditorInsets:L("MainThreadEditorInsets"),MainThreadEditorTabs:L("MainThreadEditorTabs"),MainThreadErrors:L("MainThreadErrors"),MainThreadTreeViews:L("MainThreadTreeViews"),MainThreadDownloadService:L("MainThreadDownloadService"),MainThreadLanguageFeatures:L("MainThreadLanguageFeatures"),MainThreadLanguages:L("MainThreadLanguages"),MainThreadLogger:L("MainThreadLogger"),MainThreadMessageService:L("MainThreadMessageService"),MainThreadOutputService:L("MainThreadOutputService"),MainThreadProgress:L("MainThreadProgress"),MainThreadQuickDiff:L("MainThreadQuickDiff"),MainThreadQuickOpen:L("MainThreadQuickOpen"),MainThreadStatusBar:L("MainThreadStatusBar"),MainThreadSecretState:L("MainThreadSecretState"),MainThreadStorage:L("MainThreadStorage"),MainThreadSpeech:L("MainThreadSpeechProvider"),MainThreadTelemetry:L("MainThreadTelemetry"),MainThreadTerminalService:L("MainThreadTerminalService"),MainThreadWebviews:L("MainThreadWebviews"),MainThreadWebviewPanels:L("MainThreadWebviewPanels"),MainThreadWebviewViews:L("MainThreadWebviewViews"),MainThreadCustomEditors:L("MainThreadCustomEditors"),MainThreadUrls:L("MainThreadUrls"),MainThreadUriOpeners:L("MainThreadUriOpeners"),MainThreadProfileContentHandlers:L("MainThreadProfileContentHandlers"),MainThreadWorkspace:L("MainThreadWorkspace"),MainThreadFileSystem:L("MainThreadFileSystem"),MainThreadFileSystemEventService:L("MainThreadFileSystemEventService"),MainThreadExtensionService:L("MainThreadExtensionService"),MainThreadSCM:L("MainThreadSCM"),MainThreadSearch:L("MainThreadSearch"),MainThreadShare:L("MainThreadShare"),MainThreadTask:L("MainThreadTask"),MainThreadWindow:L("MainThreadWindow"),MainThreadLabelService:L("MainThreadLabelService"),MainThreadNotebook:L("MainThreadNotebook"),MainThreadNotebookDocuments:L("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:L("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:L("MainThreadNotebookKernels"),MainThreadNotebookRenderers:L("MainThreadNotebookRenderers"),MainThreadInteractive:L("MainThreadInteractive"),MainThreadChat:L("MainThreadChat"),MainThreadInlineChat:L("MainThreadInlineChatShape"),MainThreadTheming:L("MainThreadTheming"),MainThreadTunnelService:L("MainThreadTunnelService"),MainThreadManagedSockets:L("MainThreadManagedSockets"),MainThreadTimeline:L("MainThreadTimeline"),MainThreadTesting:L("MainThreadTesting"),MainThreadLocalization:L("MainThreadLocalizationShape"),MainThreadAiRelatedInformation:L("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:L("MainThreadAiEmbeddingVector"),MainThreadIssueReporter:L("MainThreadIssueReporter")},Z={ExtHostCommands:L("ExtHostCommands"),ExtHostConfiguration:L("ExtHostConfiguration"),ExtHostDiagnostics:L("ExtHostDiagnostics"),ExtHostDebugService:L("ExtHostDebugService"),ExtHostDecorations:L("ExtHostDecorations"),ExtHostDocumentsAndEditors:L("ExtHostDocumentsAndEditors"),ExtHostDocuments:L("ExtHostDocuments"),ExtHostDocumentContentProviders:L("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:L("ExtHostDocumentSaveParticipant"),ExtHostEditors:L("ExtHostEditors"),ExtHostTreeViews:L("ExtHostTreeViews"),ExtHostFileSystem:L("ExtHostFileSystem"),ExtHostFileSystemInfo:L("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:L("ExtHostFileSystemEventService"),ExtHostLanguages:L("ExtHostLanguages"),ExtHostLanguageFeatures:L("ExtHostLanguageFeatures"),ExtHostQuickOpen:L("ExtHostQuickOpen"),ExtHostQuickDiff:L("ExtHostQuickDiff"),ExtHostStatusBar:L("ExtHostStatusBar"),ExtHostShare:L("ExtHostShare"),ExtHostExtensionService:L("ExtHostExtensionService"),ExtHostLogLevelServiceShape:L("ExtHostLogLevelServiceShape"),ExtHostTerminalService:L("ExtHostTerminalService"),ExtHostSCM:L("ExtHostSCM"),ExtHostSearch:L("ExtHostSearch"),ExtHostTask:L("ExtHostTask"),ExtHostWorkspace:L("ExtHostWorkspace"),ExtHostWindow:L("ExtHostWindow"),ExtHostWebviews:L("ExtHostWebviews"),ExtHostWebviewPanels:L("ExtHostWebviewPanels"),ExtHostCustomEditors:L("ExtHostCustomEditors"),ExtHostWebviewViews:L("ExtHostWebviewViews"),ExtHostEditorInsets:L("ExtHostEditorInsets"),ExtHostEditorTabs:L("ExtHostEditorTabs"),ExtHostProgress:L("ExtHostProgress"),ExtHostComments:L("ExtHostComments"),ExtHostSecretState:L("ExtHostSecretState"),ExtHostStorage:L("ExtHostStorage"),ExtHostUrls:L("ExtHostUrls"),ExtHostUriOpeners:L("ExtHostUriOpeners"),ExtHostProfileContentHandlers:L("ExtHostProfileContentHandlers"),ExtHostOutputService:L("ExtHostOutputService"),ExtHostLabelService:L("ExtHostLabelService"),ExtHostNotebook:L("ExtHostNotebook"),ExtHostNotebookDocuments:L("ExtHostNotebookDocuments"),ExtHostNotebookEditors:L("ExtHostNotebookEditors"),ExtHostNotebookKernels:L("ExtHostNotebookKernels"),ExtHostNotebookRenderers:L("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:L("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:L("ExtHostInteractive"),ExtHostInlineChat:L("ExtHostInlineChatShape"),ExtHostChat:L("ExtHostChat"),ExtHostChatAgents2:L("ExtHostChatAgents"),ExtHostChatVariables:L("ExtHostChatVariables"),ExtHostChatProvider:L("ExtHostChatProvider"),ExtHostSpeech:L("ExtHostSpeech"),ExtHostAiRelatedInformation:L("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:L("ExtHostAiEmbeddingVector"),ExtHostTheming:L("ExtHostTheming"),ExtHostTunnelService:L("ExtHostTunnelService"),ExtHostManagedSockets:L("ExtHostManagedSockets"),ExtHostAuthentication:L("ExtHostAuthentication"),ExtHostTimeline:L("ExtHostTimeline"),ExtHostTesting:L("ExtHostTesting"),ExtHostTelemetry:L("ExtHostTelemetry"),ExtHostLocalization:L("ExtHostLocalization"),ExtHostIssueReporter:L("ExtHostIssueReporter")},yv=Object.freeze(function(r,e){const t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}});var yt;(function(r){function e(t){return t===r.None||t===r.Cancelled||t instanceof il?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}r.isCancellationToken=e,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ht.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:yv})})(yt||(yt={}));class il{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?yv:(this._emitter||(this._emitter=new P),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class dt{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new il),this._token}cancel(){this._token?this._token instanceof il&&this._token.cancel():this._token=yt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof il&&this._token.dispose():this._token=yt.None}}class q2{constructor(e){this.fn=e,this.lastCache=void 0,this.lastArgKey=void 0}get(e){const t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.fn(e)),this.lastCache}}function nl(r){return!r||typeof r!="string"?!0:r.trim().length===0}const j2=/{([^}]+)}/g;function xv(r,e){return Object.keys(e).length===0?r:r.replace(j2,(t,i)=>e[i]??t)}function bs(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function G2(r,e){let t=0;const i=e.charCodeAt(0);for(let n=r.length-1;n>=0;n--)r.charCodeAt(n)===i&&t++;return t}function Q2(r,e){if(!r||!e)return r;const t=e.length;if(t===0||r.length===0)return r;let i=0;for(;r.indexOf(e,i)===i;)i=i+t;return r.substring(i)}function Cv(r,e){if(!r||!e)return r;const t=e.length,i=r.length;if(t===0||i===0)return r;let n=i,s=-1;for(;s=r.lastIndexOf(e,n-1),!(s===-1||s+t!==n);){if(s===0)return"";n=s}return r.substring(0,n)}function K2(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=bs(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(r,i)}function Sv(r){return r.source==="^"||r.source==="^$"||r.source==="$"||r.source==="^\\s*$"?!1:!!(r.exec("")&&r.lastIndex===0)}function Ev(r){return r.split(/\r\n|\r|\n/)}function Ph(r){for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function J2(r,e=r.length-1){for(let t=e;t>=0;t--){const i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function X2(r,e,t){const i=[];let n=0;for(const s of r.matchAll(e)){if(i.push(r.slice(n,s.index)),s.index===void 0)throw new Error("match.index should be defined");n=s.index+s[0].length,i.push(t(s[0],...s.slice(1),s.index,r,s.groups))}return i.push(r.slice(n)),Promise.all(i).then(s=>s.join(""))}function Sr(r,e){return r<e?-1:r>e?1:0}function Th(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){const c=r.charCodeAt(t),l=e.charCodeAt(n);if(c<l)return-1;if(c>l)return 1}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function kv(r,e){return Go(r,e,0,r.length,0,e.length)}function Go(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){let c=r.charCodeAt(t),l=e.charCodeAt(n);if(c===l)continue;if(c>=128||l>=128)return Th(r.toLowerCase(),e.toLowerCase(),t,i,n,s);Dv(c)&&(c-=32),Dv(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function Dv(r){return r>=97&&r<=122}function Er(r,e){return r.length===e.length&&Go(r,e)===0}function Ah(r,e){const t=e.length;return e.length>r.length?!1:Go(r,e,0,t)===0}function Y2(r,e){const t=Math.min(r.length,e.length);let i;for(i=0;i<t;i++)if(r.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function Rh(r){return 55296<=r&&r<=56319}function Iv(r){return 56320<=r&&r<=57343}function Pv(r,e){return(r-55296<<10)+(e-56320)+65536}function Tv(r,e,t){const i=r.charCodeAt(t);if(Rh(i)&&t+1<e){const n=r.charCodeAt(t+1);if(Iv(n))return Pv(i,n)}return i}function Z2(r,e){const t=r.charCodeAt(e-1);if(Iv(t)&&e>1){const i=r.charCodeAt(e-2);if(Rh(i))return Pv(i,t)}return t}class ex{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=Z2(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=Tv(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class tx{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new ex(e,t)}nextGraphemeLength(){const e=kr.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if($v(n,o)){t.setOffset(s);break}n=o}return t.offset-i}prevGraphemeLength(){const e=kr.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if($v(o,n)){t.setOffset(s);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function Av(r,e){return new tx(r,e).nextGraphemeLength()}let Lh;function ix(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Rv(r){return Lh||(Lh=ix()),Lh.test(r)}const nx=/^[\t\n\r\x20-\x7E]*$/;function rx(r){return nx.test(r)}const sx=/[\u2028\u2029]/;function Lv(r){return sx.test(r)}const ox="\uFEFF";function ax(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function Ov(r,e=!1){return r?(e&&(r=r.replace(/\\./g,"")),r.toLowerCase()!==r):!1}function cx(r,e=1){if(e===0)return"";let t=-1;do t=r.indexOf(`
`,t+1),e--;while(e>0&&t>=0);return t===-1?r:(r[t-1]==="\r"&&t--,r.substr(0,t))}function $v(r,e){return r===0?e!==5&&e!==7:r===2&&e===3?!1:r===4||r===2||r===3||e===4||e===2||e===3?!0:!(r===8&&(e===8||e===9||e===11||e===12)||(r===11||r===9)&&(e===9||e===10)||(r===12||r===10)&&e===10||e===5||e===13||e===7||r===1||r===13&&e===14||r===6&&e===6)}class kr{static{this._INSTANCE=null}static getInstance(){return kr._INSTANCE||(kr._INSTANCE=new kr),kr._INSTANCE}constructor(){this._data=lx()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}}function lx(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}class Qo{static{this.ambiguousCharacterData=new ui(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new q2(e=>{function t(u){const h=new Map;for(let f=0;f<u.length;f+=2)h.set(u[f],u[f+1]);return h}function i(u,h){const f=new Map(u);for(const[d,_]of h)f.set(d,_);return f}function n(u,h){if(!u)return h;const f=new Map;for(const[d,_]of u)h.has(d)&&f.set(d,_);return f}const s=this.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&u in s);o.length===0&&(o=["_default"]);let a;for(const u of o){const h=t(s[u]);a=n(a,h)}const c=t(s._common),l=i(c,a);return new Qo(l)})}static getInstance(e){return Qo.cache.get(Array.from(e))}static{this._locales=new ui(()=>Object.keys(Qo.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return Qo._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}function Le(r){return typeof r=="string"}function ux(r){return Array.isArray(r)&&r.every(e=>Le(e))}function It(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function dx(r){const e=Object.getPrototypeOf(Uint8Array);return typeof r=="object"&&r instanceof e}function Nn(r){return typeof r=="number"&&!isNaN(r)}function Oh(r){return typeof r>"u"}function ys(r){return!Lt(r)}function Lt(r){return Oh(r)||r===null}function Nv(r,e){if(!r)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function xs(r){if(Lt(r))throw new Error("Assertion Failed: argument is undefined or null");return r}const hx=Object.prototype.hasOwnProperty;function fx(r){if(!It(r))return!1;for(const e in r)if(hx.call(r,e))return!1;return!0}function px(r){return typeof r=="function"}function gx(r,e){if(Le(e)){if(typeof r!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(px(e)){try{if(r instanceof e)return}catch{}if(!Lt(r)&&r.constructor===e||e.length===1&&e.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Fn(r){return r===47||r===92}function Fv(r){return r.replace(/[\\/]/g,$e.sep)}function mx(r){return r.indexOf("/")===-1&&(r=Fv(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function Mv(r,e=$e.sep){if(!r)return"";const t=r.length,i=r.charCodeAt(0);if(Fn(i)){if(Fn(r.charCodeAt(1))&&!Fn(r.charCodeAt(2))){let s=3;const o=s;for(;s<t&&!Fn(r.charCodeAt(s));s++);if(o!==s&&!Fn(r.charCodeAt(s+1))){for(s+=1;s<t;s++)if(Fn(r.charCodeAt(s)))return r.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(Hv(i)&&r.charCodeAt(1)===58)return Fn(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(Fn(r.charCodeAt(n)))return r.slice(0,n+1)}return""}const vx=/[\\/:\*\?"<>\|]/g,_x=/[\\/]/g,wx=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function bx(r,e=Gt){const t=e?vx:_x;return!(!r||r.length===0||/^\s+$/.test(r)||(t.lastIndex=0,t.test(r))||e&&wx.test(r)||r==="."||r===".."||e&&r[r.length-1]==="."||e&&r.length!==r.trim().length||r.length>255)}function rl(r,e,t,i=bi){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!Ah(r,e))return!1;if(e.length===r.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,r.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),r.indexOf(e)===0}function Hv(r){return r>=65&&r<=90||r>=97&&r<=122}function yx(r,e=Gt){return e?Hv(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}var K;(function(r){r.inMemory="inmemory",r.vscode="vscode",r.internal="private",r.walkThrough="walkThrough",r.walkThroughSnippet="walkThroughSnippet",r.http="http",r.https="https",r.file="file",r.mailto="mailto",r.untitled="untitled",r.data="data",r.command="command",r.vscodeRemote="vscode-remote",r.vscodeRemoteResource="vscode-remote-resource",r.vscodeManagedRemoteResource="vscode-managed-remote-resource",r.vscodeUserData="vscode-userdata",r.vscodeCustomEditor="vscode-custom-editor",r.vscodeNotebookCell="vscode-notebook-cell",r.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",r.vscodeNotebookCellOutput="vscode-notebook-cell-output",r.vscodeInteractiveInput="vscode-interactive-input",r.vscodeSettings="vscode-settings",r.vscodeWorkspaceTrust="vscode-workspace-trust",r.vscodeTerminal="vscode-terminal",r.vscodeChatCodeBlock="vscode-chat-code-block",r.vscodeChatSesssion="vscode-chat-editor",r.webviewPanel="webview-panel",r.vscodeWebview="vscode-webview",r.extension="extension",r.vscodeFileResource="vscode-file",r.tmp="tmp",r.vsls="vsls",r.vscodeSourceControl="vscode-scm",r.codeSetting="code-setting",r.codeFeature="code-feature"})(K||(K={}));function $h(r,e){return b.isUri(r)?Er(r.scheme,e):Ah(r,e+":")}function xx(r,...e){return e.some(t=>$h(r,t))}const Cx="tkn";class Sx{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${K.vscodeRemoteResource}`}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e){this._remoteResourcesPath=`${e}/${K.vscodeRemoteResource}`}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Zi(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${Cx}=${encodeURIComponent(s)}`),b.from({scheme:bh?this._preferredWebSchema:K.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const Ex=new Sx,kx="vscode-app";class Ko{constructor(){this.staticBrowserUris=new it,this.appResourcePathUrls=new Map,this.moduleContentProvider=new Map}static{this.FALLBACK_AUTHORITY=kx}registerModuleContentProvider(e,t){this.moduleContentProvider.set(e,t)}toModuleContent(e){return this.moduleContentProvider.get(e)()}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){let t=this.appResourcePathUrls.get(e);return typeof t=="function"&&(t=t()),new URL(t??e,globalThis.location?.href??self.location.href).toString()}asBrowserUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===K.vscodeRemote?Ex.rewrite(e):e.scheme===K.file&&(y2||x2===`${K.vscodeFileResource}://${Ko.FALLBACK_AUTHORITY}`)?e.with({scheme:K.vscodeFileResource,authority:e.authority||Ko.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===K.vscodeFileResource?e.with({scheme:K.file,authority:e.authority!==Ko.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){return b.isUri(e)?e:b.parse(t.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),Te(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}}new Ko;var Uv;(function(r){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:b.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o?.get(t);if(a)return e.get(a)}r.getHeadersFromQuery=i;function n(s,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,c):s[t]=c}r.addSearchParam=n})(Uv||(Uv={}));function xi(r){return Yc(r,!0)}class Jo{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:Sr(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===K.file)return rl(xi(e),xi(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(Vv(e.authority,t.authority))return rl(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return b.joinPath(e,...t)}basenameOrAuthority(e){return Dr(e)||e.authority}basename(e){return $e.basename(e.path)}extname(e){return $e.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===K.file?t=b.file(Cr(xi(e))).path:(t=$e.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===K.file?t=b.file(_s(xi(e))).path:t=$e.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Vv(e.authority,t.authority))return;if(e.scheme===K.file){const s=jo(xi(e),xi(t));return Gt?Fv(s):s}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const o=Math.min(i.length,n.length);s<o&&!(i.charCodeAt(s)!==n.charCodeAt(s)&&i.charAt(s).toLowerCase()!==n.charAt(s).toLowerCase());s++);i=n.substr(0,s)+i.substr(s)}return $e.relative(i,n)}resolvePath(e,t){if(e.scheme===K.file){const i=b.file(N2(xi(e),t));return e.with({authority:i.authority,path:i.path})}return t=mx(t),e.with({path:$e.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Er(e,t)}hasTrailingPathSeparator(e,t=bi){if(e.scheme===K.file){const i=xi(e);return i.length>Mv(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=bi){return zv(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=bi){let i=!1;if(e.scheme===K.file){const n=xi(e);i=n!==void 0&&n.length===Mv(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!zv(e,t)?e.with({path:e.path+"/"}):e}}const Oe=new Jo(()=>!1),Dx=new Jo(r=>r.scheme===K.file?!An:!0),Ix=new Jo(r=>!0),Bv=Oe.isEqual.bind(Oe);Oe.isEqualOrParent.bind(Oe),Oe.getComparisonKey.bind(Oe);const Nh=Oe.basenameOrAuthority.bind(Oe),Dr=Oe.basename.bind(Oe);Oe.extname.bind(Oe);const Fh=Oe.dirname.bind(Oe),Cs=Oe.joinPath.bind(Oe);Oe.normalizePath.bind(Oe);const Wv=Oe.relativePath.bind(Oe);Oe.resolvePath.bind(Oe);const Px=Oe.isAbsolutePath.bind(Oe),Vv=Oe.isEqualAuthority.bind(Oe),zv=Oe.hasTrailingPathSeparator.bind(Oe);Oe.removeTrailingPathSeparator.bind(Oe),Oe.addTrailingPathSeparator.bind(Oe);var qv;(function(r){r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&i.set(a,c)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(r.META_DATA_MIME,s),i}r.parseMetaData=e})(qv||(qv={}));function Mn(r){return!!r&&typeof r.then=="function"}function Tx(r){const e=new dt,t=r(e.token),i=new Promise((n,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),s(new mr)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),n(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,s){return i.then(n,s)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Mh(r,e,t){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose(),i(t)});r.then(i,n).finally(()=>s.dispose())})}function Ax(r,e){return new Promise((t,i)=>{const n=e.onCancellationRequested(()=>{n.dispose(),i(new mr)});r.then(t,i).finally(()=>n.dispose())})}function Pt(r){return new Promise((e,t)=>{const i=r();Mn(i)?i.then(e,t):e(i)})}function Rx(){let r,e;return{promise:new Promise((i,n)=>{r=i,e=n}),resolve:r,reject:e}}class rn{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function Hn(r,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{s.dispose(),t()},r),s=e.onCancellationRequested(()=>{clearTimeout(n),s.dispose(),i(new mr)})}):Tx(t=>Hn(r,t))}function Lx(r,e=0,t){const i=setTimeout(()=>{r()},e);return Te(()=>{clearTimeout(i)})}class Ox{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new P}whenIdle(){return this.size>0?ht.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}class $x extends Ox{constructor(){super(1)}}class Nx{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new Ss;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=Oe){const i=t.getComparisonKey(e);return this.queues.get(i)?.size??0}queueFor(e,t,i=Oe){const n=i.getComparisonKey(e);let s=this.queues.get(n);if(!s){s=new $x;const o=this.drainListenerCount++,a=ht.once(s.onDrained)(()=>{s?.dispose(),this.queues.delete(n),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(o),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new j1),this.drainListeners.set(o,a),this.queues.set(n,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){for(const[,e]of this.queues)e.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}}class Fx{constructor(){this.disposable=void 0}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Te(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel()}}class Xo{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}let Hh;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Hh=(r,e)=>{nv(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Hh=(r,e,t)=>{const i=r.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}}})();class Mx{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Hh(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class Hx extends Mx{constructor(e){super(globalThis,e)}}class Ss{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new mr)}}var Uh;(function(r){async function e(i){let n;const s=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return s}r.settled=e;function t(i){return new Promise(async(n,s)=>{try{await i(n,s)}catch(o){s(o)}})}r.withAsyncBody=t})(Uh||(Uh={}));class Jt{static fromArray(e){return new Jt(t=>{t.emitMany(e)})}static fromPromise(e){return new Jt(async t=>{t.emitMany(await e)})}static fromPromises(e){return new Jt(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new Jt(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}static{this.EMPTY=Jt.fromArray([])}constructor(e){this._state=0,this._results=[],this._error=null,this._onStateChanged=new P,queueMicrotask(async()=>{const t={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(t)),this.resolve()}catch(i){this.reject(i)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await ht.toPromise(this._onStateChanged.event)}while(!0)}}}static map(e,t){return new Jt(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return Jt.map(this,e)}static filter(e,t){return new Jt(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return Jt.filter(this,e)}static coalesce(e){return Jt.filter(e,t=>!!t)}coalesce(){return Jt.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return Jt.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}}class Bh{constructor(){this._deferred=new Ss,this._asyncIterable=new Jt(i=>{if(e){i.reject(e);return}return t&&i.emitMany(t),this._errorFn=n=>i.reject(n),this._emitFn=n=>i.emitOne(n),this._deferred.p});let e,t;this._emitFn=i=>{t||(t=[]),t.push(i)},this._errorFn=i=>{e||(e=i)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}}function jv(r,e,t,i){if(!r||i>200)return null;if(typeof r=="object"){if(r.$mid===1)return t?b.revive(e.transformIncoming(r)):e.transformIncoming(r);if(r instanceof he)return null;for(const n in r)if(Object.hasOwnProperty.call(r,n)){const s=jv(r[n],e,t,i+1);s!==null&&(r[n]=s)}}return null}function Yo(r,e){const t=jv(r,e,!1,0);return t===null?r:t}class Gv{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):Zi(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class Ux extends Gv{constructor(){super(),this._hasErr=!0,this._err=new mr}}var Qv;function Wh(r,e){try{return JSON.stringify(r,e)}catch{return"null"}}const Vh="$$ref$$",Bx={[Vh]:-1};function Kv(r,e=null,t=!1){const i=[];return{jsonString:(t?Wh:JSON.stringify)(r,(s,o)=>{if(typeof o>"u")return Bx;if(typeof o=="object"){if(o instanceof he){const a=i.push(o)-1;return{[Vh]:a}}if(e)return e(s,o)}return o}),referencedBuffers:i}}function Jv(r,e,t){return JSON.parse(r,(i,n)=>{if(n){const s=n[Vh];if(typeof s=="number")return e[s];if(t&&n.$mid===1)return t.transformIncoming(n)}return n})}function Xv(r,e){return JSON.stringify(r,e)}function Wx(r){return r?(e,t)=>t&&t.$mid===1?r.transformOutgoing(t):t:null}const Vx=()=>{},zx=Symbol.for("rpcProtocol"),qx=Symbol.for("rpcProxy");class sl extends Me{static{Qv=zx}static{this.UNRESPONSIVE_TIME=3*1e3}constructor(e,t=null,i=null){super(),this[Qv]=!0,this._onDidChangeResponsiveState=this._register(new P),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=i,this._uriReplacer=Wx(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let n=0,s=el.count;n<s;n++)this._locals[n]=null,this._proxies[n]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=0,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new Xo(()=>this._checkUnresponsive(),1e3)),this._protocol.onMessage(n=>this._receiveOneMessage(n))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(L1())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+sl.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+sl.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(0)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(1):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?Yo(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:i}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,i)),this._proxies[t]}_createProxy(e,t){const i={get:(n,s)=>(typeof s=="string"&&!n[s]&&s.charCodeAt(0)===36&&(n[s]=(...o)=>this._remoteCall(e,s,o)),s===qx?t:n[s])};return new Proxy(Object.create(null),i)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,i=e.length;t<i;t++){const n=e[t];if(!this._locals[n.nid])throw new Error(`Missing proxy instance ${n.sid}`)}}_receiveOneMessage(e){if(this._isDisposed)return;const t=e.byteLength,i=tt.read(e,0),n=i.readUInt8(),s=i.readUInt32();switch(n){case 1:case 2:{let{rpcId:o,method:a,args:c}=ii.deserializeRequestJSONArgs(i);this._uriTransformer&&(c=Yo(c,this._uriTransformer)),this._receiveRequest(t,s,o,a,c,n===2);break}case 3:case 4:{let{rpcId:o,method:a,args:c}=ii.deserializeRequestMixedArgs(i);this._uriTransformer&&(c=Yo(c,this._uriTransformer)),this._receiveRequest(t,s,o,a,c,n===4);break}case 5:{this._logger?.logIncoming(t,s,0,"ack"),this._onDidReceiveAcknowledge(s);break}case 6:{this._receiveCancel(t,s);break}case 7:{this._receiveReply(t,s,void 0);break}case 9:{let o=ii.deserializeReplyOKJSON(i);this._uriTransformer&&(o=Yo(o,this._uriTransformer)),this._receiveReply(t,s,o);break}case 10:{const o=ii.deserializeReplyOKJSONWithBuffers(i,this._uriTransformer);this._receiveReply(t,s,o);break}case 8:{const o=ii.deserializeReplyOKVSBuffer(i);this._receiveReply(t,s,o);break}case 11:{let o=ii.deserializeReplyErrError(i);this._uriTransformer&&(o=Yo(o,this._uriTransformer)),this._receiveReplyErr(t,s,o);break}case 12:{this._receiveReplyErr(t,s,void 0);break}default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,i,n,s,o){this._logger?.logIncoming(e,t,1,`receiveRequest ${tl(i)}.${n}(`,s);const a=String(t);let c,l;if(o){const h=new dt;s.push(h.token),c=this._invokeHandler(i,n,s),l=()=>h.cancel()}else c=this._invokeHandler(i,n,s),l=Vx;this._cancelInvokedHandlers[a]=l;const u=ii.serializeAcknowledged(t);this._logger?.logOutgoing(u.byteLength,t,1,"ack"),this._protocol.send(u),c.then(h=>{delete this._cancelInvokedHandlers[a];const f=ii.serializeReplyOK(t,h,this._uriReplacer);this._logger?.logOutgoing(f.byteLength,t,1,"reply:",h),this._protocol.send(f)},h=>{delete this._cancelInvokedHandlers[a];const f=ii.serializeReplyErr(t,h);this._logger?.logOutgoing(f.byteLength,t,1,"replyErr:",h),this._protocol.send(f)})}_receiveCancel(e,t){this._logger?.logIncoming(e,t,1,"receiveCancel");const i=String(t);this._cancelInvokedHandlers[i]?.()}_receiveReply(e,t,i){this._logger?.logIncoming(e,t,0,"receiveReply:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n],s.resolveOk(i)}_receiveReplyErr(e,t,i){this._logger?.logIncoming(e,t,0,"receiveReplyErr:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n];let o;i&&(i.$isError?(o=new Error,o.name=i.name,o.message=i.message,o.stack=i.stack):o=i),s.resolveErr(o)}_invokeHandler(e,t,i){try{return Promise.resolve(this._doInvokeHandler(e,t,i))}catch(n){return Promise.reject(n)}}_doInvokeHandler(e,t,i){const n=this._locals[e];if(!n)throw new Error("Unknown actor "+tl(e));const s=n[t];if(typeof s!="function")throw new Error("Unknown method "+t+" on actor "+tl(e));return s.apply(n,i)}_remoteCall(e,t,i){if(this._isDisposed)return new Ux;let n=null;if(i.length>0&&yt.isCancellationToken(i[i.length-1])&&(n=i.pop()),n&&n.isCancellationRequested)return Promise.reject(L1());const s=ii.serializeRequestArguments(i,this._uriReplacer),o=++this._lastMessageId,a=String(o),c=new Gv,l=new Pe;n&&l.add(n.onCancellationRequested(()=>{const h=ii.serializeCancel(o);this._logger?.logOutgoing(h.byteLength,o,0,"cancel"),this._protocol.send(ii.serializeCancel(o))})),this._pendingRPCReplies[a]=new jx(c,l),this._onWillSendRequest(o);const u=ii.serializeRequest(o,e,t,s,!!n);return this._logger?.logOutgoing(u.byteLength,o,0,`request: ${tl(e)}.${t}(`,i),this._protocol.send(u),c}}class jx{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}class tt{static alloc(e,t,i){const n=new tt(he.alloc(i+1+4),0);return n.writeUInt8(e),n.writeUInt32(t),n}static read(e,t){return new tt(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(t+=1,s.type){case 1:t+=this.sizeLongString(s.value);break;case 2:t+=this.sizeVSBuffer(s.value);break;case 3:t+=this.sizeUInt32,t+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)t+=this.sizeVSBuffer(s.buffers[o]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,i=e.length;t<i;t++){const n=e[t];switch(n.type){case 1:this.writeUInt8(1),this.writeLongString(n.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(n.value);break;case 3:this.writeUInt8(3),this.writeUInt32(n.buffers.length),this.writeLongString(n.value);for(let s=0;s<n.buffers.length;++s)this.writeBuffer(n.buffers[s]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let i=0;i<e;i++)switch(this.readUInt8()){case 1:t[i]=this.readLongString();break;case 2:t[i]=this.readVSBuffer();break;case 3:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<s;++c)a.push(this.readVSBuffer());t[i]=new Ni(Jv(o,a,null));break}case 4:t[i]=void 0;break}return t}}class ii{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof he||e[t]instanceof Ni||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let n=0,s=e.length;n<s;n++){const o=e[n];if(o instanceof he)i[n]={type:2,value:o};else if(typeof o>"u")i[n]={type:4};else if(o instanceof Ni){const{jsonString:a,referencedBuffers:c}=Kv(o.value,t);i[n]={type:3,value:he.fromString(a),buffers:c}}else i[n]={type:1,value:he.fromString(Xv(o,t))}}return{type:1,args:i}}return{type:0,args:Xv(e,t)}}static serializeRequest(e,t,i,n,s){switch(n.type){case 0:return this._requestJSONArgs(e,t,i,n.args,s);case 1:return this._requestMixedArgs(e,t,i,n.args,s)}}static _requestJSONArgs(e,t,i,n,s){const o=he.fromString(i),a=he.fromString(n);let c=0;c+=tt.sizeUInt8(),c+=tt.sizeShortString(o),c+=tt.sizeLongString(a);const l=tt.alloc(s?2:1,e,c);return l.writeUInt8(t),l.writeShortString(o),l.writeLongString(a),l.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(n)}}static _requestMixedArgs(e,t,i,n,s){const o=he.fromString(i);let a=0;a+=tt.sizeUInt8(),a+=tt.sizeShortString(o),a+=tt.sizeMixedArray(n);const c=tt.alloc(s?4:3,e,a);return c.writeUInt8(t),c.writeShortString(o),c.writeMixedArray(n),c.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readMixedArray(),s=new Array(n.length);for(let o=0,a=n.length;o<a;o++){const c=n[o];typeof c=="string"?s[o]=JSON.parse(c):s[o]=c}return{rpcId:t,method:i,args:s}}static serializeAcknowledged(e){return tt.alloc(5,e,0).buffer}static serializeCancel(e){return tt.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof he)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof Ni){const{jsonString:n,referencedBuffers:s}=Kv(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,n,s)}else return this._serializeReplyOKJSON(e,Wh(t,i))}static _serializeReplyOKEmpty(e){return tt.alloc(7,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=tt.sizeVSBuffer(t);const n=tt.alloc(8,e,i);return n.writeVSBuffer(t),n.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=he.fromString(t);let n=0;n+=tt.sizeLongString(i);const s=tt.alloc(9,e,n);return s.writeLongString(i),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const n=he.fromString(t);let s=0;s+=tt.sizeUInt32,s+=tt.sizeLongString(n);for(const a of i)s+=tt.sizeVSBuffer(a);const o=tt.alloc(10,e,s);o.writeUInt32(i.length),o.writeLongString(n);for(const a of i)o.writeBuffer(a);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),n=e.readLongString(),s=[];for(let o=0;o<i;++o)s.push(e.readVSBuffer());return new Ni(Jv(n,s,t))}static serializeReplyErr(e,t){const i=t?Wh(Mc(t),null):void 0;if(typeof i!="string")return this._serializeReplyErrEmpty(e);const n=he.fromString(i);let s=0;s+=tt.sizeLongString(n);const o=tt.alloc(11,e,s);return o.writeLongString(n),o.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return tt.alloc(12,e,0).buffer}}function zh(r,e){return e&&(r.stack||r.stacktrace)?g("vs/base/common/errorMessage","stackTrace.format","{0}: {1}",Zv(r),Yv(r.stack)||Yv(r.stacktrace)):Zv(r)}function Yv(r){return Array.isArray(r)?r.join(`
`):r}function Zv(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?g("vs/base/common/errorMessage","nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||g("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function Un(r=null,e=!1){if(!r)return g("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){const t=Mt(r),i=Un(t[0],e);return t.length>1?g("vs/base/common/errorMessage","error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(Le(r))return r;if(r.detail){const t=r.detail;if(t.error)return zh(t.error,e);if(t.exception)return zh(t.exception,e)}return r.stack?zh(r,e):r.message?r.message:g("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function qh(r){return jh(r,0)}function jh(r,e){switch(typeof r){case"object":return r===null?sn(349,e):Array.isArray(r)?Qx(r,e):Kx(r,e);case"string":return e_(r,e);case"boolean":return Gx(r,e);case"number":return sn(r,e);case"undefined":return sn(937,e);default:return sn(617,e)}}function sn(r,e){return(e<<5)-e+r|0}function Gx(r,e){return sn(r?433:863,e)}function e_(r,e){e=sn(149417,e);for(let t=0,i=r.length;t<i;t++)e=sn(r.charCodeAt(t),e);return e}function Qx(r,e){return e=sn(104579,e),r.reduce((t,i)=>jh(i,t),e)}function Kx(r,e){return e=sn(181387,e),Object.keys(r).sort().reduce((t,i)=>(t=e_(i,t),jh(r[i],t)),e)}function Gh(...r){switch(r.length){case 1:return g("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return g("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return g("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}const Jx=g("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),Xx=g("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class Bn{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw lh(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(Gh("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Gh("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Gh("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Bn._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(Jx);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(Xx);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===47&&!i){e++;break}else s===91?i=!0:s===92?t=!0:s===93&&(i=!1);e++}for(;e<this._input.length&&Bn._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}var Ci;(function(r){r.serviceIds=new Map,r.DI_TARGET="$di$target",r.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[r.DI_DEPENDENCIES]||[]}r.getServiceDependencies=e})(Ci||(Ci={}));const ol=ee("instantiationService");function Yx(r,e,t){e[Ci.DI_TARGET]===e?e[Ci.DI_DEPENDENCIES].push({id:r,index:t}):(e[Ci.DI_DEPENDENCIES]=[{id:r,index:t}],e[Ci.DI_TARGET]=e)}function ee(r){if(Ci.serviceIds.has(r))return Ci.serviceIds.get(r);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Yx(e,t,n)};return e.toString=()=>r,Ci.serviceIds.set(r,e),e}function P7(r){return r}const xt=new Map;xt.set("false",!1),xt.set("true",!0),xt.set("isMac",wi),xt.set("isLinux",An),xt.set("isWindows",Gt),xt.set("isWeb",bh),xt.set("isMacNative",wi&&!bh),xt.set("isEdge",D2),xt.set("isFirefox",E2),xt.set("isChrome",cv),xt.set("isSafari",k2);const Zx=Object.prototype.hasOwnProperty,eC={regexParsingWithErrorRecovery:!0},tC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.emptyString","Empty context key expression"),iC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),nC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.noInAfterNot","'in' after 'not'."),t_=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),rC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedToken","Unexpected token"),sC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),oC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),aC=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let i_=class Fc{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=eC){this._config=e,this._scanner=new Bn,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:tC,offset:0,lexeme:"",additionalInfo:iC});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?sC:void 0;throw this._parsingErrors.push({message:rC,offset:i.offset,lexeme:Bn.getLexeme(i),additionalInfo:n}),Fc._parseError}return t}catch(t){if(t!==Fc._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:Ot.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:Ot.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),Tt.INSTANCE;case 12:return this._advance(),$t.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,t_),t?.negate()}case 17:return this._advance(),Pr.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),Ot.true();case 12:return this._advance(),Ot.false();case 0:{this._advance();const t=this._expr();return this._consume(1,t_),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const s=n.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let c;try{c=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return oa.create(t,c)}switch(n.type){case 10:case 19:{const s=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let f=0;f<n.lexeme.length;f++)n.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;s.push(Bn.getLexeme(o)),this._advance(),o=this._peek()}const c=s.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this._removeFlagsGY(c.substring(l+1));let h;try{h=new RegExp(c.substring(1,l),u)}catch{throw this._errExpectedButGot("REGEX",n)}return Ot.regex(t,h)}case 18:{const s=n.lexeme;this._advance();let o=null;if(!nl(s)){const a=s.indexOf("/"),c=s.lastIndexOf("/");if(a!==c&&a>=0){const l=s.slice(a+1,c),u=s[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return oa.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,nC);const n=this._value();return Ot.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return Ot.equals(t,n);switch(n){case"true":return Ot.has(t);case"false":return Ot.not(t);default:return Ot.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return Ot.notEquals(t,n);switch(n){case"true":return Ot.not(t);case"false":return Ot.has(t);default:return Ot.notEquals(t,n)}}case 5:return this._advance(),ra.create(t,this._value());case 6:return this._advance(),sa.create(t,this._value());case 7:return this._advance(),ia.create(t,this._value());case 8:return this._advance(),na.create(t,this._value());case 13:return this._advance(),Ot.in(t,this._value());default:return Ot.has(t)}}case 20:throw this._parsingErrors.push({message:oC,offset:e.offset,lexeme:"",additionalInfo:aC}),Fc._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=g("vs/platform/contextkey/common/contextkey","contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Bn.getLexeme(t)),s=t.offset,o=Bn.getLexeme(t);return this._parsingErrors.push({message:n,offset:s,lexeme:o,additionalInfo:i}),Fc._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};class Ot{static false(){return Tt.INSTANCE}static true(){return $t.INSTANCE}static has(e){return Ir.create(e)}static equals(e,t){return ea.create(e,t)}static notEquals(e,t){return ta.create(e,t)}static regex(e,t){return oa.create(e,t)}static in(e,t){return al.create(e,t)}static notIn(e,t){return cl.create(e,t)}static not(e){return Pr.create(e)}static and(...e){return Wn.create(e,null,!0)}static or(...e){return Fi.create(e,null,!0)}static greater(e,t){return ia.create(e,t)}static greaterEquals(e,t){return na.create(e,t)}static smaller(e,t){return ra.create(e,t)}static smallerEquals(e,t){return sa.create(e,t)}static{this._parser=new i_({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this._parser.parse(e)}}function cC(r){const e=new i_({regexParsingWithErrorRecovery:!1});return r.map(t=>(e.parse(t),e.lexingErrors.length>0?e.lexingErrors.map(i=>({errorMessage:i.additionalInfo?g("vs/platform/contextkey/common/contextkey","contextkey.scanner.errorForLinterWithHint","Unexpected token. Hint: {0}",i.additionalInfo):g("vs/platform/contextkey/common/contextkey","contextkey.scanner.errorForLinter","Unexpected token."),offset:i.offset,length:i.lexeme.length})):e.parsingErrors.length>0?e.parsingErrors.map(i=>({errorMessage:i.additionalInfo?`${i.message}. ${i.additionalInfo}`:i.message,offset:i.offset,length:i.lexeme.length})):[]))}function Zo(r,e){return r.cmp(e)}class Tt{static{this.INSTANCE=new Tt}constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return $t.INSTANCE}}class $t{static{this.INSTANCE=new $t}constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Tt.INSTANCE}}class Ir{static create(e,t=null){const i=xt.get(e);return typeof i=="boolean"?i?$t.INSTANCE:Tt.INSTANCE:new Ir(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:r_(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=xt.get(this.key);return typeof e=="boolean"?e?$t.INSTANCE:Tt.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Pr.create(this.key,this)),this.negated}}class ea{static create(e,t,i=null){if(typeof t=="boolean")return t?Ir.create(e,i):Pr.create(e,i);const n=xt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?$t.INSTANCE:Tt.INSTANCE:new ea(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=xt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?$t.INSTANCE:Tt.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ta.create(this.key,this.value,this)),this.negated}}class al{static create(e,t){return new al(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?Zx.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=cl.create(this.key,this.valueKey)),this.negated}}class cl{static create(e,t){return new cl(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=al.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class ta{static create(e,t,i=null){if(typeof t=="boolean")return t?Pr.create(e,i):Ir.create(e,i);const n=xt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Tt.INSTANCE:$t.INSTANCE:new ta(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=xt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Tt.INSTANCE:$t.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ea.create(this.key,this.value,this)),this.negated}}class Pr{static create(e,t=null){const i=xt.get(e);return typeof i=="boolean"?i?Tt.INSTANCE:$t.INSTANCE:new Pr(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:r_(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=xt.get(this.key);return typeof e=="boolean"?e?Tt.INSTANCE:$t.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Ir.create(this.key,this)),this.negated}}function ll(r,e){if(typeof r=="string"){const t=parseFloat(r);isNaN(t)||(r=t)}return typeof r=="string"||typeof r=="number"?e(r):Tt.INSTANCE}class ia{static create(e,t,i=null){return ll(t,n=>new ia(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=sa.create(this.key,this.value,this)),this.negated}}class na{static create(e,t,i=null){return ll(t,n=>new na(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ra.create(this.key,this.value,this)),this.negated}}class ra{static create(e,t,i=null){return ll(t,n=>new ra(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=na.create(this.key,this.value,this)),this.negated}}class sa{static create(e,t,i=null){return ll(t,n=>new sa(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:Tr(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ia.create(this.key,this.value,this)),this.negated}}class oa{static create(e,t){return new oa(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=ul.create(this)),this.negated}}class ul{static create(e){return new ul(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new ul(this._actual.map(e))}negate(){return this._actual}}function n_(r){let e=null;for(let t=0,i=r.length;t<i;t++){const n=r[t].substituteConstants();if(r[t]!==n&&e===null){e=[];for(let s=0;s<t;s++)e[s]=r[s]}e!==null&&(e[t]=n)}return e===null?r:e}class Wn{static create(e,t,i){return Wn._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Zo(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=n_(this.expr);return e===this.expr?this:Wn.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let s=!1;for(const o of e)if(o){if(o.type===1){s=!0;continue}if(o.type===0)return Tt.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&s)return $t.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(Zo);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),c=n.length===0,l=Fi.create(o.expr.map(u=>Wn.create([u,a],null,i)),null,c);l&&(n.push(l),n.sort(Zo))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return Tt.INSTANCE;if(n.length===1)return n[0]}return new Wn(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new Wn(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Fi.create(e,this,!0)}return this.negated}}class Fi{static create(e,t,i){return Fi._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Zo(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=n_(this.expr);return e===this.expr?this:Fi.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const c=e[o];if(c){if(c.type===0){s=!0;continue}if(c.type===1)return $t.INSTANCE;if(c.type===9){n=n.concat(c.expr);continue}n.push(c)}}if(n.length===0&&s)return Tt.INSTANCE;n.sort(Zo)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return $t.INSTANCE;if(n.length===1)return n[0]}return new Fi(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new Fi(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const s of s_(t))for(const o of s_(i))n.push(Wn.create([s,o],null,!1));e.unshift(Fi.create(n,null,!1))}this.negated=Fi.create(e,this,!0)}return this.negated}}class X extends Ir{static{this._info=[]}static all(){return X._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?X._info.push({...i,key:e}):i!==!0&&X._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return ea.create(this.key,e)}notEqualsTo(e){return ta.create(this.key,e)}}ee("contextKeyService");function r_(r,e){return r<e?-1:r>e?1:0}function Tr(r,e,t,i){return r<t?-1:r>t?1:e<i?-1:e>i?1:0}function s_(r){return r.type===9?r.expr:[r]}const ze=ee("logService"),Es=ee("loggerService");function lC(r){return Nn(r)}var Ae;(function(r){r[r.Off=0]="Off",r[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=3]="Info",r[r.Warning=4]="Warning",r[r.Error=5]="Error"})(Ae||(Ae={}));const uC=Ae.Info;function dC(r,e,t){switch(e){case Ae.Trace:r.trace(t);break;case Ae.Debug:r.debug(t);break;case Ae.Info:r.info(t);break;case Ae.Warning:r.warn(t);break;case Ae.Error:r.error(t);break;case Ae.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function ks(r,e=!1){let t="";for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Error&&(n=Un(n,e)),typeof n=="object")try{n=JSON.stringify(n)}catch{}t+=(i>0?" ":"")+n}return t}class o_ extends Me{constructor(){super(...arguments),this.level=uC,this._onDidChangeLogLevel=this._register(new P),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Ae.Off&&this.level<=e}}class a_ extends o_{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.checkLogLevel(Ae.Trace)&&this.log(Ae.Trace,ks([e,...t],!0))}debug(e,...t){this.checkLogLevel(Ae.Debug)&&this.log(Ae.Debug,ks([e,...t]))}info(e,...t){this.checkLogLevel(Ae.Info)&&this.log(Ae.Info,ks([e,...t]))}warn(e,...t){this.checkLogLevel(Ae.Warning)&&this.log(Ae.Warning,ks([e,...t]))}error(e,...t){if(this.checkLogLevel(Ae.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(Ae.Error,ks(i))}else this.log(Ae.Error,ks([e,...t]))}flush(){}}class hC extends o_{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class fC extends Me{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new it,this._onDidChangeLoggers=this._register(new P),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new P),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new P),this.onDidChangeVisibility=this._onDidChangeVisibility.event,i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return Le(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,t){const i=this.toResource(e),n=Le(e)?e:t?.id??qh(i.toString()).toString(16);let s=this._loggers.get(i)?.logger;const o=t?.logLevel==="always"?Ae.Trace:t?.logLevel;s||(s=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:s,info:{resource:i,id:n,logLevel:o,name:t?.name,hidden:t?.hidden,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(a.info),this._loggers.set(i,a),s}toResource(e){return Le(e)?Cs(this.logsHome,`${e}.log`):e}setLogLevel(e,t){if(b.isUri(e)){const i=e,n=t,s=this._loggers.get(i);s&&n!==s.info.logLevel&&(s.info.logLevel=n===this.logLevel?void 0:n,s.logger?.setLevel(n),this._loggers.set(s.info.resource,s),this._onDidChangeLogLevel.fire([i,n]))}else{this.logLevel=e;for(const[i,n]of this._loggers.entries())this._loggers.get(i)?.info.logLevel===void 0&&n.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this._loggers.get(e)?.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this._loggers.get(e);t&&(t.logger&&t.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[t.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose()),this._loggers.clear(),super.dispose()}}function pC(r){switch(r){case Ae.Trace:return"trace";case Ae.Debug:return"debug";case Ae.Info:return"info";case Ae.Warning:return"warn";case Ae.Error:return"error";case Ae.Off:return"off"}}function gC(r){switch(r){case"trace":return Ae.Trace;case"debug":return Ae.Debug;case"info":return Ae.Info;case"warn":return Ae.Warning;case"error":return Ae.Error;case"critical":return Ae.Error;case"off":return Ae.Off}}new X("logLevel",pC(Ae.Info));class Mi{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const c_=[];function nt(r,e,t){e instanceof Mi||(e=new Mi(e,[],!!t)),c_.push([r,e])}function mC(){return c_}class Qh{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const At=ee("IExtHostInitDataService");class vC{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}}class l_{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new vC(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(n,t);if(s)return s;t.delete(i)}}}const _C=!1;class u_ extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class dl{constructor(e=new Qh,t=!1,i,n=_C){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._activeInstantiations=new Set,this._services.set(ol,this),this._globalGraph=n?i?._globalGraph??new l_(s=>s):void 0}createChild(e){return new dl(e,this._strict,this,this._enableTracing)}invokeFunction(e,...t){const i=ni.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw lh("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){let i,n;return e instanceof Mi?(i=ni.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=ni.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=Ci.getServiceDependencies(e).sort((a,c)=>a.index-c.index),s=[];for(const a of n){const c=this._getOrCreateServiceInstance(a.id,i);c||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(c)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(s))}_setServiceInstance(e,t){if(this._services.get(e)instanceof Mi)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Mi?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const n=new l_(a=>a.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}];for(;o.length;){const a=o.pop();if(n.lookupOrInsertNode(a),s++>1e3)throw new u_(n);for(const c of Ci.getServiceDependencies(a.desc.ctor)){const l=this._getServiceInstanceOrDescriptor(c.id);if(l||this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(a.id),String(c.id)),l instanceof Mi){const u={id:c.id,desc:l,_trace:a._trace.branch(c.id,!0)};n.lookup(u)||o.push(u),n.insertEdge(a,u)}}}for(;;){const a=n.roots();if(a.length===0){if(!n.isEmpty())throw new u_(n);break}for(const{data:c}of a){if(this._getServiceInstanceOrDescriptor(c.id)instanceof Mi){const u=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setServiceInstance(c.id,u)}n.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){if(this._services.get(e)instanceof Mi)return this._createServiceInstance(e,t,i,n,s);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,s){if(n){const o=new dl(void 0,this._strict,this,this._enableTracing);o._globalGraphImplicitDependency=String(e);const a=new Map,c=new Hx(()=>{const l=o._createInstance(t,i,s);for(const[u,h]of a){const f=l[u];if(typeof f=="function")for(const d of h)d.disposable=f.apply(l,d.listener)}return a.clear(),l});return new Proxy(Object.create(null),{get(l,u){if(!c.isInitialized&&typeof u=="string"&&(u.startsWith("onDid")||u.startsWith("onWill"))){let d=a.get(u);return d||(d=new Wo,a.set(u,d)),(w,x,k)=>{if(c.isInitialized)return c.value[u](w,x,k);{const S={listener:[w,x,k],disposable:void 0},D=d.push(S);return Te(()=>{D(),S.disposable?.dispose()})}}}if(u in l)return l[u];const h=c.value;let f=h[u];return typeof f!="function"||(f=f.bind(h),l[u]=f),f},set(l,u,h){return c.value[u]=h,!0},getPrototypeOf(l){return t.prototype}})}else return this._createInstance(t,i,s)}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class ni{static{this.all=new Set}static{this._None=new class extends ni{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,t){return e?new ni(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):ni._None}static traceCreation(e,t){return e?new ni(1,t.name):ni._None}static{this._totals=0}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new ni(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;ni._totals+=e;let t=!1;function i(s,o){const a=[],c=new Array(s+1).join("	");for(const[l,u,h]of o._dep)if(u&&h){t=!0,a.push(`${c}CREATES -> ${l}`);const f=i(s+1,h);f&&a.push(f)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${ni._totals.toFixed(2)}ms)`];(e>2||t)&&ni.all.add(n.join(`
`))}}const Ue=ee("IExtHostRpcService");class wC{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}const hl=ee("IURITransformerService");class bC{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}function F(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function O(r,e){return function(t,i){e(t,i,r)}}class yC{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class xC{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?Th(e,this._value,0,e.length,this._from,this._to):Go(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class d_{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Th(e,this._value,0,e.length,this._from,this._to):Go(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class CC{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new d_(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return kv(e,this._value.scheme);if(this._states[this._stateIdx]===2)return kv(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return Sr(e,this._value.query);if(this._states[this._stateIdx]===5)return Sr(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class fl{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}class hi{static forUris(e=()=>!1,t=()=>!1){return new hi(new CC(e,t))}static forPaths(e=!1){return new hi(new d_(void 0,!e))}static forStrings(){return new hi(new yC)}static forConfigKeys(){return new hi(new xC)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){const i=t.slice(0);N1(i);for(const n of i)this.set(n,e)}else{const i=e.slice(0);N1(i);for(const n of i)this.set(n[0],n[1])}}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new fl,this._root.segment=i.value());const s=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new fl,n.left.segment=i.value()),s.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new fl,n.right.segment=i.value()),s.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new fl,n.mid.segment=i.value()),s.push([0,n]),n=n.mid;else break}const o=n.value;n.value=t,n.key=e;for(let a=s.length-1;a>=0;a--){const c=s[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=s[a][0],h=s[a+1][0];if(u===1&&h===1)s[a][1]=c.rotateLeft();else if(u===-1&&h===-1)s[a][1]=c.rotateRight();else if(u===1&&h===-1)c.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=c.rotateLeft();else if(u===-1&&h===1)c.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){return this._getNode(e)?.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let s=this._root;for(;s;){const o=i.cmp(s.segment);if(o>0)n.push([-1,s]),s=s.left;else if(o<0)n.push([1,s]),s=s.right;else if(i.hasNext())i.next(),n.push([0,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=this._min(s.right);if(o.key){const{key:a,value:c,segment:l}=o;this._delete(o.key,!1),s.key=a,s.value=c,s.segment=l}}else{const o=s.left??s.right;if(n.length>0){const[a,c]=n[n.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this._root=o}for(let o=n.length-1;o>=0;o--){const a=n[o][1];a.updateHeight();const c=a.balanceFactor();if(c>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[o][1]=a.rotateLeft()):c<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[o][1]=a.rotateRight()),o>0)switch(n[o-1][0]){case-1:n[o-1][1].left=n[o][1];break;case 1:n[o-1][1].right=n[o][1];break;case 0:n[o-1][1].mid=n[o][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const s=i.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){const e=t=>{if(!t)return!0;const i=t.balanceFactor();return i<-1||i>1?!1:e(t.left)&&e(t.right)};return e(this._root)}}function ct(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;const e=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?ct(i):i}),e}function Kh(r){if(!r||typeof r!="object")return r;const e=[r];for(;e.length>0;){const t=e.shift();for(const i in t)if(h_.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!dx(n)&&e.push(n)}}return r}const h_=Object.prototype.hasOwnProperty;function pl(r,e){return Jh(r,e,new Set)}function Jh(r,e,t){if(Lt(r))return r;const i=e(r);if(typeof i<"u")return i;if(Array.isArray(r)){const n=[];for(const s of r)n.push(Jh(s,e,t));return n}if(It(r)){if(t.has(r))throw new Error("Cannot clone recursive data-structure");t.add(r);const n={};for(const s in r)h_.call(r,s)&&(n[s]=Jh(r[s],e,t));return t.delete(r),n}return r}function Ar(r,e,t=!0){return It(r)?(It(e)&&Object.keys(e).forEach(i=>{i in r?t&&(It(r[i])&&It(e[i])?Ar(r[i],e[i],t):r[i]=e[i]):r[i]=e[i]}),r):e}function Si(r,e){if(r===e)return!0;if(r==null||e===null||e===void 0||typeof r!=typeof e||typeof r!="object"||Array.isArray(r)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(r)){if(r.length!==e.length)return!1;for(t=0;t<r.length;t++)if(!Si(r[t],e[t]))return!1}else{const n=[];for(i in r)n.push(i);n.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!Si(n,s))return!1;for(t=0;t<n.length;t++)if(!Si(r[n[t]],e[n[t]]))return!1}return!0}function SC(r){const e=new Set;return JSON.stringify(r,(t,i)=>{if(It(i)||Array.isArray(i)){if(e.has(i))return"[Circular]";e.add(i)}return i})}function f_(r,e){const t=Object.create(null);for(const[i,n]of Object.entries(r))e(i,n)&&(t[i]=n);return t}class EC{constructor(){this._next=0}getNext(){return this._next++}}var Ye;(function(r){r[r.Ignore=0]="Ignore",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})(Ye||(Ye={})),function(r){const e="error",t="warning",i="warn",n="info",s="ignore";function o(c){return c?Er(e,c)?r.Error:Er(t,c)||Er(i,c)?r.Warning:Er(n,c)?r.Info:r.Ignore:r.Ignore}r.fromValue=o;function a(c){switch(c){case r.Error:return e;case r.Warning:return t;case r.Info:return n;default:return s}}r.toString=a}(Ye||(Ye={}));var kC=Ye;ee("notificationService");var p_;(function(r){r[r.DEFAULT=0]="DEFAULT",r[r.SILENT=1]="SILENT",r[r.URGENT=2]="URGENT"})(p_||(p_={}));var g_;(function(r){r[r.WORKSPACE=0]="WORKSPACE",r[r.PROFILE=1]="PROFILE",r[r.APPLICATION=2]="APPLICATION"})(g_||(g_={}));var m_;(function(r){r[r.OFF=0]="OFF",r[r.ERROR=1]="ERROR"})(m_||(m_={}));const Xh=ee("contextService");let DC=class{constructor(e,t,i,n,s){this._id=e,this._transient=i,this._configuration=n,this._ignorePathCasing=s,this._foldersMap=hi.forUris(this._ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this._ignorePathCasing=e._ignorePathCasing,this.folders=e.folders}get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this._foldersMap.findSubstr(e)||null}updateFoldersMap(){this._foldersMap=hi.forUris(this._ignorePathCasing,()=>!0);for(const e of this.folders)this._foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class v_{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return Cs(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function __(r){return new v_({uri:r,index:0,name:Nh(r)},{uri:r.toString()})}const IC="code-workspace";g("vs/platform/workspace/common/workspace","codeWorkspace","Code Workspace");class PC{constructor(){this._systemSchemes=new Set(Object.keys(K)),this._providerInfo=new Map,this.extUri=new Jo(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const Ds=ee("IExtHostFileSystemInfo"),on=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){r(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,s="";return s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s}}(),Yh=Object.freeze({create:r=>gs(r.map(e=>e.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>Yh.split(r).filter(e=>!e.startsWith("#"))});function w_(...r){return function(e,t){for(let i=0,n=r.length;i<n;i++){const s=r[i](e,t);if(s)return s}return null}}y_.bind(void 0,!1);const b_=y_.bind(void 0,!0);function y_(r,e,t){if(!t||t.length<e.length)return null;let i;return r?i=Ah(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function TC(r,e){const t=e.toLowerCase().indexOf(r.toLowerCase());return t===-1?null:[{start:t,end:t+r.length}]}function AC(r,e){return Zh(r.toLowerCase(),e.toLowerCase(),0,0)}function Zh(r,e,t,i){if(t===r.length)return[];if(i===e.length)return null;if(r[t]===e[i]){let n=null;return(n=Zh(r,e,t+1,i+1))?C_({start:i,end:i+1},n):null}return Zh(r,e,t,i+1)}function ef(r){return 97<=r&&r<=122}function gl(r){return 65<=r&&r<=90}function tf(r){return 48<=r&&r<=57}function RC(r){return r===32||r===9||r===10||r===13}const LC=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>LC.add(r.charCodeAt(0)));function x_(r){return ef(r)||gl(r)||tf(r)}function C_(r,e){return e.length===0?e=[r]:r.end===e[0].start?e[0].start=r.start:e.unshift(r),e}function S_(r,e){for(let t=e;t<r.length;t++){const i=r.charCodeAt(t);if(gl(i)||tf(i)||t>0&&!x_(r.charCodeAt(t-1)))return t}return r.length}function nf(r,e,t,i){if(t===r.length)return[];if(i===e.length)return null;if(r[t]!==e[i].toLowerCase())return null;{let n=null,s=i+1;for(n=nf(r,e,t+1,i+1);!n&&(s=S_(e,s))<e.length;)n=nf(r,e,t+1,s),s++;return n===null?null:C_({start:i,end:i+1},n)}}function OC(r){let e=0,t=0,i=0,n=0,s=0;for(let u=0;u<r.length;u++)s=r.charCodeAt(u),gl(s)&&e++,ef(s)&&t++,x_(s)&&i++,tf(s)&&n++;const o=e/r.length,a=t/r.length,c=i/r.length,l=n/r.length;return{upperPercent:o,lowerPercent:a,alphaPercent:c,numericPercent:l}}function $C(r){const{upperPercent:e,lowerPercent:t}=r;return t===0&&e>.6}function NC(r){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=r;return t>.2&&e<.8&&i>.6&&n<.2}function FC(r){let e=0,t=0,i=0,n=0;for(let s=0;s<r.length;s++)i=r.charCodeAt(s),gl(i)&&e++,ef(i)&&t++,RC(i)&&n++;return(e===0||t===0)&&n===0?r.length<=30:e<=5}function E_(r,e){if(!e||(e=e.trim(),e.length===0)||!FC(r))return null;e.length>60&&(e=e.substring(0,60));const t=OC(e);if(!NC(t)){if(!$C(t))return null;e=e.toLowerCase()}let i=null,n=0;for(r=r.toLowerCase();n<e.length&&(i=nf(r,e,0,n))===null;)n=S_(e,n+1);return i}w_(b_,E_,TC),w_(b_,E_,AC),new W1(1e4);const k_=128;function rf(){const r=[],e=[];for(let t=0;t<=k_;t++)e[t]=0;for(let t=0;t<=k_;t++)r.push(e.slice(0));return r}rf(),rf(),rf();var D_;(function(r){r.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}r.isDefault=e})(D_||(D_={}));class T7{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}}const sf=Object.create(null);function p(r,e){if(Le(e)){const t=sf[e];if(t===void 0)throw new Error(`${r} references an unknown codicon: ${e}`);e=t}return sf[r]=e,{id:r}}function MC(){return sf}const ne={add:p("add",6e4),plus:p("plus",6e4),gistNew:p("gist-new",6e4),repoCreate:p("repo-create",6e4),lightbulb:p("lightbulb",60001),lightBulb:p("light-bulb",60001),repo:p("repo",60002),repoDelete:p("repo-delete",60002),gistFork:p("gist-fork",60003),repoForked:p("repo-forked",60003),gitPullRequest:p("git-pull-request",60004),gitPullRequestAbandoned:p("git-pull-request-abandoned",60004),recordKeys:p("record-keys",60005),keyboard:p("keyboard",60005),tag:p("tag",60006),tagAdd:p("tag-add",60006),tagRemove:p("tag-remove",60006),gitPullRequestLabel:p("git-pull-request-label",60006),person:p("person",60007),personFollow:p("person-follow",60007),personOutline:p("person-outline",60007),personFilled:p("person-filled",60007),gitBranch:p("git-branch",60008),gitBranchCreate:p("git-branch-create",60008),gitBranchDelete:p("git-branch-delete",60008),sourceControl:p("source-control",60008),mirror:p("mirror",60009),mirrorPublic:p("mirror-public",60009),star:p("star",60010),starAdd:p("star-add",60010),starDelete:p("star-delete",60010),starEmpty:p("star-empty",60010),comment:p("comment",60011),commentAdd:p("comment-add",60011),alert:p("alert",60012),warning:p("warning",60012),search:p("search",60013),searchSave:p("search-save",60013),logOut:p("log-out",60014),signOut:p("sign-out",60014),logIn:p("log-in",60015),signIn:p("sign-in",60015),eye:p("eye",60016),eyeUnwatch:p("eye-unwatch",60016),eyeWatch:p("eye-watch",60016),circleFilled:p("circle-filled",60017),primitiveDot:p("primitive-dot",60017),closeDirty:p("close-dirty",60017),debugBreakpoint:p("debug-breakpoint",60017),debugBreakpointDisabled:p("debug-breakpoint-disabled",60017),debugBreakpointPending:p("debug-breakpoint-pending",60377),debugHint:p("debug-hint",60017),primitiveSquare:p("primitive-square",60018),edit:p("edit",60019),pencil:p("pencil",60019),info:p("info",60020),issueOpened:p("issue-opened",60020),gistPrivate:p("gist-private",60021),gitForkPrivate:p("git-fork-private",60021),lock:p("lock",60021),mirrorPrivate:p("mirror-private",60021),close:p("close",60022),removeClose:p("remove-close",60022),x:p("x",60022),repoSync:p("repo-sync",60023),sync:p("sync",60023),clone:p("clone",60024),desktopDownload:p("desktop-download",60024),beaker:p("beaker",60025),microscope:p("microscope",60025),vm:p("vm",60026),deviceDesktop:p("device-desktop",60026),file:p("file",60027),fileText:p("file-text",60027),more:p("more",60028),ellipsis:p("ellipsis",60028),kebabHorizontal:p("kebab-horizontal",60028),mailReply:p("mail-reply",60029),reply:p("reply",60029),organization:p("organization",60030),organizationFilled:p("organization-filled",60030),organizationOutline:p("organization-outline",60030),newFile:p("new-file",60031),fileAdd:p("file-add",60031),newFolder:p("new-folder",60032),fileDirectoryCreate:p("file-directory-create",60032),trash:p("trash",60033),trashcan:p("trashcan",60033),history:p("history",60034),clock:p("clock",60034),folder:p("folder",60035),fileDirectory:p("file-directory",60035),symbolFolder:p("symbol-folder",60035),logoGithub:p("logo-github",60036),markGithub:p("mark-github",60036),github:p("github",60036),terminal:p("terminal",60037),console:p("console",60037),repl:p("repl",60037),zap:p("zap",60038),symbolEvent:p("symbol-event",60038),error:p("error",60039),stop:p("stop",60039),variable:p("variable",60040),symbolVariable:p("symbol-variable",60040),array:p("array",60042),symbolArray:p("symbol-array",60042),symbolModule:p("symbol-module",60043),symbolPackage:p("symbol-package",60043),symbolNamespace:p("symbol-namespace",60043),symbolObject:p("symbol-object",60043),symbolMethod:p("symbol-method",60044),symbolFunction:p("symbol-function",60044),symbolConstructor:p("symbol-constructor",60044),symbolBoolean:p("symbol-boolean",60047),symbolNull:p("symbol-null",60047),symbolNumeric:p("symbol-numeric",60048),symbolNumber:p("symbol-number",60048),symbolStructure:p("symbol-structure",60049),symbolStruct:p("symbol-struct",60049),symbolParameter:p("symbol-parameter",60050),symbolTypeParameter:p("symbol-type-parameter",60050),symbolKey:p("symbol-key",60051),symbolText:p("symbol-text",60051),symbolReference:p("symbol-reference",60052),goToFile:p("go-to-file",60052),symbolEnum:p("symbol-enum",60053),symbolValue:p("symbol-value",60053),symbolRuler:p("symbol-ruler",60054),symbolUnit:p("symbol-unit",60054),activateBreakpoints:p("activate-breakpoints",60055),archive:p("archive",60056),arrowBoth:p("arrow-both",60057),arrowDown:p("arrow-down",60058),arrowLeft:p("arrow-left",60059),arrowRight:p("arrow-right",60060),arrowSmallDown:p("arrow-small-down",60061),arrowSmallLeft:p("arrow-small-left",60062),arrowSmallRight:p("arrow-small-right",60063),arrowSmallUp:p("arrow-small-up",60064),arrowUp:p("arrow-up",60065),bell:p("bell",60066),bold:p("bold",60067),book:p("book",60068),bookmark:p("bookmark",60069),debugBreakpointConditionalUnverified:p("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:p("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:p("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:p("debug-breakpoint-data-unverified",60072),debugBreakpointData:p("debug-breakpoint-data",60073),debugBreakpointDataDisabled:p("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:p("debug-breakpoint-log-unverified",60074),debugBreakpointLog:p("debug-breakpoint-log",60075),debugBreakpointLogDisabled:p("debug-breakpoint-log-disabled",60075),briefcase:p("briefcase",60076),broadcast:p("broadcast",60077),browser:p("browser",60078),bug:p("bug",60079),calendar:p("calendar",60080),caseSensitive:p("case-sensitive",60081),check:p("check",60082),checklist:p("checklist",60083),chevronDown:p("chevron-down",60084),dropDownButton:p("drop-down-button",60084),chevronLeft:p("chevron-left",60085),chevronRight:p("chevron-right",60086),chevronUp:p("chevron-up",60087),chromeClose:p("chrome-close",60088),chromeMaximize:p("chrome-maximize",60089),chromeMinimize:p("chrome-minimize",60090),chromeRestore:p("chrome-restore",60091),circle:p("circle",60092),circleOutline:p("circle-outline",60092),debugBreakpointUnverified:p("debug-breakpoint-unverified",60092),circleSlash:p("circle-slash",60093),circuitBoard:p("circuit-board",60094),clearAll:p("clear-all",60095),clippy:p("clippy",60096),closeAll:p("close-all",60097),cloudDownload:p("cloud-download",60098),cloudUpload:p("cloud-upload",60099),code:p("code",60100),collapseAll:p("collapse-all",60101),colorMode:p("color-mode",60102),commentDiscussion:p("comment-discussion",60103),compareChanges:p("compare-changes",60157),creditCard:p("credit-card",60105),dash:p("dash",60108),dashboard:p("dashboard",60109),database:p("database",60110),debugContinue:p("debug-continue",60111),debugDisconnect:p("debug-disconnect",60112),debugPause:p("debug-pause",60113),debugRestart:p("debug-restart",60114),debugStart:p("debug-start",60115),debugStepInto:p("debug-step-into",60116),debugStepOut:p("debug-step-out",60117),debugStepOver:p("debug-step-over",60118),debugStop:p("debug-stop",60119),debug:p("debug",60120),deviceCameraVideo:p("device-camera-video",60121),deviceCamera:p("device-camera",60122),deviceMobile:p("device-mobile",60123),diffAdded:p("diff-added",60124),diffIgnored:p("diff-ignored",60125),diffModified:p("diff-modified",60126),diffRemoved:p("diff-removed",60127),diffRenamed:p("diff-renamed",60128),diff:p("diff",60129),discard:p("discard",60130),editorLayout:p("editor-layout",60131),emptyWindow:p("empty-window",60132),exclude:p("exclude",60133),extensions:p("extensions",60134),eyeClosed:p("eye-closed",60135),fileBinary:p("file-binary",60136),fileCode:p("file-code",60137),fileMedia:p("file-media",60138),filePdf:p("file-pdf",60139),fileSubmodule:p("file-submodule",60140),fileSymlinkDirectory:p("file-symlink-directory",60141),fileSymlinkFile:p("file-symlink-file",60142),fileZip:p("file-zip",60143),files:p("files",60144),filter:p("filter",60145),flame:p("flame",60146),foldDown:p("fold-down",60147),foldUp:p("fold-up",60148),fold:p("fold",60149),folderActive:p("folder-active",60150),folderOpened:p("folder-opened",60151),gear:p("gear",60152),gift:p("gift",60153),gistSecret:p("gist-secret",60154),gist:p("gist",60155),gitCommit:p("git-commit",60156),gitCompare:p("git-compare",60157),gitMerge:p("git-merge",60158),githubAction:p("github-action",60159),githubAlt:p("github-alt",60160),globe:p("globe",60161),grabber:p("grabber",60162),graph:p("graph",60163),gripper:p("gripper",60164),heart:p("heart",60165),home:p("home",60166),horizontalRule:p("horizontal-rule",60167),hubot:p("hubot",60168),inbox:p("inbox",60169),issueClosed:p("issue-closed",60324),issueReopened:p("issue-reopened",60171),issues:p("issues",60172),italic:p("italic",60173),jersey:p("jersey",60174),json:p("json",60175),bracket:p("bracket",60175),kebabVertical:p("kebab-vertical",60176),key:p("key",60177),law:p("law",60178),lightbulbAutofix:p("lightbulb-autofix",60179),linkExternal:p("link-external",60180),link:p("link",60181),listOrdered:p("list-ordered",60182),listUnordered:p("list-unordered",60183),liveShare:p("live-share",60184),loading:p("loading",60185),location:p("location",60186),mailRead:p("mail-read",60187),mail:p("mail",60188),markdown:p("markdown",60189),megaphone:p("megaphone",60190),mention:p("mention",60191),milestone:p("milestone",60192),gitPullRequestMilestone:p("git-pull-request-milestone",60192),mortarBoard:p("mortar-board",60193),move:p("move",60194),multipleWindows:p("multiple-windows",60195),mute:p("mute",60196),noNewline:p("no-newline",60197),note:p("note",60198),octoface:p("octoface",60199),openPreview:p("open-preview",60200),package:p("package",60201),paintcan:p("paintcan",60202),pin:p("pin",60203),play:p("play",60204),run:p("run",60204),plug:p("plug",60205),preserveCase:p("preserve-case",60206),preview:p("preview",60207),project:p("project",60208),pulse:p("pulse",60209),question:p("question",60210),quote:p("quote",60211),radioTower:p("radio-tower",60212),reactions:p("reactions",60213),references:p("references",60214),refresh:p("refresh",60215),regex:p("regex",60216),remoteExplorer:p("remote-explorer",60217),remote:p("remote",60218),remove:p("remove",60219),replaceAll:p("replace-all",60220),replace:p("replace",60221),repoClone:p("repo-clone",60222),repoForcePush:p("repo-force-push",60223),repoPull:p("repo-pull",60224),repoPush:p("repo-push",60225),report:p("report",60226),requestChanges:p("request-changes",60227),rocket:p("rocket",60228),rootFolderOpened:p("root-folder-opened",60229),rootFolder:p("root-folder",60230),rss:p("rss",60231),ruby:p("ruby",60232),saveAll:p("save-all",60233),saveAs:p("save-as",60234),save:p("save",60235),screenFull:p("screen-full",60236),screenNormal:p("screen-normal",60237),searchStop:p("search-stop",60238),server:p("server",60240),settingsGear:p("settings-gear",60241),settings:p("settings",60242),shield:p("shield",60243),smiley:p("smiley",60244),sortPrecedence:p("sort-precedence",60245),splitHorizontal:p("split-horizontal",60246),splitVertical:p("split-vertical",60247),squirrel:p("squirrel",60248),starFull:p("star-full",60249),starHalf:p("star-half",60250),symbolClass:p("symbol-class",60251),symbolColor:p("symbol-color",60252),symbolCustomColor:p("symbol-customcolor",60252),symbolConstant:p("symbol-constant",60253),symbolEnumMember:p("symbol-enum-member",60254),symbolField:p("symbol-field",60255),symbolFile:p("symbol-file",60256),symbolInterface:p("symbol-interface",60257),symbolKeyword:p("symbol-keyword",60258),symbolMisc:p("symbol-misc",60259),symbolOperator:p("symbol-operator",60260),symbolProperty:p("symbol-property",60261),wrench:p("wrench",60261),wrenchSubaction:p("wrench-subaction",60261),symbolSnippet:p("symbol-snippet",60262),tasklist:p("tasklist",60263),telescope:p("telescope",60264),textSize:p("text-size",60265),threeBars:p("three-bars",60266),thumbsdown:p("thumbsdown",60267),thumbsup:p("thumbsup",60268),tools:p("tools",60269),triangleDown:p("triangle-down",60270),triangleLeft:p("triangle-left",60271),triangleRight:p("triangle-right",60272),triangleUp:p("triangle-up",60273),twitter:p("twitter",60274),unfold:p("unfold",60275),unlock:p("unlock",60276),unmute:p("unmute",60277),unverified:p("unverified",60278),verified:p("verified",60279),versions:p("versions",60280),vmActive:p("vm-active",60281),vmOutline:p("vm-outline",60282),vmRunning:p("vm-running",60283),watch:p("watch",60284),whitespace:p("whitespace",60285),wholeWord:p("whole-word",60286),window:p("window",60287),wordWrap:p("word-wrap",60288),zoomIn:p("zoom-in",60289),zoomOut:p("zoom-out",60290),listFilter:p("list-filter",60291),listFlat:p("list-flat",60292),listSelection:p("list-selection",60293),selection:p("selection",60293),listTree:p("list-tree",60294),debugBreakpointFunctionUnverified:p("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:p("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:p("debug-breakpoint-function-disabled",60296),debugStackframeActive:p("debug-stackframe-active",60297),circleSmallFilled:p("circle-small-filled",60298),debugStackframeDot:p("debug-stackframe-dot",60298),debugStackframe:p("debug-stackframe",60299),debugStackframeFocused:p("debug-stackframe-focused",60299),debugBreakpointUnsupported:p("debug-breakpoint-unsupported",60300),symbolString:p("symbol-string",60301),debugReverseContinue:p("debug-reverse-continue",60302),debugStepBack:p("debug-step-back",60303),debugRestartFrame:p("debug-restart-frame",60304),callIncoming:p("call-incoming",60306),callOutgoing:p("call-outgoing",60307),menu:p("menu",60308),expandAll:p("expand-all",60309),feedback:p("feedback",60310),gitPullRequestReviewer:p("git-pull-request-reviewer",60310),groupByRefType:p("group-by-ref-type",60311),ungroupByRefType:p("ungroup-by-ref-type",60312),account:p("account",60313),gitPullRequestAssignee:p("git-pull-request-assignee",60313),bellDot:p("bell-dot",60314),debugConsole:p("debug-console",60315),library:p("library",60316),output:p("output",60317),runAll:p("run-all",60318),syncIgnored:p("sync-ignored",60319),pinned:p("pinned",60320),githubInverted:p("github-inverted",60321),debugAlt:p("debug-alt",60305),serverProcess:p("server-process",60322),serverEnvironment:p("server-environment",60323),pass:p("pass",60324),stopCircle:p("stop-circle",60325),playCircle:p("play-circle",60326),record:p("record",60327),debugAltSmall:p("debug-alt-small",60328),vmConnect:p("vm-connect",60329),cloud:p("cloud",60330),merge:p("merge",60331),exportIcon:p("export",60332),graphLeft:p("graph-left",60333),magnet:p("magnet",60334),notebook:p("notebook",60335),redo:p("redo",60336),checkAll:p("check-all",60337),pinnedDirty:p("pinned-dirty",60338),passFilled:p("pass-filled",60339),circleLargeFilled:p("circle-large-filled",60340),circleLarge:p("circle-large",60341),circleLargeOutline:p("circle-large-outline",60341),combine:p("combine",60342),gather:p("gather",60342),table:p("table",60343),variableGroup:p("variable-group",60344),typeHierarchy:p("type-hierarchy",60345),typeHierarchySub:p("type-hierarchy-sub",60346),typeHierarchySuper:p("type-hierarchy-super",60347),gitPullRequestCreate:p("git-pull-request-create",60348),runAbove:p("run-above",60349),runBelow:p("run-below",60350),notebookTemplate:p("notebook-template",60351),debugRerun:p("debug-rerun",60352),workspaceTrusted:p("workspace-trusted",60353),workspaceUntrusted:p("workspace-untrusted",60354),workspaceUnspecified:p("workspace-unspecified",60355),terminalCmd:p("terminal-cmd",60356),terminalDebian:p("terminal-debian",60357),terminalLinux:p("terminal-linux",60358),terminalPowershell:p("terminal-powershell",60359),terminalTmux:p("terminal-tmux",60360),terminalUbuntu:p("terminal-ubuntu",60361),terminalBash:p("terminal-bash",60362),arrowSwap:p("arrow-swap",60363),copy:p("copy",60364),personAdd:p("person-add",60365),filterFilled:p("filter-filled",60366),wand:p("wand",60367),debugLineByLine:p("debug-line-by-line",60368),inspect:p("inspect",60369),layers:p("layers",60370),layersDot:p("layers-dot",60371),layersActive:p("layers-active",60372),compass:p("compass",60373),compassDot:p("compass-dot",60374),compassActive:p("compass-active",60375),azure:p("azure",60376),issueDraft:p("issue-draft",60377),gitPullRequestClosed:p("git-pull-request-closed",60378),gitPullRequestDraft:p("git-pull-request-draft",60379),debugAll:p("debug-all",60380),debugCoverage:p("debug-coverage",60381),runErrors:p("run-errors",60382),folderLibrary:p("folder-library",60383),debugContinueSmall:p("debug-continue-small",60384),beakerStop:p("beaker-stop",60385),graphLine:p("graph-line",60386),graphScatter:p("graph-scatter",60387),pieChart:p("pie-chart",60388),bracketDot:p("bracket-dot",60389),bracketError:p("bracket-error",60390),lockSmall:p("lock-small",60391),azureDevops:p("azure-devops",60392),verifiedFilled:p("verified-filled",60393),newLine:p("newline",60394),layout:p("layout",60395),layoutActivitybarLeft:p("layout-activitybar-left",60396),layoutActivitybarRight:p("layout-activitybar-right",60397),layoutPanelLeft:p("layout-panel-left",60398),layoutPanelCenter:p("layout-panel-center",60399),layoutPanelJustify:p("layout-panel-justify",60400),layoutPanelRight:p("layout-panel-right",60401),layoutPanel:p("layout-panel",60402),layoutSidebarLeft:p("layout-sidebar-left",60403),layoutSidebarRight:p("layout-sidebar-right",60404),layoutStatusbar:p("layout-statusbar",60405),layoutMenubar:p("layout-menubar",60406),layoutCentered:p("layout-centered",60407),layoutSidebarRightOff:p("layout-sidebar-right-off",60416),layoutPanelOff:p("layout-panel-off",60417),layoutSidebarLeftOff:p("layout-sidebar-left-off",60418),target:p("target",60408),indent:p("indent",60409),recordSmall:p("record-small",60410),errorSmall:p("error-small",60411),arrowCircleDown:p("arrow-circle-down",60412),arrowCircleLeft:p("arrow-circle-left",60413),arrowCircleRight:p("arrow-circle-right",60414),arrowCircleUp:p("arrow-circle-up",60415),heartFilled:p("heart-filled",60420),map:p("map",60421),mapFilled:p("map-filled",60422),circleSmall:p("circle-small",60423),bellSlash:p("bell-slash",60424),bellSlashDot:p("bell-slash-dot",60425),commentUnresolved:p("comment-unresolved",60426),gitPullRequestGoToChanges:p("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:p("git-pull-request-new-changes",60428),searchFuzzy:p("search-fuzzy",60429),commentDraft:p("comment-draft",60430),send:p("send",60431),sparkle:p("sparkle",60432),insert:p("insert",60433),mic:p("mic",60434),thumbsDownFilled:p("thumbsdown-filled",60435),thumbsUpFilled:p("thumbsup-filled",60436),coffee:p("coffee",60437),snake:p("snake",60438),game:p("game",60439),vr:p("vr",60440),chip:p("chip",60441),piano:p("piano",60442),music:p("music",60443),micFilled:p("mic-filled",60444),gitFetch:p("git-fetch",60445),copilot:p("copilot",60446),lightbulbSparkle:p("lightbulb-sparkle",60447),lightbulbSparkleAutofix:p("lightbulb-sparkle-autofix",60447),robot:p("robot",60448),sparkleFilled:p("sparkle-filled",60449),diffSingle:p("diff-single",60450),diffMultiple:p("diff-multiple",60451),surroundWith:p("surround-with",60452),gitStash:p("git-stash",60454),gitStashApply:p("git-stash-apply",60455),gitStashPop:p("git-stash-pop",60456),runAllCoverage:p("run-all-coverage",60461),runCoverage:p("run-all-coverage",60460),coverage:p("coverage",60462),githubProject:p("github-project",60463),dialogError:p("dialog-error","error"),dialogWarning:p("dialog-warning","warning"),dialogInfo:p("dialog-info","info"),dialogClose:p("dialog-close","close"),treeItemExpanded:p("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:p("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:p("tree-filter-on-type-off","list-selection"),treeFilterClear:p("tree-filter-clear","close"),treeItemLoading:p("tree-item-loading","loading"),menuSelection:p("menu-selection","check"),menuSubmenu:p("menu-submenu","chevron-right"),menuBarMore:p("menubar-more","more"),scrollbarButtonLeft:p("scrollbar-button-left","triangle-left"),scrollbarButtonRight:p("scrollbar-button-right","triangle-right"),scrollbarButtonUp:p("scrollbar-button-up","triangle-up"),scrollbarButtonDown:p("scrollbar-button-down","triangle-down"),toolBarMore:p("toolbar-more","more"),quickInputBack:p("quick-input-back","arrow-left")};var Is;(function(r){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}r.isThemeColor=e})(Is||(Is={}));var Ht;(function(r){r.iconNameSegment="[A-Za-z0-9]+",r.iconNameExpression="[A-Za-z0-9-]+",r.iconModifierExpression="~[A-Za-z]+",r.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${r.iconNameExpression})(${r.iconModifierExpression})?$`);function t(f){const d=e.exec(f.id);if(!d)return t(ne.error);const[,_,w]=d,x=["codicon","codicon-"+_];return w&&x.push("codicon-modifier-"+w.substring(1)),x}r.asClassNameArray=t;function i(f){return t(f).join(" ")}r.asClassName=i;function n(f){return"."+t(f).join(".")}r.asCSSSelector=n;function s(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(typeof f.color>"u"||Is.isThemeColor(f.color))}r.isThemeIcon=s;const o=new RegExp(`^\\$\\((${r.iconNameExpression}(?:${r.iconModifierExpression})?)\\)$`);function a(f){const d=o.exec(f);if(!d)return;const[,_]=d;return{id:_}}r.fromString=a;function c(f){return{id:f}}r.fromId=c;function l(f,d){let _=f.id;const w=_.lastIndexOf("~");return w!==-1&&(_=_.substring(0,w)),d&&(_=`${_}~${d}`),{id:_}}r.modify=l;function u(f){const d=f.id.lastIndexOf("~");if(d!==-1)return f.id.substring(d+1)}r.getModifier=u;function h(f,d){return f.id===d.id&&f.color?.id===d.color?.id}r.isEqual=h})(Ht||(Ht={}));const of=new RegExp(`\\$\\(${Ht.iconNameExpression}(?:${Ht.iconModifierExpression})?\\)`,"g"),HC=new RegExp(`(\\\\)?${of.source}`,"g");function UC(r){return r.replace(HC,(e,t)=>t?e:`\\${e}`)}new RegExp(`\\\\${of.source}`,"g"),new RegExp(`(\\s)?(\\\\)?${of.source}(\\s)?`,"g"),new RegExp(`\\$\\(${Ht.iconNameCharacter}+\\)`,"g");let I_=class{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw be("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=BC(this.supportThemeIcons?UC(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${WC(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(bs(t),"g");return e.replace(i,(n,s)=>e.charAt(s-1)!=="\\"?`\\${n}`:n)}};function Rr(r){return r instanceof I_?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function BC(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function WC(r,e){const t=r.match(/^`+/gm)?.reduce((n,s)=>n.length>s.length?n:s).length??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,r,`${"`".repeat(i)}`].join(`
`)}function VC(r){const e=[],t=r.split("|").map(n=>n.trim());r=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),o=n?n[1]:"",a=s?s[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&e.push(`width="${a}"`),l&&e.push(`height="${o}"`)}return{href:r,dimensions:e}}var Lr={exports:{}};function P_(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function zC(r){Lr.exports.defaults=r}Lr.exports={defaults:P_(),getDefaults:P_,changeDefaults:zC};const qC=/[&<>"']/,jC=/[&<>"']/g,GC=/[<>"']|&(?!#?\w+;)/,QC=/[<>"']|&(?!#?\w+;)/g,KC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},T_=r=>KC[r];function JC(r,e){if(e){if(qC.test(r))return r.replace(jC,T_)}else if(GC.test(r))return r.replace(QC,T_);return r}const XC=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function A_(r){return r.replace(XC,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const YC=/(^|[^\[])\^/g;function ZC(r,e){r=r.source||r,e=e||"";const t={replace:(i,n)=>(n=n.source||n,n=n.replace(YC,"$1"),r=r.replace(i,n),t),getRegex:()=>new RegExp(r,e)};return t}const eS=/[^\w:]/g,tS=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function iS(r,e,t){if(r){let i;try{i=decodeURIComponent(A_(t)).replace(eS,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!tS.test(t)&&(t=oS(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const ml={},nS=/^[^:]+:\/*[^/]*$/,rS=/^([^:]+:)[\s\S]*$/,sS=/^([^:]+:\/*[^/]*)[\s\S]*$/;function oS(r,e){ml[" "+r]||(nS.test(r)?ml[" "+r]=r+"/":ml[" "+r]=R_(r,"/",!0)),r=ml[" "+r];const t=r.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:r.replace(rS,"$1")+e:e.charAt(0)==="/"?t?e:r.replace(sS,"$1")+e:r+e}const aS={exec:function(){}};function cS(r){let e=1,t,i;for(;e<arguments.length;e++){t=arguments[e];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r}function lS(r,e){const t=r.replace(/\|/g,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function R_(r,e,t){const i=r.length;if(i===0)return"";let n=0;for(;n<i;){const s=r.charAt(i-n-1);if(s===e&&!t)n++;else if(s!==e&&t)n++;else break}return r.substr(0,i-n)}function uS(r,e){if(r.indexOf(e[1])===-1)return-1;const t=r.length;let i=0,n=0;for(;n<t;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])i++;else if(r[n]===e[1]&&(i--,i<0))return n;return-1}function dS(r){r&&r.sanitize&&!r.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function hS(r,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=r),e>>=1,r+=r;return t+r}var Ps={escape:JC,unescape:A_,edit:ZC,cleanUrl:iS,noopTest:aS,merge:cS,splitCells:lS,rtrim:R_,findClosingBracket:uS,checkSanitizeDeprecation:dS,repeatString:hS};const{defaults:fS}=Lr.exports,{rtrim:af,splitCells:L_,escape:fi,findClosingBracket:pS}=Ps;function O_(r,e,t,i){const n=e.href,s=e.title?fi(e.title):null,o=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:s,text:o,tokens:i.inlineTokens(o,[])};return i.state.inLink=!1,a}else return{type:"image",raw:t,href:n,title:s,text:fi(o)}}function gS(r,e){const t=r.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[o]=s;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}var $_=class{constructor(e){this.options=e||fS}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:`
`}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:af(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=gS(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=af(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}const n={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,n,s,o,a,c,l,u,h,f,d=t[1].trim();const _=d.length>1,w={type:"list",raw:"",ordered:_,start:_?+d.slice(0,-1):"",loose:!1,items:[]};d=_?`\\d{1,9}\\${d.slice(-1)}`:`\\${d}`,this.options.pedantic&&(d=_?d:"[*+-]");const x=new RegExp(`^( {0,3}${d})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!(this.rules.block.hr.test(e)||!(t=x.exec(e)));){h=t[2].split(`
`),this.options.pedantic?(o=2,f=h[0].trimLeft()):(o=t[2].search(/[^ ]/),o=t[1].length+(o>4?1:o),f=h[0].slice(o-t[1].length)),c=!1,i=t[0],!h[0]&&/^ *$/.test(h[1])&&(i=t[1]+h.slice(0,2).join(`
`)+`
`,w.loose=!0,h=[]);const S=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(a=1;a<h.length;a++){if(u=h[a],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),S.test(u)){i=t[1]+h.slice(0,a).join(`
`)+`
`;break}if(!c){u.trim()||(c=!0),u.search(/[^ ]/)>=o?f+=`
`+u.slice(o):f+=`
`+u;continue}if(u.search(/[^ ]/)>=o||!u.trim()){f+=`
`+u.slice(o);continue}else{i=t[1]+h.slice(0,a).join(`
`)+`
`;break}}w.loose||(l?w.loose=!0:/\n *\n *$/.test(i)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(f),n&&(s=n[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),w.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:f}),w.raw+=i,e=e.slice(i.length)}w.items[w.items.length-1].raw=i.trimRight(),w.items[w.items.length-1].text=f.trimRight(),w.raw=w.raw.trimRight();const k=w.items.length;for(a=0;a<k;a++)this.lexer.state.top=!1,w.items[a].tokens=this.lexer.blockTokens(w.items[a].text,[]),w.items[a].tokens.some(S=>S.type==="space")&&(w.loose=!0,w.items[a].loose=!0);return w}}html(e){const t=this.rules.block.html.exec(e);if(t){const i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):fi(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const i={type:"table",header:L_(t[1]).map(n=>({text:n})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let n=i.align.length,s,o,a,c;for(s=0;s<n;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(n=i.rows.length,s=0;s<n;s++)i.rows[s]=L_(i.rows[s],i.header.length).map(l=>({text:l}));for(n=i.header.length,o=0;o<n;o++)i.header[o].tokens=[],this.lexer.inlineTokens(i.header[o].text,i.header[o].tokens);for(n=i.rows.length,o=0;o<n;o++)for(c=i.rows[o],a=0;a<c.length;a++)c[a].tokens=[],this.lexer.inlineTokens(c[a].text,c[a].tokens);return i}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const i={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(e){const t=this.rules.block.text.exec(e);if(t){const i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:fi(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):fi(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=af(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=pS(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let n=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),O_(t,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let n=(i[2]||i[1]).replace(/\s+/g," ");if(n=t[n.toLowerCase()],!n||!n.href){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return O_(i,n,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=n[1]||n[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){const o=n[0].length-1;let a,c,l=o,u=0;const h=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+o);(n=h.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(c=a.length,n[3]||n[4]){l+=c;continue}else if((n[5]||n[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;if(c=Math.min(c,c+l+u),Math.min(o,c)%2){const d=e.slice(1,o+n.index+c);return{type:"em",raw:e.slice(0,o+n.index+c+1),text:d,tokens:this.lexer.inlineTokens(d,[])}}const f=e.slice(2,o+n.index+c-1);return{type:"strong",raw:e.slice(0,o+n.index+c+1),text:f,tokens:this.lexer.inlineTokens(f,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return n&&s&&(i=i.substring(1,i.length-1)),i=fi(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;return i[2]==="@"?(n=fi(this.options.mangle?t(i[1]):i[1]),s="mailto:"+n):(n=fi(i[1]),s=n),{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@")n=fi(this.options.mangle?t(i[0]):i[0]),s="mailto:"+n;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);n=fi(i[0]),i[1]==="www."?s="http://"+n:s=n}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):fi(i[0]):i[0]:n=fi(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:n}}}};const{noopTest:vl,edit:rt,merge:Or}=Ps,Ce={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:vl,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ce._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,Ce._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Ce.def=rt(Ce.def).replace("label",Ce._label).replace("title",Ce._title).getRegex(),Ce.bullet=/(?:[*+-]|\d{1,9}[.)])/,Ce.listItemStart=rt(/^( *)(bull) */).replace("bull",Ce.bullet).getRegex(),Ce.list=rt(Ce.list).replace(/bull/g,Ce.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ce.def.source+")").getRegex(),Ce._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ce._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Ce.html=rt(Ce.html,"i").replace("comment",Ce._comment).replace("tag",Ce._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ce.paragraph=rt(Ce._paragraph).replace("hr",Ce.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ce._tag).getRegex(),Ce.blockquote=rt(Ce.blockquote).replace("paragraph",Ce.paragraph).getRegex(),Ce.normal=Or({},Ce),Ce.gfm=Or({},Ce.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Ce.gfm.table=rt(Ce.gfm.table).replace("hr",Ce.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ce._tag).getRegex(),Ce.pedantic=Or({},Ce.normal,{html:rt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ce._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:vl,paragraph:rt(Ce.normal._paragraph).replace("hr",Ce.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ce.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const ae={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:vl,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:vl,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};ae._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",ae.punctuation=rt(ae.punctuation).replace(/punctuation/g,ae._punctuation).getRegex(),ae.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,ae.escapedEmSt=/\\\*|\\_/g,ae._comment=rt(Ce._comment).replace("(?:-->|$)","-->").getRegex(),ae.emStrong.lDelim=rt(ae.emStrong.lDelim).replace(/punct/g,ae._punctuation).getRegex(),ae.emStrong.rDelimAst=rt(ae.emStrong.rDelimAst,"g").replace(/punct/g,ae._punctuation).getRegex(),ae.emStrong.rDelimUnd=rt(ae.emStrong.rDelimUnd,"g").replace(/punct/g,ae._punctuation).getRegex(),ae._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,ae._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,ae._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,ae.autolink=rt(ae.autolink).replace("scheme",ae._scheme).replace("email",ae._email).getRegex(),ae._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,ae.tag=rt(ae.tag).replace("comment",ae._comment).replace("attribute",ae._attribute).getRegex(),ae._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ae._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,ae._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,ae.link=rt(ae.link).replace("label",ae._label).replace("href",ae._href).replace("title",ae._title).getRegex(),ae.reflink=rt(ae.reflink).replace("label",ae._label).getRegex(),ae.reflinkSearch=rt(ae.reflinkSearch,"g").replace("reflink",ae.reflink).replace("nolink",ae.nolink).getRegex(),ae.normal=Or({},ae),ae.pedantic=Or({},ae.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:rt(/^!?\[(label)\]\((.*?)\)/).replace("label",ae._label).getRegex(),reflink:rt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ae._label).getRegex()}),ae.gfm=Or({},ae.normal,{escape:rt(ae.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),ae.gfm.url=rt(ae.gfm.url,"i").replace("email",ae.gfm._extended_email).getRegex(),ae.breaks=Or({},ae.gfm,{br:rt(ae.br).replace("{2,}","*").getRegex(),text:rt(ae.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var mS={block:Ce,inline:ae};const vS=$_,{defaults:_S}=Lr.exports,{block:_l,inline:aa}=mS,{repeatString:N_}=Ps;function wS(r){return r.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function F_(r){let e="",t,i;const n=r.length;for(t=0;t<n;t++)i=r.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}var bS=class I1{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||_S,this.options.tokenizer=this.options.tokenizer||new vS,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:_l.normal,inline:aa.normal};this.options.pedantic?(t.block=_l.pedantic,t.inline=aa.pedantic):this.options.gfm&&(t.block=_l.gfm,this.options.breaks?t.inline=aa.breaks:t.inline=aa.gfm),this.tokenizer.rules=t}static get rules(){return{block:_l,inline:aa}}static lex(e,t){return new I1(t).lex(e)}static lexInline(e,t){return new I1(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let i,n,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.type&&t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let l;this.options.extensions.startBlock.forEach(function(u){l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){n=t[t.length-1],o&&n.type==="paragraph"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&n.type==="text"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,n,s,o=e,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+N_("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+N_("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,l)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e,F_)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,F_))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const h=e.slice(1);let f;this.options.extensions.startInline.forEach(function(d){f=d.call({lexer:this},h),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s,wS)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(l=i.raw.slice(-1)),c=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}};const{defaults:yS}=Lr.exports,{cleanUrl:M_,escape:wl}=Ps;var H_=class{constructor(e){this.options=e||yS}code(e,t,i){const n=(t||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,n);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+wl(n,!0)+'">'+(i?e:wl(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:wl(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,i){const n=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+e+"</"+n+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(e=M_(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<a href="'+wl(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n}image(e,t,i){if(e=M_(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">",n}text(e){return e}},U_=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},B_=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do n++,i=e+"-"+n;while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}};const xS=H_,CS=U_,SS=B_,{defaults:ES}=Lr.exports,{unescape:kS}=Ps;var DS=class P1{constructor(e){this.options=e||ES,this.options.renderer=this.options.renderer||new xS,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new CS,this.slugger=new SS}static parse(e,t){return new P1(t).parse(e)}static parseInline(e,t){return new P1(t).parseInline(e)}parse(e,t=!0){let i="",n,s,o,a,c,l,u,h,f,d,_,w,x,k,S,D,U,R,H;const le=e.length;for(n=0;n<le;n++){if(d=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[d.type]&&(H=this.options.extensions.renderers[d.type].call({parser:this},d),H!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type))){i+=H||"";continue}switch(d.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(d.tokens),d.depth,kS(this.parseInline(d.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(d.text,d.lang,d.escaped);continue}case"table":{for(h="",u="",a=d.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(d.header[s].tokens),{header:!0,align:d.align[s]});for(h+=this.renderer.tablerow(u),f="",a=d.rows.length,s=0;s<a;s++){for(l=d.rows[s],u="",c=l.length,o=0;o<c;o++)u+=this.renderer.tablecell(this.parseInline(l[o].tokens),{header:!1,align:d.align[o]});f+=this.renderer.tablerow(u)}i+=this.renderer.table(h,f);continue}case"blockquote":{f=this.parse(d.tokens),i+=this.renderer.blockquote(f);continue}case"list":{for(_=d.ordered,w=d.start,x=d.loose,a=d.items.length,f="",s=0;s<a;s++)S=d.items[s],D=S.checked,U=S.task,k="",S.task&&(R=this.renderer.checkbox(D),x?S.tokens.length>0&&S.tokens[0].type==="paragraph"?(S.tokens[0].text=R+" "+S.tokens[0].text,S.tokens[0].tokens&&S.tokens[0].tokens.length>0&&S.tokens[0].tokens[0].type==="text"&&(S.tokens[0].tokens[0].text=R+" "+S.tokens[0].tokens[0].text)):S.tokens.unshift({type:"text",text:R}):k+=R),k+=this.parse(S.tokens,x),f+=this.renderer.listitem(k,U,D);i+=this.renderer.list(f,_,w);continue}case"html":{i+=this.renderer.html(d.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(d.tokens));continue}case"text":{for(f=d.tokens?this.parseInline(d.tokens):d.text;n+1<le&&e[n+1].type==="text";)d=e[++n],f+=`
`+(d.tokens?this.parseInline(d.tokens):d.text);i+=t?this.renderer.paragraph(f):f;continue}default:{const ie='Token with "'+d.type+'" type was not found.';if(this.options.silent){console.error(ie);return}else throw new Error(ie)}}}return i}parseInline(e,t){t=t||this.renderer;let i="",n,s,o;const a=e.length;for(n=0;n<a;n++){if(s=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=t.text(s.text);break}case"html":{i+=t.html(s.text);break}case"link":{i+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{i+=t.image(s.href,s.title,s.text);break}case"strong":{i+=t.strong(this.parseInline(s.tokens,t));break}case"em":{i+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{i+=t.codespan(s.text);break}case"br":{i+=t.br();break}case"del":{i+=t.del(this.parseInline(s.tokens,t));break}case"text":{i+=t.text(s.text);break}default:{const c='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(c);return}else throw new Error(c)}}}return i}};const ca=bS,la=DS,W_=$_,V_=H_,IS=U_,PS=B_,{merge:bl,checkSanitizeDeprecation:z_,escape:q_}=Ps,{getDefaults:TS,changeDefaults:AS,defaults:RS}=Lr.exports;function Ee(r,e,t){if(typeof r>"u"||r===null)throw new Error("marked(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=bl({},Ee.defaults,e||{}),z_(e),t){const i=e.highlight;let n;try{n=ca.lex(r,e)}catch(a){return t(a)}const s=function(a){let c;if(!a)try{e.walkTokens&&Ee.walkTokens(n,e.walkTokens),c=la.parse(n,e)}catch(l){a=l}return e.highlight=i,a?t(a):t(null,c)};if(!i||i.length<3||(delete e.highlight,!n.length))return s();let o=0;Ee.walkTokens(n,function(a){a.type==="code"&&(o++,setTimeout(()=>{i(a.text,a.lang,function(c,l){if(c)return s(c);l!=null&&l!==a.text&&(a.text=l,a.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{const i=ca.lex(r,e);return e.walkTokens&&Ee.walkTokens(i,e.walkTokens),la.parse(i,e)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+q_(i.message+"",!0)+"</pre>";throw i}}Ee.options=Ee.setOptions=function(r){return bl(Ee.defaults,r),AS(Ee.defaults),Ee},Ee.getDefaults=TS,Ee.defaults=RS,Ee.use=function(...r){const e=bl({},...r),t=Ee.defaults.extensions||{renderers:{},childTokens:{}};let i;r.forEach(n=>{if(n.extensions&&(i=!0,n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...a){let c=s.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),n.renderer){const s=Ee.defaults.renderer||new V_;for(const o in n.renderer){const a=s[o];s[o]=(...c)=>{let l=n.renderer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.renderer=s}if(n.tokenizer){const s=Ee.defaults.tokenizer||new W_;for(const o in n.tokenizer){const a=s[o];s[o]=(...c)=>{let l=n.tokenizer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.tokenizer=s}if(n.walkTokens){const s=Ee.defaults.walkTokens;e.walkTokens=o=>{n.walkTokens.call(this,o),s&&s(o)}}i&&(e.extensions=t),Ee.setOptions(e)})},Ee.walkTokens=function(r,e){for(const t of r)switch(e(t),t.type){case"table":{for(const i of t.header)Ee.walkTokens(i.tokens,e);for(const i of t.rows)for(const n of i)Ee.walkTokens(n.tokens,e);break}case"list":{Ee.walkTokens(t.items,e);break}default:Ee.defaults.extensions&&Ee.defaults.extensions.childTokens&&Ee.defaults.extensions.childTokens[t.type]?Ee.defaults.extensions.childTokens[t.type].forEach(function(i){Ee.walkTokens(t[i],e)}):t.tokens&&Ee.walkTokens(t.tokens,e)}},Ee.parseInline=function(r,e){if(typeof r>"u"||r===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");e=bl({},Ee.defaults,e||{}),z_(e);try{const t=ca.lexInline(r,e);return e.walkTokens&&Ee.walkTokens(t,e.walkTokens),la.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+q_(t.message+"",!0)+"</pre>";throw t}},Ee.Parser=la,Ee.parser=la.parse,Ee.Renderer=V_,Ee.TextRenderer=IS,Ee.Lexer=ca,Ee.lexer=ca.lex,Ee.Tokenizer=W_,Ee.Slugger=PS,Ee.parse=Ee;var j_=Ee;function LS(r){let e=JSON.parse(r);return e=Hi(e),e}function Hi(r,e=0){if(!r||e>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return b.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof he||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let t=0;t<r.length;++t)r[t]=Hi(r[t],e+1);else for(const t in r)Object.hasOwnProperty.call(r,t)&&(r[t]=Hi(r[t],e+1))}return r}const an=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),OS=/^(.+)\/(.+?)(;.+)?$/;function G_(r,e){const t=OS.exec(r);return t?`${t[1].toLowerCase()}/${t[2].toLowerCase()}${t[3]??""}`:e?void 0:r}let pi=class ps{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new ps(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return ps.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return ps.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return ps.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const s=e.column|0,o=t.column|0;return s-o}return i-n}clone(){return new ps(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new ps(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},Be=class gt{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return gt.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return gt.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return gt.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return gt.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return gt.plusRange(this,e)}static plusRange(e,t){let i,n,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new gt(i,n,s,o)}intersectRanges(e){return gt.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,c=t.startColumn,l=t.endLineNumber,u=t.endColumn;return i<a?(i=a,n=c):i===a&&(n=Math.max(n,c)),s>l?(s=l,o=u):s===l&&(o=Math.min(o,u)),i>s||i===s&&n>o?null:new gt(i,n,s,o)}equalsRange(e){return gt.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return gt.getEndPosition(this)}static getEndPosition(e){return new pi(e.endLineNumber,e.endColumn)}getStartPosition(){return gt.getStartPosition(this)}static getStartPosition(e){return new pi(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new gt(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new gt(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return gt.collapseToStart(this)}static collapseToStart(e){return new gt(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return gt.collapseToEnd(this)}static collapseToEnd(e){return new gt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new gt(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new gt(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new gt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,c=t.startColumn|0;if(a===c){const l=e.endLineNumber|0,u=t.endLineNumber|0;if(l===u){const h=e.endColumn|0,f=t.endColumn|0;return h-f}return l-u}return a-c}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};class $S{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Te(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();const i=new NS(this,e,t);return this._factories.set(e,i),Te(()=>{const n=this._factories.get(e);!n||n!==i||(this._factories.delete(e),n.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}class NS extends Me{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}var Q_;(function(r){const e=new Map;e.set(0,ne.symbolMethod),e.set(1,ne.symbolFunction),e.set(2,ne.symbolConstructor),e.set(3,ne.symbolField),e.set(4,ne.symbolVariable),e.set(5,ne.symbolClass),e.set(6,ne.symbolStruct),e.set(7,ne.symbolInterface),e.set(8,ne.symbolModule),e.set(9,ne.symbolProperty),e.set(10,ne.symbolEvent),e.set(11,ne.symbolOperator),e.set(12,ne.symbolUnit),e.set(13,ne.symbolValue),e.set(15,ne.symbolEnum),e.set(14,ne.symbolConstant),e.set(15,ne.symbolEnum),e.set(16,ne.symbolEnumMember),e.set(17,ne.symbolKeyword),e.set(27,ne.symbolSnippet),e.set(18,ne.symbolText),e.set(19,ne.symbolColor),e.set(20,ne.symbolFile),e.set(21,ne.symbolReference),e.set(22,ne.symbolCustomColor),e.set(23,ne.symbolFolder),e.set(24,ne.symbolTypeParameter),e.set(25,ne.account),e.set(26,ne.issues);function t(s){let o=e.get(s);return o||(console.info("No codicon found for CompletionItemKind "+s),o=ne.symbolProperty),o}r.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(s,o){let a=i.get(s);return typeof a>"u"&&!o&&(a=9),a}r.fromString=n})(Q_||(Q_={}));var yl;(function(r){r[r.Automatic=0]="Automatic",r[r.Explicit=1]="Explicit"})(yl||(yl={}));var K_;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(K_||(K_={}));var J_;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(J_||(J_={}));function FS(r){return r&&b.isUri(r.uri)&&Be.isIRange(r.range)&&(Be.isIRange(r.originSelectionRange)||Be.isIRange(r.targetSelectionRange))}g("vs/editor/common/languages","Array","array"),g("vs/editor/common/languages","Boolean","boolean"),g("vs/editor/common/languages","Class","class"),g("vs/editor/common/languages","Constant","constant"),g("vs/editor/common/languages","Constructor","constructor"),g("vs/editor/common/languages","Enum","enumeration"),g("vs/editor/common/languages","EnumMember","enumeration member"),g("vs/editor/common/languages","Event","event"),g("vs/editor/common/languages","Field","field"),g("vs/editor/common/languages","File","file"),g("vs/editor/common/languages","Function","function"),g("vs/editor/common/languages","Interface","interface"),g("vs/editor/common/languages","Key","key"),g("vs/editor/common/languages","Method","method"),g("vs/editor/common/languages","Module","module"),g("vs/editor/common/languages","Namespace","namespace"),g("vs/editor/common/languages","Null","null"),g("vs/editor/common/languages","Number","number"),g("vs/editor/common/languages","Object","object"),g("vs/editor/common/languages","Operator","operator"),g("vs/editor/common/languages","Package","package"),g("vs/editor/common/languages","Property","property"),g("vs/editor/common/languages","String","string"),g("vs/editor/common/languages","Struct","struct"),g("vs/editor/common/languages","TypeParameter","type parameter"),g("vs/editor/common/languages","Variable","variable");var X_;(function(r){const e=new Map;e.set(0,ne.symbolFile),e.set(1,ne.symbolModule),e.set(2,ne.symbolNamespace),e.set(3,ne.symbolPackage),e.set(4,ne.symbolClass),e.set(5,ne.symbolMethod),e.set(6,ne.symbolProperty),e.set(7,ne.symbolField),e.set(8,ne.symbolConstructor),e.set(9,ne.symbolEnum),e.set(10,ne.symbolInterface),e.set(11,ne.symbolFunction),e.set(12,ne.symbolVariable),e.set(13,ne.symbolConstant),e.set(14,ne.symbolString),e.set(15,ne.symbolNumber),e.set(16,ne.symbolBoolean),e.set(17,ne.symbolArray),e.set(18,ne.symbolObject),e.set(19,ne.symbolKey),e.set(20,ne.symbolNull),e.set(21,ne.symbolEnumMember),e.set(22,ne.symbolStruct),e.set(23,ne.symbolEvent),e.set(24,ne.symbolOperator),e.set(25,ne.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=ne.symbolProperty),n}r.toIcon=t})(X_||(X_={}));let Ts=class pr{static{this.Comment=new pr("comment")}static{this.Imports=new pr("imports")}static{this.Region=new pr("region")}static fromValue(e){switch(e){case"comment":return pr.Comment;case"imports":return pr.Imports;case"region":return pr.Region}return new pr(e)}constructor(e){this.value=e}};var cf;(function(r){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}r.is=e})(cf||(cf={}));var As;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(As||(As={}));var ua;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(ua||(ua={}));var Y_;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(Y_||(Y_={}));var Z_;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(Z_||(Z_={})),new $S;var ew;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(ew||(ew={}));var xl;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(xl||(xl={}));var Ut;(function(r){r[r.Hint=1]="Hint",r[r.Info=2]="Info",r[r.Warning=4]="Warning",r[r.Error=8]="Error"})(Ut||(Ut={})),function(r){function e(o,a){return a-o}r.compare=e;const t=Object.create(null);t[r.Error]=g("vs/platform/markers/common/markers","sev.error","Error"),t[r.Warning]=g("vs/platform/markers/common/markers","sev.warning","Warning"),t[r.Info]=g("vs/platform/markers/common/markers","sev.info","Info");function i(o){return t[o]||""}r.toString=i;function n(o){switch(o){case Ye.Error:return r.Error;case Ye.Warning:return r.Warning;case Ye.Info:return r.Info;case Ye.Ignore:return r.Hint}}r.fromSeverity=n;function s(o){switch(o){case r.Error:return Ye.Error;case r.Warning:return Ye.Warning;case r.Info:return Ye.Info;case r.Hint:return Ye.Ignore}}r.toSeverity=s}(Ut||(Ut={}));var tw;(function(r){const e="";function t(n){return i(n,!0)}r.makeKey=t;function i(n,s){const o=[e];return n.source?o.push(n.source.replace("¦","\\¦")):o.push(e),n.code?typeof n.code=="string"?o.push(n.code.replace("¦","\\¦")):o.push(n.code.value.replace("¦","\\¦")):o.push(e),n.severity!==void 0&&n.severity!==null?o.push(Ut.toString(n.severity)):o.push(e),n.message&&s?o.push(n.message.replace("¦","\\¦")):o.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(e),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(e),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(e),o.push(e),o.join("¦")}r.makeKeyOptionalMessage=i})(tw||(tw={})),ee("markerService");function Xt(r,e){if(!r)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function MS(r,e="Unreachable"){throw new Error(e)}class me{static fromExtHostTestItem(e,t,i=e.parent){if(e._isRoot)return new me([t]);const n=[e.id];for(let s=i;s&&s.id!==t;s=s.parent)n.push(s.id);return n.push(t),new me(n.reverse())}static isRoot(e){return!e.includes("\0")}static root(e){const t=e.indexOf("\0");return t===-1?e:e.slice(0,t)}static fromString(e){return new me(e.split("\0"))}static join(e,t){return new me([...e.path,t])}static joinToString(e,t){return e.toString()+"\0"+t}static parentId(e){const t=e.lastIndexOf("\0");return t===-1?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf("\0");return t===-1?e:e.slice(t+1)}static isChild(e,t){return t.startsWith(e)&&t[e.length]==="\0"}static compare(e,t){return e===t?0:me.isChild(e,t)?2:me.isChild(t,e)?3:1}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new me(this.path,1)}get parentId(){return this.viewEnd>1?new me(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new me(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new me(this.path,e)}compare(e){if(typeof e=="string")return me.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return 1;return e.viewEnd>this.viewEnd?2:e.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+="\0",this.stringifed+=this.path[e]}return this.stringifed}}const HS=r=>"runId"in r;var Rs;(function(r){r.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),r.deserialize=(e,t)=>({range:Be.lift(t.range),uri:e.asCanonicalUri(b.revive(t.uri))})})(Rs||(Rs={}));var Cl;(function(r){r.serialize=e=>({message:e.message,type:0,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&Rs.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Rs.deserialize(e,t.location)})})(Cl||(Cl={}));var Sl;(function(r){r.serialize=e=>({message:e.message,type:1,offset:e.offset,length:e.length,location:e.location&&Rs.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Rs.deserialize(e,t.location)})})(Sl||(Sl={}));var El;(function(r){r.serialize=e=>e.type===0?Cl.serialize(e):Sl.serialize(e),r.deserialize=(e,t)=>t.type===0?Cl.deserialize(e,t):Sl.deserialize(e,t)})(El||(El={}));var da;(function(r){r.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),r.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(El.serialize)}),r.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(i=>El.deserialize(e,i))})})(da||(da={}));const iw="\0",kl=(r,e)=>r+iw+e,nw=r=>{const e=r.indexOf(iw);return{ctrlId:r.slice(0,e),tagId:r.slice(e+1)}};var Dl;(function(r){r.serialize=e=>({extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:e.uri?.toJSON(),range:e.range?.toJSON()||null,description:e.description,error:e.error,sortText:e.sortText}),r.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(b.revive(t.uri)):void 0,range:t.range?Be.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(Dl||(Dl={}));var Vn;(function(r){r.serialize=e=>({expand:e.expand,item:Dl.serialize(e.item)}),r.deserialize=(e,t)=>({controllerId:me.root(t.item.extId),expand:t.expand,item:Dl.deserialize(e,t.item)})})(Vn||(Vn={}));var ha;(function(r){r.serialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=e.item.uri?.toJSON()),e.item.range!==void 0&&(t.range=e.item.range?.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},r.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?Be.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(ha||(ha={}));const lf=(r,e)=>{e.expand!==void 0&&(r.expand=e.expand),e.item!==void 0&&(r.item=r.item?Object.assign(r.item,e.item):e.item)};var rw;(function(r){r.serializeWithoutMessages=e=>({...Vn.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(da.serializeWithoutMessages)}),r.serialize=e=>({...Vn.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(da.serialize)}),r.deserialize=(e,t)=>({...Vn.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(i=>da.deserialize(e,i)),retired:!0})})(rw||(rw={}));var sw;(function(r){r.empty=()=>({covered:0,total:0}),r.sum=(e,t)=>{e.covered+=t.covered,e.total+=t.total}})(sw||(sw={}));var ow;(function(r){r.serialize=e=>({statement:e.statement,branch:e.branch,declaration:e.declaration,details:e.details?.map(Il.serialize),uri:e.uri.toJSON()}),r.deserialize=(e,t)=>({statement:t.statement,branch:t.branch,declaration:t.declaration,details:t.details?.map(Il.deserialize),uri:e.asCanonicalUri(b.revive(t.uri))})})(ow||(ow={}));function uf(r){return{...r,location:r.location?.toJSON()}}function df(r){return r.location=r.location?pi.isIPosition(r.location)?pi.lift(r.location):Be.lift(r.location):void 0,r}const US=3;var Il;(function(r){r.serialize=e=>e.type===0?Tl.serialize(e):Al.serialize(e),r.deserialize=e=>e.type===0?Tl.deserialize(e):Al.deserialize(e)})(Il||(Il={}));var Pl;(function(r){r.serialize=uf,r.deserialize=df})(Pl||(Pl={}));var Tl;(function(r){r.serialize=uf,r.deserialize=df})(Tl||(Tl={}));var Al;(function(r){r.serialize=e=>({...uf(e),branches:e.branches?.map(Pl.serialize)}),r.deserialize=e=>({...df(e),branches:e.branches?.map(Pl.deserialize)})})(Al||(Al={}));var Rl;(function(r){r.deserialize=(e,t)=>t.op===0?{op:t.op,item:Vn.deserialize(e,t.item)}:t.op===1?{op:t.op,item:ha.deserialize(t.item)}:t.op===2?{op:t.op,uri:e.asCanonicalUri(b.revive(t.uri)),docv:t.docv}:t,r.serialize=e=>e.op===0?{op:e.op,item:Vn.serialize(e.item)}:e.op===1?{op:e.op,item:ha.serialize(e.item)}:e})(Rl||(Rl={}));class BS{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){const t=this.createChangeCollector();for(const i of e)switch(i.op){case 0:this.add(Vn.deserialize(this.uriIdentity,i.item),t);break;case 1:this.update(ha.deserialize(i.item),t);break;case 3:this.remove(i.itemId,t);break;case 5:this.retireTest(i.itemId);break;case 4:this.updatePendingRoots(i.amount);break;case 6:this._tags.set(i.tag.id,i.tag);break;case 7:this._tags.delete(i.id);break}t.complete?.()}add(e,t){const i=me.parentId(e.item.extId)?.toString();let n;if(!i)n=this.createItem(e),this.roots.add(n),this.items.set(e.item.extId,n);else if(this.items.has(i)){const s=this.items.get(i);s.children.add(e.item.extId),n=this.createItem(e,s),this.items.set(e.item.extId,n)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(n),e.expand===2&&this.busyControllerCount++,n}update(e,t){const i=this.items.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.busyControllerCount--,e.expand===2&&this.busyControllerCount++),lf(i,e),t.update?.(i),i}remove(e,t){const i=this.items.get(e);if(!i)return;const n=me.parentId(i.item.extId)?.toString();n?this.items.get(n).children.delete(i.item.extId):this.roots.delete(i);const s=[[e]];for(;s.length;)for(const o of s.pop()){const a=this.items.get(o);a&&(s.push(a.children),this.items.delete(o),t.remove?.(a,a!==i),a.expand===2&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}const fa=(r,e)=>r===e,WS=Object.entries({range:(r,e)=>r===e?!0:!r||!e?!1:r.equalsRange(e),busy:fa,label:fa,description:fa,error:fa,sortText:fa,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.includes(t)))}),VS=(r,e)=>{let t;for(const[i,n]of WS)n(r[i],e[i])||(t?t[i]=e[i]:t={[i]:e[i]});return t};class zS extends Me{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new Xo(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new P),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.diff)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.diff[this.diff.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){lf(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){lf(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const n=this.resolveChildren(i);return n.isOpen()?this.expandChildren(i,t-1):n.wait().then(()=>this.expandChildren(i,t-1))}else if(i.expand===3)return i.resolveBarrier?.isOpen()===!1?i.resolveBarrier.wait().then(()=>this.expandChildren(i,t-1)):this.expandChildren(i,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case 3:this.removeItem(me.joinToString(e.fullId,t.id));break;case 0:this.upsertItem(t.item,e);break;case 5:for(const i of t.ops)this.onTestItemEvent(e,i);break;case 1:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case 2:this.updateExpandability(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.documentSynced(e.actual.uri);break;default:MS()}}documentSynced(e){e&&this.pushDiff({op:2,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){const i=me.fromExtHostTestItem(e,this.root.id,t?.actual),n=this.options.getApiFor(e);n.parent&&n.parent!==t?.actual&&this.options.getChildren(n.parent).delete(e.id);let s=this.tree.get(i.toString());if(!s){s={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(s.fullId.toString(),s),this.setItemParent(e,t),this.pushDiff({op:0,item:{controllerId:this.options.controllerId,expand:s.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,s,t);return}if(s.actual===e){this.connectItem(e,s,t);return}if(s.actual.uri?.toString()!==e.uri?.toString())return this.removeItem(i.toString()),this.upsertItem(e,t);const o=this.options.getChildren(s.actual),a=s.actual,c=VS(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0,s.actual=e,s.expand=0,c&&(c.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,a.tags,i.toString()),delete c.tags),this.onTestItemEvent(s,{op:4,update:c})),this.connectItemAndChildren(e,s,t);for(const[l,u]of o)this.options.getChildren(e).get(u.id)||this.removeItem(me.joinToString(i,u.id));this.documentSynced(s.actual.uri)}diffTagRefs(e,t,i){const n=new Set(t.map(s=>s.id));for(const s of e)n.delete(s.id)||this.incrementTagRefs(s);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(s=>kl(this.options.controllerId,s.id))}}}),n.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:kl(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:7,id:kl(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const n=this.options.getApiFor(e);n.parent=i?.actual,n.listener=s=>this.onTestItemEvent(t,s),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[n,s]of this.options.getChildren(e))this.upsertItem(s,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[n,s]of this.options.getChildren(e.actual)){const o=this.expand(me.joinToString(e.fullId,s.id),t);Mn(o)&&i.push(o)}if(i.length)return Promise.all(i).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const s=new rn;return s.open(),s}e.expand=2,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new rn,i=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,s)};let n;try{n=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(s){i(s)}return Mn(n)?n.catch(i).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const n=i.pop();if(n){this.options.getApiFor(n.actual).listener=void 0;for(const s of n.actual.tags)this.decrementTagRefs(s.id);this.tree.delete(n.fullId.toString());for(const[s,o]of this.options.getChildren(n.actual))i.push(this.tree.get(me.joinToString(n.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class qS extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class Ll extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class jS extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}}const GS=(r,e,t)=>{let i=new Map;return{get size(){return i.size},forEach(n,s){for(const o of i.values())n.call(s,o,this)},[Symbol.iterator](){return i.entries()},replace(n){const s=new Map,o=new Set(i.keys()),a={op:5,ops:[]};for(const c of n){if(!(c instanceof t))throw new Ll(c.id);const l=e(c).controllerId;if(l!==r.controllerId)throw new jS(c.id,l,r.controllerId);if(s.has(c.id))throw new qS(c.id);s.set(c.id,c),o.delete(c.id),a.ops.push({op:0,item:c})}for(const c of o.keys())a.ops.push({op:3,id:c});r.listener?.(a),i=s},add(n){if(!(n instanceof t))throw new Ll(n.id);i.set(n.id,n),r.listener?.({op:0,item:n})},delete(n){i.delete(n)&&r.listener?.({op:3,id:n})},get(n){return i.get(n)},toJSON(){return Array.from(i.values())}}},aw=new WeakMap,QS=(r,e)=>{const t={controllerId:e};return aw.set(r,t),t},Ol=r=>{const e=aw.get(r);if(!e)throw new Ll(r?.id||"<unknown>");return e};class KS{constructor(){this.data=new Map}add(e,t){Xt(Le(e)),Xt(It(t)),Xt(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}}const ri=new KS;ee("fileService");var $r;(function(r){r[r.Unknown=0]="Unknown",r[r.File=1]="File",r[r.Directory=2]="Directory",r[r.SymbolicLink=64]="SymbolicLink"})($r||($r={}));var Ls;(function(r){r[r.Readonly=1]="Readonly",r[r.Locked=2]="Locked"})(Ls||(Ls={}));var cw;(function(r){r[r.None=0]="None",r[r.FileReadWrite=2]="FileReadWrite",r[r.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",r[r.FileReadStream=16]="FileReadStream",r[r.FileFolderCopy=8]="FileFolderCopy",r[r.PathCaseSensitive=1024]="PathCaseSensitive",r[r.Readonly=2048]="Readonly",r[r.Trash=4096]="Trash",r[r.FileWriteUnlock=8192]="FileWriteUnlock",r[r.FileAtomicRead=16384]="FileAtomicRead",r[r.FileAtomicWrite=32768]="FileAtomicWrite",r[r.FileAtomicDelete=65536]="FileAtomicDelete",r[r.FileClone=131072]="FileClone"})(cw||(cw={}));var ye;(function(r){r.FileExists="EntryExists",r.FileNotFound="EntryNotFound",r.FileNotADirectory="EntryNotADirectory",r.FileIsADirectory="EntryIsADirectory",r.FileExceedsStorageQuota="EntryExceedsStorageQuota",r.FileTooLarge="EntryTooLarge",r.FileWriteLocked="EntryWriteLocked",r.NoPermissions="NoPermissions",r.Unavailable="Unavailable",r.Unknown="Unknown"})(ye||(ye={}));class $l extends Error{static create(e,t){const i=new $l(e.toString(),t);return lw(i,t),i}constructor(e,t){super(e),this.code=t}}function lw(r,e){return r.name=e?`${e} (FileSystemError)`:"FileSystemError",r}function hf(r){if(!r)return ye.Unknown;if(r instanceof $l)return r.code;const e=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!e)return ye.Unknown;switch(e[1]){case ye.FileExists:return ye.FileExists;case ye.FileIsADirectory:return ye.FileIsADirectory;case ye.FileNotADirectory:return ye.FileNotADirectory;case ye.FileNotFound:return ye.FileNotFound;case ye.FileTooLarge:return ye.FileTooLarge;case ye.FileWriteLocked:return ye.FileWriteLocked;case ye.NoPermissions:return ye.NoPermissions;case ye.Unavailable:return ye.Unavailable}return ye.Unknown}var uw;(function(r){r[r.UPDATED=0]="UPDATED",r[r.ADDED=1]="ADDED",r[r.DELETED=2]="DELETED"})(uw||(uw={}));class Nl{static{this.MIXED_CORRELATION=null}constructor(e,t){this.ignorePathCasing=t,this.correlationId=void 0,this.added=new ui(()=>{const i=hi.forUris(()=>this.ignorePathCasing);return i.fill(this.rawAdded.map(n=>[n,!0])),i}),this.updated=new ui(()=>{const i=hi.forUris(()=>this.ignorePathCasing);return i.fill(this.rawUpdated.map(n=>[n,!0])),i}),this.deleted=new ui(()=>{const i=hi.forUris(()=>this.ignorePathCasing);return i.fill(this.rawDeleted.map(n=>[n,!0])),i}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const i of e){switch(i.type){case 1:this.rawAdded.push(i.resource);break;case 0:this.rawUpdated.push(i.resource);break;case 2:this.rawDeleted.push(i.resource);break}this.correlationId!==Nl.MIXED_CORRELATION&&(typeof i.cId=="number"?this.correlationId===void 0?this.correlationId=i.cId:this.correlationId!==i.cId&&(this.correlationId=Nl.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=Nl.MIXED_CORRELATION))}}contains(e,...t){return this.doContains(e,{includeChildren:!1},...t)}affects(e,...t){return this.doContains(e,{includeChildren:!0},...t)}doContains(e,t,...i){if(!e)return!1;const n=i.length>0;return!!((!n||i.includes(1))&&(this.added.value.get(e)||t.includeChildren&&this.added.value.findSuperstr(e))||(!n||i.includes(0))&&(this.updated.value.get(e)||t.includeChildren&&this.updated.value.findSuperstr(e))||(!n||i.includes(2))&&(this.deleted.value.findSubstr(e)||t.includeChildren&&this.deleted.value.findSuperstr(e)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(e){return this.correlationId===e}hasCorrelation(){return typeof this.correlationId=="number"}}class dw extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}}var hw;(function(r){r[r.FILE=0]="FILE",r[r.FOLDER=1]="FOLDER",r[r.ROOT_FOLDER=2]="ROOT_FOLDER"})(hw||(hw={}));const JS="";function fw(r){if(!(typeof r.size!="number"||typeof r.mtime!="number"))return r.mtime.toString(29)+r.size.toString(31)}class Bt{static{this.KB=1024}static{this.MB=Bt.KB*Bt.KB}static{this.GB=Bt.MB*Bt.KB}static{this.TB=Bt.GB*Bt.KB}static formatSize(e){return Nn(e)||(e=0),e<Bt.KB?g("vs/platform/files/common/files","sizeB","{0}B",e.toFixed(0)):e<Bt.MB?g("vs/platform/files/common/files","sizeKB","{0}KB",(e/Bt.KB).toFixed(2)):e<Bt.GB?g("vs/platform/files/common/files","sizeMB","{0}MB",(e/Bt.MB).toFixed(2)):e<Bt.TB?g("vs/platform/files/common/files","sizeGB","{0}GB",(e/Bt.GB).toFixed(2)):g("vs/platform/files/common/files","sizeTB","{0}TB",(e/Bt.TB).toFixed(2))}}class XS extends Me{constructor(e,t="",i="",n=!0,s){super(),this._onDidChange=this._register(new P),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class pw extends XS{static{this.ID="vs.actions.empty"}constructor(){super(pw.ID,g("vs/base/common/actions","submenu.empty","(empty)"),void 0,!1)}}const YS={EditorFactory:"workbench.contributions.editor.inputFactories"},ZS={id:"default",displayName:g("vs/workbench/common/editor","promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:g("vs/workbench/common/editor","builtinProviderDisplayName","Built-in")};var gw;(function(r){r[r.None=0]="None",r[r.Readonly=2]="Readonly",r[r.Untitled=4]="Untitled",r[r.Singleton=8]="Singleton",r[r.RequiresTrust=16]="RequiresTrust",r[r.CanSplitInGroup=32]="CanSplitInGroup",r[r.ForceDescription=64]="ForceDescription",r[r.CanDropIntoEditor=128]="CanDropIntoEditor",r[r.MultipleEditors=256]="MultipleEditors",r[r.Scratchpad=512]="Scratchpad",r[r.AuxWindowUnsupported=1024]="AuxWindowUnsupported"})(gw||(gw={}));var mw;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.REPLACE=1]="REPLACE",r[r.MOVE=2]="MOVE",r[r.UNPIN=3]="UNPIN"})(mw||(mw={}));var vw;(function(r){r[r.PRIMARY=1]="PRIMARY",r[r.SECONDARY=2]="SECONDARY",r[r.BOTH=3]="BOTH",r[r.ANY=4]="ANY"})(vw||(vw={}));var _w;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.KEYBOARD=1]="KEYBOARD",r[r.MOUSE=2]="MOUSE"})(_w||(_w={}));var ww;(function(r){r[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT"})(ww||(ww={}));class e4{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(ol);for(const[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){const n=i.createInstance(t);this.editorSerializerInstances.set(e,n)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return xs(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),Te(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}}ri.add(YS.EditorFactory,new e4);var bw;(function(r){r[r.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",r[r.SEQUENTIAL=1]="SEQUENTIAL"})(bw||(bw={}));const pa="**",ff="/",Fl="[/\\\\]",Ml="[^/\\\\]",t4=/\//g;function yw(r,e){switch(r){case 0:return"";case 1:return`${Ml}*?`;default:return`(?:${Fl}|${Ml}+${Fl}${e?`|${Fl}${Ml}+`:""})*?`}}function pf(r,e){if(!r)return[];const t=[];let i=!1,n=!1,s="";for(const o of r){switch(o){case e:if(!i&&!n){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=o}return s&&t.push(s),t}function xw(r){if(!r)return"";let e="";const t=pf(r,ff);if(t.every(i=>i===pa))e=".*";else{let i=!1;t.forEach((n,s)=>{if(n===pa){if(i)return;e+=yw(2,s===t.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let h;u==="-"?h=u:(u==="^"||u==="!")&&!l?h="^":u===ff?h="":h=bs(u),l+=h;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const f=`(?:${pf(a,",").map(d=>xw(d)).join("|")})`;e+=f,o=!1,a="";break}case"]":{e+="["+l+"]",c=!1,l="";break}case"?":e+=Ml;continue;case"*":e+=yw(1);continue;default:e+=bs(u)}}s<t.length-1&&(t[s+1]!==pa||s+2<t.length)&&(e+=Fl)}i=n===pa})}return e}const i4=/^\*\*\/\*\.[\w\.-]+$/,n4=/^\*\*\/([\w\.-]+)\/?$/,r4=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,s4=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,o4=/^\*\*((\/[\w\.-]+)+)\/?$/,a4=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Cw=new W1(1e4),Sw=function(){return!1},Ui=function(){return null};function gf(r,e){if(!r)return Ui;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=Cw.get(i);if(n)return Ew(n,r);let s;return i4.test(t)?n=c4(t.substr(4),t):(s=n4.exec(mf(t,e)))?n=l4(s[1],t):(e.trimForExclusions?s4:r4).test(t)?n=u4(t,e):(s=o4.exec(mf(t,e)))?n=kw(s[1].substr(1),t,!0):(s=a4.exec(mf(t,e)))?n=kw(s[1],t,!1):n=d4(t),Cw.set(i,n),Ew(n,r)}function Ew(r,e){if(typeof e=="string")return r;const t=function(i,n){return rl(i,e.base,!An)?r(Q2(i.substr(e.base.length),bi),n):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function mf(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function c4(r,e){return function(t,i){return typeof t=="string"&&t.endsWith(r)?e:null}}function l4(r,e){const t=`/${r}`,i=`\\${r}`,n=function(o,a){return typeof o!="string"?null:a?a===r?e:null:o===r||o.endsWith(t)||o.endsWith(i)?e:null},s=[r];return n.basenames=s,n.patterns=[e],n.allBasenames=s,n}function u4(r,e){const t=Dw(r.slice(1,-1).split(",").map(a=>gf(a,e)).filter(a=>a!==Ui),r),i=t.length;if(!i)return Ui;if(i===1)return t[0];const n=function(a,c){for(let l=0,u=t.length;l<u;l++)if(t[l](a,c))return r;return null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function kw(r,e,t){const i=bi===$e.sep,n=i?r:r.replace(t4,bi),s=bi+n,o=$e.sep+r;let a;return t?a=function(c,l){return typeof c=="string"&&(c===n||c.endsWith(s)||!i&&(c===r||c.endsWith(o)))?e:null}:a=function(c,l){return typeof c=="string"&&(c===n||!i&&c===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function d4(r){try{const e=new RegExp(`^${xw(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return Ui}}function ga(r,e,t){return!r||typeof e!="string"?!1:Os(r)(e,void 0,t)}function Os(r,e={}){if(!r)return Sw;if(typeof r=="string"||h4(r)){const t=gf(r,e);if(t===Ui)return Sw;const i=function(n,s){return!!t(n,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return f4(r,e)}function h4(r){const e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function f4(r,e){const t=Dw(Object.getOwnPropertyNames(r).map(a=>p4(a,r[a],e)).filter(a=>a!==Ui)),i=t.length;if(!i)return Ui;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,h){let f;for(let d=0,_=t.length;d<_;d++){const w=t[d](u,h);if(typeof w=="string")return w;Mn(w)&&(f||(f=[]),f.push(w))}return f?(async()=>{for(const d of f){const _=await d;if(typeof _=="string")return _}return null})():null},c=t.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=t.reduce((u,h)=>h.allPaths?u.concat(h.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const n=function(a,c,l){let u,h;for(let f=0,d=t.length;f<d;f++){const _=t[f];_.requiresSiblings&&l&&(c||(c=Kt(a)),u||(u=c.substr(0,c.length-Eh(a).length)));const w=_(a,c,u,l);if(typeof w=="string")return w;Mn(w)&&(h||(h=[]),h.push(w))}return h?(async()=>{for(const f of h){const d=await f;if(typeof d=="string")return d}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function p4(r,e,t){if(e===!1)return Ui;const i=gf(r,t);if(i===Ui)return Ui;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const s=(o,a,c,l)=>{if(!l||!i(o,a))return null;const u=n.replace("$(basename)",()=>c),h=l(u);return Mn(h)?h.then(f=>f?r:null):h?r:null};return s.requiresSiblings=!0,s}}return i}function Dw(r,e){const t=r.filter(a=>!!a.basenames);if(t.length<2)return r;const i=t.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let n;if(e){n=[];for(let a=0,c=i.length;a<c;a++)n.push(e)}else n=t.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const s=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const h=a.charCodeAt(u-1);if(h===47||h===92)break}c=a.substr(u)}const l=i.indexOf(c);return l!==-1?n[l]:null};s.basenames=i,s.patterns=n,s.allBasenames=i;const o=r.filter(a=>!a.basenames);return o.push(s),o}ee("notebookDocumentService");const vf=["W","X","Y","Z","a","b","c","d","e","f"],g4=new RegExp(`^[${vf.join("")}]+`),Iw=7;function m4(r){if(r.scheme!==K.vscodeNotebookCell)return;const e=r.fragment.indexOf("s");if(e<0)return;const t=parseInt(r.fragment.substring(0,e).replace(g4,""),Iw),i=i2(r.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:r.with({scheme:i,fragment:null})}}function v4(r,e){const t=e.toString(Iw),n=`${t.length<vf.length?vf[t.length-1]:"z"}${t}s${G1(he.fromString(r.scheme),!0,!0)}`;return r.with({scheme:K.vscodeNotebookCell,fragment:n})}var $s;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})($s||($s={})),an.latex,an.markdown,an.text,an.latex,an.markdown,an.text;var ma;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(ma||(ma={}));var Pw;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(Pw||(Pw={}));var Ei;(function(r){r[r.ModelChange=1]="ModelChange",r[r.Move=2]="Move",r[r.ChangeCellLanguage=5]="ChangeCellLanguage",r[r.Initialize=6]="Initialize",r[r.ChangeCellMetadata=7]="ChangeCellMetadata",r[r.Output=8]="Output",r[r.OutputItem=9]="OutputItem",r[r.ChangeCellContent=10]="ChangeCellContent",r[r.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",r[r.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",r[r.ChangeCellMime=13]="ChangeCellMime",r[r.Unknown=100]="Unknown"})(Ei||(Ei={}));var Tw;(function(r){r[r.Handle=0]="Handle",r[r.Index=1]="Index"})(Tw||(Tw={}));var Aw;(function(r){r.scheme=K.vscodeNotebookCell;function e(a,c){return v4(a,c)}r.generate=e;function t(a){return m4(a)}r.parse=t;function i(a,c){return a.with({scheme:K.vscodeNotebookCellOutput,fragment:`op${c??""},${a.scheme!==K.file?a.scheme:""}`})}r.generateCellOutputUri=i;function n(a){if(a.scheme!==K.vscodeNotebookCellOutput)return;const c=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(a.fragment);if(!c)return;const l=c[1]&&c[1]!==""?c[1]:void 0,u=c[2];return{outputId:l,notebook:a.with({scheme:u||K.file,fragment:null})}}r.parseCellOutputUri=n;function s(a,c,l){return r.generate(a,c).with({scheme:l})}r.generateCellPropertyUri=s;function o(a,c){if(a.scheme===c)return r.parse(a.with({scheme:r.scheme}))}r.parseCellPropertyUri=o})(Aw||(Aw={})),new X("notebookEditorCursorAtBoundary","none"),new X("notebookEditorCursorAtLineBoundary","none");var Rw;(function(r){r.default="default",r.option="option"})(Rw||(Rw={}));class Hl{static{this._prefix="notebook/"}static create(e){return`${Hl._prefix}${e}`}static parse(e){if(e.startsWith(Hl._prefix))return e.substring(Hl._prefix.length)}}function Lw(r){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(r)}const _4=new TextDecoder;function w4(r){const e=[];let t=!1;for(const o of r)(e.length===0||t)&&(e.push(o),t=!0);let i=y4(e);const n=he.concat(e.map(o=>he.wrap(o))),s=k4(n);return i=i||s.byteLength!==n.byteLength,{data:s,didCompression:i}}const Ul="\x1B[A",_f=Ul.split("").map(r=>r.charCodeAt(0)),b4=10;function y4(r){let e=!1;return r.forEach((t,i)=>{if(i===0||t.length<Ul.length)return;const n=r[i-1],s=t.subarray(0,Ul.length);if(s[0]===_f[0]&&s[1]===_f[1]&&s[2]===_f[2]){const o=n.lastIndexOf(b4);if(o===-1)return;e=!0,r[i-1]=n.subarray(0,o),r[i]=t.subarray(Ul.length)}}),e}function x4(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function C4(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){const e=r.match(/^(.*)\r+/m)[1];let t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}const S4=8,E4=13;function k4(r){return!r.buffer.includes(S4)&&!r.buffer.includes(E4)?r:he.fromString(C4(x4(_4.decode(r.buffer))))}const D4=ee("editorGroupsService");var Ow;(function(r){r[r.UP=0]="UP",r[r.DOWN=1]="DOWN",r[r.LEFT=2]="LEFT",r[r.RIGHT=3]="RIGHT"})(Ow||(Ow={}));var $w;(function(r){r[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL"})($w||($w={}));var Nw;(function(r){r[r.FIRST=0]="FIRST",r[r.LAST=1]="LAST",r[r.NEXT=2]="NEXT",r[r.PREVIOUS=3]="PREVIOUS"})(Nw||(Nw={}));var Fw;(function(r){r[r.MAXIMIZE=0]="MAXIMIZE",r[r.EXPAND=1]="EXPAND",r[r.EVEN=2]="EVEN"})(Fw||(Fw={}));var Mw;(function(r){r[r.COPY_EDITORS=0]="COPY_EDITORS",r[r.MOVE_EDITORS=1]="MOVE_EDITORS"})(Mw||(Mw={}));var Hw;(function(r){r[r.CREATION_TIME=0]="CREATION_TIME",r[r.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",r[r.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(Hw||(Hw={})),ee("editorService");const I4=-1,P4=-2;ee("extensionGalleryService");var Uw;(function(r){r.Unsupported="Unsupported",r.Deprecated="Deprecated",r.Malicious="Malicious",r.Incompatible="Incompatible",r.IncompatibleTargetPlatform="IncompatibleTargetPlatform",r.ReleaseVersionNotFound="ReleaseVersionNotFound",r.Invalid="Invalid",r.Download="Download",r.DownloadSignature="DownloadSignature",r.UpdateMetadata="UpdateMetadata",r.Extract="Extract",r.Scanning="Scanning",r.Delete="Delete",r.Rename="Rename",r.CorruptZip="CorruptZip",r.IncompleteZip="IncompleteZip",r.Signature="Signature",r.NotAllowed="NotAllowed",r.Gallery="Gallery",r.Unknown="Unknown",r.Internal="Internal"})(Uw||(Uw={}));var Bw;(function(r){r.Timeout="Timeout",r.Cancelled="Cancelled",r.Failed="Failed"})(Bw||(Bw={})),ee("extensionManagementService"),ee("IGlobalExtensionEnablementService"),ee("IExtensionTipsService"),J1("vs/platform/extensionManagement/common/extensionManagement","extensions","Extensions"),J1("vs/platform/extensionManagement/common/extensionManagement","preferences","Preferences");function wf(r){if(!r)return;const e=r.indexOf("+");return e<0?r:r.substr(0,e)}class Qe{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,n=typeof t=="string"?t:t.value;return Er(i,n)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class Ns{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Qe.toKey(e))}delete(e){return this._set.delete(Qe.toKey(e))}has(e){return this._set.has(Qe.toKey(e))}}class zn{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Qe.toKey(e))}get(e){return this._map.get(Qe.toKey(e))}has(e){return this._map.has(Qe.toKey(e))}set(e,t){this._map.set(Qe.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}ee("IBuiltinExtensionsScannerService"),ee("telemetryService"),ee("customEndpointTelemetryService");class bf{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}}const T4="extensionTelemetryLog",A4=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function R4(r){if(!r)return"none";const e=wf(r);return A4.has(e)?e:"other"}function L4(r,e){if(!r||!r.includes("/")&&!r.includes("\\"))return r;let t=r;const i=[];for(const a of e)for(;;){const c=a.exec(r);if(!c)break;i.push([c.index,a.lastIndex])}const n=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(t="";;){const a=s.exec(r);if(!a)break;const c=i.some(([l,u])=>a.index<u&&l<s.lastIndex);!n.test(a[0])&&!c&&(t+=r.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<r.length&&(t+=r.substr(o)),t}function O4(r){if(!r)return r;const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"Email",regex:/@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/}];for(const t of e)if(t.regex.test(r))return`<REDACTED: ${t.label}>`;return r}function Ww(r,e){return pl(r,t=>{if(t instanceof bf||Object.hasOwnProperty.call(t,"isTrustedTelemetryValue"))return t.value;if(typeof t=="string"){let i=t.replaceAll("%20"," ");i=L4(i,e);for(const n of e)i=i.replace(n,"");return i=O4(i),i}})}new Qe("pprice.better-merge");const $4=Object.freeze({identifier:new Qe("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:b.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});ee("extensionService");class Vw{constructor(e){this.dependency=e}}function Ct(r,e){return r.enabledApiProposals?r.enabledApiProposals.includes(e):!1}function N(r,e){if(!Ct(r,e))throw new Error(`Extension '${r.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${r.enabledApiProposals?.join(", ")??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${r.identifier.value}`)}ee("remoteAuthorityResolverService");class N4{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}}class F4{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}}var cn;(function(r){r.Unknown="Unknown",r.NotAvailable="NotAvailable",r.TemporarilyNotAvailable="TemporarilyNotAvailable",r.NoResolverFound="NoResolverFound",r.InvalidAuthority="InvalidAuthority"})(cn||(cn={}));function zw(r){const e=r.indexOf("+");return e===-1?r:r.substring(0,e)}var yf,Nr,ln,xf,Fr,qn,Mr,Cf,Sf,Bl,va,Ef,Bi,Wi,kf,Wt,Df;function Y(r){return Object.assign(r,{apply:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const i=t.length===1?[]:t[1];return Reflect.construct(r,i,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const[i,...n]=t;return Reflect.construct(r,n,i.constructor)}}})}var If;(function(r){r[r.Top=0]="Top",r[r.Bottom=1]="Bottom"})(If||(If={}));let ke=yf=class{static from(...e){let t=e;return new yf(function(){if(t){for(const i of t)i&&typeof i.dispose=="function"&&i.dispose();t=void 0}})}#e;constructor(e){this.#e=e}dispose(){typeof this.#e=="function"&&(this.#e(),this.#e=void 0)}};ke=yf=F([Y],ke);let xe=Nr=class{static Min(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isBefore(t)&&(t=n)}return t}static Max(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isAfter(t)&&(t=n)}return t}static isPosition(e){if(!e)return!1;if(e instanceof Nr)return!0;const{line:t,character:i}=e;return typeof t=="number"&&typeof i=="number"}static of(e){if(e instanceof Nr)return e;if(this.isPosition(e))return new Nr(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw be("line must be non-negative");if(t<0)throw be("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw be();let i;return typeof e>"u"?i=0:typeof e=="number"?i=e:(i=typeof e.lineDelta=="number"?e.lineDelta:0,t=typeof e.characterDelta=="number"?e.characterDelta:0),i===0&&t===0?this:new Nr(this.line+i,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw be();let i;return typeof e>"u"?i=this.line:typeof e=="number"?i=e:(i=typeof e.line=="number"?e.line:this.line,t=typeof e.character=="number"?e.character:this.character),i===this.line&&t===this.character?this:new Nr(i,t)}toJSON(){return{line:this.line,character:this.character}}};xe=Nr=F([Y],xe);let ve=ln=class{static isRange(e){return e instanceof ln?!0:e?xe.isPosition(e.start)&&xe.isPosition(e.end):!1}static of(e){if(e instanceof ln)return e;if(this.isRange(e))return new ln(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new xe(e,t),o=new xe(i,n)):xe.isPosition(e)&&xe.isPosition(t)&&(s=xe.of(e),o=xe.of(t)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(e){return ln.isRange(e)?this.contains(e.start)&&this.contains(e.end):xe.isPosition(e)?!(xe.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=xe.Max(e.start,this._start),i=xe.Min(e.end,this._end);if(!t.isAfter(i))return new ln(t,i)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=xe.Min(e.start,this._start),i=xe.Max(e.end,this.end);return new ln(t,i)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw be();let i;return e?xe.isPosition(e)?i=e:(i=e.start||this.start,t=e.end||this.end):i=this.start,i.isEqual(this._start)&&t.isEqual(this.end)?this:new ln(i,t)}toJSON(){return[this.start,this.end]}};ve=ln=F([Y],ve);let un=xf=class extends ve{static isSelection(e){return e instanceof xf?!0:e?ve.isRange(e)&&xe.isPosition(e.anchor)&&xe.isPosition(e.active)&&typeof e.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new xe(e,t),o=new xe(i,n)):xe.isPosition(e)&&xe.isPosition(t)&&(s=xe.of(e),o=xe.of(t)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}};un=xf=F([Y],un);const qw=r=>{if(typeof r!="string"||r.length===0||!/^[0-9A-Za-z_\-]+$/.test(r))throw be("connectionToken")};class M4{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw be("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw be("port");typeof i<"u"&&qw(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}}class Wl{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&qw(t)}}class Vi extends Error{static NotAvailable(e,t){return new Vi(e,cn.NotAvailable,t)}static TemporarilyNotAvailable(e){return new Vi(e,cn.TemporarilyNotAvailable)}constructor(e,t=cn.Unknown,i){super(e),this._message=e,this._code=t,this._detail=i,Object.setPrototypeOf(this,Vi.prototype)}}var ki;(function(r){r[r.LF=1]="LF",r[r.CRLF=2]="CRLF"})(ki||(ki={}));var Fs;(function(r){r[r.Replace=1]="Replace",r[r.Append=2]="Append",r[r.Prepend=3]="Prepend"})(Fs||(Fs={}));let jn=Fr=class{static isTextEdit(e){return e instanceof Fr?!0:e?ve.isRange(e)&&typeof e.newText=="string":!1}static replace(e,t){return new Fr(e,t)}static insert(e,t){return Fr.replace(new ve(e,e),t)}static delete(e){return Fr.replace(e,"")}static setEndOfLine(e){const t=new Fr(new ve(new xe(0,0),new xe(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!ve.isRange(e))throw be("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw be("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw be("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};jn=Fr=F([Y],jn);let Vl=qn=class{static isNotebookCellEdit(e){return e instanceof qn?!0:e?hn.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new qn(e,t)}static insertCells(e,t){return new qn(new hn(e,e),t)}static deleteCells(e){return new qn(e,[])}static updateCellMetadata(e,t){const i=new qn(new hn(e,e),[]);return i.newCellMetadata=t,i}static updateNotebookMetadata(e){const t=new qn(new hn(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};Vl=qn=F([Y],Vl);class Hr{static isSnippetTextEdit(e){return e instanceof Hr?!0:e?ve.isRange(e.range)&&Ur.isSnippetString(e.snippet):!1}static replace(e,t){return new Hr(e,t)}static insert(e,t){return Hr.replace(new ve(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}let Gn=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,i,n){this._edits.push({_type:1,from:e,to:t,options:i,metadata:n})}createFile(e,t,i){this._edits.push({_type:1,from:void 0,to:e,options:t,metadata:i})}deleteFile(e,t,i){this._edits.push({_type:1,from:e,to:void 0,options:t,metadata:i})}replaceNotebookMetadata(e,t,i){this._edits.push({_type:3,metadata:i,uri:e,edit:{editType:5,metadata:t},notebookMetadata:t})}replaceNotebookCells(e,t,i,n){const s=t.start,o=t.end;(s!==o||i.length>0)&&this._edits.push({_type:5,uri:e,index:s,count:o-s,cells:i,metadata:n})}replaceNotebookCellMetadata(e,t,i,n){this._edits.push({_type:3,metadata:n,uri:e,edit:{editType:3,index:t,metadata:i}})}replace(e,t,i,n){this._edits.push({_type:2,uri:e,edit:new jn(t,i),metadata:n})}insert(e,t,i,n){this.replace(e,new ve(t,t),i,n)}delete(e,t,i){this.replace(e,t,"",i)}has(e){return this._edits.some(t=>t._type===2&&t.uri.toString()===e.toString())}set(e,t){if(t)for(const i of t){if(!i)continue;let n,s;Array.isArray(i)?(n=i[0],s=i[1]):n=i,Vl.isNotebookCellEdit(n)?n.newCellMetadata?this.replaceNotebookCellMetadata(e,n.range.start,n.newCellMetadata,s):n.newNotebookMetadata?this.replaceNotebookMetadata(e,n.newNotebookMetadata,s):this.replaceNotebookCells(e,n.range,n.newCells,s):Hr.isSnippetTextEdit(n)?this._edits.push({_type:6,uri:e,range:n.range,edit:n.snippet,metadata:s}):this._edits.push({_type:2,uri:e,edit:n,metadata:s})}else{for(let i=0;i<this._edits.length;i++){const n=this._edits[i];switch(n._type){case 2:case 6:case 3:case 5:n.uri.toString()===e.toString()&&(this._edits[i]=void 0);break}}Uy(this._edits)}}get(e){const t=[];for(const i of this._edits)i._type===2&&i.uri.toString()===e.toString()&&t.push(i.edit);return t}entries(){const e=new it;for(const t of this._edits)if(t._type===2){let i=e.get(t.uri);i||(i=[t.uri,[]],e.set(t.uri,i)),i[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};Gn=F([Y],Gn);let Ur=Mr=class{static isSnippetString(e){return e instanceof Mr?!0:e?typeof e.value=="string":!1}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=Mr._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e=="function"){const i=new Mr;i._tabstop=this._tabstop,e(i),this._tabstop=i._tabstop,e=i.value}else e=Mr._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const i=e.map(n=>n.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=i,this.value+="|}",this}appendVariable(e,t){if(typeof t=="function"){const i=new Mr;i._tabstop=this._tabstop,t(i),this._tabstop=i._tabstop,t=i.value}else typeof t=="string"&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};Ur=Mr=F([Y],Ur);var Br;(function(r){r[r.Unnecessary=1]="Unnecessary",r[r.Deprecated=2]="Deprecated"})(Br||(Br={}));var Et;(function(r){r[r.Hint=3]="Hint",r[r.Information=2]="Information",r[r.Warning=1]="Warning",r[r.Error=0]="Error"})(Et||(Et={}));let si=Cf=class{static isLocation(e){return e instanceof Cf?!0:e?ve.isRange(e.range)&&b.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(ve.isRange(t))this.range=ve.of(t);else if(xe.isPosition(t))this.range=new ve(t,t);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};si=Cf=F([Y],si);let _a=class{static is(e){return e?typeof e.message=="string"&&e.location&&ve.isRange(e.location.range)&&b.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};_a=F([Y],_a);let zl=class{constructor(e,t,i=Et.Error){if(!ve.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=i}toJSON(){return{severity:Et[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&Tn(e.tags,t.tags)&&Tn(e.relatedInformation,t.relatedInformation,_a.isEqual)}};zl=F([Y],zl);let ql=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};ql=F([Y],ql);var wa;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(wa||(wa={}));let jl=class{constructor(e,t=wa.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:wa[this.kind]}}};jl=F([Y],jl);let Gl=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};Gl=F([Y],Gl);var Ve;(function(r){r[r.File=0]="File",r[r.Module=1]="Module",r[r.Namespace=2]="Namespace",r[r.Package=3]="Package",r[r.Class=4]="Class",r[r.Method=5]="Method",r[r.Property=6]="Property",r[r.Field=7]="Field",r[r.Constructor=8]="Constructor",r[r.Enum=9]="Enum",r[r.Interface=10]="Interface",r[r.Function=11]="Function",r[r.Variable=12]="Variable",r[r.Constant=13]="Constant",r[r.String=14]="String",r[r.Number=15]="Number",r[r.Boolean=16]="Boolean",r[r.Array=17]="Array",r[r.Object=18]="Object",r[r.Key=19]="Key",r[r.Null=20]="Null",r[r.EnumMember=21]="EnumMember",r[r.Struct=22]="Struct",r[r.Event=23]="Event",r[r.Operator=24]="Operator",r[r.TypeParameter=25]="TypeParameter"})(Ve||(Ve={}));var ba;(function(r){r[r.Deprecated=1]="Deprecated"})(ba||(ba={}));let ya=Sf=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,i,n,s){this.name=e,this.kind=t,this.containerName=s,typeof i=="string"&&(this.containerName=i),n instanceof si?this.location=n:i instanceof ve&&(this.location=new si(n,i)),Sf.validate(this)}toJSON(){return{name:this.name,kind:Ve[this.kind],location:this.location,containerName:this.containerName}}};ya=Sf=F([Y],ya);let xa=Bl=class{static validate(e){if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");e.children?.forEach(Bl.validate)}constructor(e,t,i,n,s){this.name=e,this.detail=t,this.kind=i,this.range=n,this.selectionRange=s,this.children=[],Bl.validate(this)}};xa=Bl=F([Y],xa);var Ca;(function(r){r[r.Invoke=1]="Invoke",r[r.Automatic=2]="Automatic"})(Ca||(Ca={}));let Ql=class{constructor(e,t){this.title=e,this.kind=t}};Ql=F([Y],Ql);let Ze=class{static{va=this}static{this.sep="."}constructor(e){this.value=e}append(e){return new va(this.value?this.value+va.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+va.sep)}};Ze=va=F([Y],Ze),Ze.Empty=new Ze(""),Ze.QuickFix=Ze.Empty.append("quickfix"),Ze.Refactor=Ze.Empty.append("refactor"),Ze.RefactorExtract=Ze.Refactor.append("extract"),Ze.RefactorInline=Ze.Refactor.append("inline"),Ze.RefactorMove=Ze.Refactor.append("move"),Ze.RefactorRewrite=Ze.Refactor.append("rewrite"),Ze.Source=Ze.Empty.append("source"),Ze.SourceOrganizeImports=Ze.Source.append("organizeImports"),Ze.SourceFixAll=Ze.Source.append("fixAll"),Ze.Notebook=Ze.Empty.append("notebook");let Sa=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};Sa=F([Y],Sa);let Pf=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}},jw=class{constructor(e,t){this.fromRanges=t,this.from=e}},Gw=class{constructor(e,t){this.fromRanges=t,this.to=e}};var Ms;(function(r){r[r.Information=0]="Information",r[r.Warning=1]="Warning",r[r.Error=2]="Error"})(Ms||(Ms={}));let Kl=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};Kl=F([Y],Kl);let gi=Ef=class{#e;static isMarkdownString(e){return e instanceof Ef?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}constructor(e,t=!1){this.#e=new I_(e,{supportThemeIcons:t})}get value(){return this.#e.value}set value(e){this.#e.value=e}get isTrusted(){return this.#e.isTrusted}set isTrusted(e){this.#e.isTrusted=e}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(e){this.#e.supportThemeIcons=e}get supportHtml(){return this.#e.supportHtml}set supportHtml(e){this.#e.supportHtml=e}get baseUri(){return this.#e.baseUri}set baseUri(e){this.#e.baseUri=e}appendText(e){return this.#e.appendText(e),this}appendMarkdown(e){return this.#e.appendMarkdown(e),this}appendCodeblock(e,t){return this.#e.appendCodeblock(t??"",e),this}};gi=Ef=F([Y],gi);let Tf=class{constructor(e,t){this.label=e,this.documentation=t}};Tf=F([Y],Tf);let Af=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};Af=F([Y],Af);let Rf=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Rf=F([Y],Rf);var Lf;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(Lf||(Lf={}));var Of;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(Of||(Of={}));let Jl=class{constructor(e){this.value=e}};Jl=F([Y],Jl);let Xl=class{constructor(e,t,i){this.position=e,this.label=t,this.kind=i}};Xl=F([Y],Xl);var Hs;(function(r){r[r.Invoke=0]="Invoke",r[r.TriggerCharacter=1]="TriggerCharacter",r[r.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Hs||(Hs={}));var ce;(function(r){r[r.Text=0]="Text",r[r.Method=1]="Method",r[r.Function=2]="Function",r[r.Constructor=3]="Constructor",r[r.Field=4]="Field",r[r.Variable=5]="Variable",r[r.Class=6]="Class",r[r.Interface=7]="Interface",r[r.Module=8]="Module",r[r.Property=9]="Property",r[r.Unit=10]="Unit",r[r.Value=11]="Value",r[r.Enum=12]="Enum",r[r.Keyword=13]="Keyword",r[r.Snippet=14]="Snippet",r[r.Color=15]="Color",r[r.File=16]="File",r[r.Reference=17]="Reference",r[r.Folder=18]="Folder",r[r.EnumMember=19]="EnumMember",r[r.Constant=20]="Constant",r[r.Struct=21]="Struct",r[r.Event=22]="Event",r[r.Operator=23]="Operator",r[r.TypeParameter=24]="TypeParameter",r[r.User=25]="User",r[r.Issue=26]="Issue"})(ce||(ce={}));var Ea;(function(r){r[r.Deprecated=1]="Deprecated"})(Ea||(Ea={}));let Yl=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&ce[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Yl=F([Y],Yl);let Us=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};Us=F([Y],Us);let $f=class{constructor(e,t,i){this.insertText=e,this.range=t,this.command=i}};$f=F([Y],$f);let Nf=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};Nf=F([Y],Nf);var ka;(function(r){r[r.Active=-1]="Active",r[r.Beside=-2]="Beside",r[r.One=1]="One",r[r.Two=2]="Two",r[r.Three=3]="Three",r[r.Four=4]="Four",r[r.Five=5]="Five",r[r.Six=6]="Six",r[r.Seven=7]="Seven",r[r.Eight=8]="Eight",r[r.Nine=9]="Nine"})(ka||(ka={}));var Qn;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})(Qn||(Qn={}));function H4(r,e){return`${Qe.toKey(r)}.${e}`}var Di;(function(r){r[r.Off=0]="Off",r[r.On=1]="On",r[r.Relative=2]="Relative",r[r.Interval=3]="Interval"})(Di||(Di={}));var Bs;(function(r){r[r.Manual=1]="Manual",r[r.AfterDelay=2]="AfterDelay",r[r.FocusOut=3]="FocusOut"})(Bs||(Bs={}));var Zl;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(Zl||(Zl={}));var Ws;(function(r){r[r.Keyboard=1]="Keyboard",r[r.Mouse=2]="Mouse",r[r.Command=3]="Command"})(Ws||(Ws={}));var Da;(function(r){r[r.Undo=1]="Undo",r[r.Redo=2]="Redo"})(Da||(Da={}));var Wr;(function(r){r[r.OpenOpen=0]="OpenOpen",r[r.ClosedClosed=1]="ClosedClosed",r[r.OpenClosed=2]="OpenClosed",r[r.ClosedOpen=3]="ClosedOpen"})(Wr||(Wr={})),function(r){function e(t){switch(t){case"keyboard":return r.Keyboard;case"mouse":return r.Mouse;case"api":return r.Command}}r.fromValue=e}(Ws||(Ws={}));var Vs;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(Vs||(Vs={})),function(r){function e(t){switch(t){case r.Other:return"other";case r.Comment:return"comment";case r.String:return"string";case r.RegEx:return"regex"}return"other"}r.toString=e}(Vs||(Vs={}));let eu=class{constructor(e,t){if(t&&!b.isUri(t))throw be("target");if(!ve.isRange(e)||e.isEmpty)throw be("range");this.range=e,this.target=t}};eu=F([Y],eu);let zs=class{constructor(e,t,i,n){this.red=e,this.green=t,this.blue=i,this.alpha=n}};zs=F([Y],zs);let tu=class{constructor(e,t){if(t&&!(t instanceof zs))throw be("color");if(!ve.isRange(e)||e.isEmpty)throw be("range");this.range=e,this.color=t}};tu=F([Y],tu);let iu=class{constructor(e){if(!e||typeof e!="string")throw be("label");this.label=e}};iu=F([Y],iu);var Ff;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Information=2]="Information"})(Ff||(Ff={}));var Mf;(function(r){r[r.Unknown=0]="Unknown",r[r.Shutdown=1]="Shutdown",r[r.Process=2]="Process",r[r.User=3]="User",r[r.Extension=4]="Extension"})(Mf||(Mf={}));class U4{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw be("startIndex");if(typeof t!="number"||t<1)throw be("length");if(i!==void 0&&typeof i!="string")throw be("tooltip")}}class B4{constructor(e){this.uri=e}}class W4{constructor(e){this.terminalCommand=e}}var Hf;(function(r){r[r.Panel=1]="Panel",r[r.Editor=2]="Editor"})(Hf||(Hf={}));class V4{constructor(e){if(this.options=e,typeof e!="object")throw be("options")}}var Uf;(function(r){r[r.Always=1]="Always",r[r.Silent=2]="Silent",r[r.Never=3]="Never"})(Uf||(Uf={}));var Bf;(function(r){r[r.Shared=1]="Shared",r[r.Dedicated=2]="Dedicated",r[r.New=3]="New"})(Bf||(Bf={}));let Ia=class{static{Bi=this}static{this.Clean=new Bi("clean","Clean")}static{this.Build=new Bi("build","Build")}static{this.Rebuild=new Bi("rebuild","Rebuild")}static{this.Test=new Bi("test","Test")}static from(e){switch(e){case"clean":return Bi.Clean;case"build":return Bi.Build;case"rebuild":return Bi.Rebuild;case"test":return Bi.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!="string"||typeof t!="string")throw be("name");this._id=e}get id(){return this._id}};Ia=Bi=F([Y],Ia);function Qw(r){let e="";for(let t=0;t<r.length;t++)e+=r[t].replace(/,/g,",,")+",";return e}let qs=class{constructor(e,t,i){if(typeof e!="string")throw be("process");this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=i):this._options=t)}get process(){return this._process}set process(e){if(typeof e!="string")throw be("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return Qw(e)}};qs=F([Y],qs);let Vr=class{constructor(e,t,i){if(this._args=[],Array.isArray(t)){if(!e)throw be("command can't be undefined or null");if(typeof e!="string"&&typeof e.value!="string")throw be("command");this._command=e,this._args=t,this._options=i}else{if(typeof e!="string")throw be("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!="string")throw be("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!="string"&&typeof e.value!="string")throw be("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push(typeof t=="string"?t:t.value);return Qw(e)}};Vr=F([Y],Vr);var Wf;(function(r){r[r.Escape=1]="Escape",r[r.Strong=2]="Strong",r[r.Weak=3]="Weak"})(Wf||(Wf={}));var zr;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace"})(zr||(zr={}));class Vf{constructor(e){this._callback=e}computeId(){return"customExecution"+on()}set callback(e){this._callback=e}get callback(){return this._callback}}let nu=class{static{Wi=this}static{this.ExtensionCallbackType="customExecution"}static{this.ProcessType="process"}static{this.ShellType="shell"}static{this.EmptyType="$empty"}constructor(e,t,i,n,s,o){this.__deprecated=!1,this._definition=this.definition=e;let a;typeof t=="string"?(this._name=this.name=t,this._source=this.source=i,this.execution=n,a=s,this.__deprecated=!0):t===zr.Global||t===zr.Workspace?(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o):(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof qs?this._definition={type:Wi.ProcessType,id:this._execution.computeId()}:this._execution instanceof Vr?this._definition={type:Wi.ShellType,id:this._execution.computeId()}:this._execution instanceof Vf?this._definition={type:Wi.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:Wi.EmptyType,id:on()}}get definition(){return this._definition}set definition(e){if(e==null)throw be("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!="string")throw be("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;(Wi.EmptyType===t||Wi.ProcessType===t||Wi.ShellType===t||Wi.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!="string"||e.length===0)throw be("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._runOptions=e}};nu=Wi=F([Y],nu);var qr;(function(r){r[r.SourceControl=1]="SourceControl",r[r.Window=10]="Window",r[r.Notification=15]="Notification"})(qr||(qr={}));var zf;(function(r){function e(t){const i=t;return Nn(i.value)?i.tooltip&&!Le(i.tooltip)?(console.log("INVALID view badge, invalid tooltip",i.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",i.value),!1)}r.isViewBadge=e})(zf||(zf={}));let ru=kf=class{static isTreeItem(e,t){const i=e;if(i.checkboxState!==void 0){const n=Nn(i.checkboxState)?i.checkboxState:It(i.checkboxState)&&Nn(i.checkboxState.state)?i.checkboxState.state:void 0,s=!Nn(i.checkboxState)&&It(i.checkboxState)?i.checkboxState.tooltip:void 0;if(n===void 0||n!==zi.Checked&&n!==zi.Unchecked||s!==void 0&&!Le(s))return console.log("INVALID tree item, invalid checkboxState",i.checkboxState),!1}if(e instanceof kf)return!0;if(i.label!==void 0&&!Le(i.label)&&!i.label?.label)return console.log("INVALID tree item, invalid label",i.label),!1;if(i.id!==void 0&&!Le(i.id))return console.log("INVALID tree item, invalid id",i.id),!1;if(i.iconPath!==void 0&&!Le(i.iconPath)&&!b.isUri(i.iconPath)&&(!i.iconPath||!Le(i.iconPath.id))){const n=i.iconPath;if(!n||!Le(n.light)&&!b.isUri(n.light)&&!Le(n.dark)&&!b.isUri(n.dark))return console.log("INVALID tree item, invalid iconPath",i.iconPath),!1}return i.description!==void 0&&!Le(i.description)&&typeof i.description!="boolean"?(console.log("INVALID tree item, invalid description",i.description),!1):i.resourceUri!==void 0&&!b.isUri(i.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",i.resourceUri),!1):i.tooltip!==void 0&&!Le(i.tooltip)&&!(i.tooltip instanceof gi)?(console.log("INVALID tree item, invalid tooltip",i.tooltip),!1):i.command!==void 0&&!i.command.command?(console.log("INVALID tree item, invalid command",i.command),!1):i.collapsibleState!==void 0&&i.collapsibleState<jr.None&&i.collapsibleState>jr.Expanded?(console.log("INVALID tree item, invalid collapsibleState",i.collapsibleState),!1):i.contextValue!==void 0&&!Le(i.contextValue)?(console.log("INVALID tree item, invalid contextValue",i.contextValue),!1):i.accessibilityInformation!==void 0&&!i.accessibilityInformation?.label?(console.log("INVALID tree item, invalid accessibilityInformation",i.accessibilityInformation),!1):!0}constructor(e,t=jr.None){this.collapsibleState=t,b.isUri(e)?this.resourceUri=e:this.label=e}};ru=kf=F([Y],ru);var jr;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(jr||(jr={}));var zi;(function(r){r[r.Unchecked=0]="Unchecked",r[r.Checked=1]="Checked"})(zi||(zi={}));let su=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};su=F([Y],su);class ou extends su{}class z4 extends ou{#e;constructor(e){super(""),this.#e=e}asFile(){return this.#e}}class q4{constructor(e,t,i,n){this.name=e,this.uri=t,this._itemId=i,this._getData=n}data(){return this._getData()}}let Pa=class{#e=new Map;constructor(e){for(const[t,i]of e??[]){const n=this.#e.get(this.#t(t));n?n.push(i):this.#e.set(this.#t(t),[i])}}get(e){return this.#e.get(this.#t(e))?.[0]}set(e,t){this.#e.set(this.#t(e),[t])}forEach(e,t){for(const[i,n]of this.#e)for(const s of n)e.call(t,s,i,this)}*[Symbol.iterator](){for(const[e,t]of this.#e)for(const i of t)yield[e,i]}#t(e){return e.toLowerCase()}};Pa=F([Y],Pa);let qf=class{constructor(e){this.insertText=e}};qf=F([Y],qf);let jf=class{constructor(e,t){this.label=t,this.insertText=e}};jf=F([Y],jf);let Nt=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id!="string"?(console.log("INVALID ThemeIcon, invalid id",e.id),!1):!0}};Nt=F([Y],Nt),Nt.File=new Nt("file"),Nt.Folder=new Nt("folder");let Ta=class{constructor(e){this.id=e}};Ta=F([Y],Ta);var js;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace",r[r.WorkspaceFolder=3]="WorkspaceFolder"})(js||(js={}));let Gs=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=b.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!="string"&&(!e||!b.isUri(e)&&!b.isUri(e.uri)))throw be("base");if(typeof t!="string")throw be("pattern");typeof e=="string"?this.baseUri=b.file(e):b.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Gs=F([Y],Gs);const Kw=new WeakMap;function j4(r,e){Kw.set(r,e)}let Qs=class{constructor(e,t,i,n,s){this.enabled=typeof e=="boolean"?e:!0,typeof t=="string"&&(this.condition=t),typeof i=="string"&&(this.hitCondition=i),typeof n=="string"&&(this.logMessage=n),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=Kw.get(this)??on()),this._id}};Qs=F([Y],Qs);let Gr=class extends Qs{constructor(e,t,i,n,s,o){if(super(t,i,n,s,o),e===null)throw be("location");this.location=e}};Gr=F([Y],Gr);let Qr=class extends Qs{constructor(e,t,i,n,s,o){super(t,i,n,s,o),this.functionName=e}};Qr=F([Y],Qr);let au=class extends Qs{constructor(e,t,i,n,s,o,a,c){if(super(n,s,o,a,c),!t)throw be("dataId");this.label=e,this.dataId=t,this.canPersist=i}};au=F([Y],au);let cu=class{constructor(e,t,i){this.command=e,this.args=t||[],this.options=i}};cu=F([Y],cu);let Aa=class{constructor(e,t){this.port=e,this.host=t}};Aa=F([Y],Aa);let lu=class{constructor(e){this.path=e}};lu=F([Y],lu);let uu=class{constructor(e){this.implementation=e}};uu=F([Y],uu);let du=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}};du=F([Y],du);let hu=class{constructor(e,t){this.session=e,this.threadId=t}};hu=F([Y],hu);let fu=class{constructor(e,t){this.range=e,this.expression=t}};fu=F([Y],fu);var Ra;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(Ra||(Ra={}));let pu=class{constructor(e,t){this.range=e,this.text=t}};pu=F([Y],pu);let gu=class{constructor(e,t,i=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=i}};gu=F([Y],gu);let mu=class{constructor(e,t){this.range=e,this.expression=t}};mu=F([Y],mu);let Gf=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};Gf=F([Y],Gf);var Qf;(function(r){r[r.AIGenerated=1]="AIGenerated"})(Qf||(Qf={}));class G4{constructor(e,t){this.newSymbolName=e,this.tags=t}}var Ks;(function(r){r[r.Changed=1]="Changed",r[r.Created=2]="Created",r[r.Deleted=3]="Deleted"})(Ks||(Ks={}));let ft=Wt=class extends Error{static FileExists(e){return new Wt(e,ye.FileExists,Wt.FileExists)}static FileNotFound(e){return new Wt(e,ye.FileNotFound,Wt.FileNotFound)}static FileNotADirectory(e){return new Wt(e,ye.FileNotADirectory,Wt.FileNotADirectory)}static FileIsADirectory(e){return new Wt(e,ye.FileIsADirectory,Wt.FileIsADirectory)}static NoPermissions(e){return new Wt(e,ye.NoPermissions,Wt.NoPermissions)}static Unavailable(e){return new Wt(e,ye.Unavailable,Wt.Unavailable)}constructor(e,t=ye.Unknown,i){super(b.isUri(e)?e.toString(!0):e),this.code=i?.name??"Unknown",lw(this,t),Object.setPrototypeOf(this,Wt.prototype),typeof Error.captureStackTrace=="function"&&typeof i=="function"&&Error.captureStackTrace(this,i)}};ft=Wt=F([Y],ft);let Kf=class{constructor(e,t,i){this.start=e,this.end=t,this.kind=i}};Kf=F([Y],Kf);var dn;(function(r){r[r.Comment=1]="Comment",r[r.Imports=2]="Imports",r[r.Region=3]="Region"})(dn||(dn={}));var La;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(La||(La={}));var Jf;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(Jf||(Jf={}));var Xf;(function(r){r[r.Published=0]="Published",r[r.Draft=1]="Draft"})(Xf||(Xf={}));var Oa;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(Oa||(Oa={}));class Yf{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}function Q4(r){return typeof r>"u"||ux(r)}class Zf{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,i=e.tokenTypes.length;t<i;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,i=e.tokenModifiers.length;t<i;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,i,n,s){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(e,t,i,n,s);if(ve.isRange(e)&&typeof t=="string"&&Q4(i))return this._push(e,t,i);throw be()}_push(e,t,i){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const n=e.start.line,s=e.start.character,o=e.end.character-e.start.character,a=this._tokenTypeStrToInt.get(t);let c=0;if(i)for(const l of i){if(!this._tokenModifierStrToInt.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(l);c|=1<<u>>>0}this._pushEncoded(n,s,o,a,c)}_pushEncoded(e,t,i,n,s){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const c=this._data.length/5|0;let l=0,u=0;for(let h=0;h<c;h++){let f=this._data[5*h],d=this._data[5*h+1];f===0?(f=l,d+=u):f+=l,this._data[5*h]=f,this._data[5*h+1]=d,l=f,u=d}}let o=e,a=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=i,this._data[this._dataLen++]=n,this._data[this._dataLen++]=s,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],i=e.length/5|0;for(let a=0;a<i;a++)t[a]=a;t.sort((a,c)=>{const l=e[5*a],u=e[5*c];if(l===u){const h=e[5*a+1],f=e[5*c+1];return h-f}return l-u});const n=new Uint32Array(e.length);let s=0,o=0;for(let a=0;a<i;a++){const c=5*t[a],l=e[c+0],u=e[c+1],h=e[c+2],f=e[c+3],d=e[c+4],_=l-s,w=_===0?u-o:u,x=5*a;n[x+0]=_,n[x+1]=w,n[x+2]=h,n[x+3]=f,n[x+4]=d,s=l,o=u}return n}build(e){return this._dataIsSortedAndDeltaEncoded?new Js(new Uint32Array(this._data),e):new Js(Zf._sortAndDeltaEncode(this._data),e)}}class Js{constructor(e,t){this.resultId=t,this.data=e}}class Jw{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}}class vu{constructor(e,t){this.resultId=t,this.edits=e}}var _u;(function(r){r[r.Separate=0]="Separate",r[r.MergeWithParent=1]="MergeWithParent"})(_u||(_u={}));class K4{constructor(e){this.name=e}}let $a=class{static{this.Back={iconPath:new Nt("arrow-left")}}constructor(){}};$a=F([Y],$a);var Na;(function(r){r[r.Separator=-1]="Separator",r[r.Default=0]="Default"})(Na||(Na={}));var Xs;(function(r){r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})(Xs||(Xs={}));var Kr;(function(r){r[r.UI=1]="UI",r[r.Workspace=2]="Workspace"})(Kr||(Kr={}));class ep{static validate(e){if(typeof e.badge=="string"){let t=Av(e.badge,0);if(t<e.badge.length&&(t+=Av(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Nt.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}}let wu=class{constructor(e){this.kind=e}};wu=F([Y],wu);var Kn;(function(r){r[r.Light=1]="Light",r[r.Dark=2]="Dark",r[r.HighContrast=3]="HighContrast",r[r.HighContrastLight=4]="HighContrastLight"})(Kn||(Kn={}));let hn=class T1{static isNotebookRange(e){return e instanceof T1?!0:e?typeof e.start=="number"&&typeof e.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw be("start must be positive");if(t<0)throw be("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,i=this._end;return e.start!==void 0&&(t=e.start),e.end!==void 0&&(i=e.end),t===this._start&&i===this._end?this:new T1(t,i)}},bu=class A1{static validate(e){if(typeof e.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof e.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof e.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(t=>A1.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(e,t,i,n,s,o,a){this.kind=e,this.value=t,this.languageId=i,this.mime=n,this.outputs=s??[],this.metadata=o,this.executionSummary=a,A1.validate(this)}},Xw=class{constructor(e){this.cells=e}},Yw=class In{static isNotebookCellOutputItem(e){return e instanceof In?!0:e?typeof e.mime=="string"&&e.data instanceof Uint8Array:!1}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return In.json(t,"application/vnd.code.notebook.error")}static stdout(e){return In.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return In.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new In(e,t)}static#e=new TextEncoder;static text(e,t=an.text){const i=In.#e.encode(String(e));return new In(i,t)}static json(e,t="text/x-json"){const i=JSON.stringify(e,void 0,"	");return In.text(i,t)}constructor(e,t){this.data=e,this.mime=t;const i=G_(t,!0);if(!i)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=i}},yu=class R1{static isNotebookCellOutput(e){return e instanceof R1?!0:!e||typeof e!="object"?!1:typeof e.id=="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,t=!1){const i=new Set,n=new Set;for(let s=0;s<e.length;s++){const o=e[s],a=G_(o.mime);if(!i.has(a)||Lw(a)){i.add(a);continue}n.add(s),t&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return n.size===0?e:e.filter((s,o)=>!n.has(o))}constructor(e,t,i){this.items=R1.ensureUniqueMimeTypes(e,!0),typeof t=="string"?(this.id=t,this.metadata=i):(this.id=on(),this.metadata=t??i)}};var Jr;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})(Jr||(Jr={}));var Ys;(function(r){r[r.Idle=1]="Idle",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(Ys||(Ys={}));var xu;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})(xu||(xu={}));var Cu;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(Cu||(Cu={}));class J4{constructor(e,t){this.text=e,this.alignment=t}}var tp;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred"})(tp||(tp={}));var Su;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred",r[r.Hidden=-1]="Hidden"})(Su||(Su={}));let Zw=class{constructor(e,t=[]){this.uri=e,this.provides=Bo(t)}},X4=class{constructor(e){this.label=e}};var Fa;(function(r){r[r.Named=1]="Named",r[r.Indexed=2]="Indexed"})(Fa||(Fa={}));let ip=class{constructor(e,t){this.label=e,this.timestamp=t}};ip=F([Y],ip);var Zs;(function(r){r[r.Production=1]="Production",r[r.Development=2]="Development",r[r.Test=3]="Test"})(Zs||(Zs={}));var Eu;(function(r){r[r.Node=1]="Node",r[r.Webworker=2]="Webworker"})(Eu||(Eu={}));var Jn;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(Jn||(Jn={}));class Y4{constructor(e,t){this.ranges=e,this.wordPattern=t}}class Z4{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var np;(function(r){r[r.Queued=1]="Queued",r[r.Running=2]="Running",r[r.Passed=3]="Passed",r[r.Failed=4]="Failed",r[r.Skipped=5]="Skipped",r[r.Errored=6]="Errored"})(np||(np={}));var eo;(function(r){r[r.Run=1]="Run",r[r.Debug=2]="Debug",r[r.Coverage=3]="Coverage"})(eo||(eo={}));let ku=class{constructor(e=void 0,t=void 0,i=void 0,n=!1){this.include=e,this.exclude=t,this.profile=i,this.continuous=n}};ku=F([Y],ku);let Du=Df=class{static diff(e,t,i){const n=new Df(e);return n.expectedOutput=t,n.actualOutput=i,n}constructor(e){this.message=e}};Du=Df=F([Y],Du);let Ma=class{constructor(e){this.id=e}};Ma=F([Y],Ma);class Iu{constructor(e,t){this.covered=e,this.total=t}}const rp=r=>{if(r&&r.covered>r.total)throw new Error(`The total number of covered items (${r.covered}) cannot be greater than the total (${r.total})`)};class sp{static fromDetails(e,t){const i=new Iu(0,0),n=new Iu(0,0),s=new Iu(0,0);for(const a of t)if("branches"in a){i.total+=1,i.covered+=a.executed?1:0;for(const c of a.branches)n.total+=1,n.covered+=c.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new sp(e,i,n.total>0?n:void 0,s.total>0?s:void 0);return o.detailedCoverage=t,o}constructor(e,t,i,n){this.uri=e,this.statementCoverage=t,this.branchCoverage=i,this.declarationCoverage=n,rp(t),rp(i),rp(n)}}class eE{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}}class tE{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}}class e0{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}}var op;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(op||(op={}));var ap;(function(r){r[r.Untrusted=0]="Untrusted",r[r.Trusted=1]="Trusted",r[r.Unspecified=2]="Unspecified"})(ap||(ap={}));var cp;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(cp||(cp={}));let lp=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}};class up{constructor(e){this.uri=e}}class dp{constructor(e,t){this.original=e,this.modified=t}}class t0{constructor(e,t,i,n){this.base=e,this.input1=t,this.input2=i,this.result=n}}class hp{constructor(e,t){this.uri=e,this.viewType=t}}class i0{constructor(e){this.viewType=e}}class fp{constructor(e,t){this.uri=e,this.notebookType=t}}class pp{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}}class n0{constructor(){}}class r0{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class s0{constructor(e){this.providerId=e}}var gp;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(gp||(gp={}));var mp;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(mp||(mp={}));var fn;(function(r){r[r.Short=1]="Short",r[r.Medium=2]="Medium",r[r.Full=3]="Full"})(fn||(fn={}));class iE{constructor(e,t){this.label=e,this.values=t}}var Xn;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful",r[r.Undone=2]="Undone",r[r.Accepted=3]="Accepted",r[r.Bug=4]="Bug"})(Xn||(Xn={}));var Ha;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful"})(Ha||(Ha={}));let Pu=class{constructor(e){this.value=typeof e=="string"?new gi(e):e}};class Tu{constructor(e,t){this.value=e,this.baseUri=t}}let Au=class{constructor(e,t){this.value=e,this.title=t}},Ua=class{constructor(e){this.value=e}},vp=class{constructor(e){this.value=e}},Ba=class{constructor(e){this.value=e}};class o0{constructor(e,t,i,n){this.prompt=e,this.command=t,this.variables=i,this.participant=n}}class a0{constructor(e,t,i,n){this.response=e,this.result=t,this.participant=i,this.command=n}}class _p{constructor(e){this.content=e}}class wp{constructor(e,t){this.content=e,this.name=t}}class bp{constructor(e){this.content=e}}var yp;(function(r){r[r.SymbolInformation=1]="SymbolInformation",r[r.CommandInformation=2]="CommandInformation",r[r.SearchInformation=3]="SearchInformation",r[r.SettingInformation=4]="SettingInformation"})(yp||(yp={}));var xp;(function(r){r[r.Started=1]="Started",r[r.Recognizing=2]="Recognizing",r[r.Recognized=3]="Recognized",r[r.Stopped=4]="Stopped"})(xp||(xp={}));var Cp;(function(r){r[r.Recognized=1]="Recognized",r[r.Stopped=2]="Stopped"})(Cp||(Cp={}));class nE{constructor(e,t){this.text=e,this.range=t}}var Wa;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(Wa||(Wa={}));var mi;(function(r){function e(i){const{selectionStartLineNumber:n,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=i,c=new xe(n-1,s-1),l=new xe(o-1,a-1);return new un(c,l)}r.to=e;function t(i){const{anchor:n,active:s}=i;return{selectionStartLineNumber:n.line+1,selectionStartColumn:n.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}r.from=t})(mi||(mi={}));var $;(function(r){function e(i){if(!i)return;const{start:n,end:s}=i;return{startLineNumber:n.line+1,startColumn:n.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}r.from=e;function t(i){if(!i)return;const{startLineNumber:n,startColumn:s,endLineNumber:o,endColumn:a}=i;return new ve(n-1,s-1,o-1,a-1)}r.to=t})($||($={}));var Yn;(function(r){function e(i){return{uri:i.uri,range:$.from(i.range)}}r.from=e;function t(i){return new si(b.revive(i.uri),$.to(i.range))}r.to=t})(Yn||(Yn={}));var Sp;(function(r){function e(t){switch(t){case 1:return Jn.Comment;case 0:return Jn.Other;case 3:return Jn.RegEx;case 2:return Jn.String}}r.to=e})(Sp||(Sp={}));var He;(function(r){function e(i){return new xe(i.lineNumber-1,i.column-1)}r.to=e;function t(i){return{lineNumber:i.line+1,column:i.character+1}}r.from=t})(He||(He={}));var to;(function(r){function e(n,s,o){return Mt(Bo(n).map(a=>t(a,s,o)))}r.from=e;function t(n,s,o){if(typeof n=="string")return{$serialized:!0,language:n,isBuiltin:o?.isBuiltin};if(n)return{$serialized:!0,language:n.language,scheme:i(n.scheme,s),pattern:Yt.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType,isBuiltin:o?.isBuiltin}}function i(n,s){return s&&typeof n=="string"?s.transformOutgoingScheme(n):n}})(to||(to={}));var Ru;(function(r){function e(i){switch(i){case Br.Unnecessary:return 1;case Br.Deprecated:return 2}}r.from=e;function t(i){switch(i){case 1:return Br.Unnecessary;case 2:return Br.Deprecated;default:return}}r.to=t})(Ru||(Ru={}));var io;(function(r){function e(i){let n;return i.code&&(Le(i.code)||Nn(i.code)?n=String(i.code):n={value:String(i.code.value),target:i.code.target}),{...$.from(i.range),message:i.message,source:i.source,code:n,severity:Ou.from(i.severity),relatedInformation:i.relatedInformation&&i.relatedInformation.map(Lu.from),tags:Array.isArray(i.tags)?Mt(i.tags.map(Ru.from)):void 0}}r.from=e;function t(i){const n=new zl($.to(i),i.message,Ou.to(i.severity));return n.source=i.source,n.code=Le(i.code)?i.code:i.code?.value,n.relatedInformation=i.relatedInformation&&i.relatedInformation.map(Lu.to),n.tags=i.tags&&Mt(i.tags.map(Ru.to)),n}r.to=t})(io||(io={}));var Lu;(function(r){function e(i){return{...$.from(i.location.range),message:i.message,resource:i.location.uri}}r.from=e;function t(i){return new _a(new si(i.resource,$.to(i)),i.message)}r.to=t})(Lu||(Lu={}));var Ou;(function(r){function e(i){switch(i){case Et.Error:return Ut.Error;case Et.Warning:return Ut.Warning;case Et.Information:return Ut.Info;case Et.Hint:return Ut.Hint}return Ut.Error}r.from=e;function t(i){switch(i){case Ut.Info:return Et.Information;case Ut.Warning:return Et.Warning;case Ut.Error:return Et.Error;case Ut.Hint:return Et.Hint;default:return Et.Error}}r.to=t})(Ou||(Ou={}));var pt;(function(r){function e(i){return typeof i=="number"&&i>=ka.One?i-1:i===ka.Beside?P4:I4}r.from=e;function t(i){if(typeof i=="number"&&i>=0)return i+1;throw new Error("invalid 'EditorGroupColumn'")}r.to=t})(pt||(pt={}));function rE(r){return typeof r.range<"u"}function c0(r){return r.length===0?!0:!!rE(r[0])}var De;(function(r){function e(a){return a.map(r.from)}r.fromMany=e;function t(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function i(a){let c;if(t(a)){const{language:f,value:d}=a;c={value:"```"+f+`
`+d+"\n```\n"}}else gi.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=f=>{try{let d=b.parse(f,!0);d=d.with({query:n(d.query,l)}),l[f]=d}catch{}return""},h=new j_.Renderer;return h.link=u,h.image=f=>typeof f=="string"?u(VC(f).href):"",j_(c.value,{renderer:h}),c}r.from=i;function n(a,c){if(!a)return a;let l;try{l=LS(a)}catch{}if(!l)return a;let u=!1;return l=pl(l,h=>{if(b.isUri(h)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[f]=h,u=!0,f}else return}),u?JSON.stringify(l):a}function s(a){const c=new gi(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.baseUri=a.baseUri?b.from(a.baseUri):void 0,c}r.to=s;function o(a){if(a)return typeof a=="string"?a:r.from(a)}r.fromStrict=o})(De||(De={}));function sE(r){return c0(r)?r.map(e=>({range:$.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?De.fromMany(e.hoverMessage):e.hoverMessage?De.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):r.map(e=>({range:$.from(e)}))}function $u(r){return typeof r>"u"?r:typeof r=="string"?b.file(r):r}var no;(function(r){function e(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?$u(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}r.from=e})(no||(no={}));var Nu;(function(r){function e(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?$u(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?no.from(t.before):void 0,after:t.after?no.from(t.after):void 0}}r.from=e})(Nu||(Nu={}));var Ep;(function(r){function e(t){if(typeof t>"u")return t;switch(t){case Wr.OpenOpen:return 0;case Wr.ClosedClosed:return 1;case Wr.OpenClosed:return 2;case Wr.ClosedOpen:return 3}}r.from=e})(Ep||(Ep={}));var kp;(function(r){function e(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?Ep.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?Nu.from(t.light):void 0,dark:t.dark?Nu.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?$u(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?no.from(t.before):void 0,after:t.after?no.from(t.after):void 0}}r.from=e})(kp||(kp={}));var vt;(function(r){function e(i){return{text:i.newText,eol:i.newEol&&ao.from(i.newEol),range:$.from(i.range)}}r.from=e;function t(i){const n=new jn($.to(i.range),i.text);return n.newEol=typeof i.eol>"u"?void 0:ao.to(i.eol),n}r.to=t})(vt||(vt={}));var Vt;(function(r){function e(i,n){const s={edits:[]};if(i instanceof Gn){const o=new B1;for(const a of i._allEntries())a._type===1&&b.isUri(a.to)&&a.from===void 0&&o.add(a.to);for(const a of i._allEntries())if(a._type===1){let c;a.options?.contents&&(ArrayBuffer.isView(a.options.contents)?c={type:"base64",value:G1(he.wrap(a.options.contents))}:c={type:"dataTransferItem",id:a.options.contents._itemId}),s.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:c},metadata:a.metadata})}else a._type===2?s.edits.push({resource:a.uri,textEdit:vt.from(a.edit),versionId:o.has(a.uri)?void 0:n?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===6?s.edits.push({resource:a.uri,textEdit:{range:$.from(a.range),text:a.edit.value,insertAsSnippet:!0},versionId:o.has(a.uri)?void 0:n?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===3?s.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookMetadata:a.notebookMetadata,notebookVersionId:n?.getNotebookDocumentVersion(a.uri)}):a._type===5&&s.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:n?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:1,index:a.index,count:a.count,cells:a.cells.map(Qa.from)}})}return s}r.from=e;function t(i){const n=new Gn,s=new it;for(const o of i.edits)if(o.textEdit){const a=o,c=b.revive(a.resource),l=$.to(a.textEdit.range),u=a.textEdit.text,h=a.textEdit.insertAsSnippet;let f;h?f=Hr.replace(l,new Ur(u)):f=jn.replace(l,u);const d=s.get(c);d?d.push(f):s.set(c,[f])}else n.renameFile(b.revive(o.oldResource),b.revive(o.newResource),o.options);for(const[o,a]of s)n.set(o,a);return n}r.to=t})(Vt||(Vt={}));var vi;(function(r){const e=Object.create(null);e[Ve.File]=0,e[Ve.Module]=1,e[Ve.Namespace]=2,e[Ve.Package]=3,e[Ve.Class]=4,e[Ve.Method]=5,e[Ve.Property]=6,e[Ve.Field]=7,e[Ve.Constructor]=8,e[Ve.Enum]=9,e[Ve.Interface]=10,e[Ve.Function]=11,e[Ve.Variable]=12,e[Ve.Constant]=13,e[Ve.String]=14,e[Ve.Number]=15,e[Ve.Boolean]=16,e[Ve.Array]=17,e[Ve.Object]=18,e[Ve.Key]=19,e[Ve.Null]=20,e[Ve.EnumMember]=21,e[Ve.Struct]=22,e[Ve.Event]=23,e[Ve.Operator]=24,e[Ve.TypeParameter]=25;function t(n){return typeof e[n]=="number"?e[n]:6}r.from=t;function i(n){for(const s in e)if(e[s]===n)return Number(s);return Ve.Property}r.to=i})(vi||(vi={}));var pn;(function(r){function e(i){switch(i){case ba.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return ba.Deprecated}}r.to=t})(pn||(pn={}));var Va;(function(r){function e(i){return{name:i.name,kind:vi.from(i.kind),tags:i.tags&&i.tags.map(pn.from),containerName:i.containerName,location:oi.from(i.location)}}r.from=e;function t(i){const n=new ya(i.name,vi.to(i.kind),i.containerName,oi.to(i.location));return n.tags=i.tags&&i.tags.map(pn.to),n}r.to=t})(Va||(Va={}));var Dp;(function(r){function e(i){const n={name:i.name||"!!MISSING: name!!",detail:i.detail,range:$.from(i.range),selectionRange:$.from(i.selectionRange),kind:vi.from(i.kind),tags:i.tags?.map(pn.from)??[]};return i.children&&(n.children=i.children.map(e)),n}r.from=e;function t(i){const n=new xa(i.name,i.detail,vi.to(i.kind),$.to(i.range),$.to(i.selectionRange));return Ho(i.tags)&&(n.tags=i.tags.map(pn.to)),i.children&&(n.children=i.children.map(t)),n}r.to=t})(Dp||(Dp={}));var Xr;(function(r){function e(i){const n=new Pf(vi.to(i.kind),i.name,i.detail||"",b.revive(i.uri),$.to(i.range),$.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,name:i.name,detail:i.detail,kind:vi.from(i.kind),uri:i.uri,range:$.from(i.range),selectionRange:$.from(i.selectionRange),tags:i.tags?.map(pn.from)}}r.from=t})(Xr||(Xr={}));var Ip;(function(r){function e(t){return new jw(Xr.to(t.from),t.fromRanges.map(i=>$.to(i)))}r.to=e})(Ip||(Ip={}));var Pp;(function(r){function e(t){return new Gw(Xr.to(t.to),t.fromRanges.map(i=>$.to(i)))}r.to=e})(Pp||(Pp={}));var oi;(function(r){function e(i){return{range:i.range&&$.from(i.range),uri:i.uri}}r.from=e;function t(i){return new si(b.revive(i.uri),$.to(i.range))}r.to=t})(oi||(oi={}));var za;(function(r){function e(i){const n=i,s=i;return{originSelectionRange:n.originSelectionRange?$.from(n.originSelectionRange):void 0,uri:n.targetUri?n.targetUri:s.uri,range:$.from(n.targetRange?n.targetRange:s.range),targetSelectionRange:n.targetSelectionRange?$.from(n.targetSelectionRange):void 0}}r.from=e;function t(i){return{targetUri:b.revive(i.uri),targetRange:$.to(i.range),targetSelectionRange:i.targetSelectionRange?$.to(i.targetSelectionRange):void 0,originSelectionRange:i.originSelectionRange?$.to(i.originSelectionRange):void 0}}r.to=t})(za||(za={}));var Fu;(function(r){function e(i){return{range:$.from(i.range),contents:De.fromMany(i.contents)}}r.from=e;function t(i){return new ql(i.contents.map(De.to),$.to(i.range))}r.to=t})(Fu||(Fu={}));var Tp;(function(r){function e(i){return{range:$.from(i.range),expression:i.expression}}r.from=e;function t(i){return new fu($.to(i.range),i.expression)}r.to=t})(Tp||(Tp={}));var Mu;(function(r){function e(i){if(i instanceof pu)return{type:"text",range:$.from(i.range),text:i.text};if(i instanceof gu)return{type:"variable",range:$.from(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};if(i instanceof mu)return{type:"expression",range:$.from(i.range),expression:i.expression};throw new Error("Unknown 'InlineValue' type")}r.from=e;function t(i){switch(i.type){case"text":return{range:$.to(i.range),text:i.text};case"variable":return{range:$.to(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};case"expression":return{range:$.to(i.range),expression:i.expression}}}r.to=t})(Mu||(Mu={}));var Hu;(function(r){function e(i){return{frameId:i.frameId,stoppedLocation:$.from(i.stoppedLocation)}}r.from=e;function t(i){return new Gf(i.frameId,$.to(i.stoppedLocation))}r.to=t})(Hu||(Hu={}));var ro;(function(r){function e(i){return{range:$.from(i.range),kind:i.kind}}r.from=e;function t(i){return new jl($.to(i.range),i.kind)}r.to=t})(ro||(ro={}));var Ap;(function(r){function e(i){return{uri:i.uri,highlights:i.highlights.map(ro.from)}}r.from=e;function t(i){return new Gl(b.revive(i.uri),i.highlights.map(ro.to))}r.to=t})(Ap||(Ap={}));var Rp;(function(r){function e(t){switch(t){case 1:return Hs.TriggerCharacter;case 2:return Hs.TriggerForIncompleteCompletions;case 0:default:return Hs.Invoke}}r.to=e})(Rp||(Rp={}));var Lp;(function(r){function e(t){return{triggerKind:Rp.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}r.to=e})(Lp||(Lp={}));var Uu;(function(r){function e(i){switch(i){case Ea.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return Ea.Deprecated}}r.to=t})(Uu||(Uu={}));var Bu;(function(r){const e=new Map([[ce.Method,0],[ce.Function,1],[ce.Constructor,2],[ce.Field,3],[ce.Variable,4],[ce.Class,5],[ce.Interface,7],[ce.Struct,6],[ce.Module,8],[ce.Property,9],[ce.Unit,12],[ce.Value,13],[ce.Constant,14],[ce.Enum,15],[ce.EnumMember,16],[ce.Keyword,17],[ce.Snippet,27],[ce.Text,18],[ce.Color,19],[ce.File,20],[ce.Reference,21],[ce.Folder,23],[ce.Event,10],[ce.Operator,11],[ce.TypeParameter,24],[ce.Issue,26],[ce.User,25]]);function t(s){return e.get(s)??9}r.from=t;const i=new Map([[0,ce.Method],[1,ce.Function],[2,ce.Constructor],[3,ce.Field],[4,ce.Variable],[5,ce.Class],[7,ce.Interface],[6,ce.Struct],[8,ce.Module],[9,ce.Property],[12,ce.Unit],[13,ce.Value],[14,ce.Constant],[15,ce.Enum],[16,ce.EnumMember],[17,ce.Keyword],[27,ce.Snippet],[18,ce.Text],[19,ce.Color],[20,ce.File],[21,ce.Reference],[23,ce.Folder],[10,ce.Event],[11,ce.Operator],[24,ce.TypeParameter],[25,ce.User],[26,ce.Issue]]);function n(s){return i.get(s)??ce.Property}r.to=n})(Bu||(Bu={}));var Op;(function(r){function e(t,i){const n=new Yl(t.label);return n.insertText=t.insertText,n.kind=Bu.to(t.kind),n.tags=t.tags?.map(Uu.to),n.detail=t.detail,n.documentation=Rr(t.documentation)?De.to(t.documentation):t.documentation,n.sortText=t.sortText,n.filterText=t.filterText,n.preselect=t.preselect,n.commitCharacters=t.commitCharacters,Be.isIRange(t.range)?n.range=$.to(t.range):typeof t.range=="object"&&(n.range={inserting:$.to(t.range.insert),replacing:$.to(t.range.replace)}),n.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&1),typeof t.insertTextRules<"u"&&t.insertTextRules&4?n.insertText=new Ur(t.insertText):(n.insertText=t.insertText,n.textEdit=n.range instanceof ve?new jn(n.range,n.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(n.additionalTextEdits=t.additionalTextEdits.map(s=>vt.to(s))),n.command=i&&t.command?i.fromInternal(t.command):void 0,n}r.to=e})(Op||(Op={}));var Wu;(function(r){function e(i){if(typeof i.label!="string"&&!Array.isArray(i.label))throw new TypeError("Invalid label");return{label:i.label,documentation:De.fromStrict(i.documentation)}}r.from=e;function t(i){return{label:i.label,documentation:Rr(i.documentation)?De.to(i.documentation):i.documentation}}r.to=t})(Wu||(Wu={}));var Vu;(function(r){function e(i){return{label:i.label,documentation:De.fromStrict(i.documentation),parameters:Array.isArray(i.parameters)?i.parameters.map(Wu.from):[],activeParameter:i.activeParameter}}r.from=e;function t(i){return{label:i.label,documentation:Rr(i.documentation)?De.to(i.documentation):i.documentation,parameters:Array.isArray(i.parameters)?i.parameters.map(Wu.to):[],activeParameter:i.activeParameter}}r.to=t})(Vu||(Vu={}));var qa;(function(r){function e(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(Vu.from):[]}}r.from=e;function t(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(Vu.to):[]}}r.to=t})(qa||(qa={}));var $p;(function(r){function e(t,i){const n=new Xl(He.to(i.position),typeof i.label=="string"?i.label:i.label.map(Np.to.bind(void 0,t)),i.kind&&zu.to(i.kind));return n.textEdits=i.textEdits&&i.textEdits.map(vt.to),n.tooltip=Rr(i.tooltip)?De.to(i.tooltip):i.tooltip,n.paddingLeft=i.paddingLeft,n.paddingRight=i.paddingRight,n}r.to=e})($p||($p={}));var Np;(function(r){function e(t,i){const n=new Jl(i.label);return n.tooltip=Rr(i.tooltip)?De.to(i.tooltip):i.tooltip,cf.is(i.command)&&(n.command=t.fromInternal(i.command)),i.location&&(n.location=oi.to(i.location)),n}r.to=e})(Np||(Np={}));var zu;(function(r){function e(i){return i}r.from=e;function t(i){return i}r.to=t})(zu||(zu={}));var Yr;(function(r){function e(i){return{range:$.from(i.range),url:i.target,tooltip:i.tooltip}}r.from=e;function t(i){let n;if(i.url)try{n=typeof i.url=="string"?b.parse(i.url,!0):b.revive(i.url)}catch{}return new eu($.to(i.range),n)}r.to=t})(Yr||(Yr={}));var qu;(function(r){function e(i){const n=new iu(i.label);return i.textEdit&&(n.textEdit=vt.to(i.textEdit)),i.additionalTextEdits&&(n.additionalTextEdits=i.additionalTextEdits.map(s=>vt.to(s))),n}r.to=e;function t(i){return{label:i.label,textEdit:i.textEdit?vt.from(i.textEdit):void 0,additionalTextEdits:i.additionalTextEdits?i.additionalTextEdits.map(n=>vt.from(n)):void 0}}r.from=t})(qu||(qu={}));var so;(function(r){function e(i){return new zs(i[0],i[1],i[2],i[3])}r.to=e;function t(i){return[i.red,i.green,i.blue,i.alpha]}r.from=t})(so||(so={}));var Fp;(function(r){function e(i){return{range:$.from(i.range)}}r.from=e;function t(i){return new Sa($.to(i.range))}r.to=t})(Fp||(Fp={}));var ju;(function(r){function e(t){switch(t){case 2:return Bs.AfterDelay;case 1:return Bs.Manual;case 3:case 4:return Bs.FocusOut}}r.to=e})(ju||(ju={}));var oo;(function(r){function e(i){switch(i){case Di.Off:return 0;case Di.Relative:return 2;case Di.Interval:return 3;case Di.On:default:return 1}}r.from=e;function t(i){switch(i){case 0:return Di.Off;case 2:return Di.Relative;case 3:return Di.Interval;case 1:default:return Di.On}}r.to=t})(oo||(oo={}));var ao;(function(r){function e(i){if(i===ki.CRLF)return 1;if(i===ki.LF)return 0}r.from=e;function t(i){if(i===1)return ki.CRLF;if(i===0)return ki.LF}r.to=t})(ao||(ao={}));var Mp;(function(r){function e(t){if(typeof t=="object")return t.viewId;switch(t){case qr.SourceControl:return 3;case qr.Window:return 10;case qr.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}r.from=e})(Mp||(Mp={}));var Gu;(function(r){function e(i){const n={start:i.start+1,end:i.end+1};return i.kind&&(n.kind=Qu.from(i.kind)),n}r.from=e;function t(i){const n={start:i.start-1,end:i.end-1};return i.kind&&(n.kind=Qu.to(i.kind)),n}r.to=t})(Gu||(Gu={}));var Qu;(function(r){function e(i){if(i)switch(i){case dn.Comment:return Ts.Comment;case dn.Imports:return Ts.Imports;case dn.Region:return Ts.Region}}r.from=e;function t(i){if(i)switch(i.value){case Ts.Comment.value:return dn.Comment;case Ts.Imports.value:return dn.Imports;case Ts.Region.value:return dn.Region}}r.to=t})(Qu||(Qu={}));var ja;(function(r){function e(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?$.from(t.selection):void 0,override:typeof t.override=="boolean"?ZS.id:void 0}}r.from=e})(ja||(ja={}));var Yt;(function(r){function e(s){return s instanceof Gs?s.toJSON():typeof s=="string"?s:t(s)||i(s)?new Gs(s.baseUri??s.base,s.pattern).toJSON():s}r.from=e;function t(s){const o=s;return o?b.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function i(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function n(s){return typeof s=="string"?s:new Gs(b.revive(s.baseUri),s.pattern)}r.to=n})(Yt||(Yt={}));var Hp;(function(r){function e(t){if(t){if(Array.isArray(t))return t.map(e);if(typeof t=="string")return t;{const i=t;return{language:i.language,scheme:i.scheme,pattern:Yt.from(i.pattern),exclusive:i.exclusive,notebookType:i.notebookType}}}else return}r.from=e})(Hp||(Hp={}));var Ku;(function(r){function e(i){return!!i&&typeof i=="object"&&"documents"in i&&Array.isArray(i.documents)&&i.documents.every(n=>Array.isArray(n)&&n.every(s=>s&&typeof s=="object"&&"uri"in s&&b.isUri(s.uri)&&"version"in s&&typeof s.version=="number"&&"ranges"in s&&Array.isArray(s.ranges)&&s.ranges.every(o=>o instanceof ve)))}r.is=e;function t(i){return{documents:i.documents.map(n=>n.map(s=>({uri:b.from(s.uri),version:s.version,ranges:s.ranges.map(o=>$.from(o))})))}}r.from=t})(Ku||(Ku={}));var qi;(function(r){function e(i){return{start:i.start,end:i.end}}r.from=e;function t(i){return new hn(i.start,i.end)}r.to=t})(qi||(qi={}));var co;(function(r){function e(i){return{timing:typeof i.runStartTime=="number"&&typeof i.runEndTime=="number"?{startTime:i.runStartTime,endTime:i.runEndTime}:void 0,executionOrder:i.executionOrder,success:i.lastRunSuccess}}r.to=e;function t(i){return{lastRunSuccess:i.success,runStartTime:i.timing?.startTime,runEndTime:i.timing?.endTime,executionOrder:i.executionOrder}}r.from=t})(co||(co={}));var Up;(function(r){function e(t){if(t===ma.Unconfirmed)return Ys.Pending;if(t===ma.Pending)return;if(t===ma.Executing)return Ys.Executing;throw new Error(`Unknown state: ${t}`)}r.to=e})(Up||(Up={}));var Ga;(function(r){function e(i){switch(i){case Jr.Markup:return $s.Markup;case Jr.Code:default:return $s.Code}}r.from=e;function t(i){switch(i){case $s.Markup:return Jr.Markup;case $s.Code:default:return Jr.Code}}r.to=t})(Ga||(Ga={}));var Zn;(function(r){function e(i){const n={metadata:i.metadata??Object.create(null),cells:[]};for(const s of i.cells)bu.validate(s),n.cells.push(Qa.from(s));return n}r.from=e;function t(i){const n=new Xw(i.cells.map(Qa.to));return fx(i.metadata)||(n.metadata=i.metadata),n}r.to=t})(Zn||(Zn={}));var Qa;(function(r){function e(i){return{cellKind:Ga.from(i.kind),language:i.languageId,mime:i.mime,source:i.value,metadata:i.metadata,internalMetadata:co.from(i.executionSummary??{}),outputs:i.outputs?i.outputs.map(er.from):[]}}r.from=e;function t(i){return new bu(Ga.to(i.cellKind),i.source,i.language,i.mime,i.outputs?i.outputs.map(er.to):void 0,i.metadata,i.internalMetadata?co.to(i.internalMetadata):void 0)}r.to=t})(Qa||(Qa={}));var lo;(function(r){function e(i){return{mime:i.mime,valueBytes:he.wrap(i.data)}}r.from=e;function t(i){return new Yw(i.valueBytes.buffer,i.mime)}r.to=t})(lo||(lo={}));var er;(function(r){function e(i){return{outputId:i.id,items:i.items.map(lo.from),metadata:i.metadata}}r.from=e;function t(i){const n=i.items.map(lo.to);return new yu(n,i.outputId,i.metadata)}r.to=t})(er||(er={}));var Ju;(function(r){function e(n){return i(n)?{include:Yt.from(n.include)??void 0,exclude:Yt.from(n.exclude)??void 0}:Yt.from(n)??void 0}r.from=e;function t(n){return i(n)?{include:Yt.to(n.include),exclude:Yt.to(n.exclude)}:Yt.to(n)}r.to=t;function i(n){const s=n;return s?!Lt(s.include)&&!Lt(s.exclude):!1}})(Ju||(Ju={}));var Bp;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===xu.Left?1:2,command:i.toInternal(s,n),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}r.from=e})(Bp||(Bp={}));var Wp;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:i.toInternal(s,n),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}r.from=e})(Wp||(Wp={}));var Vp;(function(r){function e(t){return{transientOutputs:t?.transientOutputs??!1,transientCellMetadata:t?.transientCellMetadata??{},transientDocumentMetadata:t?.transientDocumentMetadata??{},cellContentMetadata:t?.cellContentMetadata??{}}}r.from=e})(Vp||(Vp={}));var Xu;(function(r){function e(i){return{uri:i.uri,provides:i.provides}}r.from=e;function t(i){return new Zw(b.revive(i.uri),i.provides)}r.to=t})(Xu||(Xu={}));var uo;(function(r){function e(i){return{message:De.fromStrict(i.message)||"",type:0,expected:i.expectedOutput,actual:i.actualOutput,contextValue:i.contextValue,location:i.location&&{range:$.from(i.location.range),uri:i.location.uri}}}r.from=e;function t(i){const n=new Du(typeof i.message=="string"?i.message:De.to(i.message));return n.actualOutput=i.actual,n.expectedOutput=i.expected,n.contextValue=i.contextValue,n.location=i.location?oi.to(i.location):void 0,n}r.to=t})(uo||(uo={}));var Ii;(function(r){r.namespace=kl,r.denamespace=nw})(Ii||(Ii={}));var tr;(function(r){function e(i){const n=Ol(i).controllerId;return{extId:me.fromExtHostTestItem(i,n).toString(),label:i.label,uri:b.revive(i.uri),busy:i.busy,tags:i.tags.map(s=>Ii.namespace(n,s.id)),range:Be.lift($.from(i.range)),description:i.description||null,sortText:i.sortText||null,error:i.error&&De.fromStrict(i.error)||null}}r.from=e;function t(i){return{parent:void 0,error:void 0,id:me.fromString(i.extId).localId,label:i.label,uri:b.revive(i.uri),tags:(i.tags||[]).map(n=>{const{tagId:s}=Ii.denamespace(n);return new Ma(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:$.to(i.range||void 0),canResolveChildren:!1,busy:i.busy,description:i.description||void 0,sortText:i.sortText||void 0}}r.toPlain=t})(tr||(tr={})),function(r){function e(i){return{id:i.id}}r.from=e;function t(i){return new Ma(i.id)}r.to=t}(Ii||(Ii={}));var zp;(function(r){const e=(i,n)=>{const s=[];for(const[a,c]of n)me.compare(c.item.extId,a)===2&&(n.delete(a),s.push(c));const o={...tr.toPlain(i.item),parent:void 0,taskStates:i.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(uo.to)})),children:s.map(a=>e(a,n))};for(const a of o.children)a.parent=o;return o};function t(i){const n=[],s=new Map;for(const o of i.items){s.set(o.item.extId,o);const a=me.root(o.item.extId);i.request.targets.some(c=>c.controllerId===a&&c.testIds.includes(o.item.extId))&&n.push(o)}return{completedAt:i.completedAt,results:n.map(o=>e(o,s))}}r.to=t})(zp||(zp={}));var Yu;(function(r){function e(s){return{covered:s.covered,total:s.total}}function t(s){return"line"in s?He.from(s):$.from(s)}function i(s){return"branches"in s?{count:s.executed,location:t(s.location),type:1,branches:s.branches.length?s.branches.map(o=>({count:o.executed,location:o.location&&t(o.location),label:o.label})):void 0}:{type:0,name:s.name,count:s.executed,location:t(s.location)}}r.fromDetailed=i;function n(s){return{uri:s.uri,statement:e(s.statementCoverage),branch:s.branchCoverage&&e(s.branchCoverage),declaration:s.declarationCoverage&&e(s.declarationCoverage),details:s.detailedCoverage?.map(i)}}r.fromFile=n})(Yu||(Yu={}));var qp;(function(r){function e(t){switch(t){case 1:return Ca.Invoke;case 2:return Ca.Automatic}}r.to=e})(qp||(qp={}));var Zr;(function(r){function e(i){const n=new lp(vi.to(i.kind),i.name,i.detail||"",b.revive(i.uri),$.to(i.range),$.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,kind:vi.from(i.kind),name:i.name,detail:i.detail??"",uri:i.uri,range:$.from(i.range),selectionRange:$.from(i.selectionRange),tags:i.tags?.map(pn.from)}}r.from=t})(Zr||(Zr={}));var Zu;(function(r){function e(t){if(t)return{value:t.value,tooltip:t.tooltip}}r.from=e})(Zu||(Zu={}));var ed;(function(r){function e(s,o,a){const c=o.fileData;return c?new z4(new q4(c.name,b.revive(c.uri),c.id,fh(()=>a(c.id)))):s===an.uriList&&o.uriListData?new ou(n(o.uriListData)):new ou(o.asString)}r.to=e;async function t(s,o){const a=await o.asString();if(s===an.uriList)return{asString:a,fileData:void 0,uriListData:i(a)};const c=o.asFile();return{asString:a,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}r.from=t;function i(s){return Yh.split(s).map(o=>{if(o.startsWith("#"))return o;try{return b.parse(o)}catch{}return o})}function n(s){return Yh.create(s.map(o=>typeof o=="string"?o:b.revive(o)))}})(ed||(ed={}));var ir;(function(r){function e(i,n){const s=i.items.map(([o,a])=>[o,ed.to(o,a,n)]);return new Pa(s)}r.toDataTransfer=e;async function t(i){const n={items:[]},s=[];for(const[o,a]of i)s.push((async()=>{n.items.push([o,await ed.from(o,a)])})());return await Promise.all(s),n}r.from=t})(ir||(ir={}));var Ka;(function(r){function e(i,n){return{kind:"reply",agentId:i.participant??n?.agentId??"",subCommand:i.command??n?.command,message:i.prompt,title:i.label}}r.from=e;function t(i){return{prompt:i.message,label:i.title,participant:i.agentId,command:i.subCommand}}r.to=t})(Ka||(Ka={}));var jp;(function(r){function e(t){return"commandId"in t?{kind:"command",title:t.title??"",commandId:t.commandId??"",when:t.when??"",args:t.args}:{kind:"reply",message:t.message,title:t.title,tooltip:t.tooltip}}r.from=e})(jp||(jp={}));var td;(function(r){function e(i){switch(i.role){case 0:return new _p(i.content);case 1:return new wp(i.content);case 2:return new bp(i.content)}}r.to=e;function t(i){if(i instanceof _p)return{role:0,content:i.content};if(i instanceof wp)return{role:1,content:i.content};if(i instanceof bp)return{role:2,content:i.content};throw new Error("Invalid LanguageModelMessage")}r.from=t})(td||(td={}));var ho;(function(r){function e(n){const s={};for(const o of Object.keys(n))s[o]=n[o].map(r.to);return s}r.objectTo=e;function t(n){return{level:id.to(n.level),kind:n.kind,value:kh(n.value)?b.revive(n.value):n.value,description:n.description}}r.to=t;function i(n){return{level:id.from(n.level),kind:n.kind,value:n.value,description:n.description}}r.from=i})(ho||(ho={}));var id;(function(r){function e(i){switch(i){case"short":return fn.Short;case"medium":return fn.Medium;case"full":default:return fn.Full}}r.to=e;function t(i){switch(i){case fn.Short:return"short";case fn.Medium:return"medium";case fn.Full:default:return"full"}}r.from=t})(id||(id={}));var Gp;(function(r){function e(t){switch(t){case 1:return Xn.Helpful;case 0:return Xn.Unhelpful;case 2:return Xn.Undone;case 3:return Xn.Accepted;case 4:return Xn.Bug}}r.to=e})(Gp||(Gp={}));var Ja;(function(r){function e(i){return{kind:"markdownContent",content:De.from(i.value)}}r.to=e;function t(i){return new Pu(De.to(i.content))}r.from=t})(Ja||(Ja={}));var Xa;(function(r){function e(i){const{value:n,baseUri:s}=i;function o(a,c){return a.map(l=>{const u=b.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:Dr(s),uri:s,children:o(n,s)}}}r.to=e;function t(i){const n=Hi(i.treeData);function s(c){return c.map(l=>({name:l.label,children:l.children&&s(l.children)}))}const o=n.uri,a=n.children?s(n.children):[];return new Tu(a,o)}r.from=t})(Xa||(Xa={}));var Ya;(function(r){function e(i){return{kind:"inlineReference",name:i.title,inlineReference:b.isUri(i.value)?i.value:Yn.from(i.value)}}r.to=e;function t(i){const n=Hi(i);return new Au(b.isUri(n.inlineReference)?n.inlineReference:Yn.to(n.inlineReference),i.name)}r.from=t})(Ya||(Ya={}));var Za;(function(r){function e(i){return{kind:"progressMessage",content:De.from(i.value)}}r.to=e;function t(i){return new Ua(i.content.value)}r.from=t})(Za||(Za={}));var nd;(function(r){function e(i,n,s){return{kind:"command",command:n.toInternal(i.value,s)??{command:i.value.command,title:i.value.title}}}r.to=e;function t(i,n){return new vp(n.fromInternal(i.command)??{command:i.command.id,title:i.command.title})}r.from=t})(nd||(nd={}));var fo;(function(r){function e(i){return{kind:"reference",reference:b.isUri(i.value)?i.value:Yn.from(i.value)}}r.to=e;function t(i){const n=Hi(i);return new Ba(b.isUri(n.reference)?n.reference:Yn.to(n.reference))}r.from=t})(fo||(fo={}));var ec;(function(r){function e(n){return n instanceof Pu?Ja.to(n):n instanceof Au?Ya.to(n):n instanceof Ba?fo.to(n):n instanceof Ua?Za.to(n):n instanceof Tu?Xa.to(n):{kind:"content",content:""}}r.to=e;function t(n,s){switch(n.kind){case"reference":return fo.from(n);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return i(n,s)}}r.from=t;function i(n,s){switch(n.kind){case"markdownContent":return Ja.from(n);case"inlineReference":return Ya.from(n);case"progressMessage":return;case"treeData":return Xa.from(n);case"command":return nd.from(n,s)}}r.fromContent=i})(ec||(ec={}));var rd;(function(r){function e(n,s){return"markdownContent"in s?(N(n,"chatParticipantAdditions"),{content:De.from(s.markdownContent),kind:"markdownContent"}):"content"in s?"vulnerabilities"in s&&s.vulnerabilities?(N(n,"chatParticipantAdditions"),{content:s.content,vulnerabilities:s.vulnerabilities,kind:"vulnerability"}):typeof s.content=="string"?{content:s.content,kind:"content"}:(N(n,"chatParticipantAdditions"),{content:De.from(s.content),kind:"markdownContent"}):"documents"in s?{documents:s.documents.map(o=>({uri:o.uri,version:o.version,ranges:o.ranges.map(a=>$.from(a))})),kind:"usedContext"}:"reference"in s?{reference:"uri"in s.reference?{uri:s.reference.uri,range:$.from(s.reference.range)}:s.reference,kind:"reference"}:"inlineReference"in s?{inlineReference:"uri"in s.inlineReference?{uri:s.inlineReference.uri,range:$.from(s.inlineReference.range)}:s.inlineReference,name:s.title,kind:"inlineReference"}:"participant"in s?(N(n,"chatParticipantAdditions"),{agentName:s.participant,command:s.command,kind:"agentDetection"}):"message"in s?{content:De.from(s.message),kind:"progressMessage"}:void 0}r.from=e;function t(n){switch(n.kind){case"markdownContent":case"inlineReference":case"treeData":return r.to(n);case"content":return{content:n.content};case"usedContext":return{documents:n.documents.map(s=>({uri:b.revive(s.uri),version:s.version,ranges:s.ranges.map(o=>$.to(o))}))};case"reference":return{reference:kh(n.reference)?b.revive(n.reference):Yn.to(n.reference)};case"agentDetection":return;case"progressMessage":return{message:n.content.value};case"vulnerability":return{content:n.content,vulnerabilities:n.vulnerabilities};default:return}}r.to=t;function i(n,s){switch(n.kind){case"markdownContent":return{content:n.content.value};case"inlineReference":return{inlineReference:kh(n.inlineReference)?b.revive(n.inlineReference):Yn.to(n.inlineReference),title:n.name};case"command":return{command:s.fromInternal(n.command)??{command:n.command.id,title:n.command.title}};default:return}}r.toProgressContent=i})(rd||(rd={}));var Qp;(function(r){function e(t){return{prompt:t.message,command:t.command,variables:t.variables.variables.map(sd.to)}}r.to=e})(Qp||(Qp={}));var sd;(function(r){function e(t){return{name:t.name,range:[t.range.start,t.range.endExclusive],values:t.values.map(ho.to)}}r.to=e})(sd||(sd={}));var Kp;(function(r){function e(t){return{label:t.label,values:t.values.map(ho.from),insertText:t.insertText,detail:t.detail,documentation:t.documentation}}r.from=e})(Kp||(Kp={}));var po;(function(r){function e(t){return{errorDetails:t.errorDetails,metadata:t.metadata}}r.to=e})(po||(po={}));var Jp;(function(r){function e(t,i,n){if(i.action.kind==="vote")return;const s=po.to(t);return i.action.kind==="command"?{action:{kind:"command",commandButton:rd.toProgressContent(i.action.commandButton,n)},result:s}:i.action.kind==="followUp"?{action:{kind:"followUp",followup:Ka.to(i.action.followup)},result:s}:{action:i.action,result:s}}r.to=e})(Jp||(Jp={}));var od;(function(r){function e(t,i,n){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:i.toInternal(t,n)}r.from=e})(od||(od={}));var Xp;(function(r){function e(t,i){return{id:i,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||0,contextValue:t.contextValue}}r.from=e})(Xp||(Xp={}));const l0="⟪ ",u0=" characters skipped ⟫",oE=(l0.length+u0.length+5)*2;ee("searchService");function aE(r){return!!r.preview}class cE{constructor(e,t,i,n){this.ranges=t,this.webviewIndex=n;const s=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&lE(s)){e=cx(e,i.matchLines);let o="",a=0,c=0;const l=Math.floor(i.charsPerLine/5),u=[];for(const h of s){const f=Math.max(h.startColumn-l,0),d=h.startColumn+i.charsPerLine;if(f>c+l+oE){const _=l0+(f-c)+u0;o+=_+e.slice(f,d),a+=f-(c+_.length)}else o+=e.slice(c,d);u.push(new uE(0,h.startColumn-a,h.endColumn-a)),c=d}this.preview={text:o,matches:Array.isArray(this.ranges)?u:u[0]}}else{const o=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber;this.preview={text:e,matches:Uo(t,a=>new d0(a.startLineNumber-o,a.startColumn,a.endLineNumber-o,a.endColumn))}}}}function lE(r){const e=r[0].startLineNumber;for(const t of r)if(t.startLineNumber!==e||t.endLineNumber!==e)return!1;return!0}class d0{constructor(e,t,i,n){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n}}class uE extends d0{constructor(e,t,i){super(e,t,e,i)}}function dE(r,e=!0){const t=r&&r.files&&r.files.exclude,i=e&&r&&r.search&&r.search.exclude;if(!t&&!i)return;if(!t||!i)return t||i;let n=Object.create(null);return n=Ar(n,ct(t)),n=Ar(n,ct(i),!0),n}function h0(r,e){return r.excludePattern&&ga(r.excludePattern,e)?!1:r.includePattern||r.usingSearchPaths?r.includePattern&&ga(r.includePattern,e)?!0:r.usingSearchPaths?!!r.folderQueries&&r.folderQueries.some(t=>{const i=t.folder.fsPath;if(rl(e,i)){const n=jo(i,e);return!t.includePattern||!!ga(t.includePattern,n)}else return!1}):!1:!0}var f0;(function(r){r[r.unknownEncoding=1]="unknownEncoding",r[r.regexParseError=2]="regexParseError",r[r.globParseError=3]="globParseError",r[r.invalidLiteral=4]="invalidLiteral",r[r.rgProcessError=5]="rgProcessError",r[r.other=6]="other",r[r.canceled=7]="canceled"})(f0||(f0={}));function ad(r,e){const t={...r||{},...e||{}};return Object.keys(t).filter(i=>{const n=t[i];return typeof n=="boolean"&&n})}class p0{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression={...e.excludePattern||{},...t.excludePattern||{}},this._parsedExcludeExpression=Os(this._excludeExpression);let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this._parsedIncludeExpression=Os(i))}matchesExcludesSync(e,t,i){return!!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const n=this._parsedExcludeExpression(e,t,i),s=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,i):!0;return Mn(n)?n.then(o=>o?!1:s()):s()}hasSiblingExcludeClauses(){return hE(this._excludeExpression)}}function hE(r){for(const e in r)if(typeof r[e]!="boolean")return!0;return!1}function fE(r){if(!r)return;let e;return t=>(e||(e=(r()||Promise.resolve([])).then(i=>i?g0(i):{})),e.then(i=>!!i[t]))}function pE(r){if(!r)return;let e;return t=>{if(!e){const i=r();e=i?g0(i):{}}return!!e[t]}}function g0(r){const e={};for(const t of r)e[t]=!0;return e}function tc(r,e,t){return new Jo(i=>Yp(i,t)).isEqual(r,e)}function gE(r,e,t){return tc(r.uri,e.uri,t)?0:Sr(r.uri.toString(),e.uri.toString())}function mE(r,e,t){return r.index!==e.index?r.index<e.index?-1:1:tc(r.uri,e.uri,t)?Sr(r.name,e.name):Sr(r.uri.toString(),e.uri.toString())}function m0(r,e,t,i){const n=r.slice(0).sort((o,a)=>t(o,a,i)),s=e.slice(0).sort((o,a)=>t(o,a,i));return Hy(n,s,(o,a)=>t(o,a,i))}function Yp(r,e){const t=e.getCapabilities(r.scheme);return!(t&&t&1024)}class go extends DC{static toExtHostWorkspace(e,t,i,n){if(!e)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:c,transient:l,isUntitled:u}=e,h=[],f=t;t?a.forEach((x,k)=>{const S=b.revive(x.uri),D=go._findFolder(i||t,S,n);D?(D.name=x.name,D.index=x.index,h.push(D)):h.push({uri:S,name:x.name,index:k})}):h.push(...a.map(({uri:x,name:k,index:S})=>({uri:b.revive(x),name:k,index:S}))),h.sort((x,k)=>x.index<k.index?-1:1);const d=new go(s,o,h,!!l,c?b.revive(c):null,!!u,x=>Yp(x,n)),{added:_,removed:w}=m0(f?f.workspaceFolders:[],d.workspaceFolders,gE,n);return{workspace:d,added:_,removed:w}}static _findFolder(e,t,i){for(let n=0;n<e.folders.length;n++){const s=e.workspaceFolders[n];if(tc(s.uri,t,i))return s}}constructor(e,t,i,n,s,o,a){super(e,i.map(c=>new v_(c)),n,s,a),this._name=t,this._isUntitled=o,this._workspaceFolders=[],this._structure=hi.forUris(a),i.forEach(c=>{this._workspaceFolders.push(c),this._structure.set(c.uri,c)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=Fh(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let Zp=class{constructor(e,t,i,n,s){this._onDidChangeWorkspace=new P,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new P,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new Vo,this._canonicalUriProviders=new Map,this._logService=n,this._extHostFileSystemInfo=i,this._uriTransformerService=s,this._requestIdProvider=new EC,this._barrier=new rn,this._proxy=e.getProxy(j.MainThreadWorkspace),this._messageService=e.getProxy(j.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new go(o.id,o.name,[],!!o.transient,o.configuration?b.revive(o.configuration):null,!!o.isUntitled,a=>Yp(a,i)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?b.from({scheme:K.untitled,path:Dr(Fh(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,i,...n){const s=[];if(Array.isArray(n)&&n.forEach(u=>{b.isUri(u.uri)&&!s.some(h=>tc(h.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||Nh(u.uri)})}),this._unconfirmedWorkspace||[t,i].some(u=>typeof u!="number"||u<0)||i===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+i>o.length)return!1;const a=o.slice(0);a.splice(t,i,...s.map(u=>({uri:u.uri,name:u.name||Nh(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const h=a[u];if(a.some((f,d)=>d!==u&&tc(h.uri,f.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,h)=>u.index=h);const{added:c,removed:l}=m0(o,a,mE,this._extHostFileSystemInfo);if(c.length===0&&l.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,i,s).then(void 0,h=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(kC.Error,g("vs/workbench/api/common/extHostWorkspace","updateerror","Extension '{0}' failed to update workspace folders: {1}",u,h.toString()),f,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let i,n="";if(typeof e=="string"?(i=b.file(e),n=e):typeof e<"u"&&(i=e,n=e.fsPath),!i)return n;const s=this.getWorkspaceFolder(i,!0);if(!s)return n;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let o=Wv(s.uri,i);return t&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=go.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:i,removed:n}=go.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:i,removed:n}))}findFiles(e,t,i,n,s=yt.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${n.value}, entryPoint: findFiles`);let o="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?o=t:o=t.pattern),this._findFilesImpl(e,void 0,{exclude:o,maxResults:i,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},s)}findFiles2(e,t={},i,n=yt.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${i.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,n)}async _findFilesImpl(e,t,i,n=yt.None){if(n&&n.isCancellationRequested)return Promise.resolve([]);const s=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,o={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!1,disregardSearchExcludeSettings:typeof i.useDefaultSearchExcludes=="boolean"?!i.useDefaultSearchExcludes:!1,maxResults:i.maxResults,excludePattern:s,shouldGlobSearch:typeof i.fuzzy=="boolean"?!i.fuzzy:!0,_reason:"startFileSearch"};let a;if(e){const{includePattern:c,folder:l}=eg(Yt.from(e));a=l,o.includePattern=c}else{const{includePattern:c,folder:l}=eg(Yt.from(t));a=l,o.filePattern=c}return this._proxy.$startFileSearch(a??null,o,n).then(c=>Array.isArray(c)?c.map(l=>b.revive(l)):[])}async findTextInFiles(e,t,i,n,s=yt.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${n.value}, entryPoint: findTextInFiles`);const o=this._requestIdProvider.getNext(),a=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:c,folder:l}=eg(Yt.from(t.include)),u=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,h={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:c,excludePattern:u};if(this._activeSearchCallbacks[o]=f=>{const d=b.revive(f.resource);f.results.forEach(_=>{const w=Hi(_);aE(w)?i({uri:d,preview:{text:w.preview.text,matches:Uo(w.preview.matches,x=>new ve(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn))},ranges:Uo(w.ranges,x=>new ve(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn))}):i({uri:d,text:w.text,lineNumber:w.lineNumber})})},s.isCancellationRequested)return{};try{const f=await this._proxy.$startTextSearch(e,l??null,h,o,s);return delete this._activeSearchCallbacks[o],f||{}}catch(f){throw delete this._activeSearchCallbacks[o],f}}$handleTextSearchResult(e,t){this._activeSearchCallbacks[t]?.(e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return b.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return b.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(n,i),Te(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(n)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const i=await this.resolveWorkspaceFolder(b.revive(e));if(!i){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",i);const n=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!n),!n)return;const s=await n.provideEditSessionIdentity(i,t);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(e,t,i,n){this._logService.info("Getting edit session identifier for workspaceFolder",e);const s=await this.resolveWorkspaceFolder(b.revive(e));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await o.provideEditSessionIdentityMatch?.(t,i,n);if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,n)}}async $onWillCreateEditSessionIdentity(e,t,i){const n=await this.resolveWorkspaceFolder(b.revive(e));if(n===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:n},t,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>i&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(n,i),Te(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(n)})}async provideCanonicalUri(e,t,i){const n=this._canonicalUriProviders.get(e.scheme);if(!n)return;const s=await n.provideCanonicalUri?.(b.revive(e),t,i);if(s)return s}async $provideCanonicalUri(e,t,i){return this.provideCanonicalUri(b.revive(e),{targetScheme:t},i)}};Zp=F([O(0,Ue),O(1,At),O(2,Ds),O(3,ze),O(4,hl)],Zp);const gn=ee("IExtHostWorkspace");function eg(r){let e,t;return r&&(typeof r=="string"?e=r:(e=r.pattern,t=b.revive(r.baseUri))),{includePattern:e,folder:t}}var tg;(function(r){r.DEFAULT={allowTrailingComma:!0}})(tg||(tg={}));function vE(r,e=!1){let t=0;const i=r.length;let n="",s=0,o=16,a=0;function c(w){let x=0,k=0;for(;x<w;){const S=r.charCodeAt(t);if(S>=48&&S<=57)k=k*16+S-48;else if(S>=65&&S<=70)k=k*16+S-65+10;else if(S>=97&&S<=102)k=k*16+S-97+10;else break;t++,x++}return x<w&&(k=-1),k}function l(w){t=w,n="",s=0,o=16,a=0}function u(){const w=t;if(r.charCodeAt(t)===48)t++;else for(t++;t<r.length&&mo(r.charCodeAt(t));)t++;if(t<r.length&&r.charCodeAt(t)===46)if(t++,t<r.length&&mo(r.charCodeAt(t)))for(t++;t<r.length&&mo(r.charCodeAt(t));)t++;else return a=3,r.substring(w,t);let x=t;if(t<r.length&&(r.charCodeAt(t)===69||r.charCodeAt(t)===101))if(t++,(t<r.length&&r.charCodeAt(t)===43||r.charCodeAt(t)===45)&&t++,t<r.length&&mo(r.charCodeAt(t))){for(t++;t<r.length&&mo(r.charCodeAt(t));)t++;x=t}else a=3;return r.substring(w,x)}function h(){let w="",x=t;for(;;){if(t>=i){w+=r.substring(x,t),a=2;break}const k=r.charCodeAt(t);if(k===34){w+=r.substring(x,t),t++;break}if(k===92){if(w+=r.substring(x,t),t++,t>=i){a=2;break}switch(r.charCodeAt(t++)){case 34:w+='"';break;case 92:w+="\\";break;case 47:w+="/";break;case 98:w+="\b";break;case 102:w+="\f";break;case 110:w+=`
`;break;case 114:w+="\r";break;case 116:w+="	";break;case 117:{const D=c(4);D>=0?w+=String.fromCharCode(D):a=4;break}default:a=5}x=t;continue}if(k>=0&&k<=31)if(cd(k)){w+=r.substring(x,t),a=2;break}else a=6;t++}return w}function f(){if(n="",a=0,s=t,t>=i)return s=i,o=17;let w=r.charCodeAt(t);if(ig(w)){do t++,n+=String.fromCharCode(w),w=r.charCodeAt(t);while(ig(w));return o=15}if(cd(w))return t++,n+=String.fromCharCode(w),w===13&&r.charCodeAt(t)===10&&(t++,n+=`
`),o=14;switch(w){case 123:return t++,o=1;case 125:return t++,o=2;case 91:return t++,o=3;case 93:return t++,o=4;case 58:return t++,o=6;case 44:return t++,o=5;case 34:return t++,n=h(),o=10;case 47:{const x=t-1;if(r.charCodeAt(t+1)===47){for(t+=2;t<i&&!cd(r.charCodeAt(t));)t++;return n=r.substring(x,t),o=12}if(r.charCodeAt(t+1)===42){t+=2;const k=i-1;let S=!1;for(;t<k;){if(r.charCodeAt(t)===42&&r.charCodeAt(t+1)===47){t+=2,S=!0;break}t++}return S||(t++,a=1),n=r.substring(x,t),o=13}return n+=String.fromCharCode(w),t++,o=16}case 45:if(n+=String.fromCharCode(w),t++,t===i||!mo(r.charCodeAt(t)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=u(),o=11;default:for(;t<i&&d(w);)t++,w=r.charCodeAt(t);if(s!==t){switch(n=r.substring(s,t),n){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return n+=String.fromCharCode(w),t++,o=16}}function d(w){if(ig(w)||cd(w))return!1;switch(w){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function _(){let w;do w=f();while(w>=12&&w<=15);return w}return{setPosition:l,getPosition:()=>t,scan:e?_:f,getToken:()=>o,getTokenValue:()=>n,getTokenOffset:()=>s,getTokenLength:()=>t-s,getTokenError:()=>a}}function ig(r){return r===32||r===9||r===11||r===12||r===160||r===5760||r>=8192&&r<=8203||r===8239||r===8287||r===12288||r===65279}function cd(r){return r===10||r===13||r===8232||r===8233}function mo(r){return r>=48&&r<=57}function _E(r,e,t=tg.DEFAULT){const i=vE(r,!1);function n(fe){return fe?()=>fe(i.getTokenOffset(),i.getTokenLength()):()=>!0}function s(fe){return fe?we=>fe(we,i.getTokenOffset(),i.getTokenLength()):()=>!0}const o=n(e.onObjectBegin),a=s(e.onObjectProperty),c=n(e.onObjectEnd),l=n(e.onArrayBegin),u=n(e.onArrayEnd),h=s(e.onLiteralValue),f=s(e.onSeparator),d=n(e.onComment),_=s(e.onError),w=t&&t.disallowComments,x=t&&t.allowTrailingComma;function k(){for(;;){const fe=i.scan();switch(i.getTokenError()){case 4:S(14);break;case 5:S(15);break;case 3:S(13);break;case 1:w||S(11);break;case 2:S(12);break;case 6:S(16);break}switch(fe){case 12:case 13:w?S(10):d();break;case 16:S(1);break;case 15:case 14:break;default:return fe}}}function S(fe,we=[],z=[]){if(_(fe),we.length+z.length>0){let B=i.getToken();for(;B!==17;){if(we.indexOf(B)!==-1){k();break}else if(z.indexOf(B)!==-1)break;B=k()}}}function D(fe){const we=i.getTokenValue();return fe?h(we):a(we),k(),!0}function U(){switch(i.getToken()){case 11:{let fe=0;try{fe=JSON.parse(i.getTokenValue()),typeof fe!="number"&&(S(2),fe=0)}catch{S(2)}h(fe);break}case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return k(),!0}function R(){return i.getToken()!==10?(S(3,[],[2,5]),!1):(D(!1),i.getToken()===6?(f(":"),k(),ie()||S(4,[],[2,5])):S(5,[],[2,5]),!0)}function H(){o(),k();let fe=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(fe||S(4,[],[]),f(","),k(),i.getToken()===2&&x)break}else fe&&S(6,[],[]);R()||S(4,[],[2,5]),fe=!0}return c(),i.getToken()!==2?S(7,[2],[]):k(),!0}function le(){l(),k();let fe=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(fe||S(4,[],[]),f(","),k(),i.getToken()===4&&x)break}else fe&&S(6,[],[]);ie()||S(4,[],[4,5]),fe=!0}return u(),i.getToken()!==4?S(8,[4],[]):k(),!0}function ie(){switch(i.getToken()){case 3:return le();case 1:return H();case 10:return D(!0);default:return U()}}return k(),i.getToken()===17?t.allowEmptyContent?!0:(S(4,[],[]),!1):ie()?(i.getToken()!==17&&S(9,[],[]),!0):(S(4,[],[]),!1)}const ng=ee("configurationService");function rg(r,e){const t=Object.create(null);for(const i in r)v0(t,i,r[i],e);return t}function v0(r,e,t,i){const n=e.split("."),s=n.pop();let o=r;for(let a=0;a<n.length;a++){const c=n[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function wE(r,e){const t=e.split(".");_0(r,t)}function _0(r,e){const t=e.shift();if(e.length===0){delete r[t];return}if(Object.keys(r).indexOf(t)!==-1){const i=r[t];typeof i=="object"&&!Array.isArray(i)&&(_0(i,e),Object.keys(i).length===0&&delete r[t])}}function ld(r,e,t){function i(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const n=e.split("."),s=i(r,n);return typeof s>"u"?t:s}function bE(r){return r.replace(/[\[\]]/g,"")}const sg={JSONContribution:"base.contributions.json"};function yE(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}class xE{constructor(){this._onDidChangeSchema=new P,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){this.schemasById[yE(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}}const CE=new xE;ri.add(sg.JSONContribution,CE);var w0;(function(r){r.Multiline="multilineText",r.Singleline="singlelineText"})(w0||(w0={}));const ud={Configuration:"base.contributions.configuration"};var b0;(function(r){r[r.APPLICATION=1]="APPLICATION",r[r.MACHINE=2]="MACHINE",r[r.WINDOW=3]="WINDOW",r[r.RESOURCE=4]="RESOURCE",r[r.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",r[r.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(b0||(b0={}));const vo="vscode://schemas/settings/resourceLanguage",dd=ri.as(sg.JSONContribution);class SE{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new P,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new P,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:g("vs/platform/configuration/common/configurationRegistry","defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},dd.registerSchema(vo,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),dd.registerSchema(vo,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),dd.registerSchema(vo,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),dd.registerSchema(vo,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){const i=[];for(const{overrides:n,source:s}of e)for(const o in n)if(t.add(o),ji.test(o)){const a=this.configurationDefaultsOverrides.get(o),c=a?.valuesSources??new Map;if(s)for(const f of Object.keys(n[o]))c.set(f,s);const l={...a?.value||{},...n[o]};this.configurationDefaultsOverrides.set(o,{source:s,value:l,valuesSources:c});const u=bE(o),h={type:"object",default:l,description:g("vs/platform/configuration/common/configurationRegistry","defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",u),$ref:vo,defaultDefaultValue:l,source:Le(s)?void 0:s,defaultValueSource:s};i.push(...ic(o)),this.configurationProperties[o]=h,this.defaultLanguageConfigurationOverridesNode.properties[o]=h}else{this.configurationDefaultsOverrides.set(o,{value:n[o],source:s});const a=this.configurationProperties[o];a&&(this.updatePropertyDefaultValue(o,a),this.updateSchema(o,a))}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(const{overrides:i,source:n}of e)for(const s in i){const o=this.configurationDefaultsOverrides.get(s),a=Le(n)?n:n?.id,c=Le(o?.source)?o?.source:o?.source?.id;if(a===c)if(t.add(s),this.configurationDefaultsOverrides.delete(s),ji.test(s))delete this.configurationProperties[s],delete this.defaultLanguageConfigurationOverridesNode.properties[s];else{const l=this.configurationProperties[s];l&&(this.updatePropertyDefaultValue(s,l),this.updateSchema(s,l))}}this.updateOverridePropertyPatternKey()}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(e,t){const i=n=>{if(n.properties)for(const s in n.properties){t.add(s);const o=this.configurationProperties[s];o?.policy?.name&&this.policyConfigurations.delete(o.policy.name),delete this.configurationProperties[s],this.removeFromSchema(s,n.properties[s])}n.allOf?.forEach(s=>i(s))};for(const n of e){i(n);const s=this.configurationContributors.indexOf(n);s!==-1&&this.configurationContributors.splice(s,1)}}validateAndRegisterProperties(e,t=!0,i,n,s=3,o){s=Lt(e.scope)?s:e.scope;const a=e.properties;if(a)for(const l in a){const u=a[l];if(t&&DE(l,u)){delete a[l];continue}if(u.source=i,u.defaultDefaultValue=a[l].default,this.updatePropertyDefaultValue(l,u),ji.test(l)?u.scope=void 0:(u.scope=Lt(u.scope)?s:u.scope,u.restricted=Lt(u.restricted)?!!n?.includes(l):u.restricted),a[l].hasOwnProperty("included")&&!a[l].included){this.excludedConfigurationProperties[l]=a[l],delete a[l];continue}else this.configurationProperties[l]=a[l],a[l].policy?.name&&this.policyConfigurations.set(a[l].policy.name,l);!a[l].deprecationMessage&&a[l].markdownDeprecationMessage&&(a[l].deprecationMessage=a[l].markdownDeprecationMessage),o.add(l)}const c=e.allOf;if(c)for(const l of c)this.validateAndRegisterProperties(l,t,i,n,s,o)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getConfigurationDefaultsOverrides(){return this.configurationDefaultsOverrides}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);i.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:case 5:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:g("vs/platform/configuration/common/configurationRegistry","overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:g("vs/platform/configuration/common/configurationRegistry","overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:vo};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){g("vs/platform/configuration/common/configurationRegistry","overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),g("vs/platform/configuration/common/configurationRegistry","overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let n=i?.value,s=i?.source;Oh(n)&&(n=t.defaultDefaultValue,s=void 0),Oh(n)&&(n=kE(t.type)),t.default=n,t.defaultValueSource=s}}const y0="\\[([^\\]]+)\\]",x0=new RegExp(y0,"g"),EE=`^(${y0})+$`,ji=new RegExp(EE);function ic(r){const e=[];if(ji.test(r)){let t=x0.exec(r);for(;t?.length;){const i=t[1].trim();i&&e.push(i),t=x0.exec(r)}}return gs(e)}function kE(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const hd=new SE;ri.add(ud.Configuration,hd);function DE(r,e){return r.trim()?ji.test(r)?g("vs/platform/configuration/common/configurationRegistry","config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):hd.getConfigurationProperties()[r]!==void 0?g("vs/platform/configuration/common/configurationRegistry","config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):e.policy?.name&&hd.getPolicyConfigurations().get(e.policy?.name)!==void 0?g("vs/platform/configuration/common/configurationRegistry","config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,e.policy?.name,hd.getPolicyConfigurations().get(e.policy?.name)):null:g("vs/platform/configuration/common/configurationRegistry","config.property.empty","Cannot register an empty property")}function nc(r){return Object.isFrozen(r)?r:Kh(r)}class zt{constructor(e={},t=[],i=[],n){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){const e=this.raw.map(t=>{if(t instanceof zt)return t;const i=new IE("");return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?ld(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return nc(i.rawConfiguration.getValue(e))},get override(){return t?nc(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return nc(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:s,identifiers:o,keys:a}of i.rawConfiguration.overrides){const c=new zt(s,a).getValue(e);c!==void 0&&n.push({identifiers:o,value:c})}return n.length?nc(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?ld(i,e):i:void 0}getKeysForOverrideIdentifier(e){const t=[];for(const i of this.overrides)i.identifiers.includes(e)&&t.push(...i.keys);return gs(t)}getAllOverrideIdentifiers(){const e=[];for(const t of this.overrides)e.push(...t.identifiers);return gs(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=ct(this.contents),i=ct(this.overrides),n=[...this.keys],s=this.raw?.length?[...this.raw]:[this];for(const o of e)if(s.push(...o.raw?.length?o.raw:[o]),!o.isEmpty()){this.mergeContents(t,o.contents);for(const a of o.overrides){const[c]=i.filter(l=>Tn(l.identifiers,a.identifiers));c?(this.mergeContents(c.contents,a.contents),c.keys.push(...a.keys),c.keys=gs(c.keys)):i.push(ct(a))}for(const a of o.keys)n.indexOf(a)===-1&&n.push(a)}return new zt(t,n,i,s.every(o=>o instanceof zt)?void 0:s)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of gs([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[n];const o=t[n];o&&(typeof s=="object"&&typeof o=="object"?(s=ct(s),this.mergeContents(s,o)):s=o),i[n]=s}return new zt(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&It(e[i])&&It(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=ct(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=s=>{s&&(i?this.mergeContents(i,s):i=ct(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&n(s.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),wE(this.contents,e),ji.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>Tn(i.identifiers,ic(e))),1))}updateValue(e,t,i){v0(this.contents,e,t,n=>console.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),ji.test(e)&&this.overrides.push({identifiers:ic(e),keys:Object.keys(this.contents[e]),contents:rg(this.contents[e],n=>console.error(n))})}}class IE{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||new zt}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!Lt(e)){const i=this.doParseContent(e);this.parseRaw(i,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:s,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new zt(i,n,s,a?[e]:void 0),this._restrictedConfigurations=o||[]}doParseContent(e){let t={},i=null,n=[];const s=[];function o(c){Array.isArray(n)?n.push(c):i!==null&&(n[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),s.push(n),n=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{n=s.pop()},onArrayBegin:()=>{const c=[];o(c),s.push(n),n=c,i=null},onArrayEnd:()=>{n=s.pop()},onLiteralValue:o,onError:(c,l,u)=>{}};if(e)try{_E(e,a),t=n[0]||{}}catch(c){console.error(`Error while parsing settings file ${this._name}: ${c}`),this._parseErrors=[c]}return t}doParseRaw(e,t){const i=ri.as(ud.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const s=rg(e,c=>console.error(`Conflict in settings file ${this._name}: ${c}`)),o=Object.keys(e),a=this.toOverrides(e,c=>console.error(`Conflict in settings file ${this._name}: ${c}`));return{contents:s,keys:o,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){let s=!1;if(!n?.scopes&&!n?.skipRestricted&&!n?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:s};const o={},a=[];for(const c in e)if(ji.test(c)&&i){const l=this.filter(e[c],t,!1,n);o[c]=l.raw,s=s||l.hasExcludedProperties,a.push(...l.restricted)}else{const l=t[c],u=l?typeof l.scope<"u"?l.scope:3:void 0;l?.restricted&&a.push(c),!n.exclude?.includes(c)&&(n.include?.includes(c)||(u===void 0||n.scopes===void 0||n.scopes.includes(u))&&!(n.skipRestricted&&l?.restricted))?o[c]=e[c]:s=!0}return{raw:o,restricted:a,hasExcludedProperties:s}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(ji.test(n)){const s={};for(const o in e[n])s[o]=e[n][o];i.push({identifiers:ic(n),keys:Object.keys(s),contents:rg(s,t)})}return i}}class PE{constructor(e,t,i,n,s,o,a,c,l,u,h,f,d){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=s,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=c,this.localUserConfiguration=l,this.remoteUserConfiguration=u,this.workspaceConfiguration=h,this.folderConfigurationModel=f,this.memoryConfigurationModel=d}get value(){return nc(this._value)}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let og=class Oy{constructor(e,t,i,n,s=new zt,o=new zt,a=new it,c=new zt,l=new it){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=c,this._memoryConfigurationByResource=l,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new it,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=new zt,this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const c of n.overrides)for(const l of c.identifiers)n.getOverrideValue(e,l)!==void 0&&a.add(l);return new PE(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,s||void 0,o)}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const i=[];if(!t){const{added:n,updated:s,removed:o}=nr(this._defaultConfiguration,e);t=[...n,...s,...o]}for(const n of t)for(const s of ic(n)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=e.getKeysForOverrideIdentifier(s),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!Si(this._defaultConfiguration.override(s).getValue(l),e.override(s).getValue(l)))];i.push([s,c])}return this.updateDefaultConfiguration(e),{keys:t,overrides:i}}compareAndUpdatePolicyConfiguration(e){const{added:t,updated:i,removed:n}=nr(this._policyConfiguration,e),s=[...t,...i,...n];return s.length&&this.updatePolicyConfiguration(e),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=nr(this.applicationConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateApplicationConfiguration(e),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=nr(this.localUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateLocalUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=nr(this.remoteUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateRemoteUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=nr(this.workspaceConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateWorkspaceConfiguration(e),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(e,t){const i=this.folderConfigurations.get(e),{added:n,updated:s,removed:o,overrides:a}=nr(i,t),c=[...n,...s,...o];return(c.length||!i)&&this.updateFolderConfiguration(e,t),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:i,updated:n,removed:s,overrides:o}=nr(t,void 0);return{keys:[...i,...n,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:s}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(i=>e.add(i))),[...e.values()]}allOverrideIdentifiers(){const e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(i=>e.add(i))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n))),[...t.values()]}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.policy),n=this.parseConfigurationModel(e.application),s=this.parseConfigurationModel(e.user),o=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((c,l)=>(c.set(b.revive(l[0]),this.parseConfigurationModel(l[1])),c),new it);return new Oy(t,i,n,s,new zt,o,a,new zt,new it)}static parseConfigurationModel(e){return new zt(e.contents,e.keys,e.overrides)}};class TE{constructor(e,t,i,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const s of e.keys)this.affectedKeys.add(s);for(const[,s]of e.overrides)for(const o of s)this.affectedKeys.add(o);this._affectsConfigStr=this._marker;for(const s of this.affectedKeys)this._affectsConfigStr+=s+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=og.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const s=n+i.length;if(s>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(s);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const a=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.previous?.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!Si(a,c)}return!0}}function nr(r,e){const{added:t,removed:i,updated:n}=C0(e?.rawConfiguration,r?.rawConfiguration),s=[],o=r?.getAllOverrideIdentifiers()||[],a=e?.getAllOverrideIdentifiers()||[];if(e){const c=a.filter(l=>!o.includes(l));for(const l of c)s.push([l,e.getKeysForOverrideIdentifier(l)])}if(r){const c=o.filter(l=>!a.includes(l));for(const l of c)s.push([l,r.getKeysForOverrideIdentifier(l)])}if(e&&r){for(const c of o)if(a.includes(c)){const l=C0({contents:r.getOverrideValue(void 0,c)||{},keys:r.getKeysForOverrideIdentifier(c)},{contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)});s.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:t,removed:i,updated:n,overrides:s}}function C0(r,e){const t=r?e?r.keys.filter(s=>e.keys.indexOf(s)===-1):[...r.keys]:[],i=e?r?e.keys.filter(s=>r.keys.indexOf(s)===-1):[...e.keys]:[],n=[];if(r&&e){for(const s of e.keys)if(r.keys.indexOf(s)!==-1){const o=ld(e.contents,s),a=ld(r.contents,s);Si(o,a)||n.push(s)}}return{added:t,removed:i,updated:n}}function rc(r,e){if(e){const t=e.split(".");let i=r;for(let n=0;i&&n<t.length;n++)i=i[t[n]];return i}}function AE(r){return r instanceof b}function RE(r){return r&&r.uri instanceof b&&r.languageId&&typeof r.languageId=="string"}function LE(r){return r&&!r.uri&&r.languageId&&typeof r.languageId=="string"}function OE(r){return r&&r.uri instanceof b&&(!r.name||typeof r.name=="string")&&(!r.index||typeof r.index=="number")}function S0(r){if(AE(r))return{resource:r};if(RE(r))return{resource:r.uri,overrideIdentifier:r.languageId};if(LE(r))return{overrideIdentifier:r.languageId};if(OE(r))return{resource:r.uri};if(r===null)return{resource:null}}let ag=class{constructor(e,t,i){this._proxy=e.getProxy(j.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=i,this._barrier=new rn,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new $E(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(i=>i.$acceptConfigurationChanged(e,t))}};ag=F([O(0,Ue),O(1,gn),O(2,ze)],ag);class $E{constructor(e,t,i,n){this._onDidChangeConfiguration=new P,this._proxy=e,this._logService=n,this._extHostWorkspace=t,this._configuration=og.parse(i),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=og.parse(e),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const n=S0(t)||{},s=this._toReadonlyValue(e?rc(this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,n,i?.identifier);function o(c){if(c==null)return null;if(typeof c=="boolean")return c?2:5;switch(c){case js.Global:return 2;case js.Workspace:return 5;case js.WorkspaceFolder:return 6}}const a={has(c){return typeof rc(s,c)<"u"},get:(c,l)=>{this._validateConfigurationAccess(e?`${e}.${c}`:c,n,i?.identifier);let u=rc(s,c);if(typeof u>"u")u=l;else{let h;const f=(d,_)=>{if(It(d)){let w;const x=()=>{h=h||ct(s),w=w||rc(h,_)};return new Proxy(d,{get:(k,S)=>{if(typeof S=="string"&&S.toLowerCase()==="tojson")return x(),()=>w;if(h)return w=w||rc(h,_),w[S];const D=k[S];return typeof S=="string"?f(D,`${_}.${S}`):D},set:(k,S,D)=>(x(),w&&(w[S]=D),!0),deleteProperty:(k,S)=>(x(),w&&delete w[S],!0),defineProperty:(k,S,D)=>(x(),w&&Object.defineProperty(w,S,D),!0)})}return Array.isArray(d)?ct(d):d};u=f(u,c)}return u},update:(c,l,u,h)=>{c=e?`${e}.${c}`:c;const f=o(u);return l!==void 0?this._proxy.$updateConfigurationOption(f,c,l,n,h):this._proxy.$removeConfigurationOption(f,c,n,h)},inspect:c=>{c=e?`${e}.${c}`:c;const l=this._configuration.inspect(c,n,this._extHostWorkspace.workspace);if(l)return{key:c,defaultValue:ct(l.policy?.value??l.default?.value),globalValue:ct(l.user?.value??l.application?.value),workspaceValue:ct(l.workspace?.value),workspaceFolderValue:ct(l.workspaceFolder?.value),defaultLanguageValue:ct(l.default?.override),globalLanguageValue:ct(l.user?.override??l.application?.override),workspaceLanguageValue:ct(l.workspace?.override),workspaceFolderLanguageValue:ct(l.workspaceFolder?.override),languageIds:ct(l.overrideIdentifiers)}}};return typeof s=="object"&&Ar(a,s,!1),Object.freeze(a)}_toReadonlyValue(e){const t=i=>It(i)?new Proxy(i,{get:(n,s)=>t(n[s]),set:(n,s,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(n,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(n,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:n=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}_validateConfigurationAccess(e,t,i){const n=ji.test(e)?4:this._configurationScopes.get(e),s=i?`[${i.value}] `:"";if(n===4){typeof t?.resource>"u"&&this._logService.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(n===3){t?.resource&&this._logService.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const i=new TE(e,t,this._configuration,this._extHostWorkspace.workspace);return Object.freeze({affectsConfiguration:(n,s)=>i.affectsConfiguration(n,S0(s))})}_toMap(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}}const mn=ee("IExtHostConfiguration");class NE{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}}class es{static isHostExtension(e,t,i){if(t.getExtensionDescription(e))return!1;const n=i.getExtensionDescription(e);return n?!!((n.main||n.browser)&&n.api==="none"):!1}constructor(e,t){this._activationEventsReader=e,this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(ME),this._extensionsMap=new zn,this._extensionsArr=[],this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);const t=this._activationEventsReader.readActivationEvents(e);for(const i of t)this._activationMap.has(i)||this._activationMap.set(i,[]),this._activationMap.get(i).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(e,t){this._extensionDescriptions=E0(this._extensionDescriptions,t),this._extensionDescriptions=this._extensionDescriptions.concat(e);const i=es._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=E0(this._extensionDescriptions,i.map(n=>n.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new NE(this._versionId,i)}static _findLoopingExtensions(e){const t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this._arcs.has(a)?this._arcs.get(a).push(c):this._arcs.set(a,[c])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,c){const l=t.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this._nodesArr}},i=new zn;for(const a of e)if(i.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)t.addArc(Qe.toKey(a.identifier),Qe.toKey(c));const n=new Set;t.getNodes().filter(a=>t.getArcs(a).length===0).forEach(a=>n.add(a));const s=t.getNodes().filter(a=>!n.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const c=s[a];t.hasOnlyGoodArcs(c,n)&&(s.splice(a,1),a--,n.add(c),o=!0)}}while(o);return s.map(a=>i.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new FE(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(const t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}}class FE{constructor(e,t){this.versionId=e,this.extensions=t}}function ME(r,e){const t=r.isBuiltin?0:r.isUnderDevelopment?2:1,i=e.isBuiltin?0:e.isUnderDevelopment?2:1;if(t!==i)return t-i;const n=$e.basename(r.extensionLocation.path),s=$e.basename(e.extensionLocation.path);return n<s?-1:n>s?1:0}function E0(r,e){const t=new Ns(e);return r.filter(i=>!t.has(i.identifier))}class _o{static{this.NONE=new _o(!1,-1,-1,-1)}constructor(e,t,i,n){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=i,this.activateResolvedTime=n}}class k0{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new _o(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class fd{constructor(e,t,i,n,s,o){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=n,this.exports=s,this.subscriptions=o}}class HE extends fd{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,[])}}class UE extends fd{constructor(){super(!1,null,_o.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}class pd extends fd{constructor(e){super(!0,e,_o.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}let cg=class{constructor(e,t,i,n){this._logService=n,this._registry=e,this._globalRegistry=t,this._host=i,this._operations=new zn,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,i]of this._operations)e.push(i.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const i=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(i.map(n=>({id:n.identifier,reason:{startup:t,extensionId:n.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const i=this._registry.getExtensionDescription(e);if(!i)throw new Error(`Extension '${e}' is not known`);return this._activateExtensions([{id:i.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(i=>!this.isActivated(i.id)).map(i=>this._handleActivationRequest(i));await Promise.all(t.map(i=>i.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const s=new Error(`Cannot activate unknown extension '${e.id.value}'`),o=this._createAndSaveOperation(e,null,[],new pd(s));return this._host.onExtensionActivationError(e.id,s,new Vw(e.id.value)),o}const i=[],n=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const s of n){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){i.push(o);continue}if(this._isHostExtension(s)){i.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;i.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const c=t.displayName||t.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(e,t.displayName,[],new pd(l));return this._host.onExtensionActivationError(t.identifier,l,new Vw(s)),u}return this._createAndSaveOperation(e,t.displayName,i,null)}_createAndSaveOperation(e,t,i,n){const s=new lg(e.id,t,e.reason,i,n,this._host,this._logService);return this._operations.set(e.id,s),s}_isHostExtension(e){return es.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};cg=F([O(3,ze)],cg);let lg=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,i,n,s,o,a){this._id=e,this._displayName=t,this._reason=i,this._deps=n,this._value=s,this._host=o,this._logService=a,this._barrier=new rn,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const i=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);i.detail=t.value.activationFailedError,this._value=new pd(i),this._host.onExtensionActivationError(this._id,i,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new pd(t),this._isDisposed&&gr(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};lg=F([O(6,ze)],lg);class D0{constructor(e,t){this._logService=t,this._onDidChangeStorage=new P,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(j.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const n=await this._proxy.$initializeExtensionStorage(e,t);let s;return n&&(s=this.safeParseValue(e,t,n)),s||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const n=this.safeParseValue(e,t,i);n&&this._onDidChangeStorage.fire({shared:e,key:t,value:n})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(n){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${n}`)}}}const ug=ee("IExtHostStorage");class I0{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(n=>(this._value=n,this)),this._storageListener=this._storage.onDidChangeStorage(n=>{n.shared===this._shared&&n.key===this._id&&(this._value=n.value)}),this._scheduler=new Xo(()=>{const n=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const s of n.values())s.complete()}catch(s){for(const o of n.values())o.error(s)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let i=this._value[e];return typeof i>"u"&&(i=t),i}update(e,t){this._value[e]=t;const i=this._deferredPromises.get(e);if(i!==void 0)return i.p;const n=new Ss;return this._deferredPromises.set(e,n),this._scheduler.isScheduled()||this._scheduler.schedule(),n.p}dispose(){this._storageListener.dispose()}}class BE extends I0{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var Gi;let dg=Gi=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new Nx,this._proxy=e.getProxy(j.MainThreadFileSystem);const i=this;this.value=Object.freeze({async stat(n){try{let s;const o=i._fileSystemProvider.get(n.scheme);return o?(await i._proxy.$ensureActivation(n.scheme),s=await o.impl.stat(n)):s=await i._proxy.$stat(n),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===Ls.Readonly?1:void 0}}catch(s){Gi._handleError(s)}},async readDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readDirectory(n)).slice()):await i._proxy.$readdir(n)}catch(s){return Gi._handleError(s)}},async createDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s&&!s.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(s.impl,s.extUri,n)):await i._proxy.$mkdir(n)}catch(s){return Gi._handleError(s)}},async readFile(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readFile(n)).slice()):(await i._proxy.$readFile(n)).buffer}catch(s){return Gi._handleError(s)}},async writeFile(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(o.impl,o.extUri,o.extUri.dirname(n)),await i._writeQueue.queueFor(n,()=>Promise.resolve(o.impl.writeFile(n,s,{create:!0,overwrite:!0})))):await i._proxy.$writeFile(n,he.wrap(s))}catch(o){return Gi._handleError(o)}},async delete(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly&&!s?.useTrash?(await i._proxy.$ensureActivation(n.scheme),await o.impl.delete(n,{recursive:!1,...s})):await i._proxy.$delete(n,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return Gi._handleError(o)}},async rename(n,s,o){try{return await i._proxy.$rename(n,s,{overwrite:!1,...o})}catch(a){return Gi._handleError(a)}},async copy(n,s,o){try{return await i._proxy.$copy(n,s,{overwrite:!1,...o})}catch(a){return Gi._handleError(a)}},isWritableFileSystem(n){const s=t.getCapabilities(n);if(typeof s=="number")return!(s&2048)}})}async mkdirp(e,t,i){const n=[];for(;!t.isEqual(i,t.dirname(i));)try{if(!((await e.stat(i)).type&$r.Directory))throw ft.FileExists(`Unable to create folder '${i.scheme===K.file?i.fsPath:i.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(hf(s)!==ye.FileNotFound)throw s;n.push(t.basename(i)),i=t.dirname(i)}for(let s=n.length-1;s>=0;s--){i=t.joinPath(i,n[s]);try{await e.createDirectory(i)}catch(o){if(hf(o)!==ye.FileExists)throw o}}}static _handleError(e){if(e instanceof ft)throw e;if(e instanceof $l)switch(e.code){case ye.FileExists:throw ft.FileExists(e.message);case ye.FileNotFound:throw ft.FileNotFound(e.message);case ye.FileNotADirectory:throw ft.FileNotADirectory(e.message);case ye.FileIsADirectory:throw ft.FileIsADirectory(e.message);case ye.NoPermissions:throw ft.NoPermissions(e.message);case ye.Unavailable:throw ft.Unavailable(e.message);default:throw new ft(e.message,e.name)}if(!(e instanceof Error))throw new ft(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw ft.Unavailable(e.message);switch(e.name){case ye.FileExists:throw ft.FileExists(e.message);case ye.FileNotFound:throw ft.FileNotFound(e.message);case ye.FileNotADirectory:throw ft.FileNotADirectory(e.message);case ye.FileIsADirectory:throw ft.FileIsADirectory(e.message);case ye.NoPermissions:throw ft.NoPermissions(e.message);case ye.Unavailable:throw ft.Unavailable(e.message);default:throw new ft(e.message,e.name)}}addFileSystemProvider(e,t,i){return this._fileSystemProvider.set(e,{impl:t,extUri:i?.isCaseSensitive?Oe:Ix,isReadonly:!!i?.isReadonly}),Te(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){return this._fileSystemProvider.get(e)?.extUri??Oe}};dg=Gi=F([O(0,Ue),O(1,Ds)],dg);const gd=ee("IExtHostConsumerFileSystem"),hg=ee("IExtensionStoragePaths");let fg=class{constructor(e,t,i){this._logService=t,this._extHostFileSystem=i,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(n=>this._value=n)}async _getWorkspaceStorageURI(e){return b.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(b.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:b.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2))),t}catch(i){this._logService.error("[ExtHostStorage]",i);return}}workspaceValue(e){if(this._value)return b.joinPath(this._value,e.identifier.value)}globalValue(e){return b.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};fg=F([O(0,At),O(1,ze),O(2,gd)],fg),ee("tunnelService");var P0;(function(r){r.Http="http",r.Https="https"})(P0||(P0={}));var ts;(function(r){r.ConstantPrivate="constantPrivate",r.Private="private",r.Public="public"})(ts||(ts={}));var T0;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(T0||(T0={}));function WE(r){if(r.scheme!=="http"&&r.scheme!=="https")return;const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(r.authority);if(e)return{address:e[1],port:+e[2]}}const pg=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function A0(r){return pg.indexOf(r)>=0}const gg=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function R0(r){return gg.indexOf(r)>=0}class VE{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this._dispose=i,this._onDispose=new P,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}}let L0=class{constructor(e,t){this.logService=e,this.configurationService=t,this._onTunnelOpened=new P,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new P,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new P,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[],t=Array.from(this._tunnels.values());for(const i of t){const n=Array.from(i.values());for(const s of n){const o=await s.value;o&&typeof o!="string"&&e.push(o)}}return e}async dispose(){for(const e of this._tunnels.values()){for(const{value:t}of e.values())await t.then(i=>typeof i!="string"?i?.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,i,n,s){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:i,privacy:n,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(R0(e)||A0(e))&&(e=pg[0]);const i=this.getTunnelFromMap(e,t);if(i)return++i.refcount,i.value}openTunnel(e,t,i,n,s,o=!1,a,c){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${i} on local port ${s}.`);const l=this._tunnelProvider??e;if(!l)return;if(t||(t="localhost"),n||(n=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(i)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(l,t,i,n,s,o,a,c);return u?u.then(h=>{if(h){if(typeof h=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(t,i),h}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(t,i);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(h);return(h.tunnelRemoteHost!==t||h.tunnelRemotePort!==i)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&h.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(f),f}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const t=this._tunnels.get(e.tunnelRemoteHost);if(t){const i=t.get(e.tunnelRemotePort);i&&(i.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,i))}}}}async tryDisposeTunnel(e,t,i){if(i.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);const n=i.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),n}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);const i=this._tunnels.get(e);if(i&&i.has(t)){const n=i.get(t);n.refcount=0,await this.tryDisposeTunnel(e,t,n)}}addTunnelToMap(e,t,i){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:i})}async removeEmptyOrErrorTunnelFromMap(e,t){const i=this._tunnels.get(e);if(i){const n=i.get(t),s=n?await n.value:void 0;(!s||typeof s=="string")&&i.delete(t),i.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){const i=[e];A0(e)?(i.push(...pg),i.push(...gg)):R0(e)&&i.push(...gg);const n=i.map(s=>this._tunnels.get(s));for(const s of n){const o=s?.get(t);if(o)return o}}canTunnel(e){return!!WE(e)}createWithProvider(e,t,i,n,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${i} on local port ${n}.`);const c=i;this._factoryInProgress.add(c);const l=n===void 0?i:n,u={elevationRequired:s?this.isPortPrivileged(l):!1},h={remoteAddress:{host:t,port:i},localAddressPort:n,privacy:o,public:o?o!==ts.Private:void 0,protocol:a},f=e.forwardPort(h,u);return f?(this.addTunnelToMap(t,i,f),f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(c)})):this._factoryInProgress.delete(c),f}};L0=F([O(0,ze),O(1,ng)],L0);class zE extends VE{}var mg;(function(r){function e(i){return{remoteAddress:i.remoteAddress,localAddress:i.localAddress,public:!!i.public,privacy:i.privacy??(i.public?ts.Public:ts.Private),protocol:i.protocol}}r.fromApiTunnel=e;function t(i){return{remoteAddress:{host:i.tunnelRemoteHost,port:i.tunnelRemotePort},localAddress:i.localAddress,public:i.privacy!==ts.ConstantPrivate&&i.privacy!==ts.ConstantPrivate,privacy:i.privacy,protocol:i.protocol}}r.fromServiceTunnel=t})(mg||(mg={}));const vg=ee("IExtHostTunnelService");let _g=class extends Me{constructor(e,t,i){super(),this.logService=i,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new P,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(j.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);const i=await this._proxy.$openTunnel(t,e.displayName);if(i){const n=new zE(i.remoteAddress,i.localAddress,()=>this._proxy.$closeTunnel(i.remoteAddress));return this._register(n),n}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){const i=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(i,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,i),new ke(()=>{this._portAttributesProviders.delete(i),this._proxy.$unregisterPortsAttributesProvider(i)})}async $providePortAttributes(e,t,i,n,s){const o=[];for(const c of e){const l=this._portAttributesProviders.get(c);if(!l)return[];o.push(...await Promise.all(t.map(async u=>{let h;try{h=await l.provider.providePortAttributes({port:u,pid:i,commandLine:n},s)}catch{h=await l.provider.providePortAttributes(u,i,n,s)}return{providedAttributes:h,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(n,s)=>await e.provideTunnel(n,s,new dt().token)??void 0;const i=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,privacyOptions:t.tunnelFeatures?.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(i),Promise.resolve(Te(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0)}))}async setTunnelFactory(e,t){if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());const i=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(i){this._forwardPortProvider=i;let n=e.tunnelFeatures?.privacyOptions??[];e.tunnelFeatures?.public&&n.length===0&&(n=[{id:"private",label:g("vs/workbench/api/common/extHostTunnelService","tunnelPrivacy.private","Private"),themeIcon:"lock"},{id:"public",label:g("vs/workbench/api/common/extHostTunnelService","tunnelPrivacy.public","Public"),themeIcon:"eye"}]);const s=e.tunnelFeatures?{elevation:!!e.tunnelFeatures?.elevation,public:!!e.tunnelFeatures?.public,privacyOptions:n,protocol:!0}:void 0;this._proxy.$setTunnelProvider(s)}}else this._forwardPortProvider=void 0;return Te(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){const i=this._extensionTunnels.get(e.host);i.has(e.port)&&(t&&i.get(e.port).disposeListener.dispose(),await i.get(e.port).tunnel.dispose(),i.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const i=this._forwardPortProvider(e,t);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),i!==void 0){const n=await i;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),n===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);const s=this._register(n.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(n.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:n,disposeListener:s}),mg.fromApiTunnel(n)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(i){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),i instanceof Error)return i.message}}async $applyCandidateFilter(e){const t=await Promise.all(e.map(n=>this._showCandidatePort(n.host,n.port,n.detail??""))),i=e.filter((n,s)=>t[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(n=>n.port).join(", ")} to ${i.map(n=>n.port).join(", ")}`),i}};_g=F([O(0,Ue),O(1,At),O(2,ze)],_g);function qE(r){return[...r.entries()]}function jE(r){return r?[...r.entries()]:[]}class GE{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const n=t(s=>{const o=typeof s=="string"?s:s.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const c=setTimeout(()=>this.flushBuffer(e),i);a={data:[o],timeoutId:c,dispose:()=>{clearTimeout(c),this.flushBuffer(e),n.dispose()}},this._terminalBufferMap.set(e,a)});return n}stopBuffering(e){this._terminalBufferMap.get(e)?.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}const is=(r,e,t,i)=>{let n=e;return{enumerable:!0,configurable:!1,get(){return n},set(s){if(!t(n,s)){const o=n;n=s,r.listener?.(i(s,o))}}}},wo=(r,e)=>r===e,rr={range:(r,e)=>r===e?!0:!r||!e?!1:r.isEqual(e),label:wo,description:wo,sortText:wo,busy:wo,error:wo,canResolveChildren:wo,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.find(i=>t.id===i.id)))},bo=r=>e=>({op:4,update:r(e)}),QE=(r,e)=>({range:(()=>{let t;const i=bo(n=>({range:Be.lift($.from(n))}));return{enumerable:!0,configurable:!1,get(){return t},set(n){r.listener?.({op:6}),rr.range(t,n)||(t=n,r.listener?.(i(n)))}}})(),label:is(r,e,rr.label,bo(t=>({label:t}))),description:is(r,void 0,rr.description,bo(t=>({description:t}))),sortText:is(r,void 0,rr.sortText,bo(t=>({sortText:t}))),canResolveChildren:is(r,!1,rr.canResolveChildren,t=>({op:2,state:t})),busy:is(r,!1,rr.busy,bo(t=>({busy:t}))),error:is(r,void 0,rr.error,bo(t=>({error:De.fromStrict(t)||null}))),tags:is(r,[],rr.tags,(t,i)=>({op:1,new:t.map(Ii.from),old:i.map(Ii.from)}))}),KE=r=>{const e=me.fromString(r.extId),t=new ns(e.controllerId,e.localId,r.label,b.revive(r.uri)||void 0);return t.range=$.to(r.range||void 0),t.description=r.description||void 0,t.sortText=r.sortText||void 0,t.tags=r.tags.map(i=>Ii.to({id:nw(i).tagId})),t},JE=r=>{let e;for(const t of r.tests){const i=KE(t.item);Ol(i).parent=e,e=i}return e};class ns{constructor(e,t,i,n){if(t.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=QS(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:n,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof wg?void 0:s.parent}},children:{value:GS(s,Ol,ns),enumerable:!0,writable:!1},...QE(s,i)})}}class wg extends ns{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class XE extends zS{constructor(e,t,i){super({controllerId:e,getDocumentVersion:n=>n&&i.getDocument(n)?.version,getApiFor:Ol,getChildren:n=>n.children,root:new wg(e,t),toITestItem:tr.from})}}let bg=class extends Me{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new P),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new P),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=b.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:T4,name:g("vs/workbench/api/common/extHostTelemetry","extensionTelemetryLog","Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel(i=>{lC(i)&&this.updateLoggerVisibility()})),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===Ae.Trace)}getTelemetryConfiguration(){return this._level===3}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:this._productConfig.error?this._level>=2:!1,isUsageEnabled:this._productConfig.usage?this._level>=3:!1}}instantiateLogger(e,t,i){const n=this.getTelemetryDetails(),s=new O0(t,i,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:n.isUsageEnabled,isErrorsEnabled:n.isErrorsEnabled}),o=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(e,t,i){this._level=e,this._telemetryIsSupported=t,this._productConfig=i??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=$0(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case zo.Web:t["common.uikind"]="web";break;case zo.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=wf(R4(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((i,n)=>{const s=i.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(n):this._telemetryLoggers.set(n,s)}),this._telemetryLoggers.forEach(i=>{for(const n of i)n.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const n=this._telemetryLoggers.get(e.value)?.filter(o=>!o.isDisposed);if(!n)return this._telemetryLoggers.delete(e.value),!1;let s=!1;for(const o of n)o.ignoreUnhandledExtHostErrors||(o.logError(t),s=!0);return s}};bg=F([O(0,At),O(1,Es)],bg);class O0{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,n,s,o,a){this._extension=i,this._logger=n,this._inLoggingOnlyMode=s,this._commonProperties=o,this._onDidChangeEnableStates=new P,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this._ignoreBuiltinCommonProperties=t?.ignoreBuiltInCommonProperties??!1,this._additionalCommonProperties=t?.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=Ww(t,[]),this._additionalCommonProperties&&(t=Ar(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=Ar(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender?.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},n=Ww(i,[]),s=new Error(n.message,{cause:n.cause});s.stack=n.stack,s.name=n.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(s,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0,Promise.resolve(e.flush()).then(e=void 0),this._apiObject=void 0}else this._sender=void 0}}function $0(r){const e=Date.now()-new Date(r).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const md=ee("IExtHostTelemetry");let yg=class{#e;#t;#i;constructor(e,t,i){this._commands=new Map,this._apiCommands=new Map,this.#e=e.getProxy(j.MainThreadCommands),this._logService=t,this.#i=i,this.#t=e.getProxy(j.MainThreadTelemetry),this.converter=new YE(this,n=>{const s=this._apiCommands.get(n);return s?.result===ue.Void?s:void 0},t),this._argumentProcessors=[{processArgument(n){return Hi(n)}},{processArgument(n){return pl(n,function(s){if(Be.isIRange(s))return $.to(s);if(pi.isIPosition(s))return He.to(s);if(Be.isIRange(s.range)&&b.isUri(s.uri))return oi.to(s);if(s instanceof he)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...i)=>{const n=e.args.map((o,a)=>{if(!o.validate(i[a]))throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof i[a]=="object"?JSON.stringify(i[a],null,"	"):i[a]} `);return o.convert(i[a])}),s=await this.executeCommand(e.internalId,...n);return e.result.convert(s,i,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new ke(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,i,n,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:i,thisArg:n,metadata:s,extension:o}),e&&this.#e.$registerCommand(t),new ke(()=>{this._commands.delete(t)&&e&&this.#e.$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,i){if(this._commands.has(e))return this.#e.$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let n=!1;const s=pl(t,function(o){if(o instanceof xe)return He.from(o);if(o instanceof ve)return $.from(o);if(o instanceof si)return oi.from(o);if(hn.isNotebookRange(o))return qi.from(o);if(o instanceof ArrayBuffer)return n=!0,he.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return n=!0,he.wrap(o);if(o instanceof he)return n=!0,o;if(!Array.isArray(o))return o});try{const o=await this.#e.$executeCommand(e,n?new Ni(s):s,i);return Hi(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw o}}}async _executeContributedCommand(e,t,i){const n=this._commands.get(e);if(!n)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=n;if(a?.args)for(let l=0;l<a.args.length;l++)try{gx(t[l],a.args[l].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[l].name}' - ${a.args[l].description}`)}const c=en.create();try{return await s.apply(o,t)}catch(l){if(e===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...t);u&&(e=u.command)}if(this._logService.error(l,e,n.extension?.identifier),!i)throw l;if(n.extension?.identifier){const u=this.#i.onExtensionError(n.extension.identifier,l);this._logService.trace("forwarded error to extension?",u,n.extension?.identifier)}throw new class extends Error{constructor(){super(Un(l)),this.id=e,this.source=n.extension?.displayName??n.extension?.name}}}finally{this._reportTelemetry(n,e,c.elapsed())}}_reportTelemetry(e,t,i){e.extension&&this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new bf(t),duration:i})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const i=this._commands.get(e);return i?(t=t.map(n=>this._argumentProcessors.reduce((s,o)=>o.processArgument(s,i.extension?.identifier),n)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),this.#e.$getCommands().then(t=>(e&&(t=t.filter(i=>i[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,i]of this._commands){const{metadata:n}=i;n&&(e[t]=n)}return Promise.resolve(e)}};yg=F([O(0,Ue),O(1,ze),O(2,md)],yg);const yo=ee("IExtHostCommands");class YE{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${on()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const n=this._lookupApiCommand(e.command);if(n)i.id=n.internalId,i.arguments=n.args.map((s,o)=>s.convert(e.arguments&&e.arguments[o]));else if(Ho(e.arguments)){const s=`${e.command} /${++this._cachIdPool}`;this._cache.set(s,e),t.add(Te(()=>{this._cache.delete(s),this._logService.trace("CommandsConverter#DISPOSE",s)})),i.$ident=s,i.id=this.delegatingCommandId,i.arguments=[s],this._logService.trace("CommandsConverter#CREATE",e.command,s)}return i}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}class M{static{this.Uri=new M("uri","Uri of a text document",e=>b.isUri(e),e=>e)}static{this.Position=new M("position","A position in a text document",e=>xe.isPosition(e),He.from)}static{this.Range=new M("range","A range in a text document",e=>ve.isRange(e),$.from)}static{this.Selection=new M("selection","A selection in a text document",e=>un.isSelection(e),mi.from)}static{this.Number=new M("number","",e=>typeof e=="number",e=>e)}static{this.String=new M("string","",e=>typeof e=="string",e=>e)}static{this.StringArray=M.Arr(M.String)}static Arr(e){return new M(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(i=>e.validate(i)),t=>t.map(i=>e.convert(i)))}static{this.CallHierarchyItem=new M("item","A call hierarchy item",e=>e instanceof Pf,Xr.from)}static{this.TypeHierarchyItem=new M("item","A type hierarchy item",e=>e instanceof lp,Zr.from)}static{this.TestItem=new M("testItem","A VS Code TestItem",e=>e instanceof ns,tr.from)}constructor(e,t,i,n){this.name=e,this.description=t,this.validate=i,this.convert=n}optional(){return new M(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new M(e??this.name,t??this.description,this.validate,this.convert)}}class ue{static{this.Void=new ue("no result",e=>e)}constructor(e,t){this.description=e,this.convert=t}}class pe{constructor(e,t,i,n,s){this.id=e,this.internalId=t,this.description=i,this.args=n,this.result=s}}const sc=ee("IExtHostTerminalService");class N0{constructor(e,t,i,n){this._proxy=e,this._id=t,this._creationOptions=i,this._name=n,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},sendText(o,a=!0){s._checkDisposed(),s._proxy.$sendText(s._id,o,a)},show(o){s._checkDisposed(),s._proxy.$show(s._id,o)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(!(s._cols===void 0||s._rows===void 0))return{columns:s._cols,rows:s._rows}}}}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:M0(e.iconPath)??void 0,color:Is.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this._serializeParentTerminal(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,n,s){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:n,color:Is.isThemeColor(s)?s.id:void 0,location:t?.location||this._serializeParentTerminal(e,i),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:pt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class xg{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new P,this.onProcessData=this._onProcessData.event,this._onProcessReady=new P,this._onDidChangeProperty=new P,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new P,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}resize(e,t){this._pty.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this._pty.onDidWrite(t=>this._onProcessData.fire(t)),this._pty.onDidClose?.((t=void 0)=>{this._onProcessExit.fire(t===void 0?void 0:t)}),this._pty.onDidOverrideDimensions?.(t=>{t&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:t.columns,rows:t.rows}})}),this._pty.onDidChangeName?.(t=>{this._onDidChangeProperty.fire({type:"title",value:t})}),this._pty.open(e||void 0),e&&this._pty.setDimensions?.(e),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let ZE=1,Cg=class extends Me{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,i){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new ms),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new P,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new P,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new P,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new P,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new P,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new P,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new P({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new P({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=i.getProxy(j.MainThreadTerminalService),this._bufferer=new GE(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:n=>{const s=o=>{const a=o;return this._getTerminalById(a.instanceId)?.value};switch(n?.$mid){case 15:return s(n);default:{if(Array.isArray(n))for(let o=0;o<n.length&&n[o].$mid===15;o++)n[o]=s(n[o]);return n}}}}),this._register({dispose:()=>{for(const[n,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(e){return(e?this._defaultAutomationProfile:this._defaultProfile)?.path||""}getDefaultShellArgs(e){return(e?this._defaultAutomationProfile:this._defaultProfile)?.args||[]}createExtensionTerminal(e,t){const i=new N0(this._proxy,on(),e,e.name),n=new xg(e.pty);return i.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,M0(e.iconPath),tk(e.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,n);this._terminalProcessDisposables[s]=o}),this._terminals.push(i),i.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const i=e.location.parentTerminal;if(i){const n=this._terminals.find(s=>s.value===i);n&&(t.resolvedExtHostIdentifier=n._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this._getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const n=new xg(t),s=this._setupExtHostProcessListeners(e,n);this._terminalProcessDisposables[e]=s}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const i=this._getTerminalById(e);i&&(this._activeTerminal=i,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const i=this._getTerminalById(e);i&&this._onDidWriteTerminalData.fire({terminal:i.value,data:t})}async $acceptTerminalDimensions(e,t,i){const n=this._getTerminalById(e);n&&n.setDimensions(t,i)&&this._onDidChangeTerminalDimensions.fire({terminal:n.value,dimensions:n.value.dimensions})}async $acceptDidExecuteCommand(e,t){const i=this._getTerminalById(e);i&&this._onDidExecuteCommand.fire({terminal:i.value,...t})}async $acceptTerminalMaximumDimensions(e,t,i){this._terminalProcesses.get(e)?.resize(t,i)}async $acceptTerminalTitleChange(e,t){const i=this._getTerminalById(e);i&&(i.name=t)}async $acceptTerminalClosed(e,t,i){const n=this._getTerminalObjectIndexById(this._terminals,e);if(n!==null){const s=this._terminals.splice(n,1)[0];s.setExitStatus(t,i),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(e,t,i,n){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:n.name,shellPath:n.executable,shellArgs:n.args,cwd:typeof n.cwd=="string"?n.cwd:b.revive(n.cwd),env:n.env,hideFromUser:n.hideFromUser},o=new N0(this._proxy,e,s,i);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(e,t){this._getTerminalById(e)?._setProcessId(t)}async $startExtensionTerminal(e,t){const i=this._getTerminalById(e);if(!i)return{message:g("vs/workbench/api/common/extHostTerminalService","launchFail.idMissingOnExtHost","Could not find the terminal with id {0} on the extension host",e)};i.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===i.value&&(o.dispose(),s())})});const n=this._terminalProcesses.get(e);n?n.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const i=new Pe;i.add(t.onProcessReady(s=>this._proxy.$sendProcessReady(e,s.pid,s.cwd,s.windowsPty))),i.add(t.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(e,s))),this._bufferer.startBuffering(e,t.onProcessData),i.add(t.onProcessExit(s=>this._onProcessExit(e,s))),this._terminalProcesses.set(e,t);const n=this._extensionTerminalAwaitingStart[e];return n&&t instanceof xg&&(t.startSendingEvents(n.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),i}$acceptProcessAckDataEvent(e,t){this._terminalProcesses.get(e)?.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){this._terminalProcesses.get(e)?.input(t)}$acceptTerminalInteraction(e){const t=this._getTerminalById(e);t?.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){this._getTerminalById(e)?.setSelection(t)}$acceptProcessResize(e,t,i){try{this._terminalProcesses.get(e)?.resize(t,i)}catch(n){if(n.code!=="EPIPE"&&n.code!=="ERR_IPC_CHANNEL_CLOSED")throw n}}$acceptProcessShutdown(e,t){this._terminalProcesses.get(e)?.shutdown(t)}$acceptProcessRequestInitialCwd(e){this._terminalProcesses.get(e)?.getInitialCwd().then(t=>this._proxy.$sendProcessProperty(e,{type:"initialCwd",value:t}))}$acceptProcessRequestCwd(e){this._terminalProcesses.get(e)?.getCwd().then(t=>this._proxy.$sendProcessProperty(e,{type:"cwd",value:t}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new ke(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}registerProfileProvider(e,t,i){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,i),this._proxy.$registerProfileProvider(t,e.identifier.value),new ke(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalQuickFixProvider(e,t,i){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,i),this._proxy.$registerQuickFixProvider(e,t),new ke(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const i=new dt().token;if(i.isCancellationRequested)return;const n=this._quickFixProviders.get(e);if(!n)return;const s=await n.provideTerminalQuickFixes(t,i);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new Pe;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?od.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const c of s){const l=od.from(c,this._extHostCommands.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(e,t){const i=new dt().token;let n=await this._profileProviders.get(e)?.provideTerminalProfile(i);if(!i.isCancellationRequested){if(n&&!("options"in n)&&(n={options:n}),!n||!("options"in n))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in n.options){this.createExtensionTerminal(n.options,t);return}this.createTerminalFromOptions(n.options,t)}}async $provideLinks(e,t){const i=this._getTerminalById(e);if(!i)return[];this._terminalLinkCache.delete(e),this._terminalLinkCancellationSource.get(e)?.dispose(!0);const s=new dt;this._terminalLinkCancellationSource.set(e,s);const o=[],a={terminal:i.value,line:t},c=[];for(const h of this._linkProviders)c.push(Uh.withAsyncBody(async f=>{s.token.onCancellationRequested(()=>f({provider:h,links:[]}));const d=await h.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||f({provider:h,links:d})}));const l=await Promise.all(c);if(s.token.isCancellationRequested)return[];const u=new Map;for(const h of l)h&&h.links.length>0&&o.push(...h.links.map(f=>{const d={id:ZE++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(d.id,{provider:h.provider,link:f}),d}));return this._terminalLinkCache.set(e,u),o}$activateLink(e,t){const i=this._terminalLinkCache.get(e)?.get(t);i&&i.provider.handleTerminalLink(i.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const i=this._terminalProcessDisposables[e];i&&(i.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}_getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}_getTerminalObjectById(e,t){const i=this._getTerminalObjectIndexById(e,t);return i!==null?e[i]:null}_getTerminalObjectIndexById(e,t){const i=e.findIndex(n=>n._id===t);return i===-1?null:i}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=new F0,this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const i=qE(t.map),n=jE(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,i.length===0?void 0:i,n)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const i=t[0],n=new F0(t[1]);this._setEnvironmentVariableCollection(i,n)})}$acceptDefaultProfile(e,t){const i=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,i?.path!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)})}};Cg=F([O(1,yo),O(2,Ue)],Cg);class F0{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new P,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new ek(this,e),this.scopedCollections.set(t,i),i.onDidChangeCollection(()=>this._onDidChangeCollection.fire())),i}replace(e,t,i,n){this._setIfDiffers(e,{value:t,type:Fs.Replace,options:i??{applyAtProcessCreation:!0},scope:n})}append(e,t,i,n){this._setIfDiffers(e,{value:t,type:Fs.Append,options:i??{applyAtProcessCreation:!0},scope:n})}prepend(e,t,i,n){this._setIfDiffers(e,{value:t,type:Fs.Prepend,options:i??{applyAtProcessCreation:!0},scope:n})}_setIfDiffers(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),n=this.map.get(i),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!n||n.value!==t.value||n.type!==t.type||n.options?.applyAtProcessCreation!==s.applyAtProcessCreation||n.options?.applyAtShellIntegration!==s.applyAtShellIntegration||n.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const o=this.getKey(e,t.scope),a={variable:e,...t,options:s};this.map.set(o,a),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),n=this.map.get(i);return n?H0(n):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,n]of this.map)this.getScopeKey(n.scope)===this.getScopeKey(e)&&t.set(n.variable,H0(n));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),n=this.descriptionMap.get(i);if(!n||n.description!==e){let s;typeof e=="string"?s=e:s=e?.value.split(`

`)[0];const o={description:s,scope:t};this.descriptionMap.set(i,o),this._onDidChangeCollection.fire()}}getDescription(e){const t=this.getScopeKey(e);return this.descriptionMap.get(t)?.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class ek{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new P}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((i,n)=>e.call(t,n,i,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let Sg=class extends Cg{constructor(e,t){super(!1,e,t)}createTerminal(e,t,i){throw new uh}createTerminalFromOptions(e,t){throw new uh}};Sg=F([O(0,yo),O(1,Ue)],Sg);function M0(r){if(!(!r||typeof r=="string"))return"id"in r?{id:r.id,color:r.color}:r}function tk(r){return Is.isThemeColor(r)?r:void 0}function H0(r){const e={...r};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}function oc(r,e=Gt){return yx(r,e)?r.charAt(0).toUpperCase()+r.slice(1):r}function ik(r,e){return r.replace(/^~($|\/|\\)/,`${e}$1`)}var U0;(function(r){r[r.TEXT=0]="TEXT",r[r.VARIABLE=1]="VARIABLE",r[r.SEPARATOR=2]="SEPARATOR"})(U0||(U0={}));function B0(r){return r<0?0:r>255?255:r|0}function xo(r){return r<0?0:r>4294967295?4294967295:r|0}class vd{constructor(e){const t=B0(e);this._defaultValue=t,this._asciiMap=vd._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=B0(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class nk extends vd{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function rk(r){const e={};return t=>(e.hasOwnProperty(t)||(e[t]=r(t)),e[t])}const sk=rk(r=>new nk(r));var Eg;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=4]="Right",r[r.Full=7]="Full"})(Eg||(Eg={}));var W0;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=3]="Right"})(W0||(W0={}));var V0;(function(r){r[r.Inline=1]="Inline",r[r.Gutter=2]="Gutter"})(V0||(V0={}));var z0;(function(r){r[r.Both=0]="Both",r[r.Right=1]="Right",r[r.Left=2]="Left",r[r.None=3]="None"})(z0||(z0={}));class kg{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class ok{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class ak{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}class q0{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=j0(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=K2(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new ok(t,this.wordSeparators?sk(this.wordSeparators):null,i?this.searchString:null)}}function j0(r){if(!r||r.length===0)return!1;for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=r.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function G0(r,e,t){if(!t)return new kg(r,null);const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n];return new kg(r,i)}function ck(r,e,t,i,n){if(i===0)return!0;const s=e.charCodeAt(i-1);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i);if(r.get(o)!==0)return!0}return!1}function lk(r,e,t,i,n){if(i+n===t)return!0;const s=e.charCodeAt(i+n);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(r.get(o)!==0)return!0}return!1}function Q0(r,e,t,i,n){return ck(r,e,t,i,n)&&lk(r,e,t,i,n)}class uk{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,s=i[0].length;if(n===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){Tv(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=s,!this._wordSeparators||Q0(this._wordSeparators,e,t,n,s))return i}while(i);return null}}function K0(r){return r.scheme!==K.file&&r.scheme!==K.vscodeRemote}function dk(r){if(r.folders.length)return r.folders.every(e=>K0(e.uri))?r.folders[0].uri:void 0;if(r.configuration&&K0(r.configuration))return r.configuration}function hk(r){return dk(r)?.scheme}const fk=ee("environmentService"),pk=fk,J0=ee("remoteAgentService");var Dg;const gk=ee("pathService");let X0=Dg=class{constructor(e,t,i,n){this.localUserHome=e,this.remoteAgentService=t,this.environmentService=i,this.contextService=n,this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||S2)(),this.resolveUserHome=(async()=>{const s=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=s?.userHome??e})()}hasValidBasename(e,t,i){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(n=>this.doHasValidBasename(e,n,t)):this.doHasValidBasename(e,t,i)}doHasValidBasename(e,t,i){return e.scheme===K.file||e.scheme===K.vscodeRemote?bx(i??Dr(e),t===1):!0}get defaultUriScheme(){return Dg.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return K.vscodeRemote;const i=hk(t.getWorkspace());if(i)return i;const n=t.getWorkspace().folders[0];if(n)return n.uri.scheme;const s=t.getWorkspace().configuration;return s?s.scheme:K.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?mt:$e)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){const n=e.indexOf("/",2);n===-1?(t=e.substring(2),e="/"):(t=e.substring(2,n),e=e.substring(n)||"/")}return b.from({scheme:K.file,authority:t,path:e,query:"",fragment:""})}};X0=Dg=F([O(1,J0),O(2,pk),O(3,Xh)],X0);let Y0=class{constructor(e,t,i,n,s){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=i,this.logService=n,this.pathService=s}text(e,t,i={}){e=this.getContentPattern(e,i);const n=this.configurationService.getValue(),s=t&&t.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(t?.map(__),i),type:2,contentPattern:e,previewOptions:i.previewOptions,maxFileSize:i.maxFileSize,usePCRE2:n.search.usePCRE2||s||!1,beforeContext:i.beforeContext,afterContext:i.afterContext,userDisabledExcludesAndIgnoreFiles:i.disregardExcludeSettings&&i.disregardIgnoreFiles}}getContentPattern(e,t){const i=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,"\\n"));const n={...e,wordSeparators:i.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(n.isCaseSensitive=!0),this.isMultiline(e)&&(n.isMultiline=!0),t.notebookSearchConfig?.includeMarkupInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),t.notebookSearchConfig?.includeMarkupPreview&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),t.notebookSearchConfig?.includeCodeInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),t.notebookSearchConfig?.includeOutput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),n}file(e,t={}){return{...this.commonQuery(e,t),type:1,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){return e?(e=Array.isArray(e)?e.map(_d):_d(e),t?this.parseSearchPaths(e):{pattern:Ig(...Array.isArray(e)?e:[e])}):{}}commonQuery(e=[],t={}){const i=this.handleIncludeExclude(t.includePattern,t.expandPatterns),n=this.handleIncludeExclude(t.excludePattern,t.expandPatterns),s=e.length>1,o=(i.searchPaths&&i.searchPaths.length?i.searchPaths.map(l=>this.getFolderQueryForSearchPath(l,t,n)):e.map(l=>this.getFolderQueryForRoot(l,t,n,s))).filter(l=>!!l),a={_reason:t._reason,folderQueries:o,usingSearchPaths:!!(i.searchPaths&&i.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:n.pattern,includePattern:i.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults};if(t.onlyOpenEditors){const l=Mt(Uc(this.editorGroupsService.groups.map(f=>f.editors.map(d=>d.resource))));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(l));const u=l.filter(f=>h0(a,f.fsPath)),h=this.commonQueryFromFileList(u);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(h)),{...a,...h}}const c=t.extraFileResources&&t.extraFileResources.filter(l=>h0(a,l.fsPath));return a.extraFileResources=c&&c.length?c:void 0,a}commonQueryFromFileList(e){const t=[],i=new it,n={};let s=!1;return e.forEach(o=>{if(o.scheme===K.walkThrough)return;if(Px(o)){const c=this.workspaceContextService.getWorkspaceFolder(o)?.uri??o.with({path:Cr(o.fsPath)});let l=i.get(c);l||(s=!0,l={folder:c,includePattern:{}},t.push(l),i.set(c,l));const u=jo(c.fsPath,o.fsPath);xs(l.includePattern)[u.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,n[o.fsPath]=!0)}),{folderQueries:t,includePattern:n,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(Ov(e.pattern,!0))return!0}else if(Ov(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&j0(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){const t=h=>Sh(h)||/^\.\.?([\/\\]|$)/.test(h),n=(Array.isArray(e)?e:vk(e)).map(h=>{const f=this.pathService.resolvedUserHome;return f?ik(h,f.scheme===K.file?f.fsPath:f.path):h}),s=F1(n,h=>t(h)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(h=>Cv(h,"/")).map(h=>Cv(h,"\\")).map(h=>(h[0]==="."&&(h="*"+h),_k(h))),a={},c=this.expandSearchPathPatterns(s.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=Uc(o),u=Ig(...l);return u&&(a.pattern=u),a}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:dE(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];const t=e.flatMap(n=>{let{pathPortion:s,globPortion:o}=mk(n);return o&&(o=Pg(o)),this.expandOneSearchPath(s).flatMap(c=>this.resolveOneSearchPathPattern(c,o))}),i=new Map;return t.forEach(n=>{const s=n.searchPath.toString(),o=i.get(s);o?n.pattern&&(o.pattern=o.pattern||{},o.pattern[n.pattern]=!0):i.set(s,{searchPath:n.searchPath,pattern:n.pattern?Ig(n.pattern):void 0})}),Array.from(i.values())}expandOneSearchPath(e){if(Sh(e)){const t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==K.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:b.file(_s(e))}]}if(this.workspaceContextService.getWorkbenchState()===2){const t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=_d(e),e.startsWith("../")||e===".."){const n=$e.resolve(t.path,e);return[{searchPath:t.with({path:n})}]}const i=Pg(e);return[{searchPath:t,pattern:i}]}else{if(e==="./"||e===".\\")return[];{const t=e.replace(/^\.[\/\\]/,""),n=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=t.match(new RegExp(`^${bs(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(ys);if(n.length)return n.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&Pg(o)}});{const s=e.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:e,a=g("vs/workbench/services/search/common/queryBuilder","search.noWorkspaceWithName","Workspace folder does not exist: {0}",o);throw new Error(a)}}}}resolveOneSearchPathPattern(e,t){const i=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,n=[{searchPath:e.searchPath,pattern:i}];return i&&!i.endsWith("**")&&n.push({searchPath:e.searchPath,pattern:i+"/**"}),n}getFolderQueryForSearchPath(e,t,i){const n=this.getFolderQueryForRoot(__(e.searchPath),t,i,!1);return n?{...n,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,i,n){let s;const o=b.isUri(e)?e:e.uri;if(i.searchPaths){const h=i.searchPaths.filter(f=>Bv(f.searchPath,o))[0];if(h&&!h.pattern)return null;h&&(s=h.pattern)}const a=this.configurationService.getValue({resource:o}),l={...this.getExcludesForFolder(a,t)||{},...s||{}},u=b.isUri(e)?Dr(e):e.name;return{folder:o,folderName:n?u:void 0,excludePattern:Object.keys(l).length>0?l:void 0,fileEncoding:a.files&&a.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles=="boolean"?t.disregardIgnoreFiles:!a.search?.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles=="boolean"?t.disregardGlobalIgnoreFiles:!a.search?.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles=="boolean"?t.disregardParentIgnoreFiles:!a.search?.useParentIgnoreFiles,ignoreSymlinks:typeof t.ignoreSymlinks=="boolean"?t.ignoreSymlinks:!a.search?.followSymlinks}}};Y0=F([O(0,ng),O(1,Xh),O(2,D4),O(3,ze),O(4,gk)],Y0);function mk(r){const e=r.match(/[\*\{\}\(\)\[\]\?]/);if(e){const t=e.index,i=r.substr(0,t).match(/[/|\\][^/\\]*$/);if(i){let n=r.substr(0,i.index);return n.match(/[/\\]/)||(n+="/"),{pathPortion:n,globPortion:r.substr((i.index||0)+1)}}}return{pathPortion:r}}function Ig(...r){return r.length?r.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function vk(r){return pf(r,",").map(e=>e.trim()).filter(e=>!!e.length)}function _k(r){return[`**/${r}/**`,`**/${r}`].map(t=>t.replace(/\*\*\/\*\*/g,"**"))}function _d(r){return r.replace(/\\/g,"/")}function Pg(r){return _d(r).replace(/^\.\//,"").replace(/\/+$/g,"")}const wk=7e3;function bk(r,e){const t=e.activationEvents;if(!t)return Promise.resolve(void 0);const i=[],n=[];for(const u of t)if(/^workspaceContains:/.test(u)){const h=u.substr(18);h.indexOf("*")>=0||h.indexOf("?")>=0||r.forceUsingSearch?n.push(h):i.push(h)}if(i.length===0&&n.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=Rx(),a=u=>o({activationEvent:u}),c=Promise.all(i.map(u=>yk(r,u,a))).then(()=>{}),l=xk(r,e.identifier,n,a);return Promise.all([c,l]).then(()=>{o(void 0)}),s}async function yk(r,e,t){for(const i of r.folders)if(await r.exists(Cs(b.revive(i),e))){t(`workspaceContains:${e}`);return}}async function xk(r,e,t,i){if(t.length===0)return Promise.resolve(void 0);const n=new dt,s=r.checkExists(r.folders,t,n.token),o=setTimeout(async()=>{n.cancel(),r.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${t.join(",")}`)},wk);let a=!1;try{a=await s}catch(c){gr(c)||Zi(c)}n.dispose(),clearTimeout(o),a&&i(`workspaceContains:${t.join(",")}`)}class Z0{constructor(e){this._onDidChangePassword=new P,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(j.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const Tg=ee("IExtHostSecretState");class Ck{#e;constructor(e,t){this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this._id=Qe.toKey(e.identifier),this.#e=t,this.#e.onDidChangePassword(i=>{i.extensionId===this._id&&this._onDidChange.fire({key:i.key})})}get(e){return this.#e.get(this._id,e)}store(e,t){return this.#e.store(this._id,e,t)}delete(e){return this.#e.delete(this._id,e)}}let Ag=class{constructor(e,t,i){this.logService=i,this.bundleCache=new Map,this._proxy=t.getProxy(j.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===br}getMessage(e,t){const{message:i,args:n,comment:s}=t;if(this.isDefaultLanguage)return xv(i,n??{});let o=i;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=this.bundleCache.get(e)?.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),xv(a??i,n??{})}getBundle(e){return this.bundleCache.get(e)?.contents}getBundleUri(e){return this.bundleCache.get(e)?.uri}async initializeLocalizedMessages(e){if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const i=await this.getBundleLocation(e);if(!i){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const n=await this._proxy.$fetchBundleContents(i),s=JSON.parse(n);t=e.isBuiltin?s.contents?.bundle:s}catch(n){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${i}: ${n.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:i})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return b.revive(t)}return e.l10n?b.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};Ag=F([O(0,At),O(1,Ue),O(2,ze)],Ag);const Rg=ee("IExtHostLocalizationService"),Lg=ee("IExtHostManagedSockets");let Og=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(j.MainThreadManagedSockets)}setFactory(e,t){for(const i of this._managedRemoteSockets.values())i.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new Sk(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,i=await this._factory.makeConnection(),n=new Pe;return this._managedRemoteSockets.set(t,new Ek(t,i,n)),n.add(Te(()=>this._managedRemoteSockets.delete(t))),n.add(i.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),n.dispose()})),n.add(i.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(t,s?.stack??s?.message),n.dispose()})),n.add(i.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(t,he.wrap(s)))),t}$remoteSocketWrite(e,t){this._managedRemoteSockets.get(e)?.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){await this._managedRemoteSockets.get(e)?.actual.drain?.()}};Og=F([O(0,Ue)],Og);class Sk{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class Ek extends Me{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}}var $g;const eb=ee("IHostUtils");let Ng=$g=class extends Me{constructor(e,t,i,n,s,o,a,c,l,u,h,f){super(),this._extHostManagedSockets=f,this._onDidChangeRemoteConnectionData=this._register(new P),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=i,this._initData=a,this._extHostWorkspace=n,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=l,this._extHostTerminalService=u,this._extHostLocalizationService=h,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(j.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(j.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(j.MainThreadExtensionService),this._almostReadyToRunExtensions=new rn,this._readyToStartExtensionHost=new rn,this._readyToRunExtensions=new rn,this._eagerExtensionsActivated=new rn,this._activationEventsReader=new Dk(this._initData.extensions.activationEvents),this._globalRegistry=new es(this._activationEventsReader,this._initData.extensions.allExtensions);const d=new Ns(this._initData.extensions.myExtensions);this._myRegistry=new es(this._activationEventsReader,nb(this._globalRegistry,d)),yr&&(this._logService.info(`Creating extension host with the following global extensions: ${Co(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${Co(this._myRegistry)}`)),this._storage=new D0(this._extHostContext,this._logService),this._secretState=new Z0(this._extHostContext),this._storagePath=c,this._instaService=e.createChild(new Qh([ug,this._storage],[Tg,this._secretState])),this._activator=this._register(new cg(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(_,w,x)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(_,Mc(w),x)},actualActivateExtension:async(_,w)=>{if(es.isHostExtension(_,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(_,w),new UE;const x=this._myRegistry.getExtensionDescription(_);return this._activateExtension(x,w)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),ti("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){Zi(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),qo&&ah(n=>{this._logService.error(n)}),this._extHostContext.dispose();const i=this._deactivateAll();Promise.race([Hn(5e3),i]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new Qe(t.identifier.value),extensionLocation:b.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const i=this._activator.getActivatedExtension(e);if(i.activationFailed)return Promise.reject(i.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===K.file&&this._hostUtils.fsRealpath){const t=await this._hostUtils.fsRealpath(e.fsPath);return b.file(t)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new kk(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=hi.forUris(i=>Dx.ignorePathCasing(i));return await Promise.all(e.map(async i=>{if(this._getEntryPoint(i)){const n=await this._realPathExtensionUri(i.extensionLocation);t.set(n,i)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const i=this._activator.getActivatedExtension(e);if(!i)return t;try{typeof i.module.deactivate=="function"&&(t=Promise.resolve(i.module.deactivate()).then(void 0,n=>(this._logService.error(n),Promise.resolve(void 0))))}catch(n){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(n)}try{wr(i.subscriptions)}catch(n){this._logService.error(`An error occurred when deactivating the subscriptions for extension '${e.value}':`),this._logService.error(n)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(i=>{const n=i.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,n.codeLoadingTime,n.activateCallTime,n.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",n),i},i=>{throw this._logExtensionActivationTimes(e,t,"failure"),i})}_logExtensionActivationTimes(e,t,i,n){const s=ib(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...n||{},outcome:i})}_doActivateExtension(e,t){const i=ib(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",i);const n=this._getEntryPoint(e);if(!n)return Promise.resolve(new HE(_o.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const s=new k0(t.startup);return Promise.all([this._loadCommonJSModule(e,Cs(e.extensionLocation,n),s),this._loadExtensionContext(e)]).then(o=>(ti(`code/extHost/willActivateExtension/${e.identifier.value}`),$g._callActivate(this._logService,e.identifier,o[0],o[1],s))).then(o=>(ti(`code/extHost/didActivateExtension/${e.identifier.value}`),o))}_loadExtensionContext(e){const t=new BE(e,this._storage),i=new I0(e.identifier.value,!1,this._storage),n=new Ck(e,this._secretState),s=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Zs.Test:Zs.Development:Zs.Production,o=this._initData.remote.isRemote?Kr.Workspace:Kr.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([t.whenReady,i.whenReady,this._storagePath.whenReady]).then(()=>{const a=this;let c,l;const u=Ct(e,"ipc")?this._initData.messagePorts?.get(Qe.toKey(e.identifier)):void 0;return Object.freeze({globalState:t,workspaceState:i,secrets:n,subscriptions:[],get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(h){return hv(e.extensionLocation.fsPath,h)},get storagePath(){return a._storagePath.workspaceValue(e)?.fsPath},get globalStoragePath(){return a._storagePath.globalValue(e).fsPath},get logPath(){return hv(a._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return b.joinPath(a._initData.logsLocation,e.identifier.value)},get storageUri(){return a._storagePath.workspaceValue(e)},get globalStorageUri(){return a._storagePath.globalValue(e)},get extensionMode(){return s},get extension(){return c===void 0&&(c=new ac(a,e.identifier,e,o,!1)),c},get extensionRuntime(){return N(e,"extensionRuntime"),a.extensionRuntime},get environmentVariableCollection(){return a._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!l){if(!u)return;const h=ht.buffer(ht.fromDOMEventEmitter(u,"message",f=>f.data));u.start(),l={onDidReceiveMessage:h,postMessage:u.postMessage.bind(u)}}return l}})})}static _callActivate(e,t,i,n,s){return i=i||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,i,n,s).then(o=>new fd(!1,null,s.build(),i,o,n.subscriptions))}static _callActivateOptional(e,t,i,n,s){if(typeof i.activate=="function")try{s.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const o=typeof global=="object"?global:self,a=i.activate.apply(o,[n]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(c=>(s.activateResolveStop(),c))}catch(o){return Promise.reject(o)}else return Promise.resolve(i)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,i=>{this._logService.error(i)})}_activateAllStartupFinishedDeferred(e,t=0){const n=Date.now();nv(()=>{for(let s=t;s<e.length;s+=1){const o=e[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-n>50){this._activateAllStartupFinishedDeferred(e,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(g2()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),i=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(i);else for(const n of i)if(n.activationEvents)for(const s of n.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(n,s)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],i=this._handleWorkspaceContainsEagerExtensions(t),n=this._handleRemoteResolverEagerExtensions(),s=Promise.all([n,e,i]).then(()=>{});return Promise.race([s,Hn(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const i=!this._initData.remote.isRemote&&!!this._initData.remote.authority,n={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:i||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,c)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,c)},s=await bk(n,t);if(s)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(g("vs/workbench/api/common/extHostExtensionService","extensionTestError1","Cannot load test runner."));const i=await this._loadCommonJSModule(null,t,new k0(!1));if(!i||typeof i.run!="function")throw new Error(g("vs/workbench/api/common/extHostExtensionService","extensionTestError","Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((n,s)=>{const o=(l,u)=>{l?(yr&&this._logService.error("Test runner called back with error",l),s(l)):(yr&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),n(typeof u=="number"&&u>0?1:0))},a=xi(t),c=i.run(a,o);c&&c.then&&c.then(()=>{yr&&this._logService.info("Test runner finished successfully."),n(0)}).catch(l=>{yr&&this._logService.error("Test runner finished with error",l),s(l instanceof Error&&l.stack?l.stack:String(l))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),Hn(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,Te(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){const{resolver:t}=await this._activateAndGetResolver(e);return t?.resolveExecServer?.(e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new Vi("Not an authority that can be resolved!",cn.InvalidAuthority);const i=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${i}`,!1),{authorityPrefix:i,resolver:this._resolvers[i]}}async $resolveAuthority(e,t){const i=en.create(!1),n=()=>`[resolveAuthority(${zw(e)},${t})][${i.elapsed()}ms] `,s=S=>this._logService.info(`${n()}${S}`),o=S=>this._logService.warn(`${n()}${S}`),a=(S,D=void 0)=>this._logService.error(`${n()}${S}`,D),c=S=>{if(S instanceof Vi)return{type:"error",error:{code:S._code,message:S._message,detail:S._detail}};throw S},l=async S=>{s(`activating resolver for ${S}...`);const{resolver:D,authorityPrefix:U}=await this._activateAndGetResolver(S);if(!D)throw a(`no resolver for ${U}`),new Vi(`No remote extension installed to resolve ${U}.`,cn.NoResolverFound);return{resolver:D,authorityPrefix:U,remoteAuthority:S}},u=e.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let h;try{h=await Promise.all(u.map(l)).catch(async S=>{if(!(S instanceof Vi)||S._code!==cn.InvalidAuthority)throw S;return o(`resolving nested authorities failed: ${S.message}`),[await l(e)]})}catch(S){return c(S)}const f=new Fx;f.cancelAndSet(()=>s("waiting..."),1e3);let d,_;for(const[S,{authorityPrefix:D,resolver:U,remoteAuthority:R}]of h.entries())try{if(S===h.length-1)s("invoking final resolve()..."),ti(`code/extHost/willResolveAuthority/${D}`),d=await U.resolve(R,{resolveAttempt:t,execServer:_}),ti(`code/extHost/didResolveAuthorityOK/${D}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(U,Wl.isManagedResolvedAuthority(d)?d:void 0));else{if(s(`invoking resolveExecServer() for ${R}`),ti(`code/extHost/willResolveExecServer/${D}`),_=await U.resolveExecServer?.(R,{resolveAttempt:t,execServer:_}),!_)throw new Vi(`Exec server was not available for ${R}`,cn.NoResolverFound);ti(`code/extHost/didResolveExecServerOK/${D}`)}}catch(H){return ti(`code/extHost/didResolveAuthorityError/${D}`),a("returned an error",H),f.dispose(),c(H)}f.dispose();const w={environmentTunnels:d.environmentTunnels,features:d.tunnelFeatures?{elevation:d.tunnelFeatures.elevation,privacyOptions:d.tunnelFeatures.privacyOptions,protocol:d.tunnelFeatures.protocol===void 0?!0:d.tunnelFeatures.protocol}:void 0},x={extensionHostEnv:d.extensionHostEnv,isTrusted:d.isTrusted,authenticationSession:d.authenticationSessionForInitializingExtensions?{id:d.authenticationSessionForInitializingExtensions.id,providerId:d.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${Wl.isManagedResolvedAuthority(d)?"managed authority":`${d.host}:${d.port}`}`);let k;if(Wl.isManagedResolvedAuthority(d)){const S=t;this._extHostManagedSockets.setFactory(S,d.makeConnection),k={authority:e,connectTo:new N4(S),connectionToken:d.connectionToken}}else k={authority:e,connectTo:new F4(d.host,d.port),connectionToken:d.connectionToken};return{type:"ok",value:{authority:k,options:x,tunnelInformation:w}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${zw(e)})`);const{resolver:i}=await this._activateAndGetResolver(e);if(!i)return null;const n=b.revive(t);if(typeof i.getCanonicalURI>"u")return n;const s=await Pt(()=>i.getCanonicalURI(n));return s||n}$startExtensionHost(e){e.toAdd.forEach(n=>n.extensionLocation=b.revive(n.extensionLocation));const{globalRegistry:t,myExtensions:i}=tb(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);return this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),yr&&(this._logService.info(`$startExtensionHost: global extensions: ${Co(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${Co(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===1?this._almostReadyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=b.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=tb(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),n=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),yr&&(this._logService.info(`$deltaExtensions: global extensions: ${Co(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${Co(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=he.alloc(e),i=Math.random()%256;for(let n=0;n<e;n++)t.writeUInt8(i,n);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};Ng=$g=F([O(0,ol),O(1,eb),O(2,Ue),O(3,gn),O(4,mn),O(5,ze),O(6,At),O(7,hg),O(8,vg),O(9,sc),O(10,Rg),O(11,Lg)],Ng);function tb(r,e,t,i){r.addActivationEvents(i.addActivationEvents);const n=new es(r,e.getAllExtensionDescriptions());n.deltaExtensions(i.toAdd,i.toRemove);const s=new Ns(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of i.myToRemove)s.delete(a);for(const a of i.myToAdd)s.add(a);const o=nb(n,s);return{globalRegistry:n,myExtensions:o}}function ib(r,e){return{id:r.identifier.value,name:r.name,extensionVersion:r.version,publisherDisplayName:r.publisher,activationEvents:r.activationEvents?r.activationEvents.join(","):null,isBuiltin:r.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function Co(r){return r.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const sr=ee("IExtHostExtensionService");class ac{#e;#t;#i;constructor(e,t,i,n,s){this.#e=e,this.#t=t,this.#i=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=_s(xi(i.extensionLocation)),this.packageJSON=i,this.extensionKind=n,this.isFromDifferentExtensionHost=s}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#e.activateByIdWithErrors(this.#i,{startup:!1,extensionId:this.#t,activationEvent:"api"}),this.exports}}function nb(r,e){return r.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class kk{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class Dk{constructor(e){this._map=new zn,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}class Ik extends Me{constructor(e,t=[]){super(),this.logger=new hC([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}let Fg=class extends Ik{constructor(e,t,i){const n=i.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",s=i.remote.isRemote?g("vs/workbench/api/common/extHostLogService","remote","Extension Host (Remote)"):e?g("vs/workbench/api/common/extHostLogService","worker","Extension Host (Worker)"):g("vs/workbench/api/common/extHostLogService","local","Extension Host");super(t.createLogger(n,{name:s}))}};Fg=F([O(1,Es),O(2,At)],Fg);let wd=class extends fC{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(i=>Hi(i))),this._proxy=e.getProxy(j.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(b.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,i){return new Pk(this._proxy,e,t,i)}};wd=F([O(0,Ue),O(1,At)],wd);class Pk extends a_{constructor(e,t,i,n){super(n?.logLevel==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,n).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class rb{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(ze),n=e.get(Ue).getProxy(j.MainThreadErrors);ah(s=>{t.error(s);const o=Mc(s);n.$onUnexpectedError(o)})}static async installFullHandler(e){const t=e.get(ze),i=e.get(Ue),n=e.get(sr),s=e.get(md),o=i.getProxy(j.MainThreadExtensionService),a=i.getProxy(j.MainThreadErrors),c=await n.getExtensionPathIndex(),l=new WeakMap;function u(d,_){if(l.has(d))return l.get(d).stack;let w="",x,k;for(const D of _)w+=`
	at ${D.toString()}`,k=D.getFileName(),!x&&k&&(x=c.findSubstr(b.file(k)));const S=`${d.name||"Error"}: ${d.message||""}${w}`;return l.set(d,{extensionIdentifier:x?.identifier,stack:S}),S}const h=Symbol("prepareStackTrace wrapped");let f=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return f},set(d){if(d===u||!d||d[h]){f=d||u;return}f=function(_,w){return u(_,w),d.call(Error,_,w)},Object.assign(f,{[h]:!0})}}),ah(d=>{t.error(d);const _=Mc(d),w=l.get(d);if(!w?.extensionIdentifier){a.$onUnexpectedError(_);return}o.$onExtensionRuntimeError(w.extensionIdentifier,_);const x=s.onExtensionError(w.extensionIdentifier,d);t.trace("forwarded error to extension?",x,w)})}}class Mg{constructor(e,t,i,n,s){this._hostUtils=i,this._rpcProtocol=new sl(e,null,n),t=Mg._transform(t,this._rpcProtocol);const o=new Qh(...mC());o.set(At,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(Ue,new wC(this._rpcProtocol)),o.set(hl,new bC(n)),o.set(eb,i),o.set(ze,new Mi(Fg,[!0],!0)),o.set(Es,new Mi(wd,[],!0));const a=new dl(o,!0);qo&&a.invokeFunction(rb.installEarlyHandler),this._logService=a.invokeFunction(c=>c.get(ze)),ti("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(c=>c.get(sr)),this._extensionService.initialize(),qo&&a.invokeFunction(rb.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(j.MainThreadExtensionService);return b.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(j.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,i])=>[b.revive(t),b.revive(i)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(n=>{n.extensionLocation=b.revive(t.transformIncomingURIs(n.extensionLocation))}),e.environment.appRoot=b.revive(t.transformIncomingURIs(e.environment.appRoot));const i=e.environment.extensionDevelopmentLocationURI;return i&&(e.environment.extensionDevelopmentLocationURI=i.map(n=>b.revive(t.transformIncomingURIs(n)))),e.environment.extensionTestsLocationURI=b.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=b.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=b.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=b.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=b.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=b.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}const Tk=function(e){const t=i=>{globalThis.removeEventListener("message",t);const n=i.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){n.postMessage(s,o)}},onmessage:{get(){return n.onmessage},set(s){n.onmessage=s}}}),n.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),n.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(e)};globalThis.addEventListener("message",t)}.toString();class Ak extends EventTarget{constructor(e,t,i){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const n=`((${Tk})('${t}'))`,s=new Blob([n],{type:"application/javascript"}),o=URL.createObjectURL(s),a=new MessageChannel,c=o,l={type:"_newWorker",id:c,port:a.port2,url:o,options:i};e(l,[a.port2]),this.postMessage=a.port1.postMessage.bind(a.port1),this.terminate=()=>{e({type:"_terminateWorker",id:c}),URL.revokeObjectURL(o),a.port1.close(),a.port2.close()},Object.defineProperties(this,{onmessage:{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},onmessageerror:{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}}),a.port1.addEventListener("messageerror",u=>{const h=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(h)}),a.port1.addEventListener("message",u=>{const h=new MessageEvent("message",{data:u.data});this.dispatchEvent(h)}),a.port1.start()}}new X("inOutput",!1),new X("activeLogOutput",!1),new X("outputView.scrollLock",!1),ee("outputService");var cc;(function(r){r[r.Append=1]="Append",r[r.Replace=2]="Replace",r[r.Clear=3]="Clear"})(cc||(cc={}));const Rk={OutputChannels:"workbench.contributions.outputChannels"};class Lk{constructor(){this.channels=new Map,this._onDidRegisterChannel=new P,this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=new P,this.onDidRemoveChannel=this._onDidRemoveChannel.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}removeChannel(e){this.channels.delete(e),this._onDidRemoveChannel.fire(e)}}ri.add(Rk.OutputChannels,new Lk),new X("activeOutputChannel","");function Ok(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}class sb extends a_{get disposed(){return this._disposed}constructor(e,t,i,n,s){super(),this.id=e,this.name=t,this.logger=i,this.proxy=n,this.extension=s,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel(o=>this.setLevel(o)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,cc.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,cc.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=he.fromString(t).byteLength,dC(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,cc.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class $k extends sb{appendLine(e){this.append(e)}}let Hg=class{constructor(e,t,i,n,s,o){this.initData=t,this.extHostFileSystem=i,this.extHostFileSystemInfo=n,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(j.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${Ok(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,i]of this.channels)i.visible=t===this.visibleChannelId}createOutputChannel(e,t,i){if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const n=typeof t=="object"&&t.log,s=Le(t)?t:void 0;if(Le(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=this.initData.environment.extensionLogLevel?.find(([l])=>Qe.equals(i.identifier,l))?.[1];a&&(o=gC(a));const c=n?this.doCreateLogOutputChannel(e,o,i):this.doCreateOutputChannel(e,s,i);return c.then(l=>{this.channels.set(l.id,l),l.visible=l.id===this.visibleChannelId}),n?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),c):this.createExtHostOutputChannel(e,c)}async doCreateOutputChannel(e,t,i){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const n=await this.outputDirectoryPromise,s=this.extHostFileSystemInfo.extUri.joinPath(n,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),o=this.loggerService.createLogger(s,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),a=await this.proxy.$register(e,s,t,i.identifier.value);return new sb(a,e,o,this.proxy,i)}async doCreateLogOutputChannel(e,t,i){const n=await this.createExtensionLogDirectory(i),s=e.replace(/[\\/:\*\?"<>\|]/g,""),o=this.extHostFileSystemInfo.extUri.joinPath(n,`${s}.log`),a=`${i.identifier.value}.${s}`,c=this.loggerService.createLogger(o,{id:a,name:e,logLevel:t,extensionId:i.identifier.value});return new $k(a,e,c,this.proxy,i)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const i=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(n){if(hf(n)!==ye.FileExists)throw n}return i})())}return t}createExtHostOutputChannel(e,t){let i=!1;const n=()=>{if(i)throw new Error("Channel has been closed")};return{get name(){return e},append(s){n(),t.then(o=>o.append(s))},appendLine(s){n(),t.then(o=>o.appendLine(s))},clear(){n(),t.then(s=>s.clear())},replace(s){n(),t.then(o=>o.replace(s))},show(s,o){n(),t.then(a=>a.show(s,o))},hide(){n(),t.then(s=>s.hide())},dispose(){i=!0,t.then(s=>s.dispose())}}}createExtHostLogOutputChannel(e,t,i){const n=new Pe,s=()=>{if(n.isDisposed)throw new Error("Channel has been closed")},o=n.add(new P);function a(c){t=c,o.fire(c)}return i.then(c=>{n.add(c),c.logLevel!==t&&a(c.logLevel),n.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.createExtHostOutputChannel(e,i),get logLevel(){return t},onDidChangeLogLevel:o.event,trace(c,...l){s(),i.then(u=>u.trace(c,...l))},debug(c,...l){s(),i.then(u=>u.debug(c,...l))},info(c,...l){s(),i.then(u=>u.info(c,...l))},warn(c,...l){s(),i.then(u=>u.warn(c,...l))},error(c,...l){s(),i.then(u=>u.error(c,...l))},dispose(){n.dispose()}}}};Hg=F([O(0,Ue),O(1,At),O(2,gd),O(3,Ds),O(4,Es),O(5,ze)],Hg);const ob=ee("IExtHostOutputService");var lc;let Ug=class{static{lc=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(j.MainThreadDecorations)}registerFileDecorationProvider(e,t){const i=lc._handlePool++;this._provider.set(i,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(i,t.identifier.value);const n=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(i,null);return}const o=Bo(s);if(o.length<=lc._maxEventSize){this._proxy.$onDidChange(i,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:G2(u.path,"/")})),c=My(a,(u,h)=>u.rank-h.rank||Sr(u.uri.path,h.uri.path)),l=[];e:for(const u of c){let h;for(const f of u){const d=Cr(f.uri.path);if(h!==d&&(h=d,l.push(f.uri)>=lc._maxEventSize))break e}}this._proxy.$onDidChange(i,l)});return new ke(()=>{n?.dispose(),this._proxy.$unregisterDecorationProvider(i),this._provider.delete(i)})}async $provideDecorations(e,t,i){if(!this._provider.has(e))return Object.create(null);const n=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(s.provideFileDecoration(b.revive(c),i));if(!u)return;try{ep.validate(u),u.badge&&typeof u.badge!="string"&&N(o,"codiconDecoration"),n[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(h){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${h}`)}}catch(c){this._logService.error(c)}})),n}};Ug=lc=F([O(0,Ue),O(1,ze)],Ug);const ab=ee("IExtHostDecorations");class Nk{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=xo(e);const i=this.values,n=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=xo(e),t=xo(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=xo(e),t=xo(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=xo(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,s=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,s=this.prefixSum[n],o=s-this.values[n],e<o)i=n-1;else if(e>=s)t=n+1;else break;return new Fk(n,e-o)}}class Fk{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class Mk{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new pi(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Nk(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Ev(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),n[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const cb="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Hk(r=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of cb)r.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const Uk=Hk();function lb(r){let e=Uk;if(r&&r instanceof RegExp)if(r.global)e=r;else{let t="g";r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.unicode&&(t+="u"),e=new RegExp(r.source,t)}return e.lastIndex=0,e}const ub=new Wo;ub.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function db(r,e,t,i,n){if(e=lb(e),n||(n=_r.first(ub)),t.length>n.maxLen){let l=r-n.maxLen/2;return l<0?l=0:i+=l,t=t.substring(l,r+n.maxLen/2),db(r,e,t,i,n)}const s=Date.now(),o=r-1-i;let a=-1,c=null;for(let l=1;!(Date.now()-s>=n.timeBudget);l++){const u=o-n.windowSize*l;e.lastIndex=Math.max(0,u);const h=Bk(e,t,o,a);if(!h&&c||(c=h,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:i+1+c.index,endColumn:i+1+c.index+c[0].length};return e.lastIndex=0,l}return null}function Bk(r,e,t,i){let n;for(;n=r.exec(e);){const s=n.index||0;if(s<=t&&r.lastIndex>=t)return n;if(i>0&&s>i)return null}return null}const Bg=new Map;function Wk(r,e){e?Bg.set(r,e):Bg.delete(r)}function Vk(r){return Bg.get(r)}class zk extends Mk{constructor(e,t,i,n,s,o,a){super(t,i,n,s),this._proxy=e,this._languageId=o,this._isDirty=a,this._isDisposed=!1}dispose(){Xt(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return Tn(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===K.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?ki.LF:ki.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)}}}return Object.freeze(this._document)}_acceptLanguageId(e){Xt(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){Xt(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,n=t.start.line,s=t.end.line,o=[];o.push(this._lines[n].substring(t.start.character));for(let a=n+1;a<s;a++)o.push(this._lines[a]);return o.push(this._lines[s].substring(0,t.end.character)),o.join(i)}_lineAt(e){let t;if(e instanceof xe?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new qk(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new xe(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof ve))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new ve(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof xe))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:i}=e,n=!1;if(t<0)t=0,i=0,n=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,n=!0;else{const s=this._lines[t].length;i<0?(i=0,n=!0):i>s&&(i=s,n=!0)}return n?new xe(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(!t)t=Vk(this._languageId);else if(Sv(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const n=db(i.character+1,lb(t),this._lines[i.line],0);if(n)return new ve(i.line,n.startColumn-1,i.line,n.endColumn-1)}}class qk{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new ve(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new ve(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class Wg{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}class Vg{static{this._Keys=new Wg("TextEditorDecorationType")}constructor(e,t,i){const n=Vg._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,n,kp.from(i)),this.value=Object.freeze({key:n,dispose(){e.$removeTextEditorDecorationType(n)}})}}class jk{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof xe)i=new ve(e,e);else if(e instanceof ve)i=e;else throw new Error("Unrecognized location");this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new ve(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof ve)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const n=this._document.validateRange(e);this._collectedEdits.push({range:n,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==ki.LF&&e!==ki.CRLF)throw be("endOfLine");this._setEndOfLine=e}}class Gk{constructor(e,t,i,n){this._proxy=e,this._id=t,this._accept(i),this._logService=n;const s=this;this.value={get tabSize(){return s._tabSize},set tabSize(o){s._setTabSize(o)},get indentSize(){return s._indentSize},set indentSize(o){s._setIndentSize(o)},get insertSpaces(){return s._insertSpaces},set insertSpaces(o){s._setInsertSpaces(o)},get cursorStyle(){return s._cursorStyle},set cursorStyle(o){s._setCursorStyle(o)},get lineNumbers(){return s._lineNumbers},set lineNumbers(o){s._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=oo.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:oo.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const n=this._validateTabSize(e.tabSize);n==="auto"?(i=!0,t.tabSize=n):typeof n=="number"&&this._tabSize!==n&&(this._tabSize=n,i=!0,t.tabSize=n)}if(typeof e.indentSize<"u"){const n=this._validateIndentSize(e.indentSize);n==="tabSize"?(i=!0,t.indentSize=n):typeof n=="number"&&this._originalIndentSize!==n&&(this._indentSize=n,this._originalIndentSize=n,i=!0,t.indentSize=n)}if(typeof e.insertSpaces<"u"){const n=this._validateInsertSpaces(e.insertSpaces);n==="auto"?(i=!0,t.insertSpaces=n):this._insertSpaces!==n&&(this._insertSpaces=n,i=!0,t.insertSpaces=n)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=oo.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(i=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(i)})}}class Qk{constructor(e,t,i,n,s,o,a,c){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new Gk(this._proxy,this.id,o,i),this._visibleRanges=a,this._viewColumn=c;const l=this;this.value=Object.freeze({get document(){return n.value},set document(u){throw new vr("document")},get selection(){return l._selections&&l._selections[0]},set selection(u){if(!(u instanceof un))throw be("selection");l._selections=[u],l._trySetSelection()},get selections(){return l._selections},set selections(u){if(!Array.isArray(u)||u.some(h=>!(h instanceof un)))throw be("selections");l._selections=u,l._trySetSelection()},get visibleRanges(){return l._visibleRanges},set visibleRanges(u){throw new vr("visibleRanges")},get options(){return l._options.value},set options(u){l._disposed||l._options.assign(u)},get viewColumn(){return l._viewColumn},set viewColumn(u){throw new vr("viewColumn")},edit(u,h={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const f=new jk(n.value,h);return u(f),l._applyEdit(f)},insertSnippet(u,h,f={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let d;if(!h||Array.isArray(h)&&h.length===0)d=l._selections.map(_=>$.from(_));else if(h instanceof xe){const{lineNumber:_,column:w}=He.from(h);d=[{startLineNumber:_,startColumn:w,endLineNumber:_,endColumn:w}]}else if(h instanceof ve)d=[$.from(h)];else{d=[];for(const _ of h)if(_ instanceof ve)d.push($.from(_));else{const{lineNumber:w,column:x}=He.from(_);d.push({startLineNumber:w,startColumn:x,endLineNumber:w,endColumn:x})}}return t.$tryInsertSnippet(e,n.value.version,u.value,d,f)},setDecorations(u,h){const f=h.length===0;f&&!l._hasDecorationsForKey.has(u.key)||(f?l._hasDecorationsForKey.delete(u.key):l._hasDecorationsForKey.add(u.key),l._runOnProxy(()=>{if(c0(h))return t.$trySetDecorations(e,u.key,sE(h));{const d=new Array(4*h.length);for(let _=0,w=h.length;_<w;_++){const x=h[_];d[4*_]=x.start.line+1,d[4*_+1]=x.start.character+1,d[4*_+2]=x.end.line+1,d[4*_+3]=x.end.character+1}return t.$trySetDecorationsFast(e,u.key,d)}}))},revealRange(u,h){l._runOnProxy(()=>t.$tryRevealRange(e,$.from(u),h||Zl.Default))},show(u){t.$tryShowEditor(e,pt.from(u))},hide(){t.$tryHideEditor(e)}})}dispose(){Xt(!this._disposed),this._disposed=!0}_acceptOptions(e){Xt(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){Xt(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){Xt(!this._disposed),this._viewColumn=e}_acceptSelections(e){Xt(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(mi.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(s=>s.range);i.sort((s,o)=>s.end.line===o.end.line?s.end.character===o.end.character?s.start.line===o.start.line?s.start.character-o.start.character:s.start.line-o.start.line:s.end.character-o.end.character:s.end.line-o.end.line);for(let s=0,o=i.length-1;s<o;s++){const a=i[s].end;if(i[s+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const n=t.edits.map(s=>({range:$.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,n,{setEndOfLine:typeof t.setEndOfLine=="number"?ao.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class Kk{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let zg=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new it,this._onDidAddDocuments=new P,this._onDidRemoveDocuments=new P,this._onDidChangeVisibleTextEditors=new P,this._onDidChangeActiveTextEditor=new P,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],i=[],n=[];if(e.removedDocuments)for(const s of e.removedDocuments){const o=b.revive(s),a=this._documents.get(o);a?.unref()&&(this._documents.delete(o),t.push(a.value))}if(e.addedDocuments)for(const s of e.addedDocuments){const o=b.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==K.vscodeNotebookCell&&o.scheme!==K.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new Kk(new zk(this._extHostRpc.getProxy(j.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty)),this._documents.set(o,a),i.push(a.value)),a.ref()}if(e.removedEditors)for(const s of e.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&n.push(o)}if(e.addedEditors)for(const s of e.addedEditors){const o=b.revive(s.documentUri);Xt(this._documents.has(o),`document '${o}' does not exist`),Xt(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,c=new Qk(s.id,this._extHostRpc.getProxy(j.MainThreadTextEditors),this._logService,new ui(()=>a.document),s.selections.map(mi.to),s.options,s.visibleRanges.map(l=>$.to(l)),typeof s.editorPosition=="number"?pt.to(s.editorPosition):void 0);this._editors.set(s.id,c)}e.newActiveEditor!==void 0&&(Xt(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),wr(t),wr(n),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(i),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){return this._documents.get(e)?.value}allDocuments(){return _r.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t?.value}allEditors(){return[...this._editors.values()]}};zg=F([O(0,Ue),O(1,ze)],zg);const uc=ee("IExtHostDocumentsAndEditors"),bd=ee("IExtHostApiDeprecationService");let qg=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(j.MainThreadTelemetry)}report(e,t,i){const n=this.getUsageKey(e,t);this._reportedUsages.has(n)||(this._reportedUsages.add(n),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${i}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};qg=F([O(0,Ue),O(1,ze)],qg);var yd;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(yd||(yd={}));var xd;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(xd||(xd={}));var jg;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(jg||(jg={}));var dc;(function(r){function e(n){if(n){const s=n;return s&&!!s.process}else return!1}r.is=e;function t(n){if(n==null)return;const s={process:n.process,args:n.args};return n.options&&(s.options=jg.from(n.options)),s}r.from=t;function i(n){if(n!=null)return new qs(n.process,n.args,n.options)}r.to=i})(dc||(dc={}));var Gg;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(Gg||(Gg={}));var hc;(function(r){function e(n){if(n){const s=n;return s&&(!!s.commandLine||!!s.command)}else return!1}r.is=e;function t(n){if(n==null)return;const s={};return n.commandLine!==void 0?s.commandLine=n.commandLine:(s.command=n.command,s.args=n.args),n.options&&(s.options=Gg.from(n.options)),s}r.from=t;function i(n){if(!(n==null||n.command===void 0&&n.commandLine===void 0))return n.commandLine?new Vr(n.commandLine,n.options):new Vr(n.command,n.args?n.args:[],n.options)}r.to=i})(hc||(hc={}));var vn;(function(r){function e(n){if(n){const s=n;return s&&s.customExecution==="customExecution"}else return!1}r.is=e;function t(n){return{customExecution:"customExecution"}}r.from=t;function i(n,s){return s.get(n)}r.to=i})(vn||(vn={}));var Qg;(function(r){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}r.from=e})(Qg||(Qg={}));var or;(function(r){function e(n,s){if(n==null)return[];const o=[];for(const a of n){const c=t(a,s);c&&o.push(c)}return o}r.fromMany=e;function t(n,s){if(n==null)return;let o;n.execution instanceof qs?o=dc.from(n.execution):n.execution instanceof Vr?o=hc.from(n.execution):n.execution&&n.execution instanceof Vf&&(o=vn.from(n.execution));const a=yd.from(n.definition);let c;return n.scope?typeof n.scope=="number"?c=n.scope:c=n.scope.uri:c=zr.Workspace,!a||!c?void 0:{_id:n._id,definition:a,name:n.name,source:{extensionId:s.identifier.value,label:n.source,scope:c},execution:o,isBackground:n.isBackground,group:Qg.from(n.group),presentationOptions:xd.from(n.presentationOptions),problemMatchers:n.problemMatchers,hasDefinedMatchers:n.hasDefinedMatchers,runOptions:n.runOptions?n.runOptions:{reevaluateOnRerun:!0},detail:n.detail}}r.from=t;async function i(n,s,o){if(n==null)return;let a;dc.is(n.execution)?a=dc.to(n.execution):hc.is(n.execution)?a=hc.to(n.execution):vn.is(n.execution)&&(a=vn.to(n._id,o));const c=yd.to(n.definition);let l;if(n.source&&(n.source.scope!==void 0?typeof n.source.scope=="number"?l=n.source.scope:l=await s.resolveWorkspaceFolder(b.revive(n.source.scope)):l=zr.Workspace),!c||!l)return;const u=new nu(c,l,n.name,n.source.label,a,n.problemMatchers);return n.isBackground!==void 0&&(u.isBackground=n.isBackground),n.group!==void 0&&(u.group=Ia.from(n.group._id),u.group&&n.group.isDefault&&(u.group=new Ia(u.group.id,u.group.label),n.group.isDefault===!0&&(u.group.isDefault=n.group.isDefault))),n.presentationOptions&&(u.presentationOptions=xd.to(n.presentationOptions)),n._id&&(u._id=n._id),n.detail&&(u.detail=n.detail),u}r.to=i})(or||(or={}));var Kg;(function(r){function e(i){return i}r.from=e;function t(i){if(i)return Object.assign(Object.create(null),i)}r.to=t})(Kg||(Kg={}));class Jg{#e;constructor(e,t,i){this._id=t,this._task=i,this.#e=e}get task(){return this._task}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}let Xg=class{constructor(e,t,i,n,s,o,a,c){this._onDidExecuteTask=new P,this._onDidTerminateTask=new P,this._onDidTaskProcessStarted=new P,this._onDidTaskProcessEnded=new P,this._proxy=e.getProxy(j.MainThreadTask),this._workspaceProvider=i,this._editorService=n,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=c,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,i){if(!i)return new ke(()=>{});const n=this.nextHandle();return this._handlers.set(n,{type:t,provider:i,extension:e}),this._proxy.$registerTaskProvider(n,t),new ke(()=>{this._handlers.delete(n),this._proxy.$unregisterTaskProvider(n)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(Kg.from(e)).then(async t=>{const i=[];for(const n of t){const s=await or.to(n,this._workspaceProvider,this._providedCustomExecutions2);s&&i.push(s)}return i})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof Jg))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,i){const n=this._providedCustomExecutions2.get(e.id);n&&(this._activeCustomExecutions2.set(e.id,n),this._terminalService.attachPtyToTerminal(t,await n.callback(i))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));const n=[],s=Pt(()=>i.provider.provideTasks(yt.None)).then(o=>this.provideTasksInternal(t,n,i,o));return new Promise(o=>{s.then(a=>{Promise.all(n).then(()=>{o(a)})})})}async $resolveTask(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));if(t.definition.type!==i.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${i.type}].`);const n=await or.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!n)throw new Error("Unexpected: Task cannot be resolved.");const s=await i.provider.resolveTask(n,yt.None);if(!s)return;this.checkDeprecation(s,i);const o=or.from(s,i.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==n.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return vn.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,i){const n=await this._proxy.$createTaskId(e);!i&&!this._providedCustomExecutions2.has(n)&&(this._notProvidedCustomExecutions.add(n),this._activeCustomExecutions2.set(n,t.execution)),this._providedCustomExecutions2.set(n,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const s=this._taskExecutionPromises.get(e);if(!s)throw new Pn("Unexpected: The specified task is missing an execution");return s}const i=this._taskExecutionPromises.get(e.id);if(i)return i;let n;return t?n=Promise.resolve(new Jg(this,e.id,t)):n=or.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new Pn("Unexpected: Task does not exist.");return new Jg(this,e.id,s)}),this._taskExecutionPromises.set(e.id,n),n.then(s=>(this._taskExecutions.set(e.id,s),s))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const i=this._notProvidedCustomExecutions.values();let n=i.next();for(;!n.done;)!this._activeCustomExecutions2.has(n.value)&&this._lastStartedTask!==n.value&&(this._providedCustomExecutions2.delete(n.value),this._notProvidedCustomExecutions.delete(n.value)),n=i.next()}};Xg=F([O(0,Ue),O(1,At),O(2,gn),O(3,uc),O(4,mn),O(5,sc),O(6,ze),O(7,bd)],Xg);let Yg=class extends Xg{constructor(e,t,i,n,s,o,a,c){super(e,t,i,n,s,o,a,c),this.registerTaskSystem(K.vscodeRemote,{scheme:K.vscodeRemote,authority:"",platform:b2(0)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const i=or.from(t,e);if(i===void 0)throw new Error("Task is not valid");if(vn.is(i.execution))await this.addCustomExecution(i,t,!1);else throw new uh;const n=await this.getTaskExecution(await this._proxy.$getTaskExecution(i),t);return this._proxy.$executeTask(i).catch(s=>{throw new Error(s)}),n}provideTasksInternal(e,t,i,n){const s=[];if(n)for(const o of n){if(this.checkDeprecation(o,i),!o.definition||!e[o.definition.type]){const c=o.source?o.source:"No task source";this._logService.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=or.from(o,i.extension);a&&vn.is(a.execution)?(s.push(a),t.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:i.extension}}async resolveTaskInternal(e){if(vn.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,i){}};Yg=F([O(0,Ue),O(1,At),O(2,gn),O(3,uc),O(4,mn),O(5,sc),O(6,ze),O(7,bd)],Yg);const hb=ee("IExtHostTask"),fc=ee("IExtHostEditorTabs");class fb{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new up(b.revive(this._dto.input.uri));case 2:return new dp(b.revive(this._dto.input.original),b.revive(this._dto.input.modified));case 3:return new t0(b.revive(this._dto.input.base),b.revive(this._dto.input.input1),b.revive(this._dto.input.input2),b.revive(this._dto.input.result));case 6:return new hp(b.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new i0(this._dto.input.viewType);case 4:return new fp(b.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new pp(b.revive(this._dto.input.original),b.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new n0;case 9:return new r0(b.revive(this._dto.input.uri),b.revive(this._dto.input.inputBoxUri));case 10:return new s0(this._dto.input.providerId);default:return}}}class Jk{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const i of e.tabs)i.isActive&&(this._activeTabId=i.id),this._tabs.push(new fb(i,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return pt.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find(i=>i.tabId===e._activeTabId)?.apiObject},get tabs(){return Object.freeze(e._tabs.map(i=>i.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===0){const i=new fb(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,i),e.tabDto.isActive&&(this._activeTabId=i.tabId),i}else if(e.kind===1){const i=this._tabs.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this._activeTabId&&(this._activeTabId=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this._tabs.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,i),i}const t=this._tabs.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let Zg=class{constructor(e){this._onDidChangeTabs=new P,this._onDidChangeTabGroups=new P,this._extHostTabGroups=[],this._proxy=e.getProxy(j.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(i=>i.apiObject))},get activeTabGroup(){const i=e._activeGroupId;return xs(e._extHostTabGroups.find(s=>s.groupId===i)?.apiObject)},close:async(i,n)=>{const s=Array.isArray(i)?i:[i];return s.length?Xk(s[0])?this._closeGroups(s,n):this._closeTabs(s,n):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){const t=new Set(this._extHostTabGroups.map(l=>l.groupId)),i=new Set(e.map(l=>l.groupId)),n=Vy(t,i),s=this._extHostTabGroups.filter(l=>n.removed.includes(l.groupId)).map(l=>l.apiObject),o=[],a=[];this._extHostTabGroups=e.map(l=>{const u=new Jk(l,()=>this._activeGroupId);return n.added.includes(u.groupId)?o.push(u.apiObject):a.push(u.apiObject),u});const c=xs(e.find(l=>l.isActive===!0)?.groupId);c!==void 0&&this._activeGroupId!==c&&(this._activeGroupId=c),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(i=>i.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const i=t.acceptTabOperation(e);switch(e.kind){case 0:this._onDidChangeTabs.fire(Object.freeze({opened:[i.apiObject],closed:[],changed:[]}));return;case 1:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[i.apiObject],changed:[]}));return;case 3:case 2:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[i.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const i of t.tabs)if(i.apiObject===e)return i}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const i=[];for(const n of e){const s=this._findExtHostTabFromApi(n);if(!s)throw new Error("Tab close: Invalid tab not found!");i.push(s.tabId)}return this._proxy.$closeTab(i,t)}async _closeGroups(e,t){const i=[];for(const n of e){const s=this._findExtHostTabGroupFromApi(n);if(!s)throw new Error("Group close: Invalid group not found!");i.push(s.groupId)}return this._proxy.$closeGroup(i,t)}};Zg=F([O(0,Ue)],Zg);function Xk(r){return r.tabs!==void 0}class Yk{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new P,this._onExit=new P,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,n){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.internalSend("request",s),typeof n=="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(s.seq);if(a){this.pendingRequests.delete(s.seq);const c={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:g("vs/workbench/contrib/debug/common/abstractDebugAdapter","timeout","Timeout after {0} ms for '{1}'",n,e)};a(c)}},n)}return i&&this.pendingRequests.set(s.seq,i),s.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await Hn(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":this.eventCallback?.(e);break;case"request":this.requestCallback?.(e);break;case"response":{const t=e,i=this.pendingRequests.get(t.request_seq);i&&(this.pendingRequests.delete(t.request_seq),i(t));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,i)=>e.set(i,t)),await Hn(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(i)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function Zk(r){return r.type&&(r.label||r.program||r.runtime)}const e5=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function t5(r){return!!(r&&r.match(e5))}function i5(r){if(typeof r.path=="string"&&!(typeof r.sourceReference=="number"&&r.sourceReference>0)){if(t5(r.path))return b.parse(r.path);if(Sh(r.path))return b.file(r.path)}return r.path}function n5(r){if(typeof r.path=="object"){const e=b.revive(r.path);if(e)return e.scheme===K.file?e.fsPath:e.toString()}return r.path}function r5(r,e){const t=n5,i=ct(r);return pb(i,(n,s)=>{n&&s&&(s.path=t(s))}),i}function s5(r,e){const t=i5,i=ct(r);return pb(i,(n,s)=>{!n&&s&&(s.path=t(s))}),i}function pb(r,e){switch(r.type){case"event":{const t=r;switch(t.event){case"output":e(!1,t.body.source);break;case"loadedSource":e(!1,t.body.source);break;case"breakpoint":e(!1,t.body.breakpoint.source);break}break}case"request":{const t=r;switch(t.command){case"setBreakpoints":e(!0,t.arguments.source);break;case"breakpointLocations":e(!0,t.arguments.source);break;case"source":e(!0,t.arguments.source);break;case"gotoTargets":e(!0,t.arguments.source);break;case"launchVSCode":t.arguments.args.forEach(i=>e(!1,i));break}break}case"response":{const t=r;if(t.success&&t.body)switch(t.command){case"stackTrace":t.body.stackFrames.forEach(i=>e(!1,i.source));break;case"loadedSources":t.body.sources.forEach(i=>e(!1,i));break;case"scopes":t.body.scopes.forEach(i=>e(!1,i.source));break;case"setFunctionBreakpoints":t.body.breakpoints.forEach(i=>e(!1,i.source));break;case"setBreakpoints":t.body.breakpoints.forEach(i=>e(!1,i.source));break;case"disassemble":t.body?.instructions.forEach(n=>e(!1,n.location));break}break}}}ee("configurationResolverService");var qe;(function(r){r.Unknown="unknown",r.Env="env",r.Config="config",r.Command="command",r.Input="input",r.ExtensionInstallFolder="extensionInstallFolder",r.WorkspaceFolder="workspaceFolder",r.Cwd="cwd",r.WorkspaceFolderBasename="workspaceFolderBasename",r.UserHome="userHome",r.LineNumber="lineNumber",r.SelectedText="selectedText",r.File="file",r.FileWorkspaceFolder="fileWorkspaceFolder",r.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",r.RelativeFile="relativeFile",r.RelativeFileDirname="relativeFileDirname",r.FileDirname="fileDirname",r.FileExtname="fileExtname",r.FileBasename="fileBasename",r.FileBasenameNoExtension="fileBasenameNoExtension",r.FileDirnameBasename="fileDirnameBasename",r.ExecPath="execPath",r.ExecInstallFolder="execInstallFolder",r.PathSeparator="pathSeparator",r.PathSeparatorAlias="/"})(qe||(qe={}));class qt extends Error{constructor(e,t){super(t),this.variable=e}}class pc{static{this.VARIABLE_LHS="${"}static{this.VARIABLE_REGEXP=/\$\{(.*?)\}/g}constructor(e,t,i,n){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=i,n&&(this._envVariablesPromise=n.then(s=>this.prepareEnv(s)))}prepareEnv(e){if(Gt){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}resolveWithEnvironment(e,t,i){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,i)}async resolveAsync(e,t){const i={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(i,e?e.uri:void 0,t)}async resolveAnyBase(e,t,i,n){const s=ct(t);Gt&&s.windows?Object.keys(s.windows).forEach(a=>s[a]=s.windows[a]):wi&&s.osx?Object.keys(s.osx).forEach(a=>s[a]=s.osx[a]):An&&s.linux&&Object.keys(s.linux).forEach(a=>s[a]=s.linux[a]),delete s.windows,delete s.osx,delete s.linux;const o={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(o,e?e.uri:void 0,s,i,n)}async resolveAnyAsync(e,t,i){return this.resolveAnyBase(e,t,i)}async resolveAnyMap(e,t,i){const n=new Map;return{newConfig:await this.resolveAnyBase(e,t,i,n),resolvedVariables:n}}resolveWithInteractionReplace(e,t,i,n){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,i,n){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,i,n,s){if(Le(i))return this.resolveString(e,t,i,n,s);if(Array.isArray(i))return Promise.all(i.map(o=>this.recursiveResolve(e,t,o,n,s)));if(It(i)){const o=Object.create(null),a=await Promise.all(Object.keys(i).map(async c=>[await this.resolveString(e,t,c,n,s),await this.recursiveResolve(e,t,i[c],n,s)]));for(const[c,l]of a)o[c]=l;return o}return i}resolveString(e,t,i,n,s){return X2(i,pc.VARIABLE_REGEXP,async(o,a)=>{if(a.includes(pc.VARIABLE_LHS))return o;let c=await this.evaluateSingleVariable(e,o,a,t,n);return s?.set(a,c),c!==o&&Le(c)&&c.match(pc.VARIABLE_REGEXP)&&(c=await this.resolveString(e,t,c,n,s)),c})}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,n,s){let o;const a=i.split(":");a.length>1&&(i=a[0],o=a[1]);const c=h=>{const f=this._context.getFilePath();if(f)return oc(f);throw new qt(h,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveFile","Variable {0} can not be resolved. Please open an editor.",t))},l=h=>{const f=c(h);if(this._context.getWorkspaceFolderPathForFile){const d=this._context.getWorkspaceFolderPathForFile();if(d)return oc(d)}throw new qt(h,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveFolderForFile","Variable {0}: can not find workspace folder of '{1}'.",t,Kt(f)))},u=h=>{if(o){const f=this._context.getFolderUri(o);if(f)return f;throw new qt(h,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotFindFolder","Variable {0} can not be resolved. No such folder '{1}'.",t,o))}if(n)return n;throw this._context.getWorkspaceFolderCount()>1?new qt(h,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveWorkspaceFolderMultiRoot","Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t)):new qt(h,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveWorkspaceFolder","Variable {0} can not be resolved. Please open a folder.",t))};switch(i){case"env":if(o){if(e.env){const h=e.env[Gt?o.toLowerCase():o];if(Le(h))return h}return""}throw new qt(qe.Env,g("vs/workbench/services/configurationResolver/common/variableResolver","missingEnvVarName","Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(o){const h=this._context.getConfigurationValue(n,o);if(Lt(h))throw new qt(qe.Config,g("vs/workbench/services/configurationResolver/common/variableResolver","configNotFound","Variable {0} can not be resolved because setting '{1}' not found.",t,o));if(It(h))throw new qt(qe.Config,g("vs/workbench/services/configurationResolver/common/variableResolver","configNoString","Variable {0} can not be resolved because '{1}' is a structured value.",t,o));return h}throw new qt(qe.Config,g("vs/workbench/services/configurationResolver/common/variableResolver","missingConfigName","Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(qe.Command,t,o,s,"command");case"input":return this.resolveFromMap(qe.Input,t,o,s,"input");case"extensionInstallFolder":if(o){const h=await this._context.getExtension(o);if(!h)throw new qt(qe.ExtensionInstallFolder,g("vs/workbench/services/configurationResolver/common/variableResolver","extensionNotInstalled","Variable {0} can not be resolved because the extension {1} is not installed.",t,o));return this.fsPath(h.extensionLocation)}throw new qt(qe.ExtensionInstallFolder,g("vs/workbench/services/configurationResolver/common/variableResolver","missingExtensionName","Variable {0} can not be resolved because no extension name is given.",t));default:switch(i){case"workspaceRoot":case"workspaceFolder":return oc(this.fsPath(u(qe.WorkspaceFolder)));case"cwd":return n||o?oc(this.fsPath(u(qe.Cwd))):vs();case"workspaceRootFolderName":case"workspaceFolderBasename":return oc(Kt(this.fsPath(u(qe.WorkspaceFolderBasename))));case"userHome":{if(e.userHome)return e.userHome;throw new qt(qe.UserHome,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveUserHome","Variable {0} can not be resolved. UserHome path is not defined",t))}case"lineNumber":{const h=this._context.getLineNumber();if(h)return h;throw new qt(qe.LineNumber,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveLineNumber","Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const h=this._context.getSelectedText();if(h)return h;throw new qt(qe.SelectedText,g("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveSelectedText","Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return c(qe.File);case"fileWorkspaceFolder":return l(qe.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return Kt(l(qe.FileWorkspaceFolderBasename));case"relativeFile":return n||o?jo(this.fsPath(u(qe.RelativeFile)),c(qe.RelativeFile)):c(qe.RelativeFile);case"relativeFileDirname":{const h=Cr(c(qe.RelativeFileDirname));if(n||o){const f=jo(this.fsPath(u(qe.RelativeFileDirname)),h);return f.length===0?".":f}return h}case"fileDirname":return Cr(c(qe.FileDirname));case"fileExtname":return Eh(c(qe.FileExtname));case"fileBasename":return Kt(c(qe.FileBasename));case"fileBasenameNoExtension":{const h=Kt(c(qe.FileBasenameNoExtension));return h.slice(0,h.length-Eh(h).length)}case"fileDirnameBasename":return Kt(Cr(c(qe.FileDirnameBasename)));case"execPath":{const h=this._context.getExecPath();return h||t}case"execInstallFolder":{const h=this._context.getAppRoot();return h||t}case"pathSeparator":case"/":return bi;default:try{const h=o?`${i}:${o}`:i;return this.resolveFromMap(qe.Unknown,t,h,s,void 0)}catch{return t}}}}resolveFromMap(e,t,i,n,s){if(i&&n){const o=s===void 0?n[i]:n[s+":"+i];if(typeof o=="string")return o;throw new qt(e,g("vs/workbench/services/configurationResolver/common/variableResolver","noValueForCommand","Variable {0} can not be resolved because the command has no value.",t))}return t}}const em=ee("IExtHostVariableResolverProvider");class o5 extends pc{constructor(e,t,i,n,s,o,a){function c(){if(i){const l=i.activeEditor();if(l)return l.document.uri;const u=n.tabGroups.all.find(h=>h.isActive)?.activeTab;if(u!==void 0){if(u.input instanceof dp||u.input instanceof pp)return u.input.modified;if(u.input instanceof up||u.input instanceof fp||u.input instanceof hp)return u.input.uri}}}super({getFolderUri:l=>{const u=o.folders.filter(h=>h.name===l);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>o.folders.length,getConfigurationValue:(l,u)=>s.getConfiguration(void 0,l).get(u),getAppRoot:()=>vs(),getExecPath:()=>xh.VSCODE_EXEC_PATH,getFilePath:()=>{const l=c();if(l)return _s(l.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const l=c();if(l){const u=t.getWorkspaceFolder(l);if(u)return _s(u.uri.fsPath)}}},getSelectedText:()=>{if(i){const l=i.activeEditor();if(l&&!l.selection.isEmpty)return l.document.getText(l.selection)}},getLineNumber:()=>{if(i){const l=i.activeEditor();if(l)return String(l.selection.end.line+1)}},getExtension:l=>e.getExtension(l)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(xh))}}let tm=class extends Me{constructor(e,t,i,n,s){super(),this.extensionService=e,this.workspaceService=t,this.editorService=i,this.configurationService=n,this.editorTabs=s,this._resolver=new ui(async()=>{const o=await this.configurationService.getConfigProvider(),c={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async l=>{c.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new o5(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,c,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};tm=F([O(0,sr),O(1,gn),O(2,uc),O(3,mn),O(4,fc)],tm);const gb=ee("IExtHostDebugService");let im=class{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,i,n,s,o,a){this._workspaceService=t,this._extensionService=i,this._configurationService=n,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=new P,this._onDidTerminateDebugSession=new P,this._onDidChangeActiveDebugSession=new P,this._onDidReceiveDebugSessionCustomEvent=new P,this._debugServiceProxy=e.getProxy(j.MainThreadDebugService),this._onDidChangeBreakpoints=new P,this._onDidChangeStackFrameFocus=new P,this._activeDebugConsole=new c5(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{c.onDidChange(l=>{this.registerAllDebugTypes(c)}),this.registerAllDebugTypes(c)})}async $getVisualizerTreeItem(e,t){const i=this.hydrateVisualizationContext(t);if(!i)return;const n=await this._debugVisualizationTrees.get(e)?.getTreeItem?.(i);return n?this.convertVisualizerTreeItem(e,n):void 0}registerDebugVisualizationTree(e,t,i){const n=Qe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(s,i),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!i.editItem),Te(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){const i=this._debugVisualizationElements.get(t)?.item;return i?(await this._debugVisualizationTrees.get(e)?.getChildren?.(i))?.map(s=>this.convertVisualizerTreeItem(e,s))||[]:[]}async $editVisualizerTreeItem(e,t){const i=this._debugVisualizationElements.get(e);if(!i)return;const n=await this._debugVisualizationTrees.get(i.provider)?.editItem?.(i.item,t);return this.convertVisualizerTreeItem(i.provider,n||i.item)}$disposeVisualizedTree(e){const t=this._debugVisualizationElements.get(e);if(!t)return;const i=[t.children];for(const n of i)if(n)for(const s of n)i.push(this._debugVisualizationElements.get(s)?.children),this._debugVisualizationElements.delete(s)}convertVisualizerTreeItem(e,t){let i=this._debugVisualizationTreeItemIds.get(t);return i||(i=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,i),this._debugVisualizationElements.set(i,{provider:e,item:t})),Xp.from(t,i)}asDebugSourceUri(e,t){const i=e;if(typeof i.sourceReference=="number"&&i.sourceReference>0){let n=`debug:${encodeURIComponent(i.path||"")}`,s="?";return t&&(n+=`${s}session=${encodeURIComponent(t.id)}`,s="&"),n+=`${s}ref=${i.sourceReference}`,b.parse(n)}else{if(i.path)return b.file(i.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const i of e.getAllExtensionDescriptions())if(i.contributes){const n=i.contributes.debuggers;if(n&&n.length>0)for(const s of n)Zk(s)&&t.push(s.type)}this._debugServiceProxy.$registerDebugTypes(t)}get stackFrameFocus(){return this._stackFrameFocus}get onDidChangeStackFrameFocus(){return this._onDidChangeStackFrameFocus.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){const i=this._visualizers.get(e);if(!i)throw new Error(`No debug visualizer found with id '${e}'`);let{v:n,provider:s,extensionId:o}=i;if(n.visualization||(n=await s.resolveDebugVisualization?.(n,t)||n,i.v=n),!n.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,n.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const i=t.v.visualization;i&&"command"in i&&this._commands.executeCommand(i.command,...i.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,i,n){const s=this.hydrateVisualizationContext(i),o=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const c=await a.provideDebugVisualization(s,n);return c?c.map(l=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:l,provider:a,extensionId:e});const h=l.iconPath?this.getIconPathOrClass(l.iconPath):void 0;return{id:u,name:l.name,iconClass:h?.iconClass,iconPath:h?.iconPath,visualization:this.serializeVisualization(e,l.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,i){if(!e.contributes?.debugVisualizers?.some(o=>o.id===t))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const n=Qe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(s,i),this._debugServiceProxy.$registerDebugVisualizer(n,t),Te(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(n,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(t,[],[]);const i=[],n=new Map;for(const s of t)if(s instanceof Gr){let o=n.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},n.set(s.location.uri.toString(),o),i.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof Qr&&i.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(i)}removeBreakpoints(e){const t=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],t,[]);const i=t.filter(o=>o instanceof Gr).map(o=>o.id),n=t.filter(o=>o instanceof Qr).map(o=>o.id),s=t.filter(o=>o instanceof au).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(i,n,s)}startDebugging(e,t,i){return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:i.parentSession?i.parentSession.id:void 0,lifecycleManagedByParent:i.lifecycleManagedByParent,repl:i.consoleMode===_u.MergeWithParent?"mergeWithParent":"separate",noDebug:i.noDebug,compact:i.compact,suppressSaveBeforeStart:i.suppressSaveBeforeStart,suppressDebugStatusbar:i.suppressDebugStatusbar??i.debugUI?.simple,suppressDebugToolbar:i.suppressDebugToolbar??i.debugUI?.simple,suppressDebugView:i.suppressDebugView??i.debugUI?.simple})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,i){if(!t)return new ke(()=>{});const n=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:n,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,i,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,n),new ke(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(n)})}registerDebugAdapterDescriptorFactory(e,t,i){if(!i)return new ke(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const n=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:n,factory:i}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,n),new ke(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==i),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(n)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new ke(()=>{});const i=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:i,factory:t}),new ke(()=>{this._trackerFactories=this._trackerFactories.filter(n=>n.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let i;const n=await this.getFolder(e);return n&&(i={uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAnyAsync(i,t)}createDebugAdapter(e,t){if(e.type==="implementation")return new u5(e.implementation)}createSignService(){}async $startDASession(e,t){const i=this,n=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(n.type),n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}' (extension might have failed to activate)`);const o=this.convertToDto(s),a=this.createDebugAdapter(o,n);if(!a)throw new Error(`Couldn't create a debug adapter for type '${n.type}'.`);const c=a;return this._debugAdapters.set(e,c),this.getDebugAdapterTrackers(n).then(l=>(l&&this._debugAdaptersTrackers.set(e,l),c.onMessage(async u=>{if(u.type==="request"&&u.command==="handshake"){const h=u,f={type:"response",seq:0,command:h.command,request_seq:h.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const d=await this._signService.sign(h.arguments.value);f.body={signature:d},c.sendResponse(f)}else throw new Error("no signer")}catch(d){f.success=!1,f.message=d.message,c.sendResponse(f)}}else l&&l.onDidSendMessage&&l.onDidSendMessage(u),u=s5(u),i._debugServiceProxy.$acceptDAMessage(e,u)}),c.onError(u=>{l&&l.onError&&l.onError(u),this._debugServiceProxy.$acceptDAError(e,u.name,u.message,u.stack)}),c.onExit(u=>{l&&l.onExit&&l.onExit(u??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,u??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),c.startSession()))})}$sendDAMessage(e,t){t=r5(t);const i=this._debugAdaptersTrackers.get(e);i&&i.onWillReceiveMessage&&i.onWillReceiveMessage(t),this._debugAdapters.get(e)?.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const i=this._debugAdapters.get(e);return this._debugAdapters.delete(e),i?i.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],i=[],n=[];if(e.added)for(const s of e.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new Qr(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new au(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const c=b.revive(s.uri);a=new Gr(new si(c,new xe(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}j4(a,o),this._breakpoints.set(o,a),t.push(a)}}if(e.removed)for(const s of e.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),i.push(o))}if(e.changed){for(const s of e.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof Qr&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof Gr&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new si(b.revive(s.uri),new xe(s.line,s.character))}n.push(o)}}}this.fireBreakpointChanges(t,i,n)}async $acceptStackFrameFocus(e){let t;const i=e.sessionId?await this.getSession(e.sessionId):void 0;if(!i)throw new Error("no DebugSession found for debug focus context");e.kind==="thread"?t=new hu(i.api,e.threadId):t=new du(i.api,e.threadId,e.frameId),this._stackFrameFocus=t,this._onDidChangeStackFrameFocus.fire(this._stackFrameFocus)}$provideDebugConfigurations(e,t,i){return Pt(async()=>{const n=this.getConfigProviderByHandle(e);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(t);return n.provideDebugConfigurations(s,i)}).then(n=>{if(!n)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return n})}$resolveDebugConfiguration(e,t,i,n){return Pt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(t);return s.resolveDebugConfiguration(o,i,n)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,i,n){return Pt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(t);return s.resolveDebugConfigurationWithSubstitutedVariables(o,i,n)})}async $provideDebugAdapter(e,t){const i=this.getAdapterDescriptorFactoryByHandle(e);if(!i)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const n=await this.getSession(t);return this.getAdapterDescriptor(i,n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(e,t){(await this.getSession(e))?._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const n={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(n)}convertToDto(e){if(e instanceof cu)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof Aa)return{type:"server",port:e.port,host:e.host};if(e instanceof lu)return{type:"pipeServer",path:e.path};if(e instanceof uu)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(i=>i.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(i=>i.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(i=>i.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const i=e.contributes.debuggers;if(i&&i.length>0){for(const n of i)if(n.label&&n.type&&n.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const i=e.configuration.type,n=this._trackerFactories.filter(s=>s.type===i||s.type==="*").map(s=>Pt(()=>s.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(n).then(s=>{const o=s.filter(a=>!!a);if(o.length>0)return new l5(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(e,t){const i=t.configuration.debugServer;if(typeof i=="number")return Promise.resolve(new Aa(i));if(e){const s=await this._extensionService.getExtensionRegistry();return Pt(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,s))).then(o=>{if(o)return o})}const n=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,n))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,i){(e.length>0||t.length>0||i.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:i}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const i=await this.getFolder(e.folderUri),n=e.parent?this._debugSessions.get(e.parent):void 0;t=new a5(this._debugServiceProxy,e.id,e.type,e.name,i,e.configuration,n?.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=b.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:0};if("treeId"in t)return{type:1,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let i,n;return"id"in t?n=Ht.asClassName(t):i=t,{iconPath:i,iconClass:n}}getIconUris(e){if(e instanceof Nt)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,i=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?b.file(t):t,light:typeof i=="string"?b.file(i):i}}};im=F([O(0,Ue),O(1,gn),O(2,sr),O(3,mn),O(4,fc),O(5,em),O(6,yo)],im);class a5{constructor(e,t,i,n,s,o,a){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=n,this._workspaceFolder=s,this._configuration=o,this._parentSession=a}get api(){const e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class c5{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class l5{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(i=>i.onExit?i.onExit(e,t):void 0)}}class u5 extends Yk{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let nm=class extends im{constructor(e,t,i,n,s,o,a){super(e,t,i,n,s,o,a)}};nm=F([O(0,Ue),O(1,gn),O(2,sr),O(3,mn),O(4,fc),O(5,em),O(6,yo)],nm);class d5{constructor(e,t,i){this.config=e,this.provider=t,this.sessionToken=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&Os(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&Os(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((i,n)=>{const s=o=>{this.resultCount++,e(o)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(o=>{const a=o.toString(),c=Kt(a);this.globalExcludePattern&&this.globalExcludePattern(a,c)||this.matchFile(s,{base:o,basename:c})}),Promise.all(t.map(o=>this.searchInFolder(o,s))).then(o=>{i({limitHit:this.isLimitHit,stats:o[0]||void 0})},o=>{n(new Error(Un(o)))})})}async searchInFolder(e,t){const i=new dt,n=this.getSearchOptionsForFolder(e),s=this.initDirectoryTree(),o=new p0(this.config,e),a=!o.hasSiblingExcludeClauses();let c;try{this.activeCancellationTokens.add(i),c=en.create();const l=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},n,i.token),u=c.elapsed(),h=en.create();return this.isCanceled&&!this.isLimitHit||(l&&l.forEach(f=>{const d=$e.relative(e.folder.path,f.path);if(a){const _=Kt(f.path);this.matchFile(t,{base:e.folder,relativePath:d,basename:_});return}this.addDirectoryEntries(s,e.folder,d,t)}),this.isCanceled&&!this.isLimitHit)?null:(this.matchDirectoryTree(s,o,t),{providerTime:u,postProcessTime:h.elapsed()})}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){const t=ad(this.config.includePattern,e.includePattern),i=ad(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,n){if(i===this.filePattern){const o=Kt(this.filePattern);this.matchFile(n,{base:t,relativePath:this.filePattern,basename:o})}function s(o){const a=Kt(o),c=Cr(o);let l=e[c];l||(l=e[c]=[],s(c)),l.push({base:t,relativePath:o,basename:a})}s(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,n){const s=this,o=this.filePattern;function a(c){const l=pE(()=>c.map(u=>u.basename));for(let u=0,h=c.length;u<h;u++){const f=c[u],{relativePath:d,basename:_}=f;if(i.matchesExcludesSync(d,_,o!==_?l:void 0))continue;const w=t[d];if(w)a(w);else{if(d===o)continue;s.matchFile(n,f)}if(s.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}class rm{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(e,t,i,n){const s=this.getSessionTokenSource(e.cacheKey),o=new d5(e,t,s&&s.token);let a=0;const c=l=>{a+=l.length,i(l.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,rm.BATCH_SIZE,c,n).then(l=>({limitHit:l.limitHit,stats:{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}}))}clearCache(e){this.getSessionTokenSource(e)?.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new dt),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:Cs(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,i,n){const s=n.onCancellationRequested(()=>{e.cancel()}),o=c=>{c&&(a.push(c),t>0&&a.length>=t&&(i(a),a=[]))};let a=[];return e.search(o).then(c=>(a.length&&i(a),s.dispose(),c),c=>(a.length&&i(a),s.dispose(),Promise.reject(c)))}}class h5{constructor(e,t,i,n){this.query=e,this.provider=t,this.fileUtils=i,this.processType=n,this.collector=null,this.isLimitHit=!1,this.resultCount=0}search(e,t){const i=this.query.folderQueries||[],n=new dt(t);return new Promise((s,o)=>{this.collector=new p5(e);let a=!1;const c=(l,u)=>{if(!a&&!this.isLimitHit){const h=this.resultSize(l);gc(l)&&typeof this.query.maxResults=="number"&&this.resultCount+h>this.query.maxResults&&(this.isLimitHit=!0,a=!0,n.cancel(),l=this.trimResultToSize(l,this.query.maxResults-this.resultCount));const f=this.resultSize(l);this.resultCount+=f,(f>0||!gc(l))&&this.collector.add(l,u)}};Promise.all(i.map((l,u)=>this.searchInFolder(l,h=>c(h,u),n.token))).then(l=>{n.dispose(),this.collector.flush();const u=l.some(h=>!!h&&!!h.limitHit);s({limitHit:this.isLimitHit||u,messages:Uc(l.map(h=>h?.message?Array.isArray(h.message)?h.message:[h.message]:[])),stats:{type:this.processType}})},l=>{n.dispose();const u=Un(l);o(new Error(u))})})}resultSize(e){return gc(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const i=Array.isArray(e.ranges)?e.ranges:[e.ranges],n=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:i.slice(0,t),preview:{matches:n.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,i){const n=new p0(this.query,e),s=[],o={report:l=>{if(!this.validateProviderResult(l))return;const u=e.folder.scheme===K.file?fE(()=>this.fileUtils.readdir(Fh(l.uri))):void 0,h=Wv(e.folder,l.uri);if(h){const f=n.includedInQuery(h,Kt(h),u);Mn(f)?s.push(f.then(d=>{d&&t(l)})):f&&t(l)}}},a=this.getSearchOptionsForFolder(e),c=await this.provider.provideTextSearchResults(f5(this.query.contentPattern),a,o,i);return s.length&&await Promise.all(s),c}validateProviderResult(e){if(gc(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}getSearchOptionsForFolder(e){const t=ad(this.query.includePattern,e.includePattern),i=ad(this.query.excludePattern,e.excludePattern),n={folder:b.from(e.folder),excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return n.usePCRE2=this.query.usePCRE2,n}}function f5(r){return{isCaseSensitive:r.isCaseSensitive||!1,isRegExp:r.isRegExp||!1,isWordMatch:r.isWordMatch||!1,isMultiline:r.isMultiline||!1,pattern:r.pattern}}class p5{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new Cd(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!Bv(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(g5(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function g5(r){return gc(r)?{preview:{matches:Uo(r.preview.matches,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})),text:r.preview.text},ranges:Uo(r.ranges,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))}:{text:r.text,lineNumber:r.lineNumber}}function gc(r){return!!r.preview}class Cd{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<Cd.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},Cd.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}}const mb=ee("IExtHostSearch");let sm=class{constructor(e,t,i){this.extHostRpc=e,this._uriTransformer=t,this._logService=i,this._proxy=this.extHostRpc.getProxy(j.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new rm}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,t),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),Te(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,t),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),Te(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}$provideFileSearchResults(e,t,i,n){const s=vb(i),o=this._fileSearchProvider.get(e);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(e,t,a.map(c=>c.resource))},n);throw new Error("unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,i){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,i,n){const s=this._textSearchProvider.get(e);if(!s||!s.provideTextSearchResults)throw new Error(`Unknown provider ${e}`);const o=vb(i);return this.createTextSearchManager(o,s).search(c=>this._proxy.$handleTextMatch(e,t,c),n)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new h5(e,t,{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"textSearchProvider")}};sm=F([O(0,Ue),O(1,hl),O(2,ze)],sm);function vb(r){return{...r,folderQueries:r.folderQueries&&r.folderQueries.map(m5),extraFileResources:r.extraFileResources&&r.extraFileResources.map(e=>b.revive(e))}}function m5(r){return{...r,folder:b.revive(r.folder)}}var om;let am=class{static{om=this}static{this.InitialState={focused:!0,active:!0}}getState(e){const t=this._state;return{get focused(){return t.focused},get active(){return N(e,"windowActivity"),t.active}}}constructor(e){this._onDidChangeWindowState=new P,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=om.InitialState,this._proxy=e.getProxy(j.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:t,isActive:i})=>{this.onDidChangeWindowProperty("focused",t),this.onDidChangeWindowProperty("active",i)})}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let i;if(typeof e=="string"){i=e;try{e=b.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return nl(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===K.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,i,t)}async asExternalUri(e,t){if(nl(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const i=await this._proxy.$asExternalUri(e,t);return b.from(i)}};am=om=F([O(0,Ue)],am);const _b=ee("IExtHostWindow");nt(Rg,Ag,1),nt(Es,wd,1),nt(bd,qg,1),nt(yo,yg,0),nt(mn,ag,0),nt(gd,dg,0),nt(gb,nm,0),nt(ab,Ug,0),nt(uc,zg,0),nt(Lg,Og,0),nt(Ds,PC,0),nt(ob,Hg,1),nt(mb,sm,0),nt(ug,D0,0),nt(hb,Yg,0),nt(sc,Sg,0),nt(vg,_g,0),nt(_b,am,0),nt(gn,Zp,0),nt(Tg,Z0,0),nt(md,bg,0),nt(fc,Zg,0),nt(em,tm,0);const wb={bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},v5=8;class _5{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class We{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Ed(e,t)}compute(e,t,i){return i}}class Sd{constructor(e,t){this.newValue=e,this.didChange=t}}function Ed(r,e){if(typeof r!="object"||typeof e!="object"||!r||!e)return new Sd(e,r!==e);if(Array.isArray(r)||Array.isArray(e)){const i=Array.isArray(r)&&Array.isArray(e)&&Tn(r,e);return new Sd(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=Ed(r[i],e[i]);n.didChange&&(r[i]=n.newValue,t=!0)}return new Sd(r,t)}class mc{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Ed(e,t)}validate(e){return this.defaultValue}}class So{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return Ed(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Q(r,e){return typeof r>"u"?e:r==="false"?!1:!!r}class ge extends So{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Q(e,this.defaultValue)}}function w5(r,e,t,i){if(typeof r>"u")return e;let n=parseInt(r,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class Re extends So{static clampedInt(e,t,i,n){return w5(e,t,i,n)}constructor(e,t,i,n,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=s),super(e,t,i,o),this.minimum=n,this.maximum=s}validate(e){return Re.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Qi extends So{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=n}validate(e){return this.validationFn(Qi.float(e,this.defaultValue))}}class Rt extends So{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return Rt.string(e,this.defaultValue)}}function et(r,e,t,i){return typeof r!="string"||t.indexOf(r)===-1?e:r}class je extends So{constructor(e,t,i,n,s=void 0){typeof s<"u"&&(s.type="string",s.enum=n,s.default=i),super(e,t,i,s),this._allowedValues=n}validate(e){return et(e,this.defaultValue,this._allowedValues)}}class kd extends We{constructor(e,t,i,n,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=n),super(e,t,i,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function b5(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class y5 extends We{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[g("vs/editor/common/config/editorOptions","accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),g("vs/editor/common/config/editorOptions","accessibilitySupport.on","Optimize for usage with a Screen Reader."),g("vs/editor/common/config/editorOptions","accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:g("vs/editor/common/config/editorOptions","accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class x5 extends We{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:g("vs/editor/common/config/editorOptions","comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:g("vs/editor/common/config/editorOptions","comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Q(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Q(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function C5(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var Ki;(function(r){r[r.Line=1]="Line",r[r.Block=2]="Block",r[r.Underline=3]="Underline",r[r.LineThin=4]="LineThin",r[r.BlockOutline=5]="BlockOutline",r[r.UnderlineThin=6]="UnderlineThin"})(Ki||(Ki={}));function S5(r){switch(r){case"line":return Ki.Line;case"block":return Ki.Block;case"underline":return Ki.Underline;case"line-thin":return Ki.LineThin;case"block-outline":return Ki.BlockOutline;case"underline-thin":return Ki.UnderlineThin}}class E5 extends mc{constructor(){super(141)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(111)&&n.push("showUnused"),t.get(139)&&n.push("showDeprecated"),n.join(" ")}}class k5 extends ge{constructor(){super(37,"emptySelectionClipboard",!0,{description:g("vs/editor/common/config/editorOptions","emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class D5 extends We{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:g("vs/editor/common/config/editorOptions","find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),g("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),g("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:g("vs/editor/common/config/editorOptions","find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),g("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),g("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:g("vs/editor/common/config/editorOptions","find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:g("vs/editor/common/config/editorOptions","find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:wi},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:g("vs/editor/common/config/editorOptions","find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:g("vs/editor/common/config/editorOptions","find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Q(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":et(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":et(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Q(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Q(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Q(t.loop,this.defaultValue.loop)}}}class rs extends We{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(51,"fontLigatures",rs.OFF,{anyOf:[{type:"boolean",description:g("vs/editor/common/config/editorOptions","fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:g("vs/editor/common/config/editorOptions","fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:g("vs/editor/common/config/editorOptions","fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?rs.OFF:e==="true"?rs.ON:e:e?rs.ON:rs.OFF}}class ss extends We{static{this.OFF="normal"}static{this.TRANSLATE="translate"}constructor(){super(54,"fontVariations",ss.OFF,{anyOf:[{type:"boolean",description:g("vs/editor/common/config/editorOptions","fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:g("vs/editor/common/config/editorOptions","fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:g("vs/editor/common/config/editorOptions","fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?ss.OFF:e==="true"?ss.TRANSLATE:e:e?ss.TRANSLATE:ss.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}}class I5 extends mc{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class P5 extends So{constructor(){super(52,"fontSize",wn.fontSize,{type:"number",minimum:6,maximum:100,default:wn.fontSize,description:g("vs/editor/common/config/editorOptions","fontSize","Controls the font size in pixels.")})}validate(e){const t=Qi.float(e,this.defaultValue);return t===0?wn.fontSize:Qi.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class os extends We{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(53,"fontWeight",wn.fontWeight,{anyOf:[{type:"number",minimum:os.MINIMUM_VALUE,maximum:os.MAXIMUM_VALUE,errorMessage:g("vs/editor/common/config/editorOptions","fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:os.SUGGESTION_VALUES}],default:wn.fontWeight,description:g("vs/editor/common/config/editorOptions","fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Re.clampedInt(e,wn.fontWeight,os.MINIMUM_VALUE,os.MAXIMUM_VALUE))}}class T5 extends We{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),g("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),g("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:g("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:g("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:g("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:g("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:g("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:g("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:g("vs/editor/common/config/editorOptions","alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:g("vs/editor/common/config/editorOptions","alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:g("vs/editor/common/config/editorOptions","alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:g("vs/editor/common/config/editorOptions","alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:g("vs/editor/common/config/editorOptions","alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:et(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??et(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??et(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??et(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??et(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??et(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Rt.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Rt.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Rt.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Rt.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Rt.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class A5 extends We{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:g("vs/editor/common/config/editorOptions","hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:g("vs/editor/common/config/editorOptions","hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:g("vs/editor/common/config/editorOptions","hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:g("vs/editor/common/config/editorOptions","hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),delay:Re.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Q(t.sticky,this.defaultValue.sticky),hidingDelay:Re.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Q(t.above,this.defaultValue.above)}}}class vc extends mc{constructor(){super(144)}compute(e,t,i){return vc.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const s=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,c=e.lineHeight,l=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,h=e.minimap.renderCharacters;let f=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const d=e.minimap.maxColumn,_=e.minimap.size,w=e.minimap.side,x=e.verticalScrollbarWidth,k=e.viewLineCount,S=e.remainingWidth,D=e.isViewportWrapping,U=h?2:3;let R=Math.floor(s*n);const H=R/s;let le=!1,ie=!1,fe=U*f,we=f/s,z=1;if(_==="fill"||_==="fit"){const{typicalViewportLineCount:Ke,extraLinesBeforeFirstLine:Je,extraLinesBeyondLastLine:wt,desiredRatio:Ft,minimapLineCount:bt}=vc.computeContainedMinimapLineCount({viewLineCount:k,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:c,pixelRatio:s});if(k/bt>1)le=!0,ie=!0,f=1,fe=1,we=f/s;else{let lt=!1,ci=f+1;if(_==="fit"){const kt=Math.ceil((Je+k+wt)*fe);D&&a&&S<=t.stableFitRemainingWidth?(lt=!0,ci=t.stableFitMaxMinimapScale):lt=kt>R}if(_==="fill"||lt){le=!0;const kt=f;fe=Math.min(c*s,Math.max(1,Math.floor(1/Ft))),D&&a&&S<=t.stableFitRemainingWidth&&(ci=t.stableFitMaxMinimapScale),f=Math.min(ci,Math.max(1,Math.floor(fe/U))),f>kt&&(z=Math.min(2,f/kt)),we=f/s/z,R=Math.ceil(Math.max(Ke,Je+k+wt)*fe),D?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=S,t.stableFitMaxMinimapScale=f):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const B=Math.floor(d*we),J=Math.min(B,Math.max(0,Math.floor((S-x-2)*we/(l+we)))+v5);let V=Math.floor(s*J);const re=V/s;V=Math.floor(V*z);const de=h?1:2,oe=w==="left"?0:i-J-x;return{renderMinimap:de,minimapLeft:oe,minimapWidth:J,minimapHeightIsEditorHeight:le,minimapIsSampling:ie,minimapScale:f,minimapLineHeight:fe,minimapCanvasInnerWidth:V,minimapCanvasInnerHeight:R,minimapCanvasOuterWidth:re,minimapCanvasOuterHeight:H}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,c=t.maxDigitWidth,l=t.pixelRatio,u=t.viewLineCount,h=e.get(136),f=h==="inherit"?e.get(135):h,d=f==="inherit"?e.get(131):f,_=e.get(134),w=t.isDominatedByLongLines,x=e.get(57),k=e.get(68).renderType!==0,S=e.get(69),D=e.get(105),U=e.get(84),R=e.get(73),H=e.get(103),le=H.verticalScrollbarSize,ie=H.verticalHasArrows,fe=H.arrowSize,we=H.horizontalScrollbarSize,z=e.get(43),B=e.get(110)!=="never";let J=e.get(66);z&&B&&(J+=16);let V=0;if(k){const _e=Math.max(o,S);V=Math.round(_e*c)}let re=0;x&&(re=s*t.glyphMarginDecorationLaneCount);let de=0,oe=de+re,Ke=oe+V,Je=Ke+J;const wt=i-re-V-J;let Ft=!1,bt=!1,st=-1;f==="inherit"&&w?(Ft=!0,bt=!0):d==="on"||d==="bounded"?bt=!0:d==="wordWrapColumn"&&(st=_);const lt=vc._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:D,paddingTop:U.top,paddingBottom:U.bottom,minimap:R,verticalScrollbarWidth:le,viewLineCount:u,remainingWidth:wt,isViewportWrapping:bt},t.memory||new _5);lt.renderMinimap!==0&&lt.minimapLeft===0&&(de+=lt.minimapWidth,oe+=lt.minimapWidth,Ke+=lt.minimapWidth,Je+=lt.minimapWidth);const ci=wt-lt.minimapWidth,kt=Math.max(1,Math.floor((ci-le-2)/a)),Li=ie?fe:0;return bt&&(st=Math.max(1,kt),d==="bounded"&&(st=Math.min(st,_))),{width:i,height:n,glyphMarginLeft:de,glyphMarginWidth:re,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:oe,lineNumbersWidth:V,decorationsLeft:Ke,decorationsWidth:J,contentLeft:Je,contentWidth:ci,minimap:lt,viewportColumn:kt,isWordWrapMinified:Ft,isViewportWrapping:bt,wrappingColumn:st,verticalScrollbarWidth:le,horizontalScrollbarHeight:we,overviewRuler:{top:Li,width:le,height:n-2*Li,right:0}}}}class R5 extends We{constructor(){super(138,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[g("vs/editor/common/config/editorOptions","wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),g("vs/editor/common/config/editorOptions","wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:g("vs/editor/common/config/editorOptions","wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return et(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var _n;(function(r){r.Off="off",r.OnCode="onCode",r.On="on"})(_n||(_n={}));class L5 extends We{constructor(){const e={enabled:_n.OnCode};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[_n.Off,_n.OnCode,_n.On],default:e.enabled,enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.off","Disable the code action menu."),g("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),g("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:g("vs/editor/common/config/editorOptions","enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:et(e.enabled,this.defaultValue.enabled,[_n.Off,_n.OnCode,_n.On])}}}class O5 extends We{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(115,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:g("vs/editor/common/config/editorOptions","editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:g("vs/editor/common/config/editorOptions","editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:g("vs/editor/common/config/editorOptions","editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),maxLineCount:Re.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:et(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Q(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class $5 extends We{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(140,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:g("vs/editor/common/config/editorOptions","inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","editor.inlayHints.on","Inlay hints are enabled"),g("vs/editor/common/config/editorOptions","editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",wi?"Ctrl+Option":"Ctrl+Alt"),g("vs/editor/common/config/editorOptions","editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",wi?"Ctrl+Option":"Ctrl+Alt"),g("vs/editor/common/config/editorOptions","editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:g("vs/editor/common/config/editorOptions","inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:g("vs/editor/common/config/editorOptions","inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:g("vs/editor/common/config/editorOptions","inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:et(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Re.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Rt.string(t.fontFamily,this.defaultValue.fontFamily),padding:Q(t.padding,this.defaultValue.padding)}}}class N5 extends We{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Re.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Re.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class F5 extends Qi{constructor(){super(67,"lineHeight",wn.lineHeight,e=>Qi.clamp(e,0,150),{markdownDescription:g("vs/editor/common/config/editorOptions","lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class M5 extends We{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:g("vs/editor/common/config/editorOptions","minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[g("vs/editor/common/config/editorOptions","minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),g("vs/editor/common/config/editorOptions","minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),g("vs/editor/common/config/editorOptions","minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:g("vs/editor/common/config/editorOptions","minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:g("vs/editor/common/config/editorOptions","minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:g("vs/editor/common/config/editorOptions","minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:g("vs/editor/common/config/editorOptions","minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:g("vs/editor/common/config/editorOptions","minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:g("vs/editor/common/config/editorOptions","minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),autohide:Q(t.autohide,this.defaultValue.autohide),size:et(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:et(t.side,this.defaultValue.side,["right","left"]),showSlider:et(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Q(t.renderCharacters,this.defaultValue.renderCharacters),scale:Re.clampedInt(t.scale,1,1,3),maxColumn:Re.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function H5(r){return r==="ctrlCmd"?wi?"metaKey":"ctrlKey":"altKey"}class U5 extends We{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:g("vs/editor/common/config/editorOptions","padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:g("vs/editor/common/config/editorOptions","padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Re.clampedInt(t.top,0,0,1e3),bottom:Re.clampedInt(t.bottom,0,0,1e3)}}}class B5 extends We{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:g("vs/editor/common/config/editorOptions","parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),cycle:Q(t.cycle,this.defaultValue.cycle)}}}class W5 extends mc{constructor(){super(142)}compute(e,t,i){return e.pixelRatio}}class V5 extends We{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[g("vs/editor/common/config/editorOptions","on","Quick suggestions show inside the suggest widget"),g("vs/editor/common/config/editorOptions","inline","Quick suggestions show as ghost text"),g("vs/editor/common/config/editorOptions","off","Quick suggestions are disabled")]}];super(89,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:g("vs/editor/common/config/editorOptions","quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:g("vs/editor/common/config/editorOptions","quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:g("vs/editor/common/config/editorOptions","quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:g("vs/editor/common/config/editorOptions","quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const l=e?"on":"off";return{comments:l,strings:l,other:l}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,s=["on","inline","off"];let o,a,c;return typeof t=="boolean"?o=t?"on":"off":o=et(t,this.defaultValue.other,s),typeof i=="boolean"?a=i?"on":"off":a=et(i,this.defaultValue.comments,s),typeof n=="boolean"?c=n?"on":"off":c=et(n,this.defaultValue.strings,s),{other:o,comments:a,strings:c}}}class z5 extends We{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[g("vs/editor/common/config/editorOptions","lineNumbers.off","Line numbers are not rendered."),g("vs/editor/common/config/editorOptions","lineNumbers.on","Line numbers are rendered as absolute number."),g("vs/editor/common/config/editorOptions","lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),g("vs/editor/common/config/editorOptions","lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:g("vs/editor/common/config/editorOptions","lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}class q5 extends We{constructor(){const e=[],t={type:"number",description:g("vs/editor/common/config/editorOptions","rulers.size","Number of monospace characters at which this editor ruler will render.")};super(102,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:g("vs/editor/common/config/editorOptions","rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:g("vs/editor/common/config/editorOptions","rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Re.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Re.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class j5 extends We{constructor(){super(92,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function bb(r,e){if(typeof r!="string")return e;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}class G5 extends We{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(103,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[g("vs/editor/common/config/editorOptions","scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),g("vs/editor/common/config/editorOptions","scrollbar.vertical.visible","The vertical scrollbar will always be visible."),g("vs/editor/common/config/editorOptions","scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:g("vs/editor/common/config/editorOptions","scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[g("vs/editor/common/config/editorOptions","scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),g("vs/editor/common/config/editorOptions","scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),g("vs/editor/common/config/editorOptions","scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:g("vs/editor/common/config/editorOptions","scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:g("vs/editor/common/config/editorOptions","scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:g("vs/editor/common/config/editorOptions","scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:g("vs/editor/common/config/editorOptions","scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:g("vs/editor/common/config/editorOptions","scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Re.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Re.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Re.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:bb(t.vertical,this.defaultValue.vertical),horizontal:bb(t.horizontal,this.defaultValue.horizontal),useShadows:Q(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Q(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Q(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Q(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Q(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Re.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Re.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Q(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Q(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Pi="inUntrustedWorkspace",as={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class Q5 extends We{constructor(){const e={nonBasicASCII:Pi,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Pi,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(125,"unicodeHighlight",e,{[as.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Pi],default:e.nonBasicASCII,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[as.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[as.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[as.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Pi],default:e.includeComments,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[as.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Pi],default:e.includeStrings,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[as.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[as.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:g("vs/editor/common/config/editorOptions","unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Si(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Si(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new Sd(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:Eo(t.nonBasicASCII,Pi,[!0,!1,Pi]),invisibleCharacters:Q(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Q(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Eo(t.includeComments,Pi,[!0,!1,Pi]),includeStrings:Eo(t.includeStrings,Pi,[!0,!1,Pi]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,s]of Object.entries(e))s===!0&&(i[n]=!0);return i}}class K5 extends We{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[g("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),g("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),g("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:g("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:g("vs/editor/common/config/editorOptions","inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:g("vs/editor/common/config/editorOptions","inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),mode:et(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:et(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Q(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Q(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Rt.string(t.fontFamily,this.defaultValue.fontFamily)}}}class J5 extends We{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1,backgroundColoring:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:g("vs/editor/common/config/editorOptions","inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[g("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),g("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),g("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:g("vs/editor/common/config/editorOptions","inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:g("vs/editor/common/config/editorOptions","inlineEdit.fontFamily","Controls the font family of the inline edit.")},"editor.experimentalInlineEdit.backgroundColoring":{type:"boolean",default:e.backgroundColoring,description:g("vs/editor/common/config/editorOptions","inlineEdit.backgroundColoring","Controls whether to color the background of inline edits.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),showToolbar:et(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Rt.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Q(t.keepOnBlur,this.defaultValue.keepOnBlur),backgroundColoring:Q(t.backgroundColoring,this.defaultValue.backgroundColoring)}}}class X5 extends We{constructor(){const e={enabled:wb.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:wb.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:g("vs/editor/common/config/editorOptions","bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:g("vs/editor/common/config/editorOptions","bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Q(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class Y5 extends We{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.true","Enables bracket pair guides."),g("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),g("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:g("vs/editor/common/config/editorOptions","editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),g("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),g("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:g("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:g("vs/editor/common/config/editorOptions","editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:g("vs/editor/common/config/editorOptions","editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),g("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),g("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:g("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:Eo(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Eo(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Q(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Q(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:Eo(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function Eo(r,e,t){const i=t.indexOf(r);return i===-1?e:t[i]}class Z5 extends We{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(118,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[g("vs/editor/common/config/editorOptions","suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),g("vs/editor/common/config/editorOptions","suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:g("vs/editor/common/config/editorOptions","suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:g("vs/editor/common/config/editorOptions","suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:g("vs/editor/common/config/editorOptions","suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:g("vs/editor/common/config/editorOptions","suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[g("vs/editor/common/config/editorOptions","suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),g("vs/editor/common/config/editorOptions","suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),g("vs/editor/common/config/editorOptions","suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),g("vs/editor/common/config/editorOptions","suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:g("vs/editor/common/config/editorOptions","suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:g("vs/editor/common/config/editorOptions","suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:g("vs/editor/common/config/editorOptions","suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:g("vs/editor/common/config/editorOptions","suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:g("vs/editor/common/config/editorOptions","suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:g("vs/editor/common/config/editorOptions","suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:g("vs/editor/common/config/editorOptions","suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:g("vs/editor/common/config/editorOptions","deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:g("vs/editor/common/config/editorOptions","editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:et(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Q(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Q(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Q(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Q(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:et(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Q(t.showIcons,this.defaultValue.showIcons),showStatusBar:Q(t.showStatusBar,this.defaultValue.showStatusBar),preview:Q(t.preview,this.defaultValue.preview),previewMode:et(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Q(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Q(t.showMethods,this.defaultValue.showMethods),showFunctions:Q(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Q(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Q(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Q(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Q(t.showFields,this.defaultValue.showFields),showVariables:Q(t.showVariables,this.defaultValue.showVariables),showClasses:Q(t.showClasses,this.defaultValue.showClasses),showStructs:Q(t.showStructs,this.defaultValue.showStructs),showInterfaces:Q(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Q(t.showModules,this.defaultValue.showModules),showProperties:Q(t.showProperties,this.defaultValue.showProperties),showEvents:Q(t.showEvents,this.defaultValue.showEvents),showOperators:Q(t.showOperators,this.defaultValue.showOperators),showUnits:Q(t.showUnits,this.defaultValue.showUnits),showValues:Q(t.showValues,this.defaultValue.showValues),showConstants:Q(t.showConstants,this.defaultValue.showConstants),showEnums:Q(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Q(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Q(t.showKeywords,this.defaultValue.showKeywords),showWords:Q(t.showWords,this.defaultValue.showWords),showColors:Q(t.showColors,this.defaultValue.showColors),showFiles:Q(t.showFiles,this.defaultValue.showFiles),showReferences:Q(t.showReferences,this.defaultValue.showReferences),showFolders:Q(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Q(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Q(t.showSnippets,this.defaultValue.showSnippets),showUsers:Q(t.showUsers,this.defaultValue.showUsers),showIssues:Q(t.showIssues,this.defaultValue.showIssues)}}}class eD extends We{constructor(){super(113,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:g("vs/editor/common/config/editorOptions","selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:g("vs/editor/common/config/editorOptions","selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Q(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Q(e.selectSubwords,this.defaultValue.selectSubwords)}}}class tD extends We{constructor(){super(137,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[g("vs/editor/common/config/editorOptions","wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),g("vs/editor/common/config/editorOptions","wrappingIndent.same","Wrapped lines get the same indentation as the parent."),g("vs/editor/common/config/editorOptions","wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),g("vs/editor/common/config/editorOptions","wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:g("vs/editor/common/config/editorOptions","wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class iD extends mc{constructor(){super(145)}compute(e,t,i){const n=t.get(144);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class nD extends We{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:g("vs/editor/common/config/editorOptions","dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:g("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[g("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),g("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),showDropSelector:et(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class rD extends We{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:g("vs/editor/common/config/editorOptions","pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:g("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[g("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),g("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Q(t.enabled,this.defaultValue.enabled),showPasteSelector:et(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const wn={fontFamily:wi?"Menlo, Monaco, 'Courier New', monospace":An?"'Droid Sans Mono', 'monospace', monospace":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:wi?12:14,lineHeight:0,letterSpacing:0},sD=[];function A(r){return sD[r.id]=r,r}A(new ge(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:g("vs/editor/common/config/editorOptions","acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),A(new je(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",g("vs/editor/common/config/editorOptions","acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:g("vs/editor/common/config/editorOptions","acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),A(new y5),A(new Re(3,"accessibilityPageSize",10,1,1073741824,{description:g("vs/editor/common/config/editorOptions","accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),A(new Rt(4,"ariaLabel",g("vs/editor/common/config/editorOptions","editorViewAccessibleLabel","Editor content"))),A(new ge(5,"ariaRequired",!1,void 0)),A(new ge(8,"screenReaderAnnounceInlineSuggestion",!0,{description:g("vs/editor/common/config/editorOptions","screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),A(new je(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),g("vs/editor/common/config/editorOptions","editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:g("vs/editor/common/config/editorOptions","autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),A(new je(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),g("vs/editor/common/config/editorOptions","editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:g("vs/editor/common/config/editorOptions","autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),A(new je(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:g("vs/editor/common/config/editorOptions","autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),A(new je(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:g("vs/editor/common/config/editorOptions","autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),A(new je(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),g("vs/editor/common/config/editorOptions","editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:g("vs/editor/common/config/editorOptions","autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),A(new kd(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],b5,{enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.autoIndent.none","The editor will not insert indentation automatically."),g("vs/editor/common/config/editorOptions","editor.autoIndent.keep","The editor will keep the current line's indentation."),g("vs/editor/common/config/editorOptions","editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),g("vs/editor/common/config/editorOptions","editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),g("vs/editor/common/config/editorOptions","editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:g("vs/editor/common/config/editorOptions","autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),A(new ge(13,"automaticLayout",!1)),A(new je(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),g("vs/editor/common/config/editorOptions","editor.autoSurround.quotes","Surround with quotes but not brackets."),g("vs/editor/common/config/editorOptions","editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:g("vs/editor/common/config/editorOptions","autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),A(new X5),A(new Y5),A(new ge(116,"stickyTabStops",!1,{description:g("vs/editor/common/config/editorOptions","stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),A(new ge(17,"codeLens",!0,{description:g("vs/editor/common/config/editorOptions","codeLens","Controls whether the editor shows CodeLens.")})),A(new Rt(18,"codeLensFontFamily","",{description:g("vs/editor/common/config/editorOptions","codeLensFontFamily","Controls the font family for CodeLens.")})),A(new Re(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:g("vs/editor/common/config/editorOptions","codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),A(new ge(20,"colorDecorators",!0,{description:g("vs/editor/common/config/editorOptions","colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),A(new je(147,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),g("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),g("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:g("vs/editor/common/config/editorOptions","colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),A(new Re(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:g("vs/editor/common/config/editorOptions","colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),A(new ge(22,"columnSelection",!1,{description:g("vs/editor/common/config/editorOptions","columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),A(new x5),A(new ge(24,"contextmenu",!0)),A(new ge(25,"copyWithSyntaxHighlighting",!0,{description:g("vs/editor/common/config/editorOptions","copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),A(new kd(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],C5,{description:g("vs/editor/common/config/editorOptions","cursorBlinking","Control the cursor animation style.")})),A(new je(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),g("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),g("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:g("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),A(new kd(28,"cursorStyle",Ki.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],S5,{description:g("vs/editor/common/config/editorOptions","cursorStyle","Controls the cursor style.")})),A(new Re(29,"cursorSurroundingLines",0,0,1073741824,{description:g("vs/editor/common/config/editorOptions","cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),A(new je(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),g("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:g("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle","Controls when `#cursorSurroundingLines#` should be enforced.")})),A(new Re(31,"cursorWidth",0,0,1073741824,{markdownDescription:g("vs/editor/common/config/editorOptions","cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),A(new ge(32,"disableLayerHinting",!1)),A(new ge(33,"disableMonospaceOptimizations",!1)),A(new ge(34,"domReadOnly",!1)),A(new ge(35,"dragAndDrop",!0,{description:g("vs/editor/common/config/editorOptions","dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),A(new k5),A(new nD),A(new O5),A(new je(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),g("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),g("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:g("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),A(new Rt(39,"extraEditorClassName","")),A(new Qi(40,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:g("vs/editor/common/config/editorOptions","fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),A(new D5),A(new ge(42,"fixedOverflowWidgets",!1)),A(new ge(43,"folding",!0,{description:g("vs/editor/common/config/editorOptions","folding","Controls whether the editor has code folding enabled.")})),A(new je(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),g("vs/editor/common/config/editorOptions","foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:g("vs/editor/common/config/editorOptions","foldingStrategy","Controls the strategy for computing folding ranges.")})),A(new ge(45,"foldingHighlight",!0,{description:g("vs/editor/common/config/editorOptions","foldingHighlight","Controls whether the editor should highlight folded ranges.")})),A(new ge(46,"foldingImportsByDefault",!1,{description:g("vs/editor/common/config/editorOptions","foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),A(new Re(47,"foldingMaximumRegions",5e3,10,65e3,{description:g("vs/editor/common/config/editorOptions","foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),A(new ge(48,"unfoldOnClickAfterEndOfLine",!1,{description:g("vs/editor/common/config/editorOptions","unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),A(new Rt(49,"fontFamily",wn.fontFamily,{description:g("vs/editor/common/config/editorOptions","fontFamily","Controls the font family.")})),A(new I5),A(new rs),A(new P5),A(new os),A(new ss),A(new ge(55,"formatOnPaste",!1,{description:g("vs/editor/common/config/editorOptions","formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),A(new ge(56,"formatOnType",!1,{description:g("vs/editor/common/config/editorOptions","formatOnType","Controls whether the editor should automatically format the line after typing.")})),A(new ge(57,"glyphMargin",!0,{description:g("vs/editor/common/config/editorOptions","glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),A(new T5),A(new ge(59,"hideCursorInOverviewRuler",!1,{description:g("vs/editor/common/config/editorOptions","hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),A(new A5),A(new ge(61,"inDiffEditor",!1)),A(new Qi(64,"letterSpacing",wn.letterSpacing,r=>Qi.clamp(r,-5,20),{description:g("vs/editor/common/config/editorOptions","letterSpacing","Controls the letter spacing in pixels.")})),A(new L5),A(new N5),A(new F5),A(new z5),A(new Re(69,"lineNumbersMinChars",5,1,300)),A(new ge(70,"linkedEditing",!1,{description:g("vs/editor/common/config/editorOptions","linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),A(new ge(71,"links",!0,{description:g("vs/editor/common/config/editorOptions","links","Controls whether the editor should detect links and make them clickable.")})),A(new je(72,"matchBrackets","always",["always","near","never"],{description:g("vs/editor/common/config/editorOptions","matchBrackets","Highlight matching brackets.")})),A(new M5),A(new je(74,"mouseStyle","text",["text","default","copy"])),A(new Qi(75,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:g("vs/editor/common/config/editorOptions","mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),A(new ge(76,"mouseWheelZoom",!1,{markdownDescription:wi?g("vs/editor/common/config/editorOptions","mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):g("vs/editor/common/config/editorOptions","mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),A(new ge(77,"multiCursorMergeOverlapping",!0,{description:g("vs/editor/common/config/editorOptions","multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),A(new kd(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],H5,{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),g("vs/editor/common/config/editorOptions","multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:g("vs/editor/common/config/editorOptions",{key:"multiCursorModifier"},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),A(new je(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","multiCursorPaste.spread","Each cursor pastes a single line of the text."),g("vs/editor/common/config/editorOptions","multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:g("vs/editor/common/config/editorOptions","multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),A(new Re(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:g("vs/editor/common/config/editorOptions","multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),A(new je(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","occurrencesHighlight.off","Does not highlight occurrences."),g("vs/editor/common/config/editorOptions","occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),g("vs/editor/common/config/editorOptions","occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:g("vs/editor/common/config/editorOptions","occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),A(new ge(82,"overviewRulerBorder",!0,{description:g("vs/editor/common/config/editorOptions","overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),A(new Re(83,"overviewRulerLanes",3,0,3)),A(new U5),A(new rD),A(new B5),A(new je(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),g("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:g("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),A(new ge(88,"definitionLinkOpensInPeek",!1,{description:g("vs/editor/common/config/editorOptions","definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),A(new V5),A(new Re(90,"quickSuggestionsDelay",10,0,1073741824,{description:g("vs/editor/common/config/editorOptions","quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),A(new ge(91,"readOnly",!1)),A(new j5),A(new ge(93,"renameOnType",!1,{description:g("vs/editor/common/config/editorOptions","renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:g("vs/editor/common/config/editorOptions","renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),A(new ge(94,"renderControlCharacters",!0,{description:g("vs/editor/common/config/editorOptions","renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),A(new je(95,"renderFinalNewline",An?"dimmed":"on",["off","on","dimmed"],{description:g("vs/editor/common/config/editorOptions","renderFinalNewline","Render last line number when the file ends with a newline.")})),A(new je(96,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",g("vs/editor/common/config/editorOptions","renderLineHighlight.all","Highlights both the gutter and the current line.")],description:g("vs/editor/common/config/editorOptions","renderLineHighlight","Controls how the editor should render the current line highlight.")})),A(new ge(97,"renderLineHighlightOnlyWhenFocus",!1,{description:g("vs/editor/common/config/editorOptions","renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),A(new je(98,"renderValidationDecorations","editable",["editable","on","off"])),A(new je(99,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",g("vs/editor/common/config/editorOptions","renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),g("vs/editor/common/config/editorOptions","renderWhitespace.selection","Render whitespace characters only on selected text."),g("vs/editor/common/config/editorOptions","renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:g("vs/editor/common/config/editorOptions","renderWhitespace","Controls how the editor should render whitespace characters.")})),A(new Re(100,"revealHorizontalRightPadding",15,0,1e3)),A(new ge(101,"roundedSelection",!0,{description:g("vs/editor/common/config/editorOptions","roundedSelection","Controls whether selections should have rounded corners.")})),A(new q5),A(new G5),A(new Re(104,"scrollBeyondLastColumn",4,0,1073741824,{description:g("vs/editor/common/config/editorOptions","scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),A(new ge(105,"scrollBeyondLastLine",!0,{description:g("vs/editor/common/config/editorOptions","scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),A(new ge(106,"scrollPredominantAxis",!0,{description:g("vs/editor/common/config/editorOptions","scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),A(new ge(107,"selectionClipboard",!0,{description:g("vs/editor/common/config/editorOptions","selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:An})),A(new ge(108,"selectionHighlight",!0,{description:g("vs/editor/common/config/editorOptions","selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),A(new ge(109,"selectOnLineNumbers",!0)),A(new je(110,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","showFoldingControls.always","Always show the folding controls."),g("vs/editor/common/config/editorOptions","showFoldingControls.never","Never show the folding controls and reduce the gutter size."),g("vs/editor/common/config/editorOptions","showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:g("vs/editor/common/config/editorOptions","showFoldingControls","Controls when the folding controls on the gutter are shown.")})),A(new ge(111,"showUnused",!0,{description:g("vs/editor/common/config/editorOptions","showUnused","Controls fading out of unused code.")})),A(new ge(139,"showDeprecated",!0,{description:g("vs/editor/common/config/editorOptions","showDeprecated","Controls strikethrough deprecated variables.")})),A(new $5),A(new je(112,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),g("vs/editor/common/config/editorOptions","snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),g("vs/editor/common/config/editorOptions","snippetSuggestions.inline","Show snippets suggestions with other suggestions."),g("vs/editor/common/config/editorOptions","snippetSuggestions.none","Do not show snippet suggestions.")],description:g("vs/editor/common/config/editorOptions","snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),A(new eD),A(new ge(114,"smoothScrolling",!1,{description:g("vs/editor/common/config/editorOptions","smoothScrolling","Controls whether the editor will scroll using an animation.")})),A(new Re(117,"stopRenderingLineAfter",1e4,-1,1073741824)),A(new Z5),A(new K5),A(new J5),A(new ge(148,"inlineCompletionsAccessibilityVerbose",!1,{description:g("vs/editor/common/config/editorOptions","inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),A(new Re(119,"suggestFontSize",0,0,1e3,{markdownDescription:g("vs/editor/common/config/editorOptions","suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),A(new Re(120,"suggestLineHeight",0,0,1e3,{markdownDescription:g("vs/editor/common/config/editorOptions","suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),A(new ge(121,"suggestOnTriggerCharacters",!0,{description:g("vs/editor/common/config/editorOptions","suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),A(new je(122,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","suggestSelection.first","Always select the first suggestion."),g("vs/editor/common/config/editorOptions","suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),g("vs/editor/common/config/editorOptions","suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:g("vs/editor/common/config/editorOptions","suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),A(new je(123,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),g("vs/editor/common/config/editorOptions","tabCompletion.off","Disable tab completions."),g("vs/editor/common/config/editorOptions","tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:g("vs/editor/common/config/editorOptions","tabCompletion","Enables tab completions.")})),A(new Re(124,"tabIndex",0,-1,1073741824)),A(new Q5),A(new je(126,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[g("vs/editor/common/config/editorOptions","unusualLineTerminators.auto","Unusual line terminators are automatically removed."),g("vs/editor/common/config/editorOptions","unusualLineTerminators.off","Unusual line terminators are ignored."),g("vs/editor/common/config/editorOptions","unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:g("vs/editor/common/config/editorOptions","unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),A(new ge(127,"useShadowDOM",!0)),A(new ge(128,"useTabStops",!0,{description:g("vs/editor/common/config/editorOptions","useTabStops","Inserting and deleting whitespace follows tab stops.")})),A(new je(129,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","wordBreak.normal","Use the default line break rule."),g("vs/editor/common/config/editorOptions","wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:g("vs/editor/common/config/editorOptions","wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),A(new Rt(130,"wordSeparators",cb,{description:g("vs/editor/common/config/editorOptions","wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),A(new je(131,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[g("vs/editor/common/config/editorOptions","wordWrap.off","Lines will never wrap."),g("vs/editor/common/config/editorOptions","wordWrap.on","Lines will wrap at the viewport width."),g("vs/editor/common/config/editorOptions",{key:"wordWrap.wordWrapColumn"},"Lines will wrap at `#editor.wordWrapColumn#`."),g("vs/editor/common/config/editorOptions",{key:"wordWrap.bounded"},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:g("vs/editor/common/config/editorOptions",{key:"wordWrap"},"Controls how lines should wrap.")})),A(new Rt(132,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),A(new Rt(133,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),A(new Re(134,"wordWrapColumn",80,1,1073741824,{markdownDescription:g("vs/editor/common/config/editorOptions",{key:"wordWrapColumn"},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),A(new je(135,"wordWrapOverride1","inherit",["off","on","inherit"])),A(new je(136,"wordWrapOverride2","inherit",["off","on","inherit"])),A(new E5),A(new ge(146,"defaultColorDecorators",!1,{markdownDescription:g("vs/editor/common/config/editorOptions","defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),A(new W5),A(new ge(143,"tabFocusMode",!1,{markdownDescription:g("vs/editor/common/config/editorOptions","tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),A(new vc),A(new iD),A(new tD),A(new R5);function yb(r,e,t,i,n,s){if(Array.isArray(r)){let o=0;for(const a of r){const c=yb(a,e,t,i,n,s);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof r=="string")return r==="*"?5:r===t?10:0;if(r){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=r;u&&n&&(e=n);let h=0;if(c)if(c===e.scheme)h=10;else if(c==="*")h=5;else return 0;if(o)if(o===t)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(u)if(u===s)h=10;else if(u==="*"&&s!==void 0)h=Math.max(h,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:_s(a.base)},f===e.fsPath||ga(f,e.fsPath))h=10;else return 0}return h}else return 0}}function xb(r){return typeof r=="string"?!1:Array.isArray(r)?r.some(xb):!!r.notebookType}var cm;(function(r){r[r.None=0]="None",r[r.Indent=1]="Indent",r[r.IndentOutdent=2]="IndentOutdent",r[r.Outdent=3]="Outdent"})(cm||(cm={})),ee("editSessionIdentityService");var lm;(function(r){r[r.Complete=100]="Complete",r[r.Partial=50]="Partial",r[r.None=0]="None"})(lm||(lm={}));class oD{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(j.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const n=this._relatedInformationProviders.get(e);if(!n)throw new Error("related information provider not found");return await n.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(n,i),this._proxy.$registerAiRelatedInformationProvider(n,t),new ke(()=>{this._proxy.$unregisterAiRelatedInformationProvider(n),this._relatedInformationProviders.delete(n)})}}function Cb(r){for(let e=0,t=r.length;e<t;e+=4){const i=r[e+0],n=r[e+1],s=r[e+2],o=r[e+3];r[e+0]=o,r[e+1]=s,r[e+2]=n,r[e+3]=i}}function aD(r){const e=new Uint8Array(r.buffer,r.byteOffset,r.length*4);return av()||Cb(e),he.wrap(e)}function cD(r){const e=r.buffer;if(av()||Cb(e),e.byteOffset%4===0)return new Uint32Array(e.buffer,e.byteOffset,e.length/4);{const t=new Uint8Array(e.byteLength);return t.set(e),new Uint32Array(t.buffer,t.byteOffset,t.length/4)}}function um(r){const e=new Uint32Array(lD(r));let t=0;if(e[t++]=r.id,r.type==="full")e[t++]=1,e[t++]=r.data.length,e.set(r.data,t),t+=r.data.length;else{e[t++]=2,e[t++]=r.deltas.length;for(const i of r.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return aD(e)}function lD(r){let e=0;if(e+=2,r.type==="full")e+=1+r.data.length;else{e+=1,e+=3*r.deltas.length;for(const t of r.deltas)t.data&&(e+=t.data.length)}return e}function Sb(r){const e=cD(r);let t=0;const i=e[t++];if(e[t++]===1){const a=e[t++],c=e.subarray(t,t+a);return t+=a,{id:i,type:"full",data:c}}const s=e[t++],o=[];for(let a=0;a<s;a++){const c=e[t++],l=e[t++],u=e[t++];let h;u>0&&(h=e.subarray(t,t+u),t+=u),o[a]={start:c,deleteCount:l,data:h}}return{id:i,type:"delta",deltas:o}}const uD=[new pe("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[M.Uri,M.Position],new ue("A promise that resolves to an array of DocumentHighlight-instances.",bn(ro.to))),new pe("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[M.Uri],new ue("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(r,e)=>{if(dh(r))return;class t extends ya{static to(n){const s=new t(n.name,vi.to(n.kind),n.containerName||"",new si(e[0],$.to(n.range)));return s.detail=n.detail,s.range=s.location.range,s.selectionRange=$.to(n.selectionRange),s.children=n.children?n.children.map(t.to):[],s}}return r.map(t.to)})),new pe("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[M.Uri,new M("options","Formatting options",r=>!0,r=>r)],new ue("A promise that resolves to an array of TextEdits.",bn(vt.to))),new pe("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[M.Uri,M.Range,new M("options","Formatting options",r=>!0,r=>r)],new ue("A promise that resolves to an array of TextEdits.",bn(vt.to))),new pe("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[M.Uri,M.Position,new M("ch","Trigger character",r=>typeof r=="string",r=>r),new M("options","Formatting options",r=>!0,r=>r)],new ue("A promise that resolves to an array of TextEdits.",bn(vt.to))),new pe("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Location or LocationLink instances.",Dd)),new pe("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Location or LocationLink instances.",Dd)),new pe("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Location or LocationLink instances.",Dd)),new pe("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Location or LocationLink instances.",Dd)),new pe("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Location-instances.",bn(oi.to))),new pe("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[M.Uri,M.Position],new ue("A promise that resolves to an array of Hover-instances.",bn(Fu.to))),new pe("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[M.Uri,new M("position","A position in a text document",r=>Array.isArray(r)&&r.every(e=>xe.isPosition(e)),r=>r.map(He.from))],new ue("A promise that resolves to an array of ranges.",r=>r.map(e=>{let t;for(const i of e.reverse())t=new Sa($.to(i),t);return t}))),new pe("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[M.String.with("query","Search string")],new ue("A promise that resolves to an array of SymbolInformation-instances.",r=>r.map(Va.to))),new pe("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[M.Uri,M.Position],new ue("A promise that resolves to an array of CallHierarchyItem-instances",r=>r.map(Xr.to))),new pe("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[M.CallHierarchyItem],new ue("A promise that resolves to an array of CallHierarchyIncomingCall-instances",r=>r.map(Ip.to))),new pe("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[M.CallHierarchyItem],new ue("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",r=>r.map(Pp.to))),new pe("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[M.Uri,M.Position],new ue("A promise that resolves to a range and placeholder text.",r=>{if(r)return{range:$.to(r.range),placeholder:r.text}})),new pe("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[M.Uri,M.Position,M.String.with("newName","The new symbol name")],new ue("A promise that resolves to a WorkspaceEdit.",r=>{if(r){if(r.rejectReason)throw new Error(r.rejectReason);return Vt.to(r)}})),new pe("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[M.Uri,M.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new ue("A promise that resolves to an array of DocumentLink-instances.",r=>r.map(Yr.to))),new pe("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[M.Uri],new ue("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new Yf(r.tokenTypes,r.tokenModifiers)})),new pe("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[M.Uri],new ue("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=Sb(r);if(e.type==="full")return new Js(e.data,void 0)})),new pe("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[M.Uri,M.Range.optional()],new ue("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new Yf(r.tokenTypes,r.tokenModifiers)})),new pe("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[M.Uri,M.Range],new ue("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=Sb(r);if(e.type==="full")return new Js(e.data,void 0)})),new pe("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[M.Uri,M.Position,M.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),M.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new ue("A promise that resolves to a CompletionList-instance.",(r,e,t)=>{if(!r)return new Us([]);const i=r.suggestions.map(n=>Op.to(n,t));return new Us(i,r.incomplete)})),new pe("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[M.Uri,M.Position,M.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new ue("A promise that resolves to SignatureHelp.",r=>{if(r)return qa.to(r)})),new pe("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[M.Uri,M.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new ue("A promise that resolves to an array of CodeLens-instances.",(r,e,t)=>bn(i=>new Kl($.to(i.range),i.command&&t.fromInternal(i.command)))(r))),new pe("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[M.Uri,new M("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",r=>ve.isRange(r),r=>un.isSelection(r)?mi.from(r):$.from(r)),M.String.with("kind","Code action kind to return code actions for").optional(),M.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new ue("A promise that resolves to an array of Command-instances.",(r,e,t)=>bn(i=>{if(i._isSynthetic){if(!i.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(i.command)}else{const n=new Ql(i.title,i.kind?new Ze(i.kind):void 0);return i.edit&&(n.edit=Vt.to(i.edit)),i.command&&(n.command=t.fromInternal(i.command)),n.isPreferred=i.isPreferred,n}})(r))),new pe("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[M.Uri],new ue("A promise that resolves to an array of ColorInformation objects.",r=>r?r.map(e=>new tu($.to(e.range),so.to(e.color))):[])),new pe("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new M("color","The color to show and insert",r=>r instanceof zs,so.from),new M("context","Context object with uri and range",r=>!0,r=>({uri:r.uri,range:$.from(r.range)}))],new ue("A promise that resolves to an array of ColorPresentation objects.",r=>r?r.map(qu.to):[])),new pe("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[M.Uri,M.Range],new ue("A promise that resolves to an array of Inlay objects",(r,e,t)=>r.map($p.to.bind(void 0,t)))),new pe("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[M.Uri],new ue("A promise that resolves to an array of FoldingRange objects",(r,e)=>{if(r)return r.map(Gu.to)})),new pe("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new ue("A promise that resolves to an array of NotebookContentProvider static info objects.",bn(r=>({viewType:r.viewType,displayName:r.displayName,options:{transientOutputs:r.options.transientOutputs,transientCellMetadata:r.options.transientCellMetadata,transientDocumentMetadata:r.options.transientDocumentMetadata},filenamePattern:r.filenamePattern.map(e=>Ju.to(e))})))),new pe("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[M.Uri,M.Range,new M("context","An InlineValueContext",r=>r&&typeof r.frameId=="number"&&r.stoppedLocation instanceof ve,r=>Hu.from(r))],new ue("A promise that resolves to an array of InlineValue objects",r=>r.map(Mu.to))),new pe("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new M("uriOrString","Uri-instance or string (only http/https)",r=>b.isUri(r)||typeof r=="string"&&xx(r,K.http,K.https),r=>r),new M("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[pt.from(r),void 0]:[pt.from(r.viewColumn),ja.from(r)])).optional(),M.String.with("label","").optional()],ue.Void),new pe("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[M.Uri.with("resource","Resource to open"),M.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new M("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[pt.from(r),void 0]:[pt.from(r.viewColumn),ja.from(r)])).optional()],ue.Void),new pe("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[M.Uri.with("left","Left-hand side resource of the diff editor"),M.Uri.with("right","Right-hand side resource of the diff editor"),M.String.with("title","Human readable title for the diff editor").optional(),new M("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="object",r=>r&&[pt.from(r.viewColumn),ja.from(r)]).optional()],ue.Void),new pe("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[M.String.with("title","Human readable title for the changes editor"),new M("resourceList","List of resources to compare",r=>{for(const e of r){if(e.length!==3)return!1;const[t,i,n]=e;if(!b.isUri(t)||!b.isUri(i)&&i!==void 0&&i!==null||!b.isUri(n)&&n!==void 0&&n!==null)return!1}return!0},r=>r)],ue.Void),new pe("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[M.Uri,M.Position],new ue("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Zr.to))),new pe("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[M.TypeHierarchyItem],new ue("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Zr.to))),new pe("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[M.TypeHierarchyItem],new ue("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Zr.to))),new pe("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[M.TestItem],ue.Void),new pe("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[M.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],ue.Void),new pe("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[M.String.with("name","The context key name"),new M("value","The context key value",()=>!0,r=>r)],ue.Void),new pe("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[M.Uri,M.StringArray,new M("MappedEditsContext","Mapped Edits Context",r=>Ku.is(r),r=>Ku.from(r))],new ue("A promise that resolves to a workspace edit or null",r=>r?Vt.to(r):null))];class dD{static register(e){uD.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",cC)}}function bn(r){return e=>{if(Array.isArray(e))return e.map(r)}}function Dd(r){if(!Array.isArray(r))return;const e=[];for(const t of r)FS(t)?e.push(za.to(t)):e.push(oi.to(t));return e}const Eb="__";ee("IAuthenticationService");class hD{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new P,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new kb,this._getSessionsTaskSingler=new kb,this._proxy=e.getProxy(j.MainThreadAuthentication)}async getSession(e,t,i,n={}){const s=Qe.toKey(e.identifier),o=[...i].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${t} ${o}`,async()=>{await this._proxy.$ensureProvider(t);const a=e.displayName||e.name;return this._proxy.$getSession(t,i,s,a,n)})}async getSessions(e,t,i){const n=Qe.toKey(e.identifier),s=[...i].sort().join(" ");return await this._getSessionsTaskSingler.getOrCreate(`${n} ${s}`,async()=>{await this._proxy.$ensureProvider(t);const o=e.displayName||e.name;return this._proxy.$getSessions(t,i,n,o)})}async removeSession(e,t){const i=this._authenticationProviders.get(e);return i?i.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,i,n){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:i,options:n??{supportsMultipleAccounts:!1}});const s=i.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));return this._proxy.$registerAuthenticationProvider(e,t,n?.supportsMultipleAccounts??!1),new ke(()=>{s.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}$createSession(e,t,i){const n=this._authenticationProviders.get(e);if(n)return Promise.resolve(n.provider.createSession(t,i));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$removeSession(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.removeSession(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$getSessions(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.getSessions(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(Eb)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}}class kb{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const n=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,n),n}}let dm=class{constructor(e,t){this._proxy=e.getProxy(j.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:i=>t.getDocument(i)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,i){const n=Vt.from(e,this._versionInformationProvider);return this._proxy.$tryApplyWorkspaceEdit(n,void 0,i?.isRefactoring??!1)}};dm=F([O(0,Ue)],dm);class hm{static{this._pool=0}constructor(e,t){this.extension=e,this.provider=t,this.handle=hm._pool++}}class fm{static{this._nextId=0}constructor(e){this._chatProvider=new Map,this._chatSessions=new Map,this._proxy=e.getProxy(j.MainThreadChat)}registerChatProvider(e,t,i){const n=new hm(e,i);return this._chatProvider.set(n.handle,n),this._proxy.$registerChatProvider(n.handle,t),Te(()=>{this._proxy.$unregisterChatProvider(n.handle),this._chatProvider.delete(n.handle)})}transferChatSession(e,t){const i=_r.find(this._chatSessions.keys(),n=>this._chatSessions.get(n)===e)??0;typeof i=="number"&&this._proxy.$transferChatSession(i,t)}sendInteractiveRequestToProvider(e,t){this._proxy.$sendRequestToProvider(e,t)}async $prepareChat(e,t){const i=this._chatProvider.get(e);if(!i)return;const n=await i.provider.prepareSession(t);if(!n)return;const s=fm._nextId++;return this._chatSessions.set(s,n),{id:s,requesterUsername:n.requester?.name,requesterAvatarIconUri:n.requester?.icon,responderUsername:n.responder?.name,responderAvatarIconUri:n.responder?.icon,inputPlaceholder:n.inputPlaceholder}}$releaseSession(e){this._chatSessions.delete(e)}}var Id;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(Id||(Id={}));var Db;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(Db||(Db={})),ee("IChatService");class fD{constructor(e,t,i,n,s,o){this._extension=e,this._request=t,this._proxy=i,this._logService=n,this._commandsConverter=s,this._sessionDisposables=o,this._stopWatch=en.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this;this._stopWatch.reset();const i=n=>{typeof this._firstProgress>"u"&&"content"in n&&(this._firstProgress=this._stopWatch.elapsed()),this._proxy.$handleProgressChunk(this._request.requestId,n)};this._apiObject={markdown(n){t(this.markdown);const s=new Pu(n),o=Ja.to(s);return i(o),this},filetree(n,s){t(this.filetree);const o=new Tu(n,s),a=Xa.to(o);return i(a),this},anchor(n,s){t(this.anchor);const o=new Au(n,s),a=Ya.to(o);return i(a),this},button(n){t(this.anchor);const s=new vp(n),o=nd.to(s,e._commandsConverter,e._sessionDisposables);return i(o),this},progress(n){t(this.progress);const s=new Ua(n),o=Za.to(s);return i(o),this},reference(n){t(this.reference);const s=new Ba(n),o=fo.to(s);return i(o),this},push(n){t(this.push);const s=ec.to(n);return i(s),this},report(n){if(t(this.report),"placeholder"in n&&"resolvedContent"in n)return;const s=rd.from(e._extension,n);if(!s){e._logService.error("Unknown progress type: "+JSON.stringify(n));return}return i(s),this}}}return this._apiObject}}class pm{static{this._idPool=0}constructor(e,t,i){this._logService=t,this.commands=i,this._agents=new Map,this._sessionDisposables=new j1,this._proxy=e.getProxy(j.MainThreadChatAgents2)}createChatAgent(e,t,i){const n=pm._idPool++,s=new pD(e,t,this._proxy,n,i);return this._agents.set(n,s),this._proxy.$registerAgent(n,e.identifier,t,{}),s.apiAgent}async $invokeAgent(e,t,i,n){const s=this._agents.get(e);if(!s)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let o=this._sessionDisposables.get(t.sessionId);o||(o=new Pe,this._sessionDisposables.set(t.sessionId,o));const a=new fD(s.extension,t,this._proxy,this._logService,this.commands.converter,o);try{const c=await this.prepareHistoryTurns(t.agentId,i),l=s.invoke(Qp.to(t),{history:c},a.apiObject,n);return await Mh(Promise.resolve(l).then(u=>{if(u?.metadata)try{JSON.stringify(u.metadata)}catch(h){const f=`result.metadata MUST be JSON.stringify-able. Got error: ${h.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${f}`,s.extension),{errorDetails:{message:f},timings:a.timings}}return{errorDetails:u?.errorDetails,timings:a.timings,metadata:u?.metadata}}),n)}catch(c){return this._logService.error(c,s.extension),{errorDetails:{message:g("vs/workbench/api/common/extHostChatAgents2","errorResponse","Error from provider: {0}",Un(c)),responseIsIncomplete:!0}}}finally{a.close()}}async prepareHistoryTurns(e,t){const i=[];for(const n of t.history){const s=po.to(n.result),o=e===n.request.agentId?s:{...s,metadata:void 0};i.push(new o0(n.request.message,n.request.command,n.request.variables.variables.map(sd.to),{extensionId:"",name:n.request.agentId}));const a=Mt(n.response.map(c=>ec.fromContent(c,this.commands.converter)));i.push(new a0(a,o,{extensionId:"",name:n.request.agentId},n.request.command))}return i}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideSlashCommands(e,t,i){const n=this._agents.get(e);if(!n)return[];const s=await this.prepareHistoryTurns(n.id,t);try{return await n.provideSlashCommands({history:s},i)}catch(o){const a=Un(o);return this._logService.error(`[${n.extension.identifier.value}] [@${n.id}] Error while providing slash commands: ${a}`),[]}}async $provideFollowups(e,t,i,n){const s=this._agents.get(t);if(!s)return Promise.resolve([]);const o=po.to(i);return(await s.provideFollowups(o,n)).filter(a=>{const c=!a.participant||_r.some(this._agents.values(),l=>l.id===a.participant&&Qe.equals(l.extension.identifier,s.extension.identifier));return c||this._logService.warn(`[@${s.id}] ChatFollowup refers to an invalid participant: ${a.participant}`),c}).map(a=>Ka.from(a,e))}$acceptFeedback(e,t,i,n){const s=this._agents.get(e);if(!s)return;const o=po.to(t);let a;switch(i){case Id.Down:a=Ha.Unhelpful;break;case Id.Up:a=Ha.Helpful;break}s.acceptFeedback(Object.freeze(n?{result:o,kind:a,reportIssue:n}:{result:o,kind:a}))}$acceptAction(e,t,i){const n=this._agents.get(e);if(!n||i.action.kind==="vote")return;const s=Jp.to(t,i,this.commands.converter);s&&n.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(e,t,i){const n=this._agents.get(e);return n?(await n.invokeCompletionProvider(t,i)).map(Kp.from):[]}async $provideWelcomeMessage(e,t){const i=this._agents.get(e);if(i)return await i.provideWelcomeMessage(t)}async $provideSampleQuestions(e,t){const i=this._agents.get(e);if(i)return(await i.provideSampleQuestions(t)).map(n=>Ka.from(n,void 0))}}class pD{constructor(e,t,i,n,s){this.extension=e,this.id=t,this._proxy=i,this._handle=n,this._requestHandler=s,this._onDidReceiveFeedback=new P,this._onDidPerformAction=new P}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideSlashCommands(e,t){if(!this._commandProvider)return[];const i=await this._commandProvider.provideCommands(e,t);return i?i.map(n=>("isSticky2"in n&&N(this.extension,"chatParticipantAdditions"),{name:n.name,description:n.description??"",followupPlaceholder:n.isSticky2?.placeholder,isSticky:n.isSticky2?.isSticky??n.isSticky,sampleRequest:n.sampleRequest})):[]}async provideFollowups(e,t){if(!this._followupProvider)return[];const i=await this._followupProvider.provideFollowups(e,t);return i?i.filter(n=>!(n&&"commandId"in n)).filter(n=>!(n&&"message"in n)):[]}async provideWelcomeMessage(e){if(!this._welcomeMessageProvider)return[];const t=await this._welcomeMessageProvider.provideWelcomeMessage(e);return t?t.map(i=>typeof i=="string"?i:De.from(i)):[]}async provideSampleQuestions(e){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const t=await this._welcomeMessageProvider.provideSampleQuestions(e);return t||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{description:this._description??"",fullName:this._fullName,icon:this._iconPath?this._iconPath instanceof b?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Nt?this._iconPath:void 0,hasSlashCommands:this._commandProvider!==void 0,hasFollowups:this._followupProvider!==void 0,isDefault:this._isDefault,isSecondary:this._isSecondary,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:De.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:De.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:De.from(this._helpTextPostfix),sampleRequest:this._sampleRequest,supportIssueReporting:this._supportIssueReporting,isSticky:this._isSticky}),t=!1}))},n=this;return{get name(){return n.id},get description(){return n._description??""},set description(s){n._description=s,i()},get fullName(){return N(n.extension,"defaultChatParticipant"),n._fullName??n.extension.displayName??n.extension.name},set fullName(s){N(n.extension,"defaultChatParticipant"),n._fullName=s,i()},get iconPath(){return n._iconPath},set iconPath(s){n._iconPath=s,i()},get requestHandler(){return n._requestHandler},set requestHandler(s){Nv(typeof s=="function","Invalid request handler"),n._requestHandler=s},get commandProvider(){return n._commandProvider},set commandProvider(s){n._commandProvider=s,i()},get followupProvider(){return n._followupProvider},set followupProvider(s){n._followupProvider=s,i()},get isDefault(){return N(n.extension,"defaultChatParticipant"),n._isDefault},set isDefault(s){N(n.extension,"defaultChatParticipant"),n._isDefault=s,i()},get helpTextPrefix(){return N(n.extension,"defaultChatParticipant"),n._helpTextPrefix},set helpTextPrefix(s){if(N(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextPrefix is only available on the default chat agent");n._helpTextPrefix=s,i()},get helpTextVariablesPrefix(){return N(n.extension,"defaultChatParticipant"),n._helpTextVariablesPrefix},set helpTextVariablesPrefix(s){if(N(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextVariablesPrefix is only available on the default chat agent");n._helpTextVariablesPrefix=s,i()},get helpTextPostfix(){return N(n.extension,"defaultChatParticipant"),n._helpTextPostfix},set helpTextPostfix(s){if(N(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextPostfix is only available on the default chat agent");n._helpTextPostfix=s,i()},get isSecondary(){return N(n.extension,"defaultChatParticipant"),n._isSecondary},set isSecondary(s){N(n.extension,"defaultChatParticipant"),n._isSecondary=s,i()},get sampleRequest(){return n._sampleRequest},set sampleRequest(s){n._sampleRequest=s,i()},get supportIssueReporting(){return N(n.extension,"chatParticipantAdditions"),n._supportIssueReporting},set supportIssueReporting(s){N(n.extension,"chatParticipantAdditions"),n._supportIssueReporting=s,i()},get onDidReceiveFeedback(){return n._onDidReceiveFeedback.event},set participantVariableProvider(s){if(N(n.extension,"chatParticipantAdditions"),n._agentVariableProvider=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");n._proxy.$registerAgentCompletionsProvider(n._handle,s.triggerCharacters)}else n._proxy.$unregisterAgentCompletionsProvider(n._handle)},get participantVariableProvider(){return N(n.extension,"chatParticipantAdditions"),n._agentVariableProvider},set welcomeMessageProvider(s){N(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider=s,i()},get welcomeMessageProvider(){return N(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider},onDidPerformAction:Ct(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,get isSticky(){return n._isSticky},set isSticky(s){n._isSticky=s,i()},dispose(){e=!0,n._commandProvider=void 0,n._followupProvider=void 0,n._onDidReceiveFeedback.dispose(),n._proxy.$unregisterAgent(n._handle)}}}invoke(e,t,i,n){return this._requestHandler(e,t,i,n)}}const gD=ee("progressService");class Ib{static{this.None=Object.freeze({report(){}})}get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}}let Pb=class extends Me{constructor(e,t){super(),this.deferred=new Ss,t.withProgress(e,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(Te(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};Pb=F([O(1,gD)],Pb),ee("editorProgressService");class Tb{constructor(e,t){this.option=e,this.stream=new Bh,this.stream=t??new Bh}}class mD{constructor(e,t){this.cts=t,this._responseStreams=new Map,this._defaultStream=new Bh,this._isDone=!1;const i=this;this.apiObject={result:e,stream:i._defaultStream.asyncIterable},e.then(()=>{for(const n of this._streams())n.resolve()}).catch(n=>{n instanceof Error||(n=new Error(Un(n),{cause:n}));for(const s of this._streams())s.reject(n)}).finally(()=>{this._isDone=!0})}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new Tb(e.index,this._defaultStream):t=new Tb(e.index),this._responseStreams.set(e.index,t)),t.stream.emitOne(e.part)}}class gm{static{this._idPool=1}constructor(e,t,i){this._logService=t,this._extHostAuthentication=i,this._onDidChangeModelAccess=new P,this._onDidChangeProviders=new P,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._languageModelIds=new Set,this._modelAccessList=new zn,this._pendingRequest=new Map,this._proxy=e.getProxy(j.MainThreadChatProvider)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,i,n){const s=gm._idPool++;this._languageModels.set(s,{extension:e.identifier,provider:i});let o;return n.auth&&(o={providerLabel:e.displayName||e.name,accountLabel:typeof n.auth=="object"?n.auth.label:void 0}),this._proxy.$registerProvider(s,t,{extension:e.identifier,model:n.name??"",auth:o}),Te(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s)})}async $provideLanguageModelResponse(e,t,i,n,s,o){const a=this._languageModels.get(e);if(!a)return;const c=new Ib(async l=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}this._proxy.$handleProgressChunk(t,{index:l.index,part:l.part})});return a.provider.provideLanguageModelResponse2(n.map(td.to),s,Qe.toKey(i),c,o)}$updateLanguageModels(e){const t=[],i=[];if(e.added)for(const n of e.added)this._languageModelIds.add(n),t.push(n);if(e.removed)for(const n of e.removed){this._languageModelIds.delete(n),i.push(n);for(const[s,o]of this._pendingRequest)o.languageModelId===n&&(o.res.cts.cancel(),this._pendingRequest.delete(s))}this._onDidChangeProviders.fire(Object.freeze({added:Object.freeze(t),removed:Object.freeze(i)}))}getLanguageModelIds(){return Array.from(this._languageModelIds)}$updateModelAccesslist(e){const t=new Array;for(const{from:i,to:n,enabled:s}of e){const o=this._modelAccessList.get(i)??new Ns;if(o.has(n)!==s){s?o.add(n):o.delete(n),this._modelAccessList.set(i,o);const c={from:i,to:n};t.push(c),this._onDidChangeModelAccess.fire(c)}}}async requestLanguageModelAccess(e,t,i){const n=e.identifier,s=i?.justification,o=await this._proxy.$prepareChatAccess(n,t,s);if(!o)throw new Error(`Language model '${t}' NOT found`);this._isUsingAuth(n,o)&&await this._getAuthAccess(e,{identifier:o.extension,displayName:o.auth.providerLabel},s);const a=this;return{get model(){return o.model},get isRevoked(){return a._isUsingAuth(n,o)&&!a._modelAccessList.get(n)?.has(o.extension)||!a._languageModelIds.has(t)},get onDidChangeAccess(){const c=ht.filter(a._onDidChangeProviders.event,u=>u.removed.includes(t)),l=ht.filter(a._onDidChangeModelAccess.event,u=>Qe.equals(u.from,n)&&Qe.equals(u.to,o.extension));return ht.signal(ht.any(c,l))},makeChatRequest(c,l,u){if(a._isUsingAuth(n,o)&&!a._modelAccessList.get(n)?.has(o.extension))throw new Error("Access to chat has been revoked");if(!a._languageModelIds.has(t))throw new Error("Language Model has been removed");const h=new dt(u),f=Math.random()*1e6|0,d=a._proxy.$fetchResponse(n,t,f,c.map(td.from),l??{},h.token),_=new mD(d,h);return a._pendingRequest.set(f,{languageModelId:t,res:_}),d.finally(()=>{a._pendingRequest.delete(f),h.dispose()}),_.apiObject}}}async $handleResponseFragment(e,t){const i=this._pendingRequest.get(e);i&&i.res.handleFragment(t)}async _getAuthAccess(e,t,i){const n=Eb+t.identifier.value;if(!await this._extHostAuthentication.getSession(e,n,[],{silent:!0}))try{const o=i?g("vs/workbench/api/common/extHostChatProvider","chatAccessWithJustification",`To allow access to the language models provided by {0}. Justification:

{1}`,t.displayName,i):g("vs/workbench/api/common/extHostChatProvider","chatAccess","To allow access to the language models provided by {0}",t.displayName);await this._extHostAuthentication.getSession(e,n,[],{forceNewSession:{detail:o}})}catch{throw new Error("Access to language models has not been granted")}this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}])}_isUsingAuth(e,t){return!!t.auth&&!Qe.equals(t.extension,e)}}class mm{static{this._idPool=0}constructor(e){this._resolver=new Map,this._proxy=e.getProxy(j.MainThreadChatVariables)}async $resolveVariable(e,t,i,n){const s=this._resolver.get(e);if(s)try{if(s.resolver.resolve2){N(s.extension,"chatParticipantAdditions");const o=new vD(t,this._proxy),a=await s.resolver.resolve2(s.data.name,{prompt:i},o.apiObject,n);if(a)return a.map(ho.from)}else{const o=await s.resolver.resolve(s.data.name,{prompt:i},n);if(o)return o.map(ho.from)}}catch(o){ch(o)}}registerVariableResolver(e,t,i,n){const s=mm._idPool++;return this._resolver.set(s,{extension:e,data:{name:t,description:i},resolver:n}),this._proxy.$registerVariable(s,{name:t,description:i}),Te(()=>{this._resolver.delete(s),this._proxy.$unregisterVariable(s)})}}class vD{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this,i=n=>{this._proxy.$handleProgressChunk(this._requestId,n)};this._apiObject={progress(n){t(this.progress);const s=new Ua(n),o=Za.to(s);return i(o),this},reference(n){t(this.reference);const s=new Ba(n),o=fo.to(s);return i(o),this},push(n){t(this.push);const s=ec.to(n);return i(s),this}}}return this._apiObject}}class _D{constructor(e){const t=e.getProxy(j.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}}const Ab="vscode-cdn.net",wD=`vscode-resource.${Ab}`,vm=`'self' https://*.${Ab}`;function _c(r,e){return r.scheme===K.http||r.scheme===K.https?r:(e&&e.authority&&e.isRemote&&r.scheme===K.file&&(r=b.from({scheme:K.vscodeRemote,authority:e.authority,path:r.path})),b.from({scheme:K.https,authority:`${r.scheme}+${bD(r.authority)}.${wD}`,path:r.path,fragment:r.fragment,query:r.query}))}function bD(r){return r.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57?e:"-"+t.toString(16).padStart(4,"0")})}class yD{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new Pe,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const n=t.getVisibleTextEditors();for(const s of this._insets.values())n.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,i,n,s){let o;for(const d of this._editors.getVisibleTextEditors(!0))if(d.value===e){o=d;break}if(!o)throw new Error("not a visible editor");const a=this,c=this._handlePool++,l=new P,u=new P,h=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(d){return _c(d,a._remoteInfo)}get cspSource(){return vm}set options(d){this._options=d,a._proxy.$setOptions(c,d)}get options(){return this._options}set html(d){this._html=d,a._proxy.$setHtml(c,d)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(d){return a._proxy.$postMessage(c,d)}},f=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=h,this.onDidDispose=u.event}dispose(){a._insets.has(c)&&(a._insets.delete(c),a._proxy.$disposeEditorInset(c),u.fire(),u.dispose(),l.dispose())}};return this._proxy.$createEditorInset(c,o.id,o.value.document.uri,t+1,i,n||{},s.identifier,s.extensionLocation),this._insets.set(c,{editor:e,inset:f,onDidReceiveMessage:l}),f}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){this._insets.get(e)?.onDidReceiveMessage.fire(t)}}function xD(r,e,t){const i=r.getProxy(j.MainThreadComments);class n{static{this.handlePool=0}constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new zn,e.registerArgumentProcessor({processArgument:d=>{if(d&&d.$mid===6){const _=this._commentControllers.get(d.handle);return _?_.value:d}else if(d&&d.$mid===7){const _=this._commentControllers.get(d.commentControlHandle);if(!_)return d;const w=_.getCommentThread(d.commentThreadHandle);return w?w.value:d}else if(d&&(d.$mid===9||d.$mid===8)){const _=this._commentControllers.get(d.thread.commentControlHandle);if(!_)return d;const w=_.getCommentThread(d.thread.commentThreadHandle);return w?d.$mid===8?w.value:{thread:w.value,text:d.text}:d}else if(d&&d.$mid===10){const _=this._commentControllers.get(d.thread.commentControlHandle);if(!_)return d;const w=_.getCommentThread(d.thread.commentThreadHandle);if(!w)return d;const x=d.commentUniqueId,k=w.getCommentByUniqueId(x);return k||d}else if(d&&d.$mid===11){const _=this._commentControllers.get(d.thread.commentControlHandle);if(!_)return d;const w=_.getCommentThread(d.thread.commentThreadHandle);if(!w)return d;const x=d.text,k=d.commentUniqueId,S=w.getCommentByUniqueId(k);return S?(typeof S.body=="string"?S.body=x:S.body=new gi(x),S):d}return d}})}createCommentController(d,_,w){const x=n.handlePool++,k=new o(d,x,_,w);this._commentControllers.set(k.handle,k);const S=this._commentControllersByExtension.get(d.identifier)||[];return S.push(k),this._commentControllersByExtension.set(d.identifier,S),k.value}async $createCommentThreadTemplate(d,_,w){const x=this._commentControllers.get(d);x&&x.$createCommentThreadTemplate(_,w)}async $setActiveComment(d,_){const w=this._commentControllers.get(d);w&&w.$setActiveComment(_??void 0)}async $updateCommentThreadTemplate(d,_,w){const x=this._commentControllers.get(d);x&&x.$updateCommentThreadTemplate(_,w)}$deleteCommentThread(d,_){this._commentControllers.get(d)?.$deleteCommentThread(_)}$provideCommentingRanges(d,_,w){const x=this._commentControllers.get(d);if(!x||!x.commentingRangeProvider)return Promise.resolve(void 0);const k=t.getDocument(b.revive(_));return Pt(async()=>{const S=await x.commentingRangeProvider.provideCommentingRanges(k,w);let D;return Array.isArray(S)?D={ranges:S,fileComments:!1}:S?D={ranges:S.ranges||[],fileComments:S.fileComments||!1}:D=S??void 0,D}).then(S=>{let D;return S&&(D={ranges:S.ranges.map(U=>$.from(U)),fileComments:S.fileComments}),D})}$toggleReaction(d,_,w,x,k){const S=this._commentControllers.get(d);return!S||!S.reactionHandler?Promise.resolve(void 0):Pt(()=>{const D=S.getCommentThread(_);if(D){const U=D.getCommentByUniqueId(x.uniqueIdInThread);if(S!==void 0&&U&&S.reactionHandler)return S.reactionHandler(U,l(k))}return Promise.resolve(void 0)})}}class s{static{this._handlePool=0}set threadId(d){this._id=d}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(d){(d===void 0!=(this._range===void 0)||!d||!this._range||!d.isEqual(this._range))&&(this._range=d,this.modifications.range=d,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(d){this._canReply!==d&&(this._canReply=d,this.modifications.canReply=d,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(d){this._label=d,this.modifications.label=d,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(d){this._contextValue=d,this.modifications.contextValue=d,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(d){this._comments=d,this.modifications.comments=d,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(d){this._collapseState=d,this.modifications.collapsibleState=d,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(d){this._state=d,this.modifications.state=d,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(d,_,w,x,k,S,D,U){this._commentControllerHandle=_,this._id=w,this._uri=x,this._range=k,this._comments=S,this.extensionDescription=D,this._isTemplate=U,this.handle=s._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new P,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new ms,this._acceptInputDisposables.value=new Pe,this._id===void 0&&(this._id=`${d}.${this.handle}`),i.$createCommentThread(_,this.handle,this._id,this._uri,$.from(this._range),D.identifier,this._isTemplate),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.comments=S,this._localDisposables.push({dispose:()=>{i.$deleteCommentThread(_,this.handle)}});const R=this;this.value={get uri(){return R.uri},get range(){return R.range},set range(H){R.range=H},get comments(){return R.comments},set comments(H){R.comments=H},get collapsibleState(){return R.collapsibleState},set collapsibleState(H){R.collapsibleState=H},get canReply(){return R.canReply},set canReply(H){R.canReply=H},get contextValue(){return R.contextValue},set contextValue(H){R.contextValue=H},get label(){return R.label},set label(H){R.label=H},get state(){return R.state},set state(H){R.state=H},dispose:()=>{R.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new Pe);const d=w=>Object.prototype.hasOwnProperty.call(this.modifications,w),_={};d("range")&&(_.range=$.from(this._range)),d("label")&&(_.label=this.label),d("contextValue")&&(_.contextValue=this.contextValue??null),d("comments")&&(_.comments=this._comments.map(w=>a(this,w,this._commentsMap,this.extensionDescription))),d("collapsibleState")&&(_.collapseState=u(this._collapseState)),d("canReply")&&(_.canReply=this.canReply),d("state")&&(_.state=h(this._state)),d("isTemplate")&&(_.isTemplate=this._isTemplate),this.modifications={},i.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,_)}getCommentByUniqueId(d){for(const _ of this._commentsMap){const w=_[0],x=_[1];if(d===x)return w}}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(d=>d.dispose())}}class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(d){this._commentingRangeProvider=d,i.$updateCommentingRanges(this.handle)}get reactionHandler(){return this._reactionHandler}set reactionHandler(d){this._reactionHandler=d,i.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!d})}get options(){return this._options}set options(d){this._options=d,i.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return N(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return N(this._extension,"activeComment"),this._activeThread}constructor(d,_,w,x){this._extension=d,this._handle=_,this._id=w,this._label=x,this._threads=new Map,i.$registerCommentController(this.handle,w,x,this._extension.identifier.value);const k=this;this.value=Object.freeze({id:k.id,label:k.label,get options(){return k.options},set options(S){k.options=S},get commentingRangeProvider(){return k.commentingRangeProvider},set commentingRangeProvider(S){k.commentingRangeProvider=S},get reactionHandler(){return k.reactionHandler},set reactionHandler(S){k.reactionHandler=S},get activeCommentThread(){return k.activeCommentThread},createCommentThread(S,D,U){return k.createCommentThread(S,D,U).value},dispose:()=>{k.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{i.$unregisterCommentController(this.handle)}})}createCommentThread(d,_,w){_===void 0&&N(this._extension,"fileComments");const x=new s(this.id,this.handle,void 0,d,_,w,this._extension,!1);return this._threads.set(x.handle,x),x}$setActiveComment(d){if(!d){this._activeComment=void 0,this._activeThread=void 0;return}const _=this._threads.get(d.commentThreadHandle);_&&(this._activeComment=d.uniqueIdInThread?_.getCommentByUniqueId(d.uniqueIdInThread):void 0,this._activeThread=_)}$createCommentThreadTemplate(d,_){const w=new s(this.id,this.handle,void 0,b.revive(d),$.to(_),[],this._extension,!0);return w.collapsibleState=As.Expanded,this._threads.set(w.handle,w),w}$updateCommentThreadTemplate(d,_){const w=this._threads.get(d);w&&(w.range=$.to(_))}$deleteCommentThread(d){this._threads.get(d)?.dispose(),this._threads.delete(d)}getCommentThread(d){return this._threads.get(d)}dispose(){this._threads.forEach(d=>{d.dispose()}),this._localDisposables.forEach(d=>d.dispose())}}function a(f,d,_,w){let x=_.get(d);return x||(x=++f.commentHandle,_.set(d,x)),d.state!==void 0&&N(w,"commentsDraftState"),d.reactions?.some(k=>k.reactors!==void 0)&&N(w,"commentReactor"),{mode:d.mode,contextValue:d.contextValue,uniqueIdInThread:x,body:typeof d.body=="string"?d.body:De.from(d.body),userName:d.author.name,userIconPath:d.author.iconPath,label:d.label,commentReactions:d.reactions?d.reactions.map(k=>c(k)):void 0,state:d.state,timestamp:d.timestamp?.toJSON()}}function c(f){return{label:f.label,iconPath:f.iconPath?$u(f.iconPath):void 0,count:f.count,hasReacted:f.authorHasReacted,reactors:f.reactors&&f.reactors.length>0&&typeof f.reactors[0]!="string"?f.reactors.map(d=>d.name):f.reactors}}function l(f){return{label:f.label||"",count:f.count||0,iconPath:f.iconPath?b.revive(f.iconPath):"",authorHasReacted:f.hasReacted||!1,reactors:f.reactors?.map(d=>({name:d}))}}function u(f){if(f!==void 0)switch(f){case La.Expanded:return As.Expanded;case La.Collapsed:return As.Collapsed}return As.Collapsed}function h(f){if(f!==void 0)switch(f){case Oa.Unresolved:return ua.Unresolved;case Oa.Resolved:return ua.Resolved}return ua.Unresolved}return new n}var Rb={exports:{}},_m={};(function(r,e){e=r.exports=Ne;var t;typeof process=="object"&&_m&&_m.NODE_DEBUG&&/\bsemver\b/i.test(_m.NODE_DEBUG)?t=function(){var y=Array.prototype.slice.call(arguments,0);y.unshift("SEMVER"),console.log.apply(console,y)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var i=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,o=e.re=[],a=e.src=[],c=0,l=c++;a[l]="0|[1-9]\\d*";var u=c++;a[u]="[0-9]+";var h=c++;a[h]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=c++;a[f]="("+a[l]+")\\.("+a[l]+")\\.("+a[l]+")";var d=c++;a[d]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var _=c++;a[_]="(?:"+a[l]+"|"+a[h]+")";var w=c++;a[w]="(?:"+a[u]+"|"+a[h]+")";var x=c++;a[x]="(?:-("+a[_]+"(?:\\."+a[_]+")*))";var k=c++;a[k]="(?:-?("+a[w]+"(?:\\."+a[w]+")*))";var S=c++;a[S]="[0-9A-Za-z-]+";var D=c++;a[D]="(?:\\+("+a[S]+"(?:\\."+a[S]+")*))";var U=c++,R="v?"+a[f]+a[x]+"?"+a[D]+"?";a[U]="^"+R+"$";var H="[v=\\s]*"+a[d]+a[k]+"?"+a[D]+"?",le=c++;a[le]="^"+H+"$";var ie=c++;a[ie]="((?:<|>)?=?)";var fe=c++;a[fe]=a[u]+"|x|X|\\*";var we=c++;a[we]=a[l]+"|x|X|\\*";var z=c++;a[z]="[v=\\s]*("+a[we]+")(?:\\.("+a[we]+")(?:\\.("+a[we]+")(?:"+a[x]+")?"+a[D]+"?)?)?";var B=c++;a[B]="[v=\\s]*("+a[fe]+")(?:\\.("+a[fe]+")(?:\\.("+a[fe]+")(?:"+a[k]+")?"+a[D]+"?)?)?";var J=c++;a[J]="^"+a[ie]+"\\s*"+a[z]+"$";var V=c++;a[V]="^"+a[ie]+"\\s*"+a[B]+"$";var re=c++;a[re]="(?:^|[^\\d])(\\d{1,"+s+"})(?:\\.(\\d{1,"+s+"}))?(?:\\.(\\d{1,"+s+"}))?(?:$|[^\\d])";var de=c++;a[de]="(?:~>?)";var oe=c++;a[oe]="(\\s*)"+a[de]+"\\s+",o[oe]=new RegExp(a[oe],"g");var Ke="$1~",Je=c++;a[Je]="^"+a[de]+a[z]+"$";var wt=c++;a[wt]="^"+a[de]+a[B]+"$";var Ft=c++;a[Ft]="(?:\\^)";var bt=c++;a[bt]="(\\s*)"+a[Ft]+"\\s+",o[bt]=new RegExp(a[bt],"g");var st="$1^",lt=c++;a[lt]="^"+a[Ft]+a[z]+"$";var ci=c++;a[ci]="^"+a[Ft]+a[B]+"$";var kt=c++;a[kt]="^"+a[ie]+"\\s*("+H+")$|^$";var Li=c++;a[Li]="^"+a[ie]+"\\s*("+R+")$|^$";var _e=c++;a[_e]="(\\s*)"+a[ie]+"\\s*("+H+"|"+a[z]+")",o[_e]=new RegExp(a[_e],"g");var u1="$1$2$3",Ji=c++;a[Ji]="^\\s*("+a[z]+")\\s+-\\s+("+a[z]+")\\s*$";var ur=c++;a[ur]="^\\s*("+a[B]+")\\s+-\\s+("+a[B]+")\\s*$";var Lc=c++;a[Lc]="(<|>)?=?\\s*\\*";for(var kn=0;kn<c;kn++)t(kn,a[kn]),o[kn]||(o[kn]=new RegExp(a[kn]));e.parse=Dn;function Dn(y,I){if(y instanceof Ne)return y;if(typeof y!="string"||y.length>i)return null;var T=I?o[le]:o[U];if(!T.test(y))return null;try{return new Ne(y,I)}catch{return null}}e.valid=d1;function d1(y,I){var T=Dn(y,I);return T?T.version:null}e.clean=Yd;function Yd(y,I){var T=Dn(y.trim().replace(/^[=v]+/,""),I);return T?T.version:null}e.SemVer=Ne;function Ne(y,I){if(y instanceof Ne){if(y.loose===I)return y;y=y.version}else if(typeof y!="string")throw new TypeError("Invalid Version: "+y);if(y.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof Ne))return new Ne(y,I);t("SemVer",y,I),this.loose=I;var T=y.trim().match(I?o[le]:o[U]);if(!T)throw new TypeError("Invalid Version: "+y);if(this.raw=y,this.major=+T[1],this.minor=+T[2],this.patch=+T[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");T[4]?this.prerelease=T[4].split(".").map(function(G){if(/^[0-9]+$/.test(G)){var W=+G;if(W>=0&&W<n)return W}return G}):this.prerelease=[],this.build=T[5]?T[5].split("."):[],this.format()}Ne.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Ne.prototype.toString=function(){return this.version},Ne.prototype.compare=function(y){return t("SemVer.compare",this.version,this.loose,y),y instanceof Ne||(y=new Ne(y,this.loose)),this.compareMain(y)||this.comparePre(y)},Ne.prototype.compareMain=function(y){return y instanceof Ne||(y=new Ne(y,this.loose)),Xi(this.major,y.major)||Xi(this.minor,y.minor)||Xi(this.patch,y.patch)},Ne.prototype.comparePre=function(y){if(y instanceof Ne||(y=new Ne(y,this.loose)),this.prerelease.length&&!y.prerelease.length)return-1;if(!this.prerelease.length&&y.prerelease.length)return 1;if(!this.prerelease.length&&!y.prerelease.length)return 0;var I=0;do{var T=this.prerelease[I],G=y.prerelease[I];if(t("prerelease compare",I,T,G),T===void 0&&G===void 0)return 0;if(G===void 0)return 1;if(T===void 0)return-1;if(T===G)continue;return Xi(T,G)}while(++I)},Ne.prototype.inc=function(y,I){switch(y){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",I);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",I);break;case"prepatch":this.prerelease.length=0,this.inc("patch",I),this.inc("pre",I);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",I),this.inc("pre",I);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var T=this.prerelease.length;--T>=0;)typeof this.prerelease[T]=="number"&&(this.prerelease[T]++,T=-2);T===-1&&this.prerelease.push(0)}I&&(this.prerelease[0]===I?isNaN(this.prerelease[1])&&(this.prerelease=[I,0]):this.prerelease=[I,0]);break;default:throw new Error("invalid increment argument: "+y)}return this.format(),this.raw=this.version,this},e.inc=Zd;function Zd(y,I,T,G){typeof T=="string"&&(G=T,T=void 0);try{return new Ne(y,T).inc(I,G).version}catch{return null}}e.diff=dr;function dr(y,I){if(Lo(y,I))return null;var T=Dn(y),G=Dn(I);if(T.prerelease.length||G.prerelease.length){for(var W in T)if((W==="major"||W==="minor"||W==="patch")&&T[W]!==G[W])return"pre"+W;return"prerelease"}for(var W in T)if((W==="major"||W==="minor"||W==="patch")&&T[W]!==G[W])return W}e.compareIdentifiers=Xi;var eh=/^[0-9]+$/;function Xi(y,I){var T=eh.test(y),G=eh.test(I);return T&&G&&(y=+y,I=+I),T&&!G?-1:G&&!T?1:y<I?-1:y>I?1:0}e.rcompareIdentifiers=Oc;function Oc(y,I){return Xi(I,y)}e.major=h1;function h1(y,I){return new Ne(y,I).major}e.minor=f1;function f1(y,I){return new Ne(y,I).minor}e.patch=hs;function hs(y,I){return new Ne(y,I).patch}e.compare=Oi;function Oi(y,I,T){return new Ne(y,T).compare(new Ne(I,T))}e.compareLoose=p1;function p1(y,I){return Oi(y,I,!0)}e.rcompare=g1;function g1(y,I,T){return Oi(I,y,T)}e.sort=Ao;function Ao(y,I){return y.sort(function(T,G){return e.compare(T,G,I)})}e.rsort=m1;function m1(y,I){return y.sort(function(T,G){return e.rcompare(T,G,I)})}e.gt=Ro;function Ro(y,I,T){return Oi(y,I,T)>0}e.lt=hr;function hr(y,I,T){return Oi(y,I,T)<0}e.eq=Lo;function Lo(y,I,T){return Oi(y,I,T)===0}e.neq=th;function th(y,I,T){return Oi(y,I,T)!==0}e.gte=Oo;function Oo(y,I,T){return Oi(y,I,T)>=0}e.lte=$o;function $o(y,I,T){return Oi(y,I,T)<=0}e.cmp=No;function No(y,I,T,G){var W;switch(I){case"===":typeof y=="object"&&(y=y.version),typeof T=="object"&&(T=T.version),W=y===T;break;case"!==":typeof y=="object"&&(y=y.version),typeof T=="object"&&(T=T.version),W=y!==T;break;case"":case"=":case"==":W=Lo(y,T,G);break;case"!=":W=th(y,T,G);break;case">":W=Ro(y,T,G);break;case">=":W=Oo(y,T,G);break;case"<":W=hr(y,T,G);break;case"<=":W=$o(y,T,G);break;default:throw new TypeError("Invalid operator: "+I)}return W}e.Comparator=ei;function ei(y,I){if(y instanceof ei){if(y.loose===I)return y;y=y.value}if(!(this instanceof ei))return new ei(y,I);t("comparator",y,I),this.loose=I,this.parse(y),this.semver===fs?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var fs={};ei.prototype.parse=function(y){var I=this.loose?o[kt]:o[Li],T=y.match(I);if(!T)throw new TypeError("Invalid comparator: "+y);this.operator=T[1],this.operator==="="&&(this.operator=""),T[2]?this.semver=new Ne(T[2],this.loose):this.semver=fs},ei.prototype.toString=function(){return this.value},ei.prototype.test=function(y){return t("Comparator.test",y,this.loose),this.semver===fs?!0:(typeof y=="string"&&(y=new Ne(y,this.loose)),No(y,this.operator,this.semver,this.loose))},ei.prototype.intersects=function(y,I){if(!(y instanceof ei))throw new TypeError("a Comparator is required");var T;if(this.operator==="")return T=new ot(y.value,I),Mo(this.value,T,I);if(y.operator==="")return T=new ot(this.value,I),Mo(y.semver,T,I);var G=(this.operator===">="||this.operator===">")&&(y.operator===">="||y.operator===">"),W=(this.operator==="<="||this.operator==="<")&&(y.operator==="<="||y.operator==="<"),m=this.semver.version===y.semver.version,v=(this.operator===">="||this.operator==="<=")&&(y.operator===">="||y.operator==="<="),C=No(this.semver,"<",y.semver,I)&&(this.operator===">="||this.operator===">")&&(y.operator==="<="||y.operator==="<"),q=No(this.semver,">",y.semver,I)&&(this.operator==="<="||this.operator==="<")&&(y.operator===">="||y.operator===">");return G||W||m&&v||C||q},e.Range=ot;function ot(y,I){if(y instanceof ot)return y.loose===I?y:new ot(y.raw,I);if(y instanceof ei)return new ot(y.value,I);if(!(this instanceof ot))return new ot(y,I);if(this.loose=I,this.raw=y,this.set=y.split(/\s*\|\|\s*/).map(function(T){return this.parseRange(T.trim())},this).filter(function(T){return T.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+y);this.format()}ot.prototype.format=function(){return this.range=this.set.map(function(y){return y.join(" ").trim()}).join("||").trim(),this.range},ot.prototype.toString=function(){return this.range},ot.prototype.parseRange=function(y){var I=this.loose;y=y.trim(),t("range",y,I);var T=I?o[ur]:o[Ji];y=y.replace(T,b1),t("hyphen replace",y),y=y.replace(o[_e],u1),t("comparator trim",y,o[_e]),y=y.replace(o[oe],Ke),y=y.replace(o[bt],st),y=y.split(/\s+/).join(" ");var G=I?o[kt]:o[Li],W=y.split(" ").map(function(m){return ih(m,I)}).join(" ").split(/\s+/);return this.loose&&(W=W.filter(function(m){return!!m.match(G)})),W=W.map(function(m){return new ei(m,I)}),W},ot.prototype.intersects=function(y,I){if(!(y instanceof ot))throw new TypeError("a Range is required");return this.set.some(function(T){return T.every(function(G){return y.set.some(function(W){return W.every(function(m){return G.intersects(m,I)})})})})},e.toComparators=$c;function $c(y,I){return new ot(y,I).set.map(function(T){return T.map(function(G){return G.value}).join(" ").trim().split(" ")})}function ih(y,I){return t("comp",y),y=se(y,I),t("caret",y),y=Yi(y,I),t("tildes",y),y=v1(y,I),t("xrange",y),y=w1(y,I),t("stars",y),y}function E(y){return!y||y.toLowerCase()==="x"||y==="*"}function Yi(y,I){return y.trim().split(/\s+/).map(function(T){return nh(T,I)}).join(" ")}function nh(y,I){var T=I?o[wt]:o[Je];return y.replace(T,function(G,W,m,v,C){t("tilde",y,G,W,m,v,C);var q;return E(W)?q="":E(m)?q=">="+W+".0.0 <"+(+W+1)+".0.0":E(v)?q=">="+W+"."+m+".0 <"+W+"."+(+m+1)+".0":C?(t("replaceTilde pr",C),C.charAt(0)!=="-"&&(C="-"+C),q=">="+W+"."+m+"."+v+C+" <"+W+"."+(+m+1)+".0"):q=">="+W+"."+m+"."+v+" <"+W+"."+(+m+1)+".0",t("tilde return",q),q})}function se(y,I){return y.trim().split(/\s+/).map(function(T){return Fe(T,I)}).join(" ")}function Fe(y,I){t("caret",y,I);var T=I?o[ci]:o[lt];return y.replace(T,function(G,W,m,v,C){t("caret",y,G,W,m,v,C);var q;return E(W)?q="":E(m)?q=">="+W+".0.0 <"+(+W+1)+".0.0":E(v)?W==="0"?q=">="+W+"."+m+".0 <"+W+"."+(+m+1)+".0":q=">="+W+"."+m+".0 <"+(+W+1)+".0.0":C?(t("replaceCaret pr",C),C.charAt(0)!=="-"&&(C="-"+C),W==="0"?m==="0"?q=">="+W+"."+m+"."+v+C+" <"+W+"."+m+"."+(+v+1):q=">="+W+"."+m+"."+v+C+" <"+W+"."+(+m+1)+".0":q=">="+W+"."+m+"."+v+C+" <"+(+W+1)+".0.0"):(t("no pr"),W==="0"?m==="0"?q=">="+W+"."+m+"."+v+" <"+W+"."+m+"."+(+v+1):q=">="+W+"."+m+"."+v+" <"+W+"."+(+m+1)+".0":q=">="+W+"."+m+"."+v+" <"+(+W+1)+".0.0"),t("caret return",q),q})}function v1(y,I){return t("replaceXRanges",y,I),y.split(/\s+/).map(function(T){return _1(T,I)}).join(" ")}function _1(y,I){y=y.trim();var T=I?o[V]:o[J];return y.replace(T,function(G,W,m,v,C,q){t("xRange",y,G,W,m,v,C,q);var Ie=E(m),Ge=Ie||E(v),Dt=Ge||E(C),li=Dt;return W==="="&&li&&(W=""),Ie?W===">"||W==="<"?G="<0.0.0":G="*":W&&li?(Ge&&(v=0),Dt&&(C=0),W===">"?(W=">=",Ge?(m=+m+1,v=0,C=0):Dt&&(v=+v+1,C=0)):W==="<="&&(W="<",Ge?m=+m+1:v=+v+1),G=W+m+"."+v+"."+C):Ge?G=">="+m+".0.0 <"+(+m+1)+".0.0":Dt&&(G=">="+m+"."+v+".0 <"+m+"."+(+v+1)+".0"),t("xRange return",G),G})}function w1(y,I){return t("replaceStars",y,I),y.trim().replace(o[Lc],"")}function b1(y,I,T,G,W,m,v,C,q,Ie,Ge,Dt,li){return E(T)?I="":E(G)?I=">="+T+".0.0":E(W)?I=">="+T+"."+G+".0":I=">="+I,E(q)?C="":E(Ie)?C="<"+(+q+1)+".0.0":E(Ge)?C="<"+q+"."+(+Ie+1)+".0":Dt?C="<="+q+"."+Ie+"."+Ge+"-"+Dt:C="<="+C,(I+" "+C).trim()}ot.prototype.test=function(y){if(!y)return!1;typeof y=="string"&&(y=new Ne(y,this.loose));for(var I=0;I<this.set.length;I++)if(Fo(this.set[I],y))return!0;return!1};function Fo(y,I){for(var T=0;T<y.length;T++)if(!y[T].test(I))return!1;if(I.prerelease.length){for(var T=0;T<y.length;T++)if(t(y[T].semver),y[T].semver!==fs&&y[T].semver.prerelease.length>0){var G=y[T].semver;if(G.major===I.major&&G.minor===I.minor&&G.patch===I.patch)return!0}return!1}return!0}e.satisfies=Mo;function Mo(y,I,T){try{I=new ot(I,T)}catch{return!1}return I.test(y)}e.maxSatisfying=y1;function y1(y,I,T){var G=null,W=null;try{var m=new ot(I,T)}catch{return null}return y.forEach(function(v){m.test(v)&&(!G||W.compare(v)===-1)&&(G=v,W=new Ne(G,T))}),G}e.minSatisfying=x1;function x1(y,I,T){var G=null,W=null;try{var m=new ot(I,T)}catch{return null}return y.forEach(function(v){m.test(v)&&(!G||W.compare(v)===1)&&(G=v,W=new Ne(G,T))}),G}e.validRange=rh;function rh(y,I){try{return new ot(y,I).range||"*"}catch{return null}}e.ltr=C1;function C1(y,I,T){return Nc(y,I,"<",T)}e.gtr=S1;function S1(y,I,T){return Nc(y,I,">",T)}e.outside=Nc;function Nc(y,I,T,G){y=new Ne(y,G),I=new ot(I,G);var W,m,v,C,q;switch(T){case">":W=Ro,m=$o,v=hr,C=">",q=">=";break;case"<":W=hr,m=Oo,v=Ro,C="<",q="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Mo(y,I,G))return!1;for(var Ie=0;Ie<I.set.length;++Ie){var Ge=I.set[Ie],Dt=null,li=null;if(Ge.forEach(function(fr){fr.semver===fs&&(fr=new ei(">=0.0.0")),Dt=Dt||fr,li=li||fr,W(fr.semver,Dt.semver,G)?Dt=fr:v(fr.semver,li.semver,G)&&(li=fr)}),Dt.operator===C||Dt.operator===q||(!li.operator||li.operator===C)&&m(y,li.semver))return!1;if(li.operator===q&&v(y,li.semver))return!1}return!0}e.prerelease=E1;function E1(y,I){var T=Dn(y,I);return T&&T.prerelease.length?T.prerelease:null}e.intersects=k1;function k1(y,I,T){return y=new ot(y,T),I=new ot(I,T),y.intersects(I)}e.coerce=D1;function D1(y){if(y instanceof Ne)return y;if(typeof y!="string")return null;var I=y.match(o[re]);return I==null?null:Dn((I[1]||"0")+"."+(I[2]||"0")+"."+(I[3]||"0"))}})(Rb,Rb.exports);const Lb=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,CD=/^-(\d{4})(\d{2})(\d{2})$/;function SD(r){return r=r.trim(),r==="*"||Lb.test(r)}function Ob(r){if(!SD(r))return null;if(r=r.trim(),r==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const e=r.match(Lb);return e?{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]!=="x",minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]!=="x",patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]!=="x",preRelease:e[8]||null}:null}function $b(r){if(!r)return null;const e=r.majorBase,t=r.majorMustEqual,i=r.minorBase;let n=r.minorMustEqual;const s=r.patchBase;let o=r.patchMustEqual;r.hasCaret&&(e===0||(n=!1),o=!1);let a=0;if(r.preRelease){const c=CD.exec(r.preRelease);if(c){const[,l,u,h]=c;a=Date.UTC(Number(l),Number(u)-1,Number(h))}}return{majorBase:e,majorMustEqual:t,minorBase:i,minorMustEqual:n,patchBase:s,patchMustEqual:o,isMinimum:r.hasGreaterEquals,notBefore:a}}class ED{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function kD(r,e){if(e.serializeBuffersForPostMessage){const t=new ED,n=JSON.stringify(r,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a)};if(ArrayBuffer.isView(a)){const c=DD(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=t.buffers.map(o=>{const a=new Uint8Array(o);return he.wrap(a)});return{message:n,buffers:s}}else return{message:JSON.stringify(r),buffers:[]}}function DD(r){switch(r.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function ID(r,e){const t=e.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),i=e.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=t[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(r,i),arrayBuffers:t}}class PD{#e;#t;#i;#n;#s;#r;#a;#o;#c;#l;#u;#h;constructor(e,t,i,n,s,o,a){this.#a="",this.#c=!1,this.#l=!1,this._onMessageEmitter=new P,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#d=new P,this._onDidDispose=this.#d.event,this.#e=e,this.#t=t,this.#o=i,this.#n=n,this.#s=s,this.#r=o,this.#u=ko(o),this.#h=TD(o),this.#i=a}#d;dispose(){this.#c=!0,this.#d.fire(),this.#d.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#l=!0,_c(e,this.#n)}get cspSource(){const e=this.#r.extensionLocation;if(e.scheme===K.https||e.scheme===K.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+vm}return vm}get html(){return this.assertNotDisposed(),this.#a}set html(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#h&&!this.#l&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#l=!0,this.#i.report("Webview vscode-resource: uris",this.#r,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#t.$setHtml(this.#e,this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),this.#o}set options(e){this.assertNotDisposed(),Si(this.#o,e)||this.#t.$setOptions(this.#e,Nb(this.#r,this.#s,e)),this.#o=e}async postMessage(e){if(this.#c)return!1;const t=kD(e,{serializeBuffersForPostMessage:this.#u});return this.#t.$postMessage(this.#e,t.message,...t.buffers)}assertNotDisposed(){if(this.#c)throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){if(!this.#h)return e;const t=this.#r.extensionLocation?.scheme===K.vscodeRemote,i=this.#r.extensionLocation.scheme===K.vscodeRemote?this.#r.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(n,s,o,a,c,l)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(c)}),h=_c(u,{isRemote:t,authority:i}).toString();return`${s}${h}${l}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(n,s,o,a,c,l)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(c)}),h=_c(u,{isRemote:t,authority:i}).toString();return`${s}${h}${l}`})}}function ko(r){try{const e=$b(Ob(r.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function TD(r){try{const e=$b(Ob(r.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class AD extends Me{constructor(e,t,i,n,s){super(),this.remoteInfo=t,this.workspace=i,this._logService=n,this._deprecationService=s,this._webviews=new Map,this._webviewProxy=e.getProxy(j.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const n=this.getWebview(e);if(n){const{message:s}=ID(t,i.value);n._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const n=new PD(e,this._webviewProxy,RD(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,n);const s=n._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return n}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function Pd(r){return{id:r.identifier,location:r.extensionLocation}}function Nb(r,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||LD(r,e)}}function RD(r){return{enableCommandUris:r.enableCommandUris,enableScripts:r.enableScripts,enableForms:r.enableForms,portMapping:r.portMapping,localResourceRoots:r.localResourceRoots?.map(e=>b.from(e))}}function LD(r,e){return[...(e?.getWorkspaceFolders()||[]).map(t=>t.uri),r.extensionLocation]}class Ti{static{this.enableDebugLogging=!1}constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){Ti.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}}class OD{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Ti("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=UD(this.document.uri)+this._backupCounter++;return Cs(this._storagePath,e)}updateBackup(e){this._backup?.delete(),this._backup=e}disposeBackup(){this._backup?.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class $D{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const n=this.key(e,t.uri);if(this._documents.has(n))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new OD(t,i);return this._documents.set(n,s),s}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}}class ND{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(0,e,t,i)}addCustomProvider(e,t,i){return this.add(1,e,t,i)}get(e){return this._providers.get(e)}add(e,t,i,n){if(this._providers.has(t))throw new Error(`Provider for viewType:${t} already registered`);return this._providers.set(t,{type:e,extension:i,provider:n}),new ke(()=>this._providers.delete(t))}}class FD{constructor(e,t,i,n,s){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=n,this._extHostWebviewPanels=s,this._editorProviders=new ND,this._documents=new $D,this._proxy=e.getProxy(j.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,n){const s=new Pe;return MD(i)?(s.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(Pd(e),t,n.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},ko(e))):(s.add(this._editorProviders.addCustomProvider(t,e,i)),Td(i)&&s.add(i.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(t,o.document.uri);if(HD(o)){const c=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,t,c,o.label)}else this._proxy.$onContentChange(o.document.uri,t)})),this._proxy.$registerCustomEditorProvider(Pd(e),t,n.webviewOptions||{},!!n.supportsMultipleEditorsPerDocument,ko(e))),ke.from(s,new ke(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,n,s){const o=this._editorProviders.get(t);if(!o)throw new Error(`No provider found for '${t}'`);if(o.type!==1)throw new Error(`Invalid provide type for '${t}'`);const a=b.revive(e),c=await o.provider.openCustomDocument(a,{backupId:i,untitledDocumentData:n?.buffer},s);let l;return Td(o.provider)&&this._extensionStoragePaths&&(l=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)),this._documents.add(t,c,l),{editable:Td(o.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const n=b.revive(e),{document:s}=this.getCustomDocumentEntry(t,n);this._documents.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,i,n,s,o){const a=this._editorProviders.get(i);if(!a)throw new Error(`No provider found for '${i}'`);const c=pt.to(s),l=this._extHostWebview.createNewWebview(t,n.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,i,n.title,c,n.options,l,n.active),h=b.revive(e);switch(a.type){case 1:{const{document:f}=this.getCustomDocumentEntry(i,h);return a.provider.resolveCustomEditor(f,u,o)}case 0:{const f=this._extHostDocuments.getDocument(h);return a.provider.resolveCustomTextEditor(f,u,o)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const n=this._editorProviders.get(i);if(!n)throw new Error(`No provider found for '${i}'`);if(!n.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=b.revive(t),a=this._extHostDocuments.getDocument(o);await n.provider.moveCustomTextEditor(a,s,yt.None)}async $undo(e,t,i,n){return this.getCustomDocumentEntry(t,e).undo(i,n)}async $redo(e,t,i,n){return this.getCustomDocumentEntry(t,e).redo(i,n)}async $revert(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(n.document,i),n.disposeBackup()}async $onSave(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(n.document,i),n.disposeBackup()}async $onSaveAs(e,t,i,n){const s=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(s.document,b.revive(i),n)}async $backup(e,t,i){const n=this.getCustomDocumentEntry(t,e),o=await this.getCustomEditorProvider(t).backupCustomDocument(n.document,{destination:n.getNewBackupUri()},i);return n.updateBackup(o),o.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,b.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const i=this._editorProviders.get(e)?.provider;if(!i||!Td(i))throw new Error("Custom document is not editable");return i}}function Td(r){return!!r.onDidChangeCustomDocument}function MD(r){return typeof r.resolveCustomTextEditor=="function"}function HD(r){return typeof r.undo=="function"&&typeof r.redo=="function"}function UD(r){const e=r.scheme===K.file||r.scheme===K.untitled?r.fsPath:r.toString();return qh(e)+""}var ar;class Ad{#e;#t;#i;constructor(e,t,i,n,s,o,a,c){this._name=e,this._owner=t,this._maxDiagnosticsTotal=i,this._maxDiagnosticsPerFile=n,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(n,i),this.#i=new it(l=>o.getComparisonKey(l)),this.#e=a,this.#t=c}dispose(){this._isDisposed||(this.#t.fire([...this.#i.keys()]),this.#e?.$clear(this._owner),this.#i.clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let i=[];if(b.isUri(e)){if(!t){this.delete(e);return}this.#i.set(e,t.slice()),i=[e]}else if(Array.isArray(e)){i=[];let o;e=[...e].sort(Ad._compareIndexedTuplesByUri);for(const a of e){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&this.#i.get(o).length===0&&this.#i.delete(o),o=c,i.push(c),this.#i.set(c,[])),l)this.#i.get(c)?.push(...l);else{const u=this.#i.get(c);u&&(u.length=0)}}}if(this.#t.fire(i),!this.#e)return;const n=[];let s=0;for(const o of i){let a=[];const c=this.#i.get(o);if(c)if(c.length>this._maxDiagnosticsPerFile){a=[];const l=[Et.Error,Et.Warning,Et.Information,Et.Hint];e:for(let u=0;u<4;u++)for(const h of c)if(h.severity===l[u]&&a.push({...io.from(h),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:Ut.Info,message:g("vs/workbench/api/common/extHostDiagnostics",{key:"limitHit"},"Not showing {0} further errors and warnings.",c.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...io.from(l),modelVersionId:this._modelVersionIdProvider(o)}));if(n.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}this.#e.$changeMany(this._owner,n)}delete(e){this._checkDisposed(),this.#t.fire([e]),this.#i.delete(e),this.#e?.$changeMany(this._owner,[[e,void 0]])}clear(){this._checkDisposed(),this.#t.fire([...this.#i.keys()]),this.#i.clear(),this.#e?.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[i,n]of this)e.call(t,i,n,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of this.#i.keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=this.#i.get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(this.#i.get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}}let wm=class{static{ar=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*ar._maxDiagnosticsPerFile}static _mapper(e){const t=new it;for(const i of e)t.set(i,i);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,i,n){this._logService=t,this._fileSystemInfoService=i,this._extHostDocumentsAndEditors=n,this._collections=new Map,this._onDidChangeDiagnostics=new f2({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=ht.map(this._onDidChangeDiagnostics.event,ar._mapper),this._proxy=e.getProxy(j.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:i,_proxy:n,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:c}=this,l=new class{$changeMany(f,d){n.$changeMany(f,d),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,f,d.length===0?"CLEARING":d)}$clear(f){n.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,f)}dispose(){n.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+ar._idPool++,u=t;else if(!i.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+ar._idPool++;while(i.has(u))}return new class extends Ad{constructor(){super(t,u,ar._maxDiagnosticsTotal,ar._maxDiagnosticsPerFile,f=>c.getDocument(f)?.version,a.extUri,l,s),i.set(u,this)}dispose(){super.dispose(),i.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,i=[];for(const n of this._collections.values())n.forEach((s,o)=>{let a=t.get(s.toString());typeof a>"u"&&(a=i.length,t.set(s.toString(),a),i.push([s,[]])),i[a][1]=i[a][1].concat(...o)});return i}}_getDiagnostics(e){let t=[];for(const i of this._collections.values())i.has(e)&&(t=t.concat(i.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",i=new Ad(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,n=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,i),this._mirrorCollection=i}for(const[t,i]of e)this._mirrorCollection.set(b.revive(t),i.map(io.to))}};wm=ar=F([O(1,ze),O(2,Ds)],wm);class BD{constructor(e){this._proxy=e.getProxy(j.MainThreadDialogs)}showOpenDialog(e,t){return t?.allowUIResources&&N(e,"showLocal"),this._proxy.$showOpenDialog(t).then(i=>i?i.map(n=>b.revive(n)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?b.revive(t):void 0)}}class bm{static{this._handlePool=0}constructor(e,t,i){this._documentsAndEditors=t,this._logService=i,this._documentContentProviders=new Map,this._proxy=e.getProxy(j.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(K).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const i=bm._handlePool++;this._documentContentProviders.set(i,t),this._proxy.$registerTextContentProvider(i,e);let n;if(typeof t.onDidChange=="function"){let s;n=t.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(i,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this._documentsAndEditors.getDocument(o);if(!l)return;const u=Ev(c);if(!l.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,c)}).catch(Zi).finally(()=>{s===a&&(s=void 0)});s=a})}return new ke(()=>{this._documentContentProviders.delete(i)&&this._proxy.$unregisterTextContentProvider(i),n&&(n.dispose(),n=void 0)})}$provideTextDocumentContent(e,t){const i=this._documentContentProviders.get(e);return i?Promise.resolve(i.provideTextDocumentContent(b.revive(t),yt.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}}class WD{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._callbacks=new Wo,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,n)=>{const o={dispose:this._callbacks.push([t,i,e])};return Array.isArray(n)&&n.push(o),o}}async $participateInSave(e,t){const i=b.revive(e);let n=!1;const s=setTimeout(()=>n=!0,this._thresholds.timeout),o=[];try{for(const a of[...this._callbacks]){if(n)break;const c=this._documents.getDocument(i),l=await this._deliverEventAsyncAndBlameBadListeners(a,{document:c,reason:ju.to(t)});o.push(l)}}finally{clearTimeout(s)}return o}_deliverEventAsyncAndBlameBadListeners([e,t,i],n){const s=this._badListeners.get(e);return typeof s=="number"&&s>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,n).then(()=>!0,o=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(o),!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,i,n){const s=[],o=Date.now(),{document:a,reason:c}=n,{version:l}=a,u=Object.freeze({document:a,reason:c,waitUntil(h){if(Object.isFrozen(s))throw lh("waitUntil can not be called async");s.push(Promise.resolve(h))}});try{t.apply(i,[u])}catch(h){return Promise.reject(h)}return new Promise((h,f)=>{const d=setTimeout(()=>f(new Error("timeout")),this._thresholds.timeout);return Promise.all(s).then(_=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(d),h(_)}).catch(_=>{clearTimeout(d),f(_)})}).then(h=>{const f={edits:[]};for(const d of h)if(Array.isArray(d)&&d.every(_=>_ instanceof jn))for(const{newText:_,newEol:w,range:x}of d)f.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:x&&$.from(x),text:_,eol:w&&ao.from(w)}});if(f.edits.length!==0)return l===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(f):Promise.reject(new Error("concurrent_edits"))})}}class VD{constructor(e,t){this._onDidAddDocument=new P,this._onDidRemoveDocument=new P,this._onDidChangeDocument=new P,this._onDidSaveDocument=new P,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new Pe,this._documentLoader=new Map,this._proxy=e.getProxy(j.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(i=>{for(const n of i)this._onDidRemoveDocument.fire(n.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(i=>{for(const n of i)this._onDidAddDocument.fire(n.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let i=this._documentLoader.get(e.toString());return i||(i=this._proxy.$tryOpenDocument(e).then(n=>{this._documentLoader.delete(e.toString());const s=b.revive(n);return xs(this._documentsAndEditors.getDocument(s))},n=>(this._documentLoader.delete(e.toString()),Promise.reject(n))),this._documentLoader.set(e.toString(),i)),i}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>b.revive(t))}$acceptModelLanguageChanged(e,t){const i=b.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");this._onDidRemoveDocument.fire(n.document),n._acceptLanguageId(t),this._onDidAddDocument.fire(n.document)}$acceptModelSaved(e){const t=b.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=b.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");n._acceptIsDirty(t),this._onDidChangeDocument.fire({document:n.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const n=b.revive(e),s=this._documentsAndEditors.getDocument(n);if(!s)throw new Error("unknown document");s._acceptIsDirty(i),s.onEvents(t);let o;t.isUndoing?o=Da.Undo:t.isRedoing&&(o=Da.Redo),this._onDidChangeDocument.fire(Kh({document:s.document,contentChanges:t.changes.map(a=>({range:$.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:o}))}setWordDefinitionFor(e,t){Wk(e,t)}}class zD{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(j.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const n=this._AiEmbeddingVectorProviders.get(e);if(!n)throw new Error("Embedding vector provider not found");const s=await n.provideEmbeddingVector(t,i);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(n,i),this._proxy.$registerAiEmbeddingVectorProvider(t,n),new ke(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(n),this._AiEmbeddingVectorProviders.delete(n)})}}class qD{constructor(e,t,i){const n=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)n[s]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Fb{constructor(e){let t=0,i=0;for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];c>t&&(t=c),a>i&&(i=a),l>i&&(i=l)}t++,i++;const n=new qD(i,t,0);for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];n.set(a,c,l)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let ym=null;function jD(){return ym===null&&(ym=new Fb([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),ym}let wc=null;function GD(){if(wc===null){wc=new vd(0);const r=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<r.length;t++)wc.set(r.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)wc.set(e.charCodeAt(t),2)}return wc}class Rd{static _createLink(e,t,i,n,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),c=t.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=jD()){const i=GD(),n=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),c=a.length;let l=0,u=0,h=0,f=1,d=!1,_=!1,w=!1,x=!1;for(;l<c;){let k=!1;const S=a.charCodeAt(l);if(f===13){let D;switch(S){case 40:d=!0,D=0;break;case 41:D=d?0:1;break;case 91:w=!0,_=!0,D=0;break;case 93:w=!1,D=_?0:1;break;case 123:x=!0,D=0;break;case 125:D=x?0:1;break;case 39:case 34:case 96:h===S?D=1:h===39||h===34||h===96?D=0:D=1;break;case 42:D=h===42?1:0;break;case 124:D=h===124?1:0;break;case 32:D=w?0:1;break;default:D=i.get(S)}D===1&&(n.push(Rd._createLink(i,a,s,u,l)),k=!0)}else if(f===12){let D;S===91?(_=!0,D=0):D=i.get(S),D===1?k=!0:f=13}else f=t.nextState(f,S),f===0&&(k=!0);k&&(f=1,d=!1,_=!1,x=!1,u=l+1,h=S),l++}f===13&&n.push(Rd._createLink(i,a,s,u,c))}return n}}class QD{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,n,s=14,o=14;for(const a of e){let c=i?Y2(i,a):0;for(c===0?n=1:n=o;c<a.length;c++)c+1===a.length?(s=o,o=9):o+=1,t.push([n,a.toUpperCase().charCodeAt(c),o]),t.push([n,a.toLowerCase().charCodeAt(c),o]),n=o;i=a,o=s}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new Fb(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=Rd.computeLinks({getLineContent(n){return e.lineAt(n-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const n of i){const s=Yr.to(n);s.target&&t.push(s)}return t}}class Ld{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new QD,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(j.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(e,t,i,n={}){if(Ld._validateFileSystemProvider(i),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(s,i);let o=2;n.isCaseSensitive&&(o+=1024),n.isReadonly&&(o+=2048),typeof i.copy=="function"&&(o+=8),typeof i.open=="function"&&typeof i.close=="function"&&typeof i.read=="function"&&typeof i.write=="function"&&(N(e,"fsChunks"),o+=4);let a;n.isReadonly&&Rr(n.isReadonly)&&n.isReadonly.value!==""&&(a={value:n.isReadonly.value,isTrusted:n.isReadonly.isTrusted,supportThemeIcons:n.isReadonly.supportThemeIcons,supportHtml:n.isReadonly.supportHtml,baseUri:n.isReadonly.baseUri,uris:n.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,t,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(l)});const c=i.onDidChangeFile(l=>{const u=[];for(const h of l){const{uri:f,type:d}=h;if(f.scheme!==t)continue;let _;switch(d){case Ks.Changed:_=0;break;case Ks.Created:_=1;break;case Ks.Deleted:_=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:_})}this._proxy.$onFileSystemChange(s,u)});return Te(()=>{c.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:i,mtime:n,size:s,permissions:o}=e;return{type:t,ctime:i,mtime:n,size:s,permissions:o}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(b.revive(t))).then(i=>Ld._asIStat(i))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(b.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(b.revive(t))).then(i=>he.wrap(i))}$writeFile(e,t,i,n){return Promise.resolve(this._getFsProvider(e).writeFile(b.revive(t),i.buffer,n))}$delete(e,t,i){return Promise.resolve(this._getFsProvider(e).delete(b.revive(t),i))}$rename(e,t,i,n){return Promise.resolve(this._getFsProvider(e).rename(b.revive(t),b.revive(i),n))}$copy(e,t,i,n){const s=this._getFsProvider(e);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(b.revive(t),b.revive(i),n))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(b.revive(t)))}$watch(e,t,i,n){const s=this._getFsProvider(e).watch(b.revive(i),n);this._watches.set(t,s)}$unwatch(e,t){const i=this._watches.get(t);i&&(i.dispose(),this._watches.delete(t))}$open(e,t,i){const n=this._getFsProvider(e);if(!n.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(n.open(b.revive(t),i))}$close(e,t){const i=this._getFsProvider(e);if(!i.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(i.close(t))}$read(e,t,i,n){const s=this._getFsProvider(e);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=he.alloc(n);return Promise.resolve(s.read(t,i,o.buffer,0,n)).then(a=>o.slice(0,a))}$write(e,t,i,n){const s=this._getFsProvider(e);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(t,i,n.buffer,0,n.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const i=new Error;throw i.name="ENOPRO",i.message="no provider",i}return t}}class KD{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,i,n,s,o){this.session=Math.random(),this._onDidCreate=new P,this._onDidChange=new P,this._onDidDelete=new P,this._config=0,o?.ignoreCreateEvents&&(this._config+=1),o?.ignoreChangeEvents&&(this._config+=2),o?.ignoreDeleteEvents&&(this._config+=4);const a=Os(s),c=typeof s=="string",l=o?.correlate,u=n(h=>{if(!(typeof h.session=="number"&&h.session!==this.session)&&!(l&&typeof h.session>"u")){if(!o?.ignoreCreateEvents)for(const f of h.created){const d=b.revive(f);a(d.fsPath)&&(!c||t.getWorkspaceFolder(d))&&this._onDidCreate.fire(d)}if(!o?.ignoreChangeEvents)for(const f of h.changed){const d=b.revive(f);a(d.fsPath)&&(!c||t.getWorkspaceFolder(d))&&this._onDidChange.fire(d)}if(!o?.ignoreDeleteEvents)for(const f of h.deleted){const d=b.revive(f);a(d.fsPath)&&(!c||t.getWorkspaceFolder(d))&&this._onDidDelete.fire(d)}}});this._disposable=ke.from(this.ensureWatching(e,i,s,o,o?.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,n,s){const o=ke.from();if(typeof i=="string")return o;const a=e.getProxy(j.MainThreadFileSystemEventService);let c=!1;return(i.pattern.includes(pa)||i.pattern.includes(ff))&&(c=!0),a.$watch(t.identifier.value,this.session,i.baseUri,{recursive:c,excludes:n?.excludes??[]},!!s),ke.from({dispose:()=>a.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class JD{constructor(e){this._events=e,this.session=this._events.session,this._created=new ui(()=>this._events.created.map(b.revive)),this._changed=new ui(()=>this._events.changed.map(b.revive)),this._deleted=new ui(()=>this._events.deleted.map(b.revive))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class XD{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new P,this._onDidRenameFile=new P,this._onDidCreateFile=new P,this._onDidDeleteFile=new P,this._onWillRenameFile=new Vo,this._onWillCreateFile=new Vo,this._onWillDeleteFile=new Vo,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,n){return new KD(this._mainContext,e,t,this._onFileSystemEvent.event,Yt.from(i),n)}$onFileEvent(e){this._onFileSystemEvent.fire(new JD(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map(i=>({oldUri:b.revive(i.source),newUri:b.revive(i.target)}))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map(i=>b.revive(i.target))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map(i=>b.revive(i.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,n,s)=>{const o=function(c){i.call(n,c)};return o.extension=e,t.event(o,void 0,s)}}async $onWillRunFileOperation(e,t,i,n){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(s=>({oldUri:b.revive(s.source),newUri:b.revive(s.target)}))},i,n);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(s=>b.revive(s.target))},i,n);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(s=>b.revive(s.target))},i,n)}}async _fireWillEvent(e,t,i,n){const s=new Set,o=[];if(await e.fireAsync(t,n,async(c,l)=>{const u=Date.now(),h=await Promise.resolve(c);h instanceof Gn&&(o.push([l.extension,h]),s.add(l.extension.displayName??l.extension.identifier.value)),Date.now()-u>i&&this._logService.warn("SLOW file-participant",l.extension.identifier)}),n.isCancellationRequested||o.length===0)return;const a={edits:[]};for(const[,c]of o){const{edits:l}=Vt.from(c,{getTextDocumentVersion:u=>this._extHostDocumentsAndEditors.getDocument(u)?.version,getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(l)}return{edit:a,extensionNames:Array.from(s)}}}class xm{static{this._pool=0}constructor(e,t){this.extension=e,this.provider=t,this.handle=xm._pool++}}class YD{constructor(e){this.session=e,this.responses=[]}}class Od{static{this._nextId=0}constructor(e,t,i,n){this._documents=i,this._logService=n,this._inputProvider=new Map,this._inputSessions=new Map,this._proxy=e.getProxy(j.MainThreadInlineChat),t.registerApiCommand(new pe("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new M("Run arguments","",s=>!0,s=>{if(s)return{initialRange:s.initialRange?$.from(s.initialRange):void 0,initialSelection:un.isSelection(s.initialSelection)?mi.from(s.initialSelection):void 0,message:s.message,autoSend:s.autoSend,position:s.position?He.from(s.position):void 0}})],ue.Void))}registerProvider(e,t,i){const n=new xm(e,t);return this._inputProvider.set(n.handle,n),this._proxy.$registerInteractiveEditorProvider(n.handle,i?.label??e.displayName??e.name,e.identifier.value,typeof t.handleInteractiveEditorResponseFeedback=="function",typeof t.provideFollowups=="function",i?.supportReportIssue??!1),Te(()=>{this._proxy.$unregisterInteractiveEditorProvider(n.handle),this._inputProvider.delete(n.handle)})}async $prepareSession(e,t,i,n){const s=this._inputProvider.get(e);if(!s){this._logService.warn("CANNOT prepare session because the PROVIDER IS GONE");return}const o=this._documents.getDocument(b.revive(t)),a=mi.to(i),c=await s.provider.prepareInteractiveEditorSession({document:o,selection:a},n);if(!c)return;if(c.wholeRange&&!c.wholeRange.contains(a))throw new Error("InteractiveEditorSessionProvider returned a wholeRange that does not contain the selection.");const l=Od._nextId++;return this._inputSessions.set(l,new YD(c)),{id:l,placeholder:c.placeholder,input:c.input,slashCommands:c.slashCommands?.map(u=>({command:u.command,detail:u.detail,refer:u.refer,executeImmediately:u.executeImmediately})),wholeRange:$.from(c.wholeRange),message:c.message}}async $provideResponse(e,t,i,n){const s=this._inputProvider.get(e);if(!s)return;const o=this._inputSessions.get(t.id);if(!o)return;const a={prompt:i.prompt,selection:mi.to(i.selection),wholeRange:$.to(i.wholeRange),attempt:i.attempt,live:i.live,previewDocument:this._documents.getDocument(b.revive(i.previewDocument)),withIntentDetection:i.withIntentDetection};let c=!1;const l={report:async k=>{if(!i.live&&k.edits?.length)throw new Error("Progress reporting is only supported for live sessions");c||n.isCancellationRequested||await this._proxy.$handleProgressChunk(i.requestId,{message:k.message,edits:k.edits?.map(vt.from),editsShouldBeInstant:k.editsShouldBeInstant,slashCommand:k.slashCommand?.command,markdownFragment:gi.isMarkdownString(k.content)?k.content.value:k.content})}},u=Promise.resolve(s.provider.provideInteractiveEditorResponse(o.session,a,l,n));let h;try{h=await Mh(u,n)}finally{c=!0}if(!h)return;const f=o.responses.push(h)-1,d={wholeRange:$.from(h.wholeRange),placeholder:h.placeholder};if(!Od._isEditResponse(h))return{...d,id:f,type:"editorEdit",message:De.from(h.contents),edits:[]};const{edits:_,contents:w}=h,x=w!==void 0?De.from(w):void 0;return _ instanceof Gn?{...d,id:f,type:"bulkEdit",edits:Vt.from(_),message:x}:{...d,id:f,type:"editorEdit",edits:_.map(vt.from),message:x}}async $provideFollowups(e,t,i,n){const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o?.responses[i];if(s&&a&&s.provider.provideFollowups){const c=Promise.resolve(s.provider.provideFollowups(o.session,a,n));return(await Mh(c,n))?.map(jp.from)}}$handleFeedback(e,t,i,n){const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o?.responses[i];if(s&&a){const c=Gp.to(n);s.provider.handleInteractiveEditorResponseFeedback?.(o.session,a,c)}}$releaseSession(e,t){}static _isEditResponse(e){return typeof e=="object"&&typeof e.edits=="object"}}class ZD{constructor(e,t,i,n,s){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=n;const o=new pe("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new M("showOptions","Show Options",a=>!0,a=>a),new M("resource","Interactive resource Uri",a=>!0,a=>a),new M("controllerId","Notebook controller Id",a=>!0,a=>a),new M("title","Interactive editor title",a=>!0,a=>a)],new ue("Notebook and input URI",a=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const c=this._extHostNotebooks.getEditorById(a.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",c.id),{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri),notebookEditor:c.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,t,i,n){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class eI{constructor(e){this._IssueUriRequestHandlers=new Map,this._IssueDataProviders=new Map,this._proxy=e.getProxy(j.MainThreadIssueReporter)}async $getIssueReporterUri(e,t){if(this._IssueUriRequestHandlers.size===0)throw new Error("No issue request handlers registered");const i=this._IssueUriRequestHandlers.get(e);if(!i)throw new Error("Issue request handler not found");const n=await i.handleIssueUrlRequest();if(!n)throw new Error("Issue request handler returned no result");return n}async $getIssueReporterData(e,t){if(this._IssueDataProviders.size===0)throw new Error("No issue request handlers registered");const i=this._IssueDataProviders.get(e);if(!i)throw new Error("Issue data provider not found");const n=await i.provideIssueData(t);if(!n)throw new Error("Issue data provider returned no result");return n}async $getIssueReporterTemplate(e,t){if(this._IssueDataProviders.size===0)throw new Error("No issue request handlers registered");const i=this._IssueDataProviders.get(e);if(!i)throw new Error("Issue data provider not found");const n=await i.provideIssueTemplate(t);if(!n)throw new Error("Issue template provider returned no result");return n}registerIssueUriRequestHandler(e,t){const i=e.identifier.value;return this._IssueUriRequestHandlers.set(i,t),this._proxy.$registerIssueUriRequestHandler(i),new ke(()=>{this._proxy.$unregisterIssueUriRequestHandler(i),this._IssueUriRequestHandlers.delete(i)})}registerIssueDataProvider(e,t){const i=e.identifier.value;return this._IssueDataProviders.set(i,t),this._proxy.$registerIssueDataProvider(i),new ke(()=>{this._proxy.$unregisterIssueDataProvider(i),this._IssueDataProviders.delete(i)})}}class tI{constructor(e){this._handlePool=0,this._proxy=e.getProxy(j.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),Te(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}class ai extends Be{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return ai.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new ai(this.startLineNumber,this.startColumn,e,t):new ai(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new pi(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new pi(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new ai(e,t,this.endLineNumber,this.endColumn):new ai(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new ai(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new ai(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new ai(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new ai(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,s){return s===0?new ai(e,t,i,n):new ai(i,n,e,t)}}class $d{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentSymbols(i,t);if(!dh(n))return n[0]instanceof xa?n.map(Dp.from):$d._asDocumentSymbolTree(n)}static _asDocumentSymbolTree(e){e=e.slice(0).sort((n,s)=>{let o=n.location.range.start.compareTo(s.location.range.start);return o===0&&(o=s.location.range.end.compareTo(n.location.range.end)),o});const t=[],i=[];for(const n of e){const s={name:n.name||"!!MISSING: name!!",kind:vi.from(n.kind),tags:n.tags?.map(pn.from)||[],detail:"",containerName:n.containerName,range:$.from(n.location.range),selectionRange:$.from(n.location.range),children:[]};for(;;){if(i.length===0){i.push(s),t.push(s);break}const o=i[i.length-1];if(Be.containsRange(o.range,s.range)&&!Be.equalsRange(o.range,s.range)){o.children?.push(s),i.push(s);break}i.pop()}}return t}}class Nd{constructor(e,t,i,n,s,o){this._documents=e,this._commands=t,this._provider=i,this._extension=n,this._extTelemetry=s,this._logService=o,this._cache=new Ti("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideCodeLenses(i,t);if(!n||t.isCancellationRequested)return;const s=this._cache.add(n),o=new Pe;this._disposables.set(s,o);const a={cacheId:s,lenses:[]};for(let c=0;c<n.length;c++)a.lenses.push({cacheId:[s,c],range:$.from(n[c].range),command:this._commands.toInternal(n[c].command,o)});return a}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let n;if(typeof this._provider.resolveCodeLens!="function"||i.isResolved?n=i:n=await this._provider.resolveCodeLens(i,t),n||(n=i),t.isCancellationRequested)return;const s=e.cacheId&&this._disposables.get(e.cacheId[0]);if(s){if(!n.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o),this._logService.error(o);return}return e.command=this._commands.toInternal(n.command,s),e}}releaseCodeLenses(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function Fd(r){return Array.isArray(r)?r.map(za.from):r?[za.from(r)]:[]}class Mb{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideDefinition(n,s,i);return Fd(o)}}class Hb{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideDeclaration(n,s,i);return Fd(o)}}class Ub{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideImplementation(n,s,i);return Fd(o)}}class Bb{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideTypeDefinition(n,s,i);return Fd(o)}}class Wb{constructor(e,t){this._documents=e,this._provider=t}async provideHover(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideHover(n,s,i);if(!(!o||dh(o.contents)))return o.range||(o.range=n.getWordRangeAtPosition(s)),o.range||(o.range=new ve(s,s)),Fu.from(o)}}class Vb{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideEvaluatableExpression(n,s,i);if(o)return Tp.from(o)}}class zb{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,n){const s=this._documents.getDocument(e),o=await this._provider.provideInlineValues(s,$.to(t),Hu.to(i),n);if(Array.isArray(o))return o.map(a=>Mu.from(a))}}class qb{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideDocumentHighlights(n,s,i);if(Array.isArray(o))return o.map(ro.from)}}class jb{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,i,n){const s=this._documents.getDocument(e),o=i.map(l=>this._documents.getDocument(l)),a=He.to(t),c=await this._provider.provideMultiDocumentHighlights(s,a,o,n);if(Array.isArray(c))return c.map(Ap.from)}}class Gb{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.provideLinkedEditingRanges(n,s,i);if(o&&Array.isArray(o.ranges))return{ranges:Mt(o.ranges.map($.from)),wordPattern:o.wordPattern}}}class Qb{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,n){const s=this._documents.getDocument(e),o=He.to(t),a=await this._provider.provideReferences(s,o,i,n);if(Array.isArray(a))return a.map(oi.from)}}class cr{static{this._maxCodeActionsPerFile=1e3}constructor(e,t,i,n,s,o,a){this._documents=e,this._commands=t,this._diagnostics=i,this._provider=n,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new Ti("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,i,n){const s=this._documents.getDocument(e),o=ai.isISelection(t)?mi.to(t):$.to(t),a=[];for(const d of this._diagnostics.getDiagnostics(e))if(o.intersection(d.range)&&a.push(d)>cr._maxCodeActionsPerFile)break;const c={diagnostics:a,only:i.only?new Ze(i.only):void 0,triggerKind:qp.to(i.trigger)},l=await this._provider.provideCodeActions(s,o,c,n);if(!Ho(l)||n.isCancellationRequested)return;const u=this._cache.add(l),h=new Pe;this._disposables.set(u,h);const f=[];for(let d=0;d<l.length;d++){const _=l[d];if(_)if(cr._isCommand(_))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:_.title,command:this._commands.toInternal(_,h)});else{c.only&&(_.kind?c.only.contains(_.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action is of kind '${_.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const w=_.ranges??[];f.push({cacheId:[u,d],title:_.title,command:_.command&&this._commands.toInternal(_.command,h),diagnostics:_.diagnostics&&_.diagnostics.map(io.from),edit:_.edit&&Vt.from(_.edit,void 0),kind:_.kind&&_.kind.value,isPreferred:_.isPreferred,isAI:Ct(this._extension,"codeActionAI")?_.isAI:!1,ranges:Ct(this._extension,"codeActionRanges")?Mt(w.map($.from)):void 0,disabled:_.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(e,t){const[i,n]=e,s=this._cache.get(i,n);if(!s||cr._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,t)??s;let a;o.edit&&(a=Vt.from(o.edit,void 0));let c;if(o.command){const l=this._disposables.get(i);l&&(c=this._commands.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}}class Do{static toInternalProviderId(e,t){return e+"."+t}constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s}async prepareDocumentPaste(e,t,i,n){if(!this._provider.prepareDocumentPaste)return;const s=this._documents.getDocument(e),o=t.map(l=>$.to(l)),a=ir.toDataTransfer(i,()=>{throw new Ny});if(await this._provider.prepareDocumentPaste(s,o,a,n),n.isCancellationRequested)return;const c=Array.from(a).filter(([,l])=>!(l instanceof ou));return ir.from(c)}async providePasteEdits(e,t,i,n,s){if(!this._provider.provideDocumentPasteEdits)return;const o=this._documents.getDocument(t),a=i.map(u=>$.to(u)),c=ir.toDataTransfer(n,async u=>(await this._proxy.$resolvePasteFileData(this._handle,e,u)).buffer),l=await this._provider.provideDocumentPasteEdits(o,a,c,s);if(l)return{label:l.label??g("vs/workbench/api/common/extHostLanguageFeatures","defaultPasteLabel","Paste using '{0}' extension",this._extension.displayName||this._extension.name),detail:this._extension.displayName||this._extension.name,yieldTo:l.yieldTo?.map(u=>"mimeType"in u?u:{providerId:Do.toInternalProviderId(u.extensionId,u.providerId)}),insertText:typeof l.insertText=="string"?l.insertText:{snippet:l.insertText.value},additionalEdit:l.additionalEdit?Vt.from(l.additionalEdit,void 0):void 0}}}class Kb{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentFormattingEdits(n,t,i);if(Array.isArray(s))return s.map(vt.from)}}class Cm{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,n){const s=this._documents.getDocument(e),o=$.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(vt.from)}async provideDocumentRangesFormattingEdits(e,t,i,n){Nv(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this._documents.getDocument(e),o=t.map($.to),a=await this._provider.provideDocumentRangesFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(vt.from)}}class Jb{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,n,s){const o=this._documents.getDocument(e),a=He.to(t),c=await this._provider.provideOnTypeFormattingEdits(o,a,i,n,s);if(Array.isArray(c))return c.map(vt.from)}}class Md{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Ti("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!Ho(i))return{symbols:[]};const n=this._cache.add(i),s={cacheId:n,symbols:[]};for(let o=0;o<i.length;o++){const a=i[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}s.symbols.push({...Va.from(a),cacheId:[n,o]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const n=await this._provider.resolveWorkspaceSymbol(i,t);return n&&Ar(e,Va.from(n),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class cs{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideRenameEdits(e,t,i,n){const s=this._documents.getDocument(e),o=He.to(t);try{const a=await this._provider.provideRenameEdits(s,o,i,n);return a?Vt.from(a):void 0}catch(a){const c=cs._asMessage(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,i){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const n=this._documents.getDocument(e),s=He.to(t);try{const o=await this._provider.prepareRename(n,s,i);let a,c;if(ve.isRange(o)?(a=o,c=n.getText(o)):It(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:$.from(a),text:c}}catch(o){const a=cs._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}class Hd{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideNewSymbolNames(e,t,i){const n=this._documents.getDocument(e),s=$.to(t);try{const o=await this._provider.provideNewSymbolNames(n,s,i);return o?o.map(a=>typeof a=="string"?{newSymbolName:a}:{newSymbolName:a.newSymbolName,tags:a.tags}):void 0}catch(o){this._logService.error(Hd._asMessage(o)??JSON.stringify(o,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}class Sm{constructor(e,t){this.resultId=e,this.tokens=t}}class Zt{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=t!==0?this._previousResults.get(t):null;let o=typeof s?.resultId=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(n,s.resultId,i):await this._provider.provideDocumentSemanticTokens(n,i);return s&&this._previousResults.delete(t),o?(o=Zt._fixProvidedSemanticTokens(o),this._send(Zt._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return Zt._isSemanticTokens(e)?Zt._isCorrectSemanticTokens(e)?e:new Js(new Uint32Array(e.data),e.resultId):Zt._isSemanticTokensEdits(e)?Zt._isCorrectSemanticTokensEdits(e)?e:new vu(e.edits.map(t=>new Jw(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!Zt._isSemanticTokens(t)||!e||!e.tokens)return t;const i=e.tokens,n=i.length,s=t.data,o=s.length;let a=0;const c=Math.min(n,o);for(;a<c&&i[a]===s[a];)a++;if(a===n&&a===o)return new vu([],t.resultId);let l=0;const u=c-a;for(;l<u&&i[n-l-1]===s[o-l-1];)l++;return new vu([{start:a,deleteCount:n-a-l,data:s.subarray(a,o-l)}],t.resultId)}_send(e,t){if(Zt._isSemanticTokens(e)){const i=this._nextResultId++;return this._previousResults.set(i,new Sm(e.resultId,e.data)),um({id:i,type:"full",data:e.data})}if(Zt._isSemanticTokensEdits(e)){const i=this._nextResultId++;return Zt._isSemanticTokens(t)?this._previousResults.set(i,new Sm(t.resultId,t.data)):this._previousResults.set(i,new Sm(e.resultId)),um({id:i,type:"delta",deltas:(e.edits||[]).map(n=>({start:n.start,deleteCount:n.deleteCount,data:n.data}))})}return null}}class Xb{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentRangeSemanticTokens(n,$.to(t),i);return s?this._send(s):null}_send(e){return um({id:0,type:"full",data:e.data})}}class ls{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._apiDeprecation=n,this._extension=s,this._cache=new Ti("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,i,n){const s=this._documents.getDocument(e),o=He.to(t),a=s.getWordRangeAtPosition(o)||new ve(o,o),c=a.with({end:o}),l=new en,u=await this._provider.provideCompletionItems(s,o,n,Lp.to(i));if(!u||n.isCancellationRequested)return;const h=Array.isArray(u)?new Us(u):u,f=ls.supportsResolving(this._provider)?this._cache.add(h.items):this._cache.add([]),d=new Pe;this._disposables.set(f,d);const _=[],w={x:f,b:_,a:{replace:$.from(a),insert:$.from(c)},c:h.isIncomplete||void 0,d:l.elapsed()};for(let x=0;x<h.items.length;x++){const k=h.items[x],S=this._convertCompletionItem(k,[f,x],c,a);_.push(S)}return w}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const i=this._cache.get(...e);if(!i)return;const n=this._convertCompletionItem(i,e),s=await this._provider.resolveCompletionItem(i,t);if(!s)return;const o=this._convertCompletionItem(s,e);return(n.h!==o.h||n.i!==o.i)&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(n.n!==o.n||n.o!==o.o||!Si(n.p,o.p))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...n,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,i,n){const s=this._disposables.get(t[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(e.command,s),a={x:t,a:e.label,b:e.kind!==void 0?Bu.from(e.kind):void 0,m:e.tags&&e.tags.map(Uu.from),c:e.detail,d:typeof e.documentation>"u"?void 0:De.fromStrict(e.documentation),e:e.sortText!==e.label?e.sortText:void 0,f:e.filterText!==e.label?e.filterText:void 0,g:e.preselect||void 0,i:e.keepWhitespace?1:0,k:e.commitCharacters?.join(""),l:e.additionalTextEdits&&e.additionalTextEdits.map(vt.from),n:o?.$ident,o:o?.id,p:o?.$ident?void 0:o?.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=e.textEdit.newText):typeof e.insertText=="string"?a.h=e.insertText:e.insertText instanceof Ur&&(a.h=e.insertText.value,a.i|=4);let c;return e.textEdit?c=e.textEdit.range:e.range&&(c=e.range),ve.isRange(c)?a.j=$.from(c):c&&(!i?.isEqual(c.inserting)||!n?.isEqual(c.replacing))&&(a.j={insert:$.from(c.inserting),replace:$.from(c.replacing)}),a}}class bc{async provideInlineCompletions(e,t,i,n){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,i){}handlePartialAccept(e,t,i){}}class iI extends bc{constructor(e,t,i,n){super(),this._extension=e,this._documents=t,this._provider=i,this._commands=n,this._references=new Yb,this._isAdditionsProposedApiEnabled=Ct(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[yl.Automatic]:Ra.Automatic,[yl.Explicit]:Ra.Invoke}}get supportsHandleEvents(){return Ct(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function")}async provideInlineCompletions(e,t,i,n){const s=this._documents.getDocument(e),o=He.to(t),a=await this._provider.provideInlineCompletionItems(s,o,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:$.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind]},n);if(!a||n.isCancellationRequested)return;const c=Array.isArray(a)?a:a.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let h;return{pid:this._references.createReferenceId({dispose(){h?.dispose()},items:c}),items:c.map((d,_)=>{let w;d.command&&(h||(h=new Pe),w=this._commands.toInternal(d.command,h));const x=d.insertText;return{insertText:typeof x=="string"?x:{snippet:x.value},filterText:d.filterText,range:d.range?$.from(d.range):void 0,command:w,idx:_,completeBracketPairs:this._isAdditionsProposedApiEnabled?d.completeBracketPairs:!1}}),commands:l.map(d=>(h||(h=new Pe),this._commands.toInternal(d,h))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){this._references.disposeReferenceId(e)?.dispose()}handleDidShowCompletionItem(e,t,i){const n=this._references.get(e)?.items[t];n&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(n,i)}handlePartialAccept(e,t,i){const n=this._references.get(e)?.items[t];n&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidPartiallyAcceptCompletionItem(n,i)}}class Em{async provideInlineEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideInlineEdit(n,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},i);if(!s||i.isCancellationRequested)return;let o;const a=this._references.createReferenceId({dispose(){o?.dispose()},item:s});let c;s.accepted&&(o||(o=new Pe),c=this._commands.toInternal(s.accepted,o));let l;return s.rejected&&(o||(o=new Pe),l=this._commands.toInternal(s.rejected,o)),{pid:a,text:s.text,range:$.from(s.range),accepted:c,rejected:l}}disposeEdit(e){this._references.disposeReferenceId(e)?.dispose()}constructor(e,t,i,n){this._documents=t,this._provider=i,this._commands=n,this._references=new Yb,this.languageTriggerKindToVSCodeTriggerKind={[xl.Automatic]:Wa.Automatic,[xl.Invoke]:Wa.Invoke}}}class Yb{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class km{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ti("SignatureHelp")}async provideSignatureHelp(e,t,i,n){const s=this._documents.getDocument(e),o=He.to(t),a=this.reviveContext(i),c=await this._provider.provideSignatureHelp(s,o,n,a);if(c){const l=this._cache.add([c]);return{...qa.from(c),id:l}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=qa.to(e.activeSignatureHelp),n=this._cache.get(e.activeSignatureHelp.id,0);n?(t=n,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class Ud{constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._logService=n,this._extension=s,this._cache=new Ti("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const n=this._documents.getDocument(e),s=$.to(t),o=await this._provider.provideInlayHints(n,s,i);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const a=this._cache.add(o);this._disposables.set(a,new Pe);const c={hints:[],cacheId:a};for(let l=0;l<o.length;l++)this._isValidInlayHint(o[l],s)&&c.hints.push(this._convertInlayHint(o[l],[a,l]));return this._logService.trace(`[InlayHints] ${c.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),c}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveInlayHint(i,t);if(n&&this._isValidInlayHint(n))return this._convertInlayHint(n,e)}releaseHints(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const n={label:"",cacheId:t,tooltip:De.fromStrict(e.tooltip),position:He.from(e.position),textEdits:e.textEdits&&e.textEdits.map(vt.from),kind:e.kind&&zu.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")n.label=e.label;else{const s=[];n.label=s;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:De.fromStrict(o.tooltip)};si.isLocation(o.location)&&(a.location=oi.from(o.location)),o.command&&(a.command=this._commands.toInternal(o.command,i)),s.push(a)}}return n}}class lr{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ti("DocumentLink")}async provideLinks(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentLinks(i,t);if(!(!Array.isArray(n)||n.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:n.filter(lr._validateLink).map(Yr.from)};{const s=this._cache.add(n),o={links:[],cacheId:s};for(let a=0;a<n.length;a++){if(!lr._validateLink(n[a]))continue;const c=Yr.from(n[a]);c.cacheId=[s,a],o.links.push(c)}return o}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveDocumentLink(i,t);if(!(!n||!lr._validateLink(n)))return Yr.from(n)}releaseLinks(e){this._cache.delete(e)}}class Dm{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentColors(i,t);return Array.isArray(n)?n.map(o=>({color:so.from(o.color),range:$.from(o.range)})):[]}async provideColorPresentations(e,t,i){const n=this._documents.getDocument(e),s=$.to(t.range),o=so.to(t.color),a=await this._provider.provideColorPresentations(o,{document:n,range:s},i);if(Array.isArray(a))return a.map(qu.from)}}class Zb{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideFoldingRanges(n,t,i);if(Array.isArray(s))return s.map(Gu.from)}}class ey{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const n=this._documents.getDocument(e),s=t.map(He.to),o=await this._provider.provideSelectionRanges(n,s,i);if(!Ho(o))return[];if(o.length!==s.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let c=0;c<s.length;c++){const l=[];a.push(l);let u=s[c],h=o[c];for(;;){if(!h.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(l.push(Fp.from(h)),!h.parent)break;u=h.range,h=h.parent}}return a}}class yc{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Wg(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.prepareCallHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideCallsTo(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyIncomingCalls(n,i);if(s)return s.map(o=>({from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>$.from(a))}))}async provideCallsFrom(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyOutgoingCalls(n,i);if(s)return s.map(o=>({to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>$.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=Xr.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){return this._cache.get(e)?.get(t)}}class xc{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Wg(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=He.to(t),o=await this._provider.prepareTypeHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideSupertypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySupertypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}async provideSubtypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySubtypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=Zr.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){return this._cache.get(e)?.get(t)}}class Cc{static toInternalProviderId(e,t){return e+"."+t}constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s}async provideDocumentOnDropEdits(e,t,i,n,s){const o=this._documents.getDocument(t),a=He.to(i),c=ir.toDataTransfer(n,async u=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,u)).buffer),l=await this._provider.provideDocumentDropEdits(o,a,c,s);if(l)return{label:l.label??g("vs/workbench/api/common/extHostLanguageFeatures","defaultDropLabel","Drop using '{0}' extension",this._extension.displayName||this._extension.name),yieldTo:l.yieldTo?.map(u=>"mimeType"in u?u:{providerId:Cc.toInternalProviderId(u.extensionId,u.providerId)}),insertText:typeof l.insertText=="string"?l.insertText:{snippet:l.insertText.value},additionalEdit:l.additionalEdit?Vt.from(l.additionalEdit,void 0):void 0}}}class ty{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,i,n){const s=b.revive(e),o=this._documents.getDocument(s),a=i.documents.map(u=>u.map(h=>({uri:b.revive(h.uri),version:h.version,ranges:h.ranges.map(f=>$.to(f))}))),c={documents:a,selections:a[0]?.[0]?.ranges??[]},l=await this._provider.provideMappedEdits(o,t,c,n);return l?Vt.from(l):null}}class Sc{constructor(e,t){this.adapter=e,this.extension=t}}class _t{static{this._handlePool=0}constructor(e,t,i,n,s,o,a,c){this._uriTransformer=t,this._documents=i,this._commands=n,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=c,this._adapter=new Map,this._proxy=e.getProxy(j.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return to.from(e,this._uriTransformer,t)}_createDisposable(e){return new ke(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return _t._handlePool++}async _withAdapter(e,t,i,n,s,o=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return n;const c=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${i.toString().replace(/[\r\n]/g,"")}'`);const l=i(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{gr(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),yt.isCancellationToken(s)?Ax(l,s):l}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new Sc(e,t)),i}static _extLabel(e){return e.displayName||e.name}registerDocumentSymbolProvider(e,t,i,n){const s=this._addNewAdapter(new $d(this._documents,i),e),o=n&&n.label||_t._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideDocumentSymbols(e,t,i){return this._withAdapter(e,$d,n=>n.provideDocumentSymbols(b.revive(t),i),void 0,i)}registerCodeLensProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(n,new Sc(new Nd(this._documents,this._commands.converter,i,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(n,this._transformDocumentSelector(t,e),s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeCodeLenses(c=>this._proxy.$emitCodeLensEvent(s));o=ke.from(o,a)}return o}$provideCodeLenses(e,t,i){return this._withAdapter(e,Nd,n=>n.provideCodeLenses(b.revive(t),i),void 0,i)}$resolveCodeLens(e,t,i){return this._withAdapter(e,Nd,n=>n.resolveCodeLens(t,i),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,Nd,i=>Promise.resolve(i.releaseCodeLenses(t)),void 0,void 0)}registerDefinitionProvider(e,t,i){const n=this._addNewAdapter(new Mb(this._documents,i),e);return this._proxy.$registerDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDefinition(e,t,i,n){return this._withAdapter(e,Mb,s=>s.provideDefinition(b.revive(t),i,n),[],n)}registerDeclarationProvider(e,t,i){const n=this._addNewAdapter(new Hb(this._documents,i),e);return this._proxy.$registerDeclarationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDeclaration(e,t,i,n){return this._withAdapter(e,Hb,s=>s.provideDeclaration(b.revive(t),i,n),[],n)}registerImplementationProvider(e,t,i){const n=this._addNewAdapter(new Ub(this._documents,i),e);return this._proxy.$registerImplementationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideImplementation(e,t,i,n){return this._withAdapter(e,Ub,s=>s.provideImplementation(b.revive(t),i,n),[],n)}registerTypeDefinitionProvider(e,t,i){const n=this._addNewAdapter(new Bb(this._documents,i),e);return this._proxy.$registerTypeDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideTypeDefinition(e,t,i,n){return this._withAdapter(e,Bb,s=>s.provideTypeDefinition(b.revive(t),i,n),[],n)}registerHoverProvider(e,t,i,n){const s=this._addNewAdapter(new Wb(this._documents,i),e);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideHover(e,t,i,n){return this._withAdapter(e,Wb,s=>s.provideHover(b.revive(t),i,n),void 0,n)}registerEvaluatableExpressionProvider(e,t,i,n){const s=this._addNewAdapter(new Vb(this._documents,i),e);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideEvaluatableExpression(e,t,i,n){return this._withAdapter(e,Vb,s=>s.provideEvaluatableExpression(b.revive(t),i,n),void 0,n)}registerInlineValuesProvider(e,t,i,n){const s=typeof i.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new zb(this._documents,i),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(t,e),s);let a=this._createDisposable(o);if(s!==void 0){const c=i.onDidChangeInlineValues(l=>this._proxy.$emitInlineValuesEvent(s));a=ke.from(a,c)}return a}$provideInlineValues(e,t,i,n,s){return this._withAdapter(e,zb,o=>o.provideInlineValues(b.revive(t),i,n,s),void 0,s)}registerDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new qb(this._documents,i),e);return this._proxy.$registerDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}registerMultiDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new jb(this._documents,i),e);return this._proxy.$registerMultiDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentHighlights(e,t,i,n){return this._withAdapter(e,qb,s=>s.provideDocumentHighlights(b.revive(t),i,n),void 0,n)}$provideMultiDocumentHighlights(e,t,i,n,s){return this._withAdapter(e,jb,o=>o.provideMultiDocumentHighlights(b.revive(t),i,n.map(a=>b.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(e,t,i){const n=this._addNewAdapter(new Gb(this._documents,i),e);return this._proxy.$registerLinkedEditingRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideLinkedEditingRanges(e,t,i,n){return this._withAdapter(e,Gb,async s=>{const o=await s.provideLinkedEditingRanges(b.revive(t),i,n);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?_t._serializeRegExp(o.wordPattern):void 0}},void 0,n)}registerReferenceProvider(e,t,i){const n=this._addNewAdapter(new Qb(this._documents,i),e);return this._proxy.$registerReferenceSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideReferences(e,t,i,n,s){return this._withAdapter(e,Qb,o=>o.provideReferences(b.revive(t),i,n,s),void 0,s)}registerCodeActionProvider(e,t,i,n){const s=new Pe,o=this._addNewAdapter(new cr(this._documents,this._commands.converter,this._diagnostics,i,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerQuickFixSupport(o,this._transformDocumentSelector(t,e),{providedKinds:n?.providedCodeActionKinds?.map(a=>a.value),documentation:n?.documentation?.map(a=>({kind:a.kind.value,command:this._commands.converter.toInternal(a.command,s)}))},_t._extLabel(e),!!i.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(e,t,i,n,s){return this._withAdapter(e,cr,o=>o.provideCodeActions(b.revive(t),i,n,s),void 0,s)}$resolveCodeAction(e,t,i){return this._withAdapter(e,cr,n=>n.resolveCodeAction(t,i),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,cr,i=>Promise.resolve(i.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,i){const n=this._addNewAdapter(new Kb(this._documents,i),e);return this._proxy.$registerDocumentFormattingSupport(n,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(n)}$provideDocumentFormattingEdits(e,t,i,n){return this._withAdapter(e,Kb,s=>s.provideDocumentFormattingEdits(b.revive(t),i,n),void 0,n)}registerDocumentRangeFormattingEditProvider(e,t,i){const n=typeof i.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new Cm(this._documents,i),e);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,n),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(e,t,i,n,s){return this._withAdapter(e,Cm,o=>o.provideDocumentRangeFormattingEdits(b.revive(t),i,n,s),void 0,s)}$provideDocumentRangesFormattingEdits(e,t,i,n,s){return this._withAdapter(e,Cm,o=>o.provideDocumentRangesFormattingEdits(b.revive(t),i,n,s),void 0,s)}registerOnTypeFormattingEditProvider(e,t,i,n){const s=this._addNewAdapter(new Jb(this._documents,i),e);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(t,e),n,e.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(e,t,i,n,s,o){return this._withAdapter(e,Jb,a=>a.provideOnTypeFormattingEdits(b.revive(t),i,n,s,o),void 0,o)}registerWorkspaceSymbolProvider(e,t){const i=this._addNewAdapter(new Md(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(i,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(i)}$provideWorkspaceSymbols(e,t,i){return this._withAdapter(e,Md,n=>n.provideWorkspaceSymbols(t,i),{symbols:[]},i)}$resolveWorkspaceSymbol(e,t,i){return this._withAdapter(e,Md,n=>n.resolveWorkspaceSymbol(t,i),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,Md,i=>i.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,i){const n=this._addNewAdapter(new cs(this._documents,i,this._logService),e);return this._proxy.$registerRenameSupport(n,this._transformDocumentSelector(t,e),cs.supportsResolving(i)),this._createDisposable(n)}$provideRenameEdits(e,t,i,n,s){return this._withAdapter(e,cs,o=>o.provideRenameEdits(b.revive(t),i,n,s),void 0,s)}$resolveRenameLocation(e,t,i,n){return this._withAdapter(e,cs,s=>s.resolveRenameLocation(b.revive(t),i,n),void 0,n)}registerNewSymbolNamesProvider(e,t,i){const n=this._addNewAdapter(new Hd(this._documents,i,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideNewSymbolNames(e,t,i,n){return this._withAdapter(e,Hd,s=>s.provideNewSymbolNames(b.revive(t),i,n),void 0,n)}registerDocumentSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new Zt(this._documents,i),e),o=typeof i.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n,o);let a=this._createDisposable(s);if(o){const c=i.onDidChangeSemanticTokens(l=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=ke.from(a,c)}return a}$provideDocumentSemanticTokens(e,t,i,n){return this._withAdapter(e,Zt,s=>s.provideDocumentSemanticTokens(b.revive(t),i,n),null,n)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,Zt,i=>i.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new Xb(this._documents,i),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(e,t,i,n){return this._withAdapter(e,Xb,s=>s.provideDocumentRangeSemanticTokens(b.revive(t),i,n),null,n)}registerCompletionItemProvider(e,t,i,n){const s=this._addNewAdapter(new ls(this._documents,this._commands.converter,i,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(t,e),n,ls.supportsResolving(i),e.identifier),this._createDisposable(s)}$provideCompletionItems(e,t,i,n,s){return this._withAdapter(e,ls,o=>o.provideCompletionItems(b.revive(t),i,n,s),void 0,s)}$resolveCompletionItem(e,t,i){return this._withAdapter(e,ls,n=>n.resolveCompletionItem(t,i),void 0,i)}$releaseCompletionItems(e,t){this._withAdapter(e,ls,i=>i.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,i,n){const s=new iI(e,this._documents,i,this._commands.converter),o=this._addNewAdapter(s,e);return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),s.supportsHandleEvents,Qe.toKey(e.identifier.value),n?.yieldTo?.map(a=>Qe.toKey(a))||[]),this._createDisposable(o)}$provideInlineCompletions(e,t,i,n,s){return this._withAdapter(e,bc,o=>o.provideInlineCompletions(b.revive(t),i,n,s),void 0,s)}$handleInlineCompletionDidShow(e,t,i,n){this._withAdapter(e,bc,async s=>{s.handleDidShowCompletionItem(t,i,n)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,i,n){this._withAdapter(e,bc,async s=>{s.handlePartialAccept(t,i,n)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,bc,async i=>{i.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,i){const n=new Em(e,this._documents,i,this._commands.converter),s=this._addNewAdapter(n,e);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(s)}$provideInlineEdit(e,t,i,n){return this._withAdapter(e,Em,s=>s.provideInlineEdits(b.revive(t),i,n),void 0,n)}$freeInlineEdit(e,t){this._withAdapter(e,Em,async i=>{i.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,i,n){const s=Array.isArray(n)?{triggerCharacters:n,retriggerCharacters:[]}:n,o=this._addNewAdapter(new km(this._documents,i),e);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideSignatureHelp(e,t,i,n,s){return this._withAdapter(e,km,o=>o.provideSignatureHelp(b.revive(t),i,n,s),void 0,s)}$releaseSignatureHelp(e,t){this._withAdapter(e,km,i=>i.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,i){const n=typeof i.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new Ud(this._documents,this._commands.converter,i,this._logService,e),e);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(t,e),typeof i.resolveInlayHint=="function",n,_t._extLabel(e));let o=this._createDisposable(s);if(n!==void 0){const a=i.onDidChangeInlayHints(c=>this._proxy.$emitInlayHintsEvent(n));o=ke.from(o,a)}return o}$provideInlayHints(e,t,i,n){return this._withAdapter(e,Ud,s=>s.provideInlayHints(b.revive(t),i,n),void 0,n)}$resolveInlayHint(e,t,i){return this._withAdapter(e,Ud,n=>n.resolveInlayHint(t,i),void 0,i)}$releaseInlayHints(e,t){this._withAdapter(e,Ud,i=>i.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,i){const n=this._addNewAdapter(new lr(this._documents,i),e);return this._proxy.$registerDocumentLinkProvider(n,this._transformDocumentSelector(t,e),typeof i.resolveDocumentLink=="function"),this._createDisposable(n)}$provideDocumentLinks(e,t,i){return this._withAdapter(e,lr,n=>n.provideLinks(b.revive(t),i),void 0,i,t.scheme==="output")}$resolveDocumentLink(e,t,i){return this._withAdapter(e,lr,n=>n.resolveLink(t,i),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,lr,i=>i.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,i){const n=this._addNewAdapter(new Dm(this._documents,i),e);return this._proxy.$registerDocumentColorProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentColors(e,t,i){return this._withAdapter(e,Dm,n=>n.provideColors(b.revive(t),i),[],i)}$provideColorPresentations(e,t,i,n){return this._withAdapter(e,Dm,s=>s.provideColorPresentations(b.revive(t),i,n),void 0,n)}registerFoldingRangeProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(n,new Sc(new Zb(this._documents,i),e)),this._proxy.$registerFoldingRangeProvider(n,this._transformDocumentSelector(t,e),e.identifier,s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=ke.from(o,a)}return o}$provideFoldingRanges(e,t,i,n){return this._withAdapter(e,Zb,s=>s.provideFoldingRanges(b.revive(t),i,n),void 0,n)}registerSelectionRangeProvider(e,t,i){const n=this._addNewAdapter(new ey(this._documents,i,this._logService),e);return this._proxy.$registerSelectionRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideSelectionRanges(e,t,i,n){return this._withAdapter(e,ey,s=>s.provideSelectionRanges(b.revive(t),i,n),[],n)}registerCallHierarchyProvider(e,t,i){const n=this._addNewAdapter(new yc(this._documents,i),e);return this._proxy.$registerCallHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareCallHierarchy(e,t,i,n){return this._withAdapter(e,yc,s=>Promise.resolve(s.prepareSession(b.revive(t),i,n)),void 0,n)}$provideCallHierarchyIncomingCalls(e,t,i,n){return this._withAdapter(e,yc,s=>s.provideCallsTo(t,i,n),void 0,n)}$provideCallHierarchyOutgoingCalls(e,t,i,n){return this._withAdapter(e,yc,s=>s.provideCallsFrom(t,i,n),void 0,n)}$releaseCallHierarchy(e,t){this._withAdapter(e,yc,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,i){const n=this._addNewAdapter(new xc(this._documents,i),e);return this._proxy.$registerTypeHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareTypeHierarchy(e,t,i,n){return this._withAdapter(e,xc,s=>Promise.resolve(s.prepareSession(b.revive(t),i,n)),void 0,n)}$provideTypeHierarchySupertypes(e,t,i,n){return this._withAdapter(e,xc,s=>s.provideSupertypes(t,i,n),void 0,n)}$provideTypeHierarchySubtypes(e,t,i,n){return this._withAdapter(e,xc,s=>s.provideSubtypes(t,i,n),void 0,n)}$releaseTypeHierarchy(e,t){this._withAdapter(e,xc,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,i,n){const s=this._nextHandle();this._adapter.set(s,new Sc(new Cc(this._proxy,this._documents,i,s,e),e));const o=Ct(e,"dropMetadata")&&n?Cc.toInternalProviderId(e.identifier.value,n.id):void 0;return this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(t,e),o,Ct(e,"dropMetadata")?n:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(e,t,i,n,s,o){return this._withAdapter(e,Cc,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,b.revive(i),n,s,o)),void 0,void 0)}registerMappedEditsProvider(e,t,i){const n=this._addNewAdapter(new ty(this._documents,i),e);return this._proxy.$registerMappedEditsProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideMappedEdits(e,t,i,n,s){return this._withAdapter(e,ty,o=>Promise.resolve(o.provideMappedEdits(t,i,n,s)),null,s)}registerDocumentPasteEditProvider(e,t,i,n){const s=this._nextHandle();this._adapter.set(s,new Sc(new Do(this._proxy,this._documents,i,s,e),e));const o=Do.toInternalProviderId(e.identifier.value,n.id);return this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(t,e),o,{supportsCopy:!!i.prepareDocumentPaste,supportsPaste:!!i.provideDocumentPasteEdits,copyMimeTypes:n.copyMimeTypes,pasteMimeTypes:n.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(e,t,i,n,s){return this._withAdapter(e,Do,o=>o.prepareDocumentPaste(b.revive(t),i,n,s),void 0,s)}$providePasteEdits(e,t,i,n,s,o){return this._withAdapter(e,Do,a=>a.providePasteEdits(t,b.revive(i),n,s,o),void 0,o)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:_t._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:_t._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?_t._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?_t._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:_t._serializeRegExp(e.beforeText),afterText:e.afterText?_t._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?_t._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(_t._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>Vs.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(_t._serializeAutoClosingPair)}setLanguageConfiguration(e,t,i){const{wordPattern:n}=i;if(n&&Sv(n))throw new Error(`Invalid language configuration: wordPattern '${n}' is not allowed to match the empty string.`);n?this._documents.setWordDefinitionFor(t,n):this._documents.setWordDefinitionFor(t,void 0),i.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),i.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const s=this._nextHandle(),o={comments:i.comments,brackets:i.brackets,wordPattern:i.wordPattern?_t._serializeRegExp(i.wordPattern):void 0,indentationRules:i.indentationRules?_t._serializeIndentationRule(i.indentationRules):void 0,onEnterRules:i.onEnterRules?_t._serializeOnEnterRules(i.onEnterRules):void 0,__electricCharacterSupport:i.__electricCharacterSupport,__characterPairSupport:i.__characterPairSupport,autoClosingPairs:i.autoClosingPairs?_t._serializeAutoClosingPairs(i.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,t,o),this._createDisposable(s)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}}class nI{constructor(e,t,i,n){this._documents=t,this._commands=i,this._uriTransformer=n,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(j.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,n=He.from(t),s=await this._proxy.$tokensAtPosition(e.uri,n),o={type:Jn.Other,range:e.getWordRangeAtPosition(t)??new ve(t.line,t.character,t.line,t.character)};if(!s)return o;const a={range:$.to(s.range),type:Sp.to(s.type)};return!a.range.contains(t)||i!==e.version?o:a}createLanguageStatusItem(e,t,i){const n=this._handlePool++,s=this._proxy,o=this._ids,a=`${e.identifier.value}/${t}`;if(o.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);o.add(a);const c={selector:i,id:t,name:e.displayName??e.name,severity:Ms.Information,command:void 0,text:"",detail:"",busy:!1};let l;const u=new Pe,h=()=>{if(l?.dispose(),!o.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}l=Lx(()=>{u.clear(),this._proxy.$setLanguageStatus(n,{id:a,name:c.name??e.displayName??e.name,source:e.displayName??e.name,selector:to.from(c.selector,this._uriTransformer),label:c.text,detail:c.detail??"",severity:c.severity===Ms.Error?Ye.Error:c.severity===Ms.Warning?Ye.Warning:Ye.Info,command:c.command&&this._commands.toInternal(c.command,u),accessibilityInfo:c.accessibilityInformation,busy:c.busy})},0)},f={dispose(){u.dispose(),l?.dispose(),s.$removeLanguageStatus(n),o.delete(a)},get id(){return c.id},get name(){return c.name},set name(d){c.name=d,h()},get selector(){return c.selector},set selector(d){c.selector=d,h()},get text(){return c.text},set text(d){c.text=d,h()},set text2(d){N(e,"languageStatusText"),c.text=d,h()},get text2(){return N(e,"languageStatusText"),c.text},get detail(){return c.detail},set detail(d){c.detail=d,h()},get severity(){return c.severity},set severity(d){c.severity=d,h()},get accessibilityInformation(){return c.accessibilityInformation},set accessibilityInformation(d){c.accessibilityInformation=d,h()},get command(){return c.command},set command(d){c.command=d,h()},get busy(){return c.busy},set busy(d){c.busy=d,h()}};return h(),f}}function rI(r){return r&&r.title}let Im=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(j.MainThreadMessageService)}showMessage(e,t,i,n,s){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof n=="string"||rI(n)?a=[n,...s]:(o.modal=n?.modal,o.useCustom=n?.useCustom,o.detail=n?.detail,a=s),o.useCustom&&N(e,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const h=a[u];if(typeof h=="string")c.push({title:h,handle:u,isCloseAffordance:!1});else if(typeof h=="object"){const{title:f,isCloseAffordance:d}=h;c.push({title:f,isCloseAffordance:!!d,handle:u}),d&&(l?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,h):l=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,h)}return this._proxy.$showMessage(t,i,o,c).then(u=>{if(typeof u=="number")return a[u]})}};Im=F([O(1,ze)],Im);class Pm{constructor(e,t,i,n){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=n}asApiEvent(){return{range:new hn(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class Tm{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=b.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(er.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(co.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Ga.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(n){e._mime=n},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(er.to)}setOutputItems(e,t,i){const n=i.map(lo.to),s=this._outputs.find(o=>o.id===e);if(s&&(t||(s.items.length=0),s.items.push(...n),s.items.length>1&&s.items.every(o=>Lw(o.mime)))){const o=new Map,a=[];s.items.forEach(c=>{let l;o.has(c.mime)?l=o.get(c.mime):(l=[],o.set(c.mime,l),a.push(c.mime)),l.push(c.data)}),s.items.length=0,a.forEach(c=>{const l=w4(o.get(c));s.items.push({mime:c,data:l.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(co.to(e))}setMime(e){}}class Am{static{this._handlePool=0}constructor(e,t,i,n,s){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=i,this.uri=n,this.handle=Am._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===K.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(i){return i=e._validateIndex(i),e._cells[i].apiCell},getCells(i){return(i?e._getCells(i):e._cells).map(s=>s.apiCell)},save(){return e._save()}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,i){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:i});const n={notebook:this.apiNotebook,metadata:i,cellChanges:[],contentChanges:[]},s=[];for(const a of e.rawEvents)a.kind===Ei.ModelChange?this._spliceNotebookCells(a.changes,!1,n.contentChanges):a.kind===Ei.Move?this._moveCells(a.index,a.length,a.newIdx,n.contentChanges):a.kind===Ei.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Ei.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Ei.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===Ei.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===Ei.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===Ei.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===Ei.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const c=s[a],l=o.get(c.cell);if(l===void 0){const u=n.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else n.cellChanges[l]={...n.cellChanges[l],...c}}return n}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,i=e.end|0;return t<0&&(t=0),i>this._cells.length&&(i=this._cells.length),e.with({start:t,end:i})}_getCells(e){e=this._validateRange(e);const t=[];for(let i=e.start;i<e.end;i++)t.push(this._cells[i]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,i){if(this._disposed)return;const n=[],s=[],o=[];if(e.reverse().forEach(a=>{const l=a[2].map(f=>{const d=new Tm(this,this._textDocumentsAndEditors,f);return t||s.push(Tm.asModelAddData(f)),d}),u=new Pm(a[0],a[1],[],l),h=this._cells.splice(a[0],a[1],...l);for(const f of h)o.push(f.uri),u.deletedItems.push(f.apiCell);n.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),i)for(const a of n)i.push(a.asApiEvent())}_moveCells(e,t,i,n){const s=this._cells.splice(e,t);this._cells.splice(i,0,...s);const o=[new Pm(e,t,s.map(a=>a.apiCell),[]),new Pm(i,0,[],s)];for(const a of o)n.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,i,n){this._cells[e].setOutputItems(t,i,n)}_changeCellLanguage(e,t){const i=this._cells[e];i.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(i.uri,t)}_changeCellMime(e,t){const i=this._cells[e];i.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}}class Ec{static{this.apiEditorsToExtHost=new WeakMap}constructor(e,t,i,n,s,o){this.id=e,this._proxy=t,this.notebookData=i,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=s,this._visibleRanges=n,this._viewColumn=o}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(hn.isNotebookRange))throw be("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,i){e._proxy.$tryRevealRange(e.id,qi.from(t),i??Cu.Default)},get viewColumn(){return e._viewColumn}},Ec.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(qi.from))}_acceptViewColumn(e){this._viewColumn=e}}class Rm{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==te)return Lm(this.right);let e=this;for(;e.parent!==te&&e.parent.left!==e;)e=e.parent;return e.parent===te?te:e.parent}prev(){if(this.left!==te)return iy(this.left);let e=this;for(;e.parent!==te&&e.parent.right!==e;)e=e.parent;return e.parent===te?te:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const te=new Rm(null,0);te.parent=te,te.left=te,te.right=te,te.color=0;function Lm(r){for(;r.left!==te;)r=r.left;return r}function iy(r){for(;r.right!==te;)r=r.right;return r}function Om(r){return r===te?0:r.size_left+r.piece.length+Om(r.right)}function $m(r){return r===te?0:r.lf_left+r.piece.lineFeedCnt+$m(r.right)}function Nm(){te.parent=te}function kc(r,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==te&&(t.left.parent=e),t.parent=e.parent,e.parent===te?r.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Dc(r,e){const t=e.left;e.left=t.right,t.right!==te&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===te?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Bd(r,e){let t,i;if(e.left===te?(i=e,t=i.right):e.right===te?(i=e,t=i.left):(i=Lm(e.right),t=i.right),i===r.root){r.root=t,t.color=0,e.detach(),Nm(),r.root.parent=te;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,Ic(r,t)):(i.parent===e?t.parent=i:t.parent=i.parent,Ic(r,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===r.root?r.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==te&&(i.left.parent=i),i.right!==te&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,Ic(r,i)),e.detach(),t.parent.left===t){const o=Om(t),a=$m(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const c=o-t.parent.size_left,l=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,yn(r,t.parent,c,l)}}if(Ic(r,t.parent),n){Nm();return}let s;for(;t!==r.root&&t.color===0;)t===t.parent.left?(s=t.parent.right,s.color===1&&(s.color=0,t.parent.color=1,kc(r,t.parent),s=t.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.right.color===0&&(s.left.color=0,s.color=1,Dc(r,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=0,s.right.color=0,kc(r,t.parent),t=r.root)):(s=t.parent.left,s.color===1&&(s.color=0,t.parent.color=1,Dc(r,t.parent),s=t.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.left.color===0&&(s.right.color=0,s.color=1,kc(r,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=0,s.left.color=0,Dc(r,t.parent),t=r.root));t.color=0,Nm()}function ny(r,e){for(Ic(r,e);e!==r.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,kc(r,e)),e.parent.color=0,e.parent.parent.color=1,Dc(r,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Dc(r,e)),e.parent.color=0,e.parent.parent.color=1,kc(r,e.parent.parent))}r.root.color=0}function yn(r,e,t,i){for(;e!==r.root&&e!==te;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function Ic(r,e){let t=0,i=0;if(e!==r.root){for(;e!==r.root&&e===e.parent.right;)e=e.parent;if(e!==r.root)for(e=e.parent,t=Om(e.left)-e.size_left,i=$m(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==r.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const xn=65535;function ry(r){let e;return r[r.length-1]<65536?e=new Uint16Array(r.length):e=new Uint32Array(r.length),e.set(r,0),e}class sI{constructor(e,t,i,n,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=s}}function Cn(r,e=!0){const t=[0];let i=1;for(let n=0,s=r.length;n<s;n++){const o=r.charCodeAt(n);o===13?n+1<s&&r.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?ry(t):t}function oI(r,e){r.length=0,r[0]=0;let t=1,i=0,n=0,s=0,o=!0;for(let c=0,l=e.length;c<l;c++){const u=e.charCodeAt(c);u===13?c+1<l&&e.charCodeAt(c+1)===10?(s++,r[t++]=c+2,c++):(i++,r[t++]=c+1):u===10?(n++,r[t++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new sI(ry(r),i,n,s,o);return r.length=0,a}class jt{constructor(e,t,i,n,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=s}}class us{constructor(e,t){this.buffer=e,this.lineStarts=t}}class aI{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==te&&e.iterate(e.root,i=>(i!==te&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class cI{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const s=i[n];if(s.node.parent===null||s.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const s of i)s!==null&&n.push(s);this._cache=n}}}class lI{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new us("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=te,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=Cn(e[s].buffer));const a=new jt(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),n=this.rbInsertRight(n,a)}this._searchCache=new cI(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=xn,i=t-Math.floor(t/3),n=i*2;let s="",o=0;const a=[];if(this.iterate(this.root,c=>{const l=this.getNodeContent(c),u=l.length;if(o<=i||o+u<n)return s+=l,o+=u,!0;const h=s.replace(/\r\n|\r|\n/g,e);return a.push(new us(h,Cn(h))),s=l,o=u,!0}),o>0){const c=s.replace(/\r\n|\r|\n/g,e);a.push(new us(c,Cn(c)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new aI(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,n=>{if(n===te)return!0;const s=this.getNodeContent(n),o=s.length,a=e.nodeAt(t),c=e.nodeAt(t+o),l=e.getValueInRange2(a,c);return t+=o,s===l})}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==te;)if(n.left!==te&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const s=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=s+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==te;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new pi(i+1,a+1)}return new pi(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===te){const s=this.getOffsetAt(i+1,1),o=n-e-s;return new pi(i+1,o+1)}else t=t.right;return new pi(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,c=this._buffers[a.piece.bufferIndex].buffer,l=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return c.substring(l+e.remainder,l+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==te;){const a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(c,c+t.remainder);break}else o+=a.substr(c,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,s=>{if(s===te)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const c=this._buffers[o.bufferIndex].buffer,l=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,h=o.end.line;let f=l[u]+o.start.column;if(n&&(c.charCodeAt(f)===10&&(f++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(u===h)return!this._EOLNormalized&&c.charCodeAt(f+a-1)===13?(n=!0,i+=c.substr(f,a-1)):i+=c.substr(f,a),!0;i+=this._EOLNormalized?c.substring(f,Math.max(f,l[u+1]-this._EOLLength)):c.substring(f,l[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let d=u+1;d<h;d++)i=this._EOLNormalized?c.substring(l[d],l[d+1]-this._EOLLength):c.substring(l[d],l[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&c.charCodeAt(l[h]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=c.substr(l[h],o.end.column-1)):i=c.substr(l[h],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}findMatchesInNode(e,t,i,n,s,o,a,c,l,u,h){const f=this._buffers[e.piece.bufferIndex],d=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),_=this.offsetInBuffer(e.piece.bufferIndex,s),w=this.offsetInBuffer(e.piece.bufferIndex,o);let x;const k={line:0,column:0};let S,D;t._wordSeparators?(S=f.buffer.substring(_,w),D=U=>U+_,t.reset(0)):(S=f.buffer,D=U=>U,t.reset(_));do if(x=t.next(S),x){if(D(x.index)>=w)return u;this.positionInBuffer(e,D(x.index)-d,k);const U=this.getLineFeedCnt(e.piece.bufferIndex,s,k),R=k.line===s.line?k.column-s.column+n:k.column+1,H=R+x[0].length;if(h[u++]=G0(new Be(i+U,R,i+U,H),x,c),D(x.index)+x[0].length>=w||u>=l)return u}while(x);return u}findMatchesLineByLine(e,t,i,n){const s=[];let o=0;const a=new uk(t.wordSeparators,t.regex);let c=this.nodeAt2(e.startLineNumber,e.startColumn);if(c===null)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(l===null)return[];let u=this.positionInBuffer(c.node,c.remainder);const h=this.positionInBuffer(l.node,l.remainder);if(c.node===l.node)return this.findMatchesInNode(c.node,a,e.startLineNumber,e.startColumn,u,h,t,i,n,o,s),s;let f=e.startLineNumber,d=c.node;for(;d!==l.node;){const w=this.getLineFeedCnt(d.piece.bufferIndex,u,d.piece.end);if(w>=1){const k=this._buffers[d.piece.bufferIndex].lineStarts,S=this.offsetInBuffer(d.piece.bufferIndex,d.piece.start),D=k[u.line+w],U=f===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(d,a,f,U,u,this.positionInBuffer(d,D-S),t,i,n,o,s),o>=n)return s;f+=w}const x=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const k=this.getLineContent(f).substring(x,e.endColumn-1);return o=this._findMatchesInLine(t,a,k,e.endLineNumber,x,o,s,i,n),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(f).substr(x),f,x,o,s,i,n),o>=n)return s;f++,c=this.nodeAt2(f,1),d=c.node,u=this.positionInBuffer(c.node,c.remainder)}if(f===e.endLineNumber){const w=f===e.startLineNumber?e.startColumn-1:0,x=this.getLineContent(f).substring(w,e.endColumn-1);return o=this._findMatchesInLine(t,a,x,e.endLineNumber,w,o,s,i,n),s}const _=f===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(l.node,a,f,_,u,h,t,i,n,o,s),s}_findMatchesInLine(e,t,i,n,s,o,a,c,l){const u=e.wordSeparators;if(!c&&e.simpleSearch){const f=e.simpleSearch,d=f.length,_=i.length;let w=-d;for(;(w=i.indexOf(f,w+d))!==-1;)if((!u||Q0(u,i,_,w,d))&&(a[o++]=new kg(new Be(n,w+1+s,n,w+1+d+s),null),o>=l))return o;return o}let h;t.reset(0);do if(h=t.next(i),h&&(a[o++]=G0(new Be(n,h.index+1+s,n,h.index+1+h[0].length+s),h,c),o>=l))return o;while(h);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==te){const{node:n,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,c=a.bufferIndex,l=this.positionInBuffer(n,s);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<xn){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const u=[];let h=new jt(a.bufferIndex,l,a.end,this.getLineFeedCnt(a.bufferIndex,l,a.end),this.offsetInBuffer(c,a.end)-this.offsetInBuffer(c,l));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,s)===10){const w={line:h.start.line+1,column:0};h=new jt(h.bufferIndex,w,h.end,this.getLineFeedCnt(h.bufferIndex,w,h.end),h.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,s-1)===13){const w=this.positionInBuffer(n,s-1);this.deleteNodeTail(n,w),t="\r"+t,n.piece.length===0&&u.push(n)}else this.deleteNodeTail(n,l);else this.deleteNodeTail(n,l);const f=this.createNewPieces(t);h.length>0&&this.rbInsertRight(n,h);let d=n;for(let _=0;_<f.length;_++)d=this.rbInsertRight(d,f[_]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let s=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)s=this.rbInsertRight(s,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===te)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),s=i.node,o=n.node;if(s===o){const f=this.positionInBuffer(s,i.remainder),d=this.positionInBuffer(s,n.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const _=s.next();Bd(this,s),this.validateCRLFWithPrevNode(_),this.computeBufferMetadata();return}this.deleteNodeHead(s,d),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,f),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,f,d),this.computeBufferMetadata();return}const a=[],c=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,c),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const l=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,l),o.piece.length===0&&a.push(o);const u=s.next();for(let f=u;f!==te&&f!==o;f=f.next())a.push(f);const h=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(h),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},c=new jt(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=c,e+=`
`,yn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let s=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)s=this.rbInsertLeft(s,n[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let s=n;for(let o=1;o<i.length;o++)s=this.rbInsertRight(s,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,c=o[n.start.line]+n.start.column+t;let l=n.start.line,u=n.end.line,h=0,f=0,d=0;for(;l<=u&&(h=l+(u-l)/2|0,d=o[h],h!==u);)if(f=o[h+1],c<d)u=h-1;else if(c>=f)l=h+1;else break;return i?(i.line=h,i.column=c-d,null):{line:h,column:c-d}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const s=n[i.line+1],o=n[i.line]+i.column;if(s>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Bd(this,e[t])}createNewPieces(e){if(e.length>xn){const u=[];for(;e.length>xn;){const f=e.charCodeAt(xn-1);let d;f===13||f>=55296&&f<=56319?(d=e.substring(0,xn-1),e=e.substring(xn-1)):(d=e.substring(0,xn),e=e.substring(xn));const _=Cn(d);u.push(new jt(this._buffers.length,{line:0,column:0},{line:_.length-1,column:d.length-_[_.length-1]},_.length-1,d.length)),this._buffers.push(new us(d,_))}const h=Cn(e);return u.push(new jt(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length)),this._buffers.push(new us(e,h)),u}let t=this._buffers[0].buffer.length;const i=Cn(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],c={line:o,column:a},l=new jt(0,n,c,this.getLineFeedCnt(0,n,c),s-t);return this._lastChangeBufferPos=c,[l]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,n="";const s=this._searchCache.get2(e);if(s){i=s.node;const o=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(c+o,c+i.piece.length);else{const l=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(c+o,c+l-t)}}else{let o=0;const a=e;for(;i!==te;)if(i.left!==te&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(h+c,h+l-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=l.substring(u+c,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==te;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(c,c+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==te;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),s=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[s]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),c=this.getLineFeedCnt(i.bufferIndex,i.start,o),l=c-n,u=a-s,h=i.length+u;e.piece=new jt(i.bufferIndex,i.start,o,c,h),yn(this,e,u,l)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),c=this.offsetInBuffer(i.bufferIndex,o),l=a-n,u=s-c,h=i.length+u;e.piece=new jt(i.bufferIndex,o,i.end,a,h),yn(this,e,u,l)}shrinkNode(e,t,i){const n=e.piece,s=n.start,o=n.end,a=n.length,c=n.lineFeedCnt,l=t,u=this.getLineFeedCnt(n.bufferIndex,n.start,l),h=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,s);e.piece=new jt(n.bufferIndex,n.start,l,u,h),yn(this,e,h-a,u-c);const f=new jt(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),d=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(d)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=Cn(t,!1);for(let d=0;d<s.length;d++)s[d]+=n;if(i){const d=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-d}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],c={line:o,column:a},l=e.piece.length+t.length,u=e.piece.lineFeedCnt,h=this.getLineFeedCnt(0,e.piece.start,c),f=h-u;e.piece=new jt(e.piece.bufferIndex,e.piece.start,c,h,l),this._lastChangeBufferPos=c,yn(this,e,t.length,f)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==te;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==te;)if(i.left!==te&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(s+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:n};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==te;){if(i.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(i.piece.length>=t-1){const s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===te||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,s=i[n]+t.start.column;return n===i.length-1||i[n+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===te||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new jt(e.piece.bufferIndex,e.piece.start,s,a,o),yn(this,e,-1,-1),e.piece.length===0&&i.push(e);const c={line:t.piece.start.line+1,column:0},l=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,c,t.piece.end);t.piece=new jt(t.piece.bufferIndex,c,t.piece.end,u,l),yn(this,t,-1,-1),t.piece.length===0&&i.push(t);const h=this.createNewPieces(`\r
`);this.rbInsertRight(e,h[0]);for(let f=0;f<i.length;f++)Bd(this,i[f])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Bd(this,i);else{const n=i.piece,s={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,s,n.end);i.piece=new jt(n.bufferIndex,s,n.end,a,o),yn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===te)return t(te);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===te)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),s=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new Rm(t,1);if(i.left=te,i.right=te,i.parent=te,i.size_left=0,i.lf_left=0,this.root===te)this.root=i,i.color=0;else if(e.right===te)e.right=i,i.parent=e;else{const s=Lm(e.right);s.left=i,i.parent=s}return ny(this,i),i}rbInsertLeft(e,t){const i=new Rm(t,1);if(i.left=te,i.right=te,i.parent=te,i.size_left=0,i.lf_left=0,this.root===te)this.root=i,i.color=0;else if(e.left===te)e.left=i,i.parent=e;else{const n=iy(e.left);n.right=i,i.parent=n}return ny(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}}function Fm(r){let e=0,t=0,i=0,n=0;for(let s=0,o=r.length;s<o;s++){const a=r.charCodeAt(s);a===13?(e===0&&(t=s),e++,s+1<o&&r.charCodeAt(s+1)===10?(n|=2,s++):n|=3,i=s+1):a===10&&(n|=1,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=r.length),[e,t,r.length-i,n]}let Mm;function uI(){return Mm||(Mm=new TextDecoder("UTF-16LE")),Mm}function dI(r,e,t){const i=new Uint16Array(r.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?hI(r,e,t):uI().decode(i)}function hI(r,e,t){const i=[];let n=0;for(let s=0;s<t;s++){const o=Jy(r,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}function Wd(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Ai{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Wd(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Wd(this.oldText)}")`:`(replace@${this.oldPosition} "${Wd(this.oldText)}" with "${Wd(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;zc(e,n,i),i+=4;for(let s=0;s<n;s++)Xy(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=Vc(e,t);return t+=4,dI(e,t,i)}writeSize(){return 8+Ai._writeStringSize(this.oldText)+Ai._writeStringSize(this.newText)}write(e,t){return zc(e,this.oldPosition,t),t+=4,zc(e,this.newPosition,t),t+=4,t=Ai._writeString(e,this.oldText,t),t=Ai._writeString(e,this.newText,t),t}static read(e,t,i){const n=Vc(e,t);t+=4;const s=Vc(e,t);t+=4;const o=Ai._readString(e,t);t+=Ai._writeStringSize(o);const a=Ai._readString(e,t);return t+=Ai._writeStringSize(a),i.push(new Ai(n,o,s,a)),t}}class Io extends Me{constructor(e,t,i,n,s,o,a){super(),this._onDidChangeContent=this._register(new P),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new lI(e,i,a)}equals(e){return!(e instanceof Io)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),s=this.getPositionAt(i);return new Be(n.lineNumber,n.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=e.endLineNumber-e.startLineNumber;s=c*l}return n-i+s}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,s=e.endLineNumber;for(let o=n;o<=s;o++){const a=this.getLineContent(o),c=o===n?e.startColumn-1:0,l=o===s?e.endColumn-1:a.length;for(let u=c;u<l;u++)Rh(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=Ph(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=J2(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,c=[];for(let w=0;w<e.length;w++){const x=e[w];a&&x._isTracked&&(a=!1);const k=x.range;if(x.text){let H=!0;o||(H=!rx(x.text),o=H),!n&&H&&(n=Rv(x.text)),!s&&H&&(s=Lv(x.text))}let S="",D=0,U=0,R=0;if(x.text){let H;[D,U,R,H]=Fm(x.text);const le=this.getEOL();H===0||H===(le===`\r
`?2:1)?S=x.text:S=x.text.replace(/\r\n|\r|\n/g,le)}c[w]={sortIndex:w,identifier:x.identifier||null,range:k,rangeOffset:this.getOffsetAt(k.startLineNumber,k.startColumn),rangeLength:this.getValueLengthInRange(k),text:S,eolCount:D,firstLineLength:U,lastLineLength:R,forceMoveMarkers:!!x.forceMoveMarkers,isAutoWhitespaceEdit:x.isAutoWhitespaceEdit||!1}}c.sort(Io._sortOpsAscending);let l=!1;for(let w=0,x=c.length-1;w<x;w++){const k=c[w].range.getEndPosition(),S=c[w+1].range.getStartPosition();if(S.isBeforeOrEqual(k)){if(S.isBefore(k))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this._reduceOperations(c));const u=i||t?Io._getInverseEditRanges(c):[],h=[];if(t)for(let w=0;w<c.length;w++){const x=c[w],k=u[w];if(x.isAutoWhitespaceEdit&&x.range.isEmpty())for(let S=k.startLineNumber;S<=k.endLineNumber;S++){let D="";S===k.startLineNumber&&(D=this.getLineContent(x.range.startLineNumber),Ph(D)!==-1)||h.push({lineNumber:S,oldContent:D})}}let f=null;if(i){let w=0;f=[];for(let x=0;x<c.length;x++){const k=c[x],S=u[x],D=this.getValueInRange(k.range),U=k.rangeOffset+w;w+=k.text.length-D.length,f[x]={sortIndex:k.sortIndex,identifier:k.identifier,range:S,text:D,textChange:new Ai(k.rangeOffset,D,U,k.text)}}l||f.sort((x,k)=>x.sortIndex-k.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const d=this._doApplyEdits(c);let _=null;if(t&&h.length>0){h.sort((w,x)=>x.lineNumber-w.lineNumber),_=[];for(let w=0,x=h.length;w<x;w++){const k=h[w].lineNumber;if(w>0&&h[w-1].lineNumber===k)continue;const S=h[w].oldContent,D=this.getLineContent(k);D.length===0||D===S||Ph(D)!==-1||_.push(k)}}return this._onDidChangeContent.fire(),new ak(f,d,_)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,s=new Be(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const c=[];for(let d=0,_=e.length;d<_;d++){const w=e[d],x=w.range;t=t||w.forceMoveMarkers,c.push(this.getValueInRange(new Be(o,a,x.startLineNumber,x.startColumn))),w.text.length>0&&c.push(w.text),o=x.endLineNumber,a=x.endColumn}const l=c.join(""),[u,h,f]=Fm(l);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:l,eolCount:u,firstLineLength:h,lastLineLength:f,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(Io._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],s=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,c=n.range.endColumn;if(s===a&&o===c&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const l=new Be(s,o,a,c);t.push({range:l,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const i=e.startLineNumber,n=e.startColumn,[s,o,a]=Fm(t);let c;if(t.length>0){const l=s+1;l===1?c=new Be(i,n,i,n+o):c=new Be(i,n,i+l-1,a+1)}else c=new Be(i,n,i,n);return c}static _getInverseEditRanges(e){const t=[];let i=0,n=0,s=null;for(let o=0,a=e.length;o<a;o++){const c=e[o];let l,u;s?s.range.endLineNumber===c.range.startLineNumber?(l=i,u=n+(c.range.startColumn-s.range.endColumn)):(l=i+(c.range.startLineNumber-s.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let h;if(c.text.length>0){const f=c.eolCount+1;f===1?h=new Be(l,u,l,u+c.firstLineLength):h=new Be(l,u,l+f-1,c.lastLineLength+1)}else h=new Be(l,u,l,u);i=h.endLineNumber,n=h.endColumn,t.push(h),s=c}return t}static _sortOpsAscending(e,t){const i=Be.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=Be.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class fI{constructor(e,t,i,n,s,o,a,c,l){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=c,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=i.length;s<o;s++){const a=i[s].buffer.replace(/\r\n|\r|\n/g,t),c=Cn(a);i[s]=new us(a,c)}const n=new Io(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class sy{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&ax(e)&&(this.BOM=ox,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=oI(this._tmpLineStarts,e);this.chunks.push(new us(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Rv(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Lv(e)))}finish(e=!0){return this._finish(),new fI(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=Cn(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class pI extends Me{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new Be(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new sy;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:n}=t.create(1);this._inputTextBuffer=i,this._register(n)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new sy;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:n,disposable:s}=i.create(1);return this._register(s),n})),this._outputTextBuffers}findInInputs(e){const i=new q0(e,!1,!1,null).parseSearchRequest();if(!i)return[];const n=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(n,i,!0,5e3)}findInOutputs(e){const i=new q0(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(n=>{const s=n.findMatchesLineByLine(this._getFullModelRange(n),i,!0,5e3);if(s.length!==0)return{textBuffer:n,matches:s}}).filter(n=>!!n):[]}}function oy(r,e){let t=-1;const i=[];let n=[];return r.forEach(o=>{o.range.startLineNumber!==t&&n.length>0&&(i.push([...n]),n=[]),n.push(o),t=o.range.endLineNumber}),n.length>0&&i.push([...n]),i.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(e.getLineContent(u));return new cE(a.join(`
`)+`
`,o.map(u=>new Be(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}Object.freeze({id:"application",order:100,title:g("vs/workbench/common/configuration","applicationConfigurationTitle","Application"),type:"object"});const gI=Object.freeze({id:"workbench",order:7,title:g("vs/workbench/common/configuration","workbenchConfigurationTitle","Workbench"),type:"object"}),mI=Object.freeze({id:"security",scope:1,title:g("vs/workbench/common/configuration","securityConfigurationTitle","Security"),type:"object",order:7});Object.freeze({id:"problems",title:g("vs/workbench/common/configuration","problemsConfigurationTitle","Problems"),type:"object",order:101});const vI={ConfigurationMigration:"base.contributions.configuration.migration"};class _I{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new P,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const Vd=new _I;ri.add(vI.ConfigurationMigration,Vd);let ay=class extends Me{static{this.ID="workbench.contrib.configurationMigration"}constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(const n of i.added)await this.migrateConfigurationsForFolder(n,Vd.migrations)})),this.migrateConfigurations(Vd.migrations),this._register(Vd.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(i=>this.migrateConfigurationsForFolderAndOverride(i,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){const i=this.configurationService.inspect(e.key,{resource:t}),n=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[s,o]of n){const a=i[s];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.runMigration(e,s,a.value,t,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const h=await this.runMigration(e,s,u,t,l);for(const f of h??[])c.push([f,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],h])=>this.configurationService.updateValue(l,u.value,{resource:t,overrideIdentifiers:h},o)))}}async runMigration(e,t,i,n,s){const o=c=>{const u=this.configurationService.inspect(c,{resource:n})[t];if(u)return s?u.overrides?.find(({identifiers:h})=>Si(h,s))?.value:u.value},a=await e.migrateFn(i,o);return Array.isArray(a)?a:[[e.key,a]]}};ay=F([O(0,ng),O(1,Xh)],ay);let cy=class extends Me{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(e){super(),this.remoteAgentService=e,this._ready=new Ss,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!Gt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;ri.as(ud.Configuration).registerConfiguration({...mI,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:g("vs/workbench/common/configuration","security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:g("vs/workbench/common/configuration","security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:g("vs/workbench/common/configuration","security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};cy=F([O(0,J0)],cy),ee("editorResolverService");const wI=ri.as(ud.Configuration),bI={...gI,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:g("vs/workbench/services/editor/common/editorResolverService","editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};wI.registerConfiguration(bI);var ly;(function(r){r.builtin="builtin",r.option="option",r.exclusive="exclusive",r.default="default"})(ly||(ly={}));function yI(r,e){if(new Set([K.extension,K.webviewPanel,K.vscodeWorkspaceTrust,K.vscodeSettings]).has(e.scheme))return!1;const n=typeof r=="string"&&r.indexOf($e.sep)>=0?`${e.scheme}:${e.path}`:Dr(e);return ga(typeof r=="string"?r.toLowerCase():r,n.toLowerCase())}class Po{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,i,n,s,o){this._textDocumentsAndEditors=i,this._textDocuments=n,this._extHostFileSystem=s,this._extHostSearch=o,this._notebookStatusBarItemProviders=new Map,this._documents=new it,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new P,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new P,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new P,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new P,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Ti("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(j.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(j.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(j.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:a=>{if(a&&a.$mid===13){const c=a.notebookEditor?.notebookUri,l=a.cell.handle,h=this._documents.get(c)?.getCell(l);if(h)return h.apiCell}if(a&&a.$mid===14){const c=a.uri,l=this._documents.get(c);if(l)return l.apiNotebook}return a}}),Po._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,i]of this._editors)if(i.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const i=this._documents.get(e);if(!i&&!t)throw new Error(`NO notebook document for '${e}'`);return i}static _convertNotebookRegistrationData(e,t){if(!t)return;const i=t.filenamePattern.map(n=>Ju.from(n)).filter(n=>n!==void 0);if(t.filenamePattern&&!i){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:i,exclusive:t.exclusive||!1}}registerNotebookCellStatusBarItemProvider(e,t,i){const n=Po._notebookStatusBarItemProviderHandlePool++,s=typeof i.onDidChangeCellStatusBarItems=="function"?Po._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(n,i),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(n,s,t);let o;return s!==void 0&&(o=i.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new ke(()=>{this._notebookStatusBarItemProviders.delete(n),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(n,s),o?.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&Zn.from(e.content)});return b.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const i=await this._notebookDocumentsProxy.$tryOpenNotebook(e),n=this._documents.get(b.revive(i));return xs(n?.apiNotebook)}async showNotebookDocument(e,t){b.isUri(e)&&(e=await this.openNotebookDocument(e));let i;typeof t=="object"?i={position:pt.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(qi.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0}:i={preserveFocus:!1};const n=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,i),s=n&&this._editors.get(n)?.apiEditor;if(s)return s;throw n?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,i,n){const s=this._notebookStatusBarItemProviders.get(e),o=b.revive(t),a=this._documents.get(o);if(!a||!s)return;const c=a.getCellFromIndex(i);if(!c)return;const l=await s.provideCellStatusBarItems(c.apiCell,n);if(!l)return;const u=new Pe,h=this._statusBarCache.add([u]),d=(Array.isArray(l)?l:[l]).map(_=>Bp.from(_,this._commandsConverter,u));return{cacheId:h,items:d}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,i,n,s){if(nl(t))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:t,serializer:i,options:n}),this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},t,Vp.from(n),Po._convertNotebookRegistrationData(e,s)),Te(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.deserializeNotebook(t.buffer,i);return new Ni(Zn.from(s))}async $notebookToData(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.serializeNotebook(Zn.to(t.value),i);return he.wrap(s)}async $saveNotebook(e,t,i,n,s){const o=b.revive(t),a=this._notebookSerializer.get(e);if(!a)throw new Error("NO serializer found");const c=this._documents.get(o);if(!c)throw new Error("Document NOT found");if(c.versionId!==i)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new dw(g("vs/workbench/api/common/extHostNotebook","err.readonly","Unable to modify read-only file '{0}'",this._resourceForError(o)),6);await this._validateWriteFile(o,n);const l={metadata:f_(c.apiNotebook.metadata,_=>!(a.options?.transientDocumentMetadata??{})[_]),cells:[]};for(const _ of c.apiNotebook.getCells()){const w=new bu(_.kind,_.document.getText(),_.document.languageId,_.mime,a.options?.transientOutputs?[]:[..._.outputs],_.metadata,_.executionSummary);w.metadata=f_(_.metadata,x=>!(a.options?.transientCellMetadata??{})[x]),l.cells.push(w)}const u=await a.serializer.serializeNotebook(l,s);await this._extHostFileSystem.value.writeFile(o,u);const h=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),f=await this._extHostFileSystem.value.stat(o);return{name:h.basename(o),isFile:(f.type&$r.File)!==0,isDirectory:(f.type&$r.Directory)!==0,isSymbolicLink:(f.type&$r.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Ls.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Ls.Locked),etag:fw({mtime:f.mtime,size:f.size}),children:void 0}}async $searchInNotebooks(e,t,i,n,s){const o=this._notebookSerializer.get(e)?.serializer;if(!o)return{limitHit:!1,results:[]};const a=new B1;await(async(f,d,_)=>{await Promise.all(f.map(async w=>await Promise.all(w.filenamePatterns.map(x=>{const k={_reason:_._reason,folderQueries:_.folderQueries,includePattern:_.includePattern,excludePattern:_.excludePattern,maxResults:_.maxResults,type:1,filePattern:x};return this._extHostSearch.doInternalFileSearchWithCustomCallback(k,d,S=>{S.forEach(D=>{a.has(D)||n.some(R=>w.isFromSettings&&!R.isFromSettings?!1:R.filenamePatterns.some(H=>yI(H,D)))||a.add(D)})}).catch(S=>{if(S.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw S})}))))})(i,s,t);const l=new it;let u=!1;const h=Array.from(a).map(async f=>{const d=[];try{if(s.isCancellationRequested)return;if(t.maxResults&&[...l.values()].reduce((k,S)=>k+S.cellResults.length,0)>t.maxResults){u=!0;return}const _=[],w=this._documents.get(f);if(w)w.apiNotebook.getCells().forEach(S=>_.push({input:S.document.getText(),outputs:S.outputs.flatMap(D=>D.items.map(U=>U.data.toString()))}));else{const k=await this._extHostFileSystem.value.readFile(f),S=he.fromString(k.toString()),D=await o.deserializeNotebook(S.buffer,s);if(s.isCancellationRequested)return;Zn.from(D).cells.forEach(R=>_.push({input:R.source,outputs:R.outputs.flatMap(H=>H.items.map(le=>le.valueBytes.toString()))}))}if(s.isCancellationRequested)return;_.forEach((k,S)=>{const D=t.contentPattern.pattern,U=new pI(k.input,void 0,k.outputs),R=U.findInInputs(D),H=U.findInOutputs(D),le=H.flatMap(ie=>oy(ie.matches,ie.textBuffer)).map((ie,fe)=>(ie.webviewIndex=fe,ie));if(R.length>0||H.length>0){const ie={index:S,contentResults:oy(R,U.inputTextBuffer),webviewResults:le};d.push(ie)}});const x={resource:f,cellResults:d};l.set(f,x);return}catch{return}});return await Promise.all(h),{limitHit:u,results:[...l.values()]}}async _validateWriteFile(e,t){const i=await this._extHostFileSystem.value.stat(e);if(typeof t?.mtime=="number"&&typeof t.etag=="string"&&t.etag!==JS&&typeof i.mtime=="number"&&typeof i.size=="number"&&t.mtime<i.mtime&&t.etag!==fw({mtime:t.mtime,size:i.size}))throw new dw(g("vs/workbench/api/common/extHostNotebook","fileModifiedError","File Modified Since"),3,t)}_resourceForError(e){return e.scheme===K.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,i){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const n=new Ec(t,this._notebookEditorsProxy,e,i.visibleRanges.map(qi.to),i.selections.map(qi.to),typeof i.viewColumn=="number"?pt.to(i.viewColumn):void 0);this._editors.set(t,n)}$acceptDocumentAndEditorsDelta(e){if(e.value.removedDocuments)for(const t of e.value.removedDocuments){const i=b.revive(t),n=this._documents.get(i);n&&(n.dispose(),this._documents.delete(i),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:n.apiNotebook.getCells().map(s=>s.document.uri)}),this._onDidCloseNotebookDocument.fire(n.apiNotebook));for(const s of this._editors.values())s.notebookData.uri.toString()===i.toString()&&this._editors.delete(s.id)}if(e.value.addedDocuments){const t=[];for(const i of e.value.addedDocuments){const n=b.revive(i.uri);if(this._documents.has(n))throw new Error(`adding EXISTING notebook ${n} `);const s=new Am(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,n,i);t.push(...i.cells.map(o=>Tm.asModelAddData(o))),this._documents.get(n)?.dispose(),this._documents.set(n,s),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:t}),this._onDidOpenNotebookDocument.fire(s.apiNotebook)}}if(e.value.addedEditors)for(const t of e.value.addedEditors){if(this._editors.has(t.id))return;const i=b.revive(t.documentUri),n=this._documents.get(i);n&&this._createExtHostEditor(n,t.id,t)}if(e.value.removedEditors)for(const t of e.value.removedEditors){const i=this._editors.get(t);i&&(this._editors.delete(t),this._activeNotebookEditor?.id===i.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(i=>this._editors.get(i)).filter(i=>!!i);const t=new Set;this._visibleNotebookEditors.forEach(i=>t.add(i.id));for(const i of this._editors.values()){const n=t.has(i.id);i._acceptVisibility(n)}this._visibleNotebookEditors=[...this._editors.values()].map(i=>i).filter(i=>i.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}static _registerApiCommands(e){const t=M.String.with("notebookType","A notebook type"),i=new pe("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new M("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>he.wrap(s))],new ue("Notebook Data",s=>Zn.to(s.value))),n=new pe("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new M("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new Ni(Zn.from(s)))],new ue("Bytes",s=>s.buffer));e.registerApiCommand(i),e.registerApiCommand(n)}}class xI{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._onWillSaveNotebookDocumentEvent=new Vo}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillSaveNotebookDocumentEvent.event(s,void 0,n)}}async $participateInSave(e,t,i){const n=b.revive(e),s=this._notebooksAndEditors.getNotebookDocument(n);if(!s)throw new Error("Unable to resolve notebook document");const o=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:s.apiNotebook,reason:ju.to(t)},i,async(c,l)=>{const u=Date.now(),h=await await Promise.resolve(c);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier),!i.isCancellationRequested&&h&&(h instanceof Gn?o.push(h):this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(o.length===0)return!0;const a={edits:[]};for(const c of o){const{edits:l}=Vt.from(c);a.edits=a.edits.concat(l)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(a)}}class CI{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new P,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new P,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,n){const o=this._notebooksAndEditors.getNotebookDocument(b.revive(e)).acceptModelChanged(t.value,i,n);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(b.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(b.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let Hm=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new P,this._onDidChangeNotebookEditorVisibleRanges=new P,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const i=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&i._acceptVisibleRanges(t.visibleRanges.ranges.map(qi.to)),t.selections&&i._acceptSelections(t.selections.selections.map(qi.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:i.apiEditor,visibleRanges:i.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:i.apiEditor,selections:i.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(pt.to(e[t]))}};Hm=F([O(0,ze)],Hm);var To;(function(r){r[r.Output=1]="Output",r[r.OutputItems=2]="OutputItems",r[r.ExecutionState=3]="ExecutionState"})(To||(To={})),ee("INotebookExecutionService");const SI=100;ee("INotebookKernelService"),ee("INotebookKernelHistoryService");let Um=class{constructor(e,t,i,n,s){this._initData=t,this._extHostNotebook=i,this._commands=n,this._logService=s,this._activeExecutions=new it,this._activeNotebookExecutions=new it,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new P,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(j.MainThreadNotebookKernels);const o=new pe("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new M("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:l}}return c})],ue.Void),a=new pe("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[M.Uri],new ue("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({name:u.name,value:u.value,type:u.type,editable:!1}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,i,n,s,o){for(const R of this._kernelData.values())if(R.controller.id===t&&Qe.equals(e.identifier,R.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,c=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const l=()=>console.warn(`NO execute handler from notebook controller '${d.id}' of extension: '${e.identifier}'`);let u=!1;const h=new P,f=new P,d={id:zd(e.identifier,t),notebookType:i,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:n||e.identifier.value,preloads:o?o.map(Xu.from):[]};let _=s??l,w,x;this._proxy.$addKernel(a,d).catch(R=>{console.log(R),u=!0});let k=0;const S=()=>{if(u)return;const R=++k;Promise.resolve().then(()=>{R===k&&this._proxy.$updateKernel(a,d)})},D=new it,U={get id(){return t},get notebookType(){return d.notebookType},onDidChangeSelectedNotebooks:h.event,get label(){return d.label},set label(R){d.label=R??e.displayName??e.name,S()},get detail(){return d.detail??""},set detail(R){d.detail=R,S()},get description(){return d.description??""},set description(R){d.description=R,S()},get supportedLanguages(){return d.supportedLanguages},set supportedLanguages(R){d.supportedLanguages=R,S()},get supportsExecutionOrder(){return d.supportsExecutionOrder??!1},set supportsExecutionOrder(R){d.supportsExecutionOrder=R,S()},get rendererScripts(){return d.preloads?d.preloads.map(Xu.to):[]},get executeHandler(){return _},set executeHandler(R){_=R??l},get interruptHandler(){return w},set interruptHandler(R){w=R,d.supportsInterrupt=!!R,S()},set variableProvider(R){N(e,"notebookVariableProvider"),x=R,d.hasVariableProvider=!!R,R?.onDidChangeVariables(H=>c._proxy.$variablesUpdated(H.uri)),S()},get variableProvider(){return x},createNotebookCellExecution(R){if(u)throw new Error("notebook controller is DISPOSED");if(!D.has(R.notebook.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(D.keys()).map(H=>H.toString())),new Error(`notebook controller is NOT associated to notebook: ${R.notebook.uri.toString()}`);return c._createNotebookCellExecution(R,zd(e.identifier,this.id))},createNotebookExecution(R){if(N(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!D.has(R.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(D.keys()).map(H=>H.toString())),new Error(`notebook controller is NOT associated to notebook: ${R.uri.toString()}`);return c._createNotebookExecution(R,zd(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),h.dispose(),f.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(R,H){H===Su.Hidden&&N(e,"notebookControllerAffinityHidden"),c._proxy.$updateNotebookPriority(a,R.uri,H)},onDidReceiveMessage:f.event,postMessage(R,H){return N(e,"notebookMessaging"),c._proxy.$postMessage(a,H&&c._extHostNotebook.getIdByEditor(H),R)},asWebviewUri(R){return N(e,"notebookMessaging"),_c(R,c._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:U,onDidReceiveMessage:f,onDidChangeSelection:h,associatedNotebooks:D}),U}getIdByController(e){for(const[t,i]of this._kernelData)if(i.controller===e)return zd(i.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const i=this._kernelDetectionTaskHandlePool++,n=this;this._logService.trace(`NotebookControllerDetectionTask[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(i,t);const s={dispose:()=>{this._kernelDetectionTask.delete(i),n._proxy.$removeKernelDetectionTask(i)}};return this._kernelDetectionTask.set(i,s),s}registerKernelSourceActionProvider(e,t,i){const n=this._kernelSourceActionProviderHandlePool++,s=typeof i.onDidChangeNotebookKernelSourceActions=="function"?n:void 0,o=this;this._kernelSourceActionProviders.set(n,i),this._logService.trace(`NotebookKernelSourceActionProvider[${n}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(n,n,t);let a;return s!==void 0&&(a=i.onDidChangeNotebookKernelSourceActions(c=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(n),o._proxy.$removeKernelSourceActionProvider(n,n),a?.dispose()}}}async $provideKernelSourceActions(e,t){const i=this._kernelSourceActionProviders.get(e);if(i){const n=new Pe;return(await i.provideNotebookKernelSourceActions(t)??[]).map(o=>Wp.from(o,this._commands.converter,n))}return[]}$acceptNotebookAssociation(e,t,i){const n=this._kernelData.get(e);if(n){const s=this._extHostNotebook.getNotebookDocument(b.revive(t));i?n.associatedNotebooks.set(s.uri,!0):n.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,s.uri.toString(),i),n.onDidChangeSelection.fire({selected:i,notebook:s.apiNotebook})}}async $executeCells(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(b.revive(t)),o=[];for(const a of i){const c=s.getCell(a);c&&o.push(c.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,s.uri.toString(),o.length),await n.controller.executeHandler.call(n.controller,o,s.apiNotebook,n.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(b.revive(t));if(n.controller.interruptHandler)await n.controller.interruptHandler.call(n.controller,s.apiNotebook);else for(const o of i){const a=s.getCell(o);a&&this._activeExecutions.get(a.uri)?.cancel()}if(n.controller.interruptHandler){const o=this._activeNotebookExecutions.get(s.uri);i.length&&Array.isArray(o)&&o.length&&o.forEach(a=>a.dispose())}}async $provideVariables(e,t,i,n,s,o,a){const c=this._kernelData.get(e);if(!c)return;const l=this._extHostNotebook.getNotebookDocument(b.revive(i)),u=c.controller.variableProvider;if(!u)return;let h;if(n!==void 0){if(h=this.variableStore[n],!h)return}else this.variableStore={};const f=s==="named"?Fa.Named:Fa.Indexed,d=u.provideVariables(l.apiNotebook,h,f,o,a);let _=0;for await(const w of d){if(a.isCancellationRequested)return;const x={id:this.id++,name:w.variable.name,value:w.variable.value,type:w.variable.type,hasNamedChildren:w.hasNamedChildren,indexedChildrenCount:w.indexedChildrenCount,extensionId:c.extensionId.value};if(this.variableStore[x.id]=w.variable,this._proxy.$receiveVariable(t,x),_++>=SI)return}}$acceptKernelMessageFromRenderer(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getEditorById(t);n.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:i}))}$cellExecutionChanged(e,t,i){const s=this._extHostNotebook.getNotebookDocument(b.revive(e)).getCell(t);if(s){const o=i?Up.to(i):Ys.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const n=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!n)throw new Error("invalid cell");if(this._activeExecutions.has(n.uri))throw new Error(`duplicate execution for ${n.uri}`);const s=new Bm(t,n,this._proxy);this._activeExecutions.set(n.uri,s);const o=s.onDidChangeState(()=>{s.state===Ri.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(n.uri))});return s.asApiObject()}_createNotebookExecution(e,t){const i=this._extHostNotebook.getNotebookDocument(e.uri),n=e.getCells().find(a=>{const c=i.getCellFromApiCell(a);return c&&this._activeExecutions.has(c.uri)});if(n)throw new Error(`duplicate cell execution for ${n.document.uri}`);if(this._activeNotebookExecutions.has(i.uri))throw new Error(`duplicate notebook execution for ${i.uri}`);const s=new Wm(t,i,this._proxy),o=s.onDidChangeState(()=>{s.state===Sn.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(i.uri))});return this._activeNotebookExecutions.set(i.uri,[s,o]),s.asApiObject()}};Um=F([O(4,ze)],Um);var Ri;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(Ri||(Ri={}));class Bm extends Me{static{this.HANDLE=0}get state(){return this._state}constructor(e,t,i){super(),this._cell=t,this._proxy=i,this._handle=Bm.HANDLE++,this._onDidChangeState=new P,this.onDidChangeState=this._onDidChangeState.event,this._state=Ri.Init,this._tokenSource=this._register(new dt),this._collector=new EI(10,n=>this.update(n)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new Ni(t))}verifyStateForOutput(){if(this._state===Ri.Init)throw new Error("Must call start before modifying cell output");if(this._state===Ri.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const i=yu.ensureUniqueMimeTypes(t.items,!0);return i===t.items?er.from(t):er.from({items:i,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,i){const n=this.cellIndexToHandle(t),s=this.validateAndConvertOutputs(Bo(e));return this.updateSoon({editType:To.Output,cellHandle:n,append:i,outputs:s})}async updateOutputItems(e,t,i){return e=yu.ensureUniqueMimeTypes(Bo(e),!0),this.updateSoon({editType:To.OutputItems,items:e.map(lo.from),outputId:t.id,append:i})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(i){e._executionOrder=i,e.update([{editType:To.ExecutionState,executionOrder:e._executionOrder}])},start(i){if(e._state===Ri.Resolved||e._state===Ri.Started)throw new Error("Cannot call start again");e._state=Ri.Started,e._onDidChangeState.fire(),e.update({editType:To.ExecutionState,runStartTime:i})},end(i,n){if(e._state===Ri.Resolved)throw new Error("Cannot call resolve twice");e._state=Ri.Resolved,e._onDidChangeState.fire(),e._collector.flush(),e._proxy.$completeExecution(e._handle,new Ni({runEndTime:n,lastRunSuccess:i}))},clearOutput(i){return e.verifyStateForOutput(),e.updateOutputs([],i,!1)},appendOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!0)},replaceOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!1)},appendOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!0)},replaceOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!1)}})}}var Sn;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(Sn||(Sn={}));class Wm extends Me{static{this.HANDLE=0}get state(){return this._state}constructor(e,t,i){super(),this._notebook=t,this._proxy=i,this._handle=Wm.HANDLE++,this._onDidChangeState=new P,this.onDidChangeState=this._onDidChangeState.event,this._state=Sn.Init,this._tokenSource=this._register(new dt),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===Sn.Resolved||this._state===Sn.Started)throw new Error("Cannot call start again");this._state=Sn.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===Sn.Resolved)throw new Error("Cannot call resolve twice");this._state=Sn.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}}class EI{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new Ss,this.startedTimer=Date.now(),Hn(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function zd(r,e){return`${r.value}/${e}`}class kI{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(j.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const n=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(t)?.fire({editor:n.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(n=>n.id===t))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(n,s,o)=>this.getOrCreateEmitterFor(t).event(n,s,o),postMessage:(n,s)=>{Ec.apiEditorsToExtHost.has(n)&&([n,s]=[s,n]);const o=s&&Ec.apiEditorsToExtHost.get(s);return this.proxy.$postMessage(o?.id,t,n)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new P({onDidRemoveLastListener:()=>{t?.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class DI{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(j.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(N(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),Te(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,n){const s=this.handlers.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,i,n)}async $readProfile(e,t,i){const n=this.handlers.get(e);if(!n)throw new Error(`Unknown handler with id: ${e}`);return n.readProfile(Le(t)?t:b.revive(t),i)}}function uy(r){return(e,t,i)=>{let n=null,s=null;if(typeof i.value=="function"?(n="value",s=i.value):typeof i.get=="function"&&(n="get",s=i.get),!s)throw new Error("not supported");i[n]=r(s,t)}}function dy(r,e,t){return uy((i,n)=>{const s=`$debounce$${n}`,o=`$debounce$result$${n}`;return function(...a){this[o]||(this[o]=void 0),clearTimeout(this[s]),this[s]=setTimeout(()=>{i.apply(this,a),this[o]=void 0},r)}})}function II(r,e,t){return uy((i,n)=>{const s=`$throttle$timer$${n}`,o=`$throttle$result$${n}`,a=`$throttle$lastRun$${n}`,c=`$throttle$pending$${n}`;return function(...l){if(this[o]||(this[o]=t?t():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...l)),this[c])return;const u=this[a]+r;u<=Date.now()?(this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0):(this[c]=!0,this[s]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0},u-Date.now()))}})}class PI{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const n=this._handles++,{title:s,location:o,cancellable:a}=t,c={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(n,{location:Mp.from(o),title:s,source:c,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(ch),this._withProgress(n,i,!!a)}_withProgress(e,t,i){let n;i&&(n=new dt,this._mapHandleToCancellationSource.set(e,n));const s=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),n?.dispose()};let o;try{o=t(new Vm(this._proxy,e),i&&n?n.token:yt.None)}catch(a){throw s(e),a}return o.then(a=>s(e),a=>s(e)),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function TI(r,e){return r.message=e.message,typeof e.increment=="number"&&(typeof r.increment=="number"?r.increment+=e.increment:r.increment=e.increment),r}class Vm extends Ib{constructor(e,t){super(i=>this.throttledReport(i)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}Vm.__decorator=F([II(100,(r,e)=>TI(r,e),()=>Object.create(null))],Vm.prototype,"throttledReport",null);class zm{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(j.MainThreadQuickDiff)}$provideOriginalResource(e,t,i){const n=b.revive(t),s=this.providers.get(e);return s?Pt(()=>s.provideOriginalResource(n,i)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,i,n){const s=zm.handlePool++;return this.providers.set(s,t),this.proxy.$registerQuickDiffProvider(s,to.from(e,this.uriTransformer),i,n),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}}function AI(r,e,t){const i=r.getProxy(j.MainThreadQuickOpen);class n{constructor(d,_){this._sessions=new Map,this._instances=0,this._workspace=d,this._commands=_}showQuickPick(d,_,w,x=yt.None){this._onDidSelectItem=void 0;const k=Promise.resolve(_),S=++this._instances,D=i.$show(S,{title:w?.title,placeHolder:w?.placeHolder,matchOnDescription:w?.matchOnDescription,matchOnDetail:w?.matchOnDetail,ignoreFocusLost:w?.ignoreFocusOut,canPickMany:w?.canPickMany},x),U={},R=D.then(()=>U);return Promise.race([R,k]).then(H=>{if(H===U)return;const le=Ct(d,"quickPickItemTooltip");return k.then(ie=>{const fe=[];for(let we=0;we<ie.length;we++){const z=ie[we];if(typeof z=="string")fe.push({label:z,handle:we});else if(z.kind===Na.Separator)fe.push({type:"separator",label:z.label});else{z.tooltip&&!le&&console.warn(`Extension '${d.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${d.identifier.value}`);const B=z.iconPath?l(z.iconPath):void 0;fe.push({label:z.label,iconPath:B?.iconPath,iconClass:B?.iconClass,description:z.description,detail:z.detail,picked:z.picked,alwaysShow:z.alwaysShow,tooltip:le?De.fromStrict(z.tooltip):void 0,handle:we})}}return w&&typeof w.onDidSelectItem=="function"&&(this._onDidSelectItem=we=>{w.onDidSelectItem(ie[we])}),i.$setItems(S,fe),D.then(we=>{if(typeof we=="number")return ie[we];if(Array.isArray(we))return we.map(z=>ie[z])})})}).then(void 0,H=>{if(!gr(H))return i.$setError(S,H),Promise.reject(H)})}$onItemSelected(d){this._onDidSelectItem?.(d)}showInput(d,_=yt.None){return this._validateInput=d?.validateInput,i.$input(d,typeof this._validateInput=="function",_).then(void 0,w=>{if(!gr(w))return Promise.reject(w)})}async $validateInput(d){if(!this._validateInput)return;const _=await this._validateInput(d);if(!_||typeof _=="string")return _;let w;switch(_.severity){case Xs.Info:w=Ye.Info;break;case Xs.Warning:w=Ye.Warning;break;case Xs.Error:w=Ye.Error;break;default:w=_.message?Ye.Error:Ye.Ignore;break}return{content:_.message,severity:w}}async showWorkspaceFolderPick(d,_=yt.None){const w=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[d]);if(!w)return;const x=await this._workspace.getWorkspaceFolders2();if(x)return x.find(k=>k.uri.toString()===w.uri.toString())}createQuickPick(d){const _=new u(d,()=>this._sessions.delete(_._id));return this._sessions.set(_._id,_),_}createInputBox(d){const _=new h(d,()=>this._sessions.delete(_._id));return this._sessions.set(_._id,_),_}$onDidChangeValue(d,_){this._sessions.get(d)?._fireDidChangeValue(_)}$onDidAccept(d){this._sessions.get(d)?._fireDidAccept()}$onDidChangeActive(d,_){const w=this._sessions.get(d);w instanceof u&&w._fireDidChangeActive(_)}$onDidChangeSelection(d,_){const w=this._sessions.get(d);w instanceof u&&w._fireDidChangeSelection(_)}$onDidTriggerButton(d,_){this._sessions.get(d)?._fireDidTriggerButton(_)}$onDidTriggerItemButton(d,_,w){const x=this._sessions.get(d);x instanceof u&&x._fireDidTriggerItemButton(_,w)}$onDidHide(d){this._sessions.get(d)?._fireDidHide()}}class s{static{this._nextId=1}constructor(d,_){this._extensionId=d,this._onDidDispose=_,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new P,this._onDidChangeValueEmitter=new P,this._onDidTriggerButtonEmitter=new P,this._onDidHideEmitter=new P,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(d){this._title=d,this.update({title:d})}get step(){return this._steps}set step(d){this._steps=d,this.update({step:d})}get totalSteps(){return this._totalSteps}set totalSteps(d){this._totalSteps=d,this.update({totalSteps:d})}get enabled(){return this._enabled}set enabled(d){this._enabled=d,this.update({enabled:d})}get busy(){return this._busy}set busy(d){this._busy=d,this.update({busy:d})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(d){this._ignoreFocusOut=d,this.update({ignoreFocusOut:d})}get value(){return this._value}set value(d){this._value=d,this.update({value:d})}get placeholder(){return this._placeholder}set placeholder(d){this._placeholder=d,this.update({placeholder:d})}get buttons(){return this._buttons}set buttons(d){this._buttons=d.slice(),this._handlesToButtons.clear(),d.forEach((_,w)=>{const x=_===$a.Back?-1:w;this._handlesToButtons.set(x,_)}),this.update({buttons:d.map((_,w)=>({...l(_.iconPath),tooltip:_.tooltip,handle:_===$a.Back?-1:w}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(d){this._value=d,this._onDidChangeValueEmitter.fire(d)}_fireDidTriggerButton(d){const _=this._handlesToButtons.get(d);_&&this._onDidTriggerButtonEmitter.fire(_)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=wr(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),i.$dispose(this._id))}update(d){if(!this._disposed){for(const _ of Object.keys(d)){const w=d[_];this._pendingUpdate[_]=w===void 0?null:w}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){i.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}}function o(f){if(f instanceof Nt)return{id:f.id};const d=c(f),_=a(f);return{dark:typeof d=="string"?b.file(d):d,light:typeof _=="string"?b.file(_):_}}function a(f){return typeof f=="object"&&"light"in f?f.light:f}function c(f){return typeof f=="object"&&"dark"in f?f.dark:f}function l(f){const d=o(f);let _,w;return"id"in d?w=Ht.asClassName(d):_=d,{iconPath:_,iconClass:w}}class u extends s{constructor(d,_){super(d.identifier,_),this.extension=d,this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new P,this._selectedItems=[],this._onDidChangeSelectionEmitter=new P,this._onDidTriggerItemButtonEmitter=new P,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(d){this._items=d.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),d.forEach((x,k)=>{this._handlesToItems.set(k,x),this._itemsToHandles.set(x,k)});const _=Ct(this.extension,"quickPickItemTooltip"),w=[];for(let x=0;x<d.length;x++){const k=d[x];if(k.kind===Na.Separator)w.push({type:"separator",label:k.label});else{k.tooltip&&!_&&console.warn(`Extension '${this.extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this.extension.identifier.value}`);const S=k.iconPath?l(k.iconPath):void 0;w.push({handle:x,label:k.label,iconPath:S?.iconPath,iconClass:S?.iconClass,description:k.description,detail:k.detail,picked:k.picked,alwaysShow:k.alwaysShow,tooltip:_?De.fromStrict(k.tooltip):void 0,buttons:k.buttons?.map((D,U)=>({...l(D.iconPath),tooltip:D.tooltip,handle:U}))})}}this.update({items:w})}get canSelectMany(){return this._canSelectMany}set canSelectMany(d){this._canSelectMany=d,this.update({canSelectMany:d})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(d){this._matchOnDescription=d,this.update({matchOnDescription:d})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(d){this._matchOnDetail=d,this.update({matchOnDetail:d})}get sortByLabel(){return this._sortByLabel}set sortByLabel(d){this._sortByLabel=d,this.update({sortByLabel:d})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(d){this._keepScrollPosition=d,this.update({keepScrollPosition:d})}get activeItems(){return this._activeItems}set activeItems(d){this._activeItems=d.filter(_=>this._itemsToHandles.has(_)),this.update({activeItems:this._activeItems.map(_=>this._itemsToHandles.get(_))})}get selectedItems(){return this._selectedItems}set selectedItems(d){this._selectedItems=d.filter(_=>this._itemsToHandles.has(_)),this.update({selectedItems:this._selectedItems.map(_=>this._itemsToHandles.get(_))})}_fireDidChangeActive(d){const _=Mt(d.map(w=>this._handlesToItems.get(w)));this._activeItems=_,this._onDidChangeActiveEmitter.fire(_)}_fireDidChangeSelection(d){const _=Mt(d.map(w=>this._handlesToItems.get(w)));this._selectedItems=_,this._onDidChangeSelectionEmitter.fire(_)}_fireDidTriggerItemButton(d,_){const w=this._handlesToItems.get(d);if(!w||!w.buttons||!w.buttons.length)return;const x=w.buttons[_];x&&this._onDidTriggerItemButtonEmitter.fire({button:x,item:w})}}class h extends s{constructor(d,_){super(d.identifier,_),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(d){this._password=d,this.update({password:d})}get prompt(){return this._prompt}set prompt(d){this._prompt=d,this.update({prompt:d})}get valueSelection(){return this._valueSelection}set valueSelection(d){this._valueSelection=d,this.update({valueSelection:d})}get validationMessage(){return this._validationMessage}set validationMessage(d){this._validationMessage=d,d?typeof d=="string"?this.update({validationMessage:d,severity:Ye.Error}):this.update({validationMessage:d.message,severity:d.severity??Ye.Error}):this.update({validationMessage:void 0,severity:Ye.Ignore})}}return new n(e,t)}const hy=new ui(()=>{const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}});function RI(r,e,t=!1){const i=r||"",n=e||"",s=hy.value.collator.compare(i,n);return hy.value.collatorIsNumeric&&s===0&&i!==n?i<n?-1:1:s}function LI(r,e,t=!1){return t||(r=r&&r.toLowerCase(),e=e&&e.toLowerCase()),r===e?0:r<e?-1:1}function qd(r,e,t=!1){const i=r.split(bi),n=e.split(bi),s=i.length-1,o=n.length-1;let a,c;for(let l=0;;l++){if(a=s===l,c=o===l,a&&c)return RI(i[l],n[l],t);if(a)return-1;if(c)return 1;const u=LI(i[l],n[l],t);if(u!==0)return u}}var qm;function fy(r){return r instanceof b}function OI(r,e){return r.scheme===K.file&&e.scheme===K.file&&An?r.toString()===e.toString():r.toString().toLowerCase()===e.toString().toLowerCase()}function jm(r){if(r)return typeof r.iconPath=="string"?b.file(r.iconPath):b.isUri(r.iconPath)||Ht.isThemeIcon(r.iconPath)?r.iconPath:void 0}function py(r){if(r.icon){if(b.isUri(r.icon))return r.icon;if(Ht.isThemeIcon(r.icon))return r.icon;{const e=r.icon;return{light:e.light,dark:e.dark}}}else return}function Gm(r,e){if(!r.iconPath&&!e.iconPath)return 0;if(r.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof r.iconPath=="string"?r.iconPath:b.isUri(r.iconPath)?r.iconPath.fsPath:r.iconPath.id,i=typeof e.iconPath=="string"?e.iconPath:b.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return qd(t,i)}function $I(r,e){let t=0;if(r.strikeThrough!==e.strikeThrough)return r.strikeThrough?1:-1;if(r.faded!==e.faded)return r.faded?1:-1;if(r.tooltip!==e.tooltip)return(r.tooltip||"").localeCompare(e.tooltip||"");if(t=Gm(r,e),t!==0)return t;if(r.light&&e.light)t=Gm(r.light,e.light);else{if(r.light)return 1;if(e.light)return-1}if(t!==0)return t;if(r.dark&&e.dark)t=Gm(r.dark,e.dark);else{if(r.dark)return 1;if(e.dark)return-1}return t}function NI(r,e){if(r.command!==e.command)return r.command<e.command?-1:1;if(r.title!==e.title)return r.title<e.title?-1:1;if(r.tooltip!==e.tooltip){if(r.tooltip!==void 0&&e.tooltip!==void 0)return r.tooltip<e.tooltip?-1:1;if(r.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(r.arguments===e.arguments)return 0;if(r.arguments)if(e.arguments){if(r.arguments.length!==e.arguments.length)return r.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<r.arguments.length;t++){const i=r.arguments[t],n=e.arguments[t];if(i!==n&&!(fy(i)&&fy(n)&&OI(i,n)))return i<n?-1:1}return 0}function gy(r,e){let t=qd(r.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(r.command&&e.command)t=NI(r.command,e.command);else{if(r.command)return 1;if(e.command)return-1}if(t!==0)return t;if(r.decorations&&e.decorations)t=$I(r.decorations,e.decorations);else{if(r.decorations)return 1;if(e.decorations)return-1}if(r.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=qd(r.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(r.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(r.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=qd(r.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(r.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function FI(r,e){for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function MI(r,e){return r.command===e.command&&r.title===e.title&&r.tooltip===e.tooltip&&(r.arguments&&e.arguments?FI(r.arguments,e.arguments):r.arguments===e.arguments)}function HI(r,e){return Tn(r,e,MI)}class UI{#e;#t;get value(){return this._value}set value(e){e=e??"",this.#e.$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#e.$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return N(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(N(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,this.#e.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.#e.$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,this.#e.$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return N(this._extension,"scmTextDocument"),this.#t.getDocument(this._documentUri)}constructor(e,t,i,n,s){this._extension=e,this._sourceControlHandle=n,this._documentUri=s,this._value="",this._onDidChange=new P,this._placeholder="",this._enabled=!0,this._visible=!0,this.#t=t,this.#e=i}showValidationMessage(e,t){N(this._extension,"scmValidation"),this.#e.$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}class Qm{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,i,n,s,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=i,this._id=n,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new P,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new P,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=Qm._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const i=this._resourceStatesCommandsMap.get(e);return i?Pt(()=>this._commands.executeCommand(i.command,...i.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const e=[...this._resourceStates].sort(gy),i=$1(this._resourceSnapshot,e,gy).map(o=>{const a=o.toInsert.map(c=>{const l=this._resourceHandlePool++;this._resourceStatesMap.set(l,c);const u=c.resourceUri;let h;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const ie=new Pe;h=this._commands.converter.toInternal(c.command,ie),this._resourceStatesDisposablesMap.set(l,ie)}else this._resourceStatesCommandsMap.set(l,c.command);const f=Ct(this._extension,"scmMultiDiffEditor"),d=f?c.multiDiffEditorOriginalUri:void 0,_=f?c.multiFileDiffEditorModifiedUri:void 0,w=jm(c.decorations),x=c.decorations&&jm(c.decorations.light)||w,k=c.decorations&&jm(c.decorations.dark)||w,S=[x,k],D=c.decorations&&c.decorations.tooltip||"",U=c.decorations&&!!c.decorations.strikeThrough,R=c.decorations&&!!c.decorations.faded,H=c.contextValue||"";return{rawResource:[l,u,S,D,U,R,H,h,d,_],handle:l}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}}),n=i.map(({start:o,deleteCount:a,toInsert:c})=>[o,a,c.map(l=>l.rawResource)]),s=i.reverse();for(const{start:o,deleteCount:a,toInsert:c}of s){const l=c.map(h=>h.handle),u=this._handlesSnapshot.splice(o,a,...l);for(const h of u)this._resourceStatesMap.delete(h),this._resourceStatesCommandsMap.delete(h),this._resourceStatesDisposablesMap.get(h)?.dispose(),this._resourceStatesDisposablesMap.delete(h)}return this._resourceSnapshot=e,n}dispose(){this._disposed=!0,this._onDidDispose.fire()}}class ds{static{this._handlePool=0}#e;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,this.#e.$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;Ct(this._extension,"quickDiffProvider")&&(t=e?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return N(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){N(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new Pe,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup(()=>{this._historyProviderCurrentHistoryItemGroup=e?.currentHistoryItemGroup,this.#e.$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)}))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,this.#e.$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Pe,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return N(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){N(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new Pe,this._actionButton=e;const t=e!==void 0?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:e.secondaryCommands?.map(i=>i.map(n=>this._commands.converter.toInternal(n,this._actionButtonDisposables.value))),description:e.description,enabled:e.enabled}:void 0;this.#e.$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&HI(this._statusBarCommands,e))return;this._statusBarDisposables.value=new Pe,this._statusBarCommands=e;const t=(e||[]).map(i=>this._commands.converter.toInternal(i,this._statusBarDisposables.value));this.#e.$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}constructor(e,t,i,n,s,o,a){this._extension=e,this._commands=n,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new ms,this._commitTemplate=void 0,this._acceptInputDisposables=new ms,this._acceptInputCommand=void 0,this._actionButtonDisposables=new ms,this._statusBarDisposables=new ms,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new P,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=ds._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,this.#e=i;const c=b.from({scheme:K.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new UI(e,t,this.#e,this.handle,c),this.#e.$registerSourceControl(this.handle,s,o,a,c)}createResourceGroup(e,t,i){const n=Ct(this._extension,"scmMultiDiffEditor")&&i?.multiDiffEditorEnableViewChanges===!0,s=new Qm(this.#e,this._commands,this.handle,e,t,n,this._extension),o=ht.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const e=[],t=[];for(const[i,n]of this.createdResourceGroups){n.dispose();const s=i.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(i),this.eventuallyUpdateResourceStates()});ht.once(i.onDidDispose)(()=>{this.updatedResourceGroups.delete(i),s.dispose(),this._groups.delete(i.handle),this.#e.$unregisterGroup(this.handle,i.handle)}),e.push([i.handle,i.id,i.label,i.features,i.multiDiffEditorEnableViewChanges]);const o=i._takeResourceStateSnapshot();o.length>0&&t.push([i.handle,o]),this._groups.set(i.handle,i)}this.#e.$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const i=t._takeResourceStateSnapshot();i.length!==0&&e.push([t.handle,i])}),e.length>0&&this.#e.$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),this.#e.$unregisterSourceControl(this.handle)}}ds.__decorator=F([dy(100)],ds.prototype,"eventuallyAddResourceGroups",null),ds.__decorator=F([dy(100)],ds.prototype,"eventuallyUpdateResourceStates",null);let Km=class{static{qm=this}static{this._handlePool=0}get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,i,n){this._commands=t,this._extHostDocuments=i,this.logService=n,this._sourceControls=new Map,this._sourceControlsByExtension=new zn,this._onDidChangeActiveProvider=new P,this._proxy=e.getProxy(j.MainThreadSCM),this._telemetry=e.getProxy(j.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===3){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===4){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===5){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(e,t,i,n){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,i,n),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const s=qm._handlePool++,o=new ds(e,this._extHostDocuments,this._proxy,this._commands,t,i,n);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(e.identifier,a),o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),i=t&&t[t.length-1];return i&&i.inputBox}$provideOriginalResource(e,t,i){const n=b.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,n.toString());const s=this._sourceControls.get(e);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Pt(()=>s.quickDiffProvider.provideOriginalResource(n,i)).then(o=>o||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const i=this._sourceControls.get(e);return i&&i.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,i,n){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,i);const s=this._sourceControls.get(e);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(t);return o?o.$executeResourceCommand(i,n):Promise.resolve(void 0)}$validateInput(e,t,i){this.logService.trace("ExtHostSCM#$validateInput",e);const n=this._sourceControls.get(e);return!n||!n.inputBox.validateInput?Promise.resolve(void 0):Pt(()=>n.inputBox.validateInput(t,i)).then(s=>{if(!s)return Promise.resolve(void 0);const o=De.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&this._sourceControls.get(e)?.setSelectionState(!0),this._selectedSourceControlHandle!==void 0&&this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(!1),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,i,n){return await this._sourceControls.get(e)?.historyProvider?.resolveHistoryItemGroupCommonAncestor(t,i,n)??void 0}async $provideHistoryItems(e,t,i,n){return(await this._sourceControls.get(e)?.historyProvider?.provideHistoryItems(t,i,n))?.map(a=>({...a,icon:py(a)}))??void 0}async $provideHistoryItemSummary(e,t,i,n){const s=this._sourceControls.get(e)?.historyProvider;if(typeof s?.provideHistoryItemSummary!="function")return;const o=await s.provideHistoryItemSummary(t,i,n);return o?{...o,icon:py(o)}:void 0}async $provideHistoryItemChanges(e,t,i,n){return await this._sourceControls.get(e)?.historyProvider?.provideHistoryItemChanges(t,i,n)??void 0}};Km=qm=F([O(3,ze)],Km);class Jm{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(j.MainThreadShare)}async $provideShare(e,t,i){return await this.providers.get(e)?.provideShare({selection:$.to(t.selection),resourceUri:b.revive(t.resourceUri)},i)??void 0}registerShareProvider(e,t){const i=Jm.handlePool++;return this.providers.set(i,t),this.proxy.$registerShareProvider(i,to.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(i),this.providers.delete(i)}}}}class Xm{static{this.ID_POOL=1}constructor(e){this.providers=new Map,this.sessions=new Map,this.proxy=e.getProxy(j.MainThreadSpeech)}async $createSpeechToTextSession(e,t,i){const n=this.providers.get(e);if(!n)return;const s=new Pe,o=new dt;this.sessions.set(t,o);const a=s.add(n.provideSpeechToTextSession(o.token,i?{language:i}:void 0));s.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,c)})),s.add(o.token.onCancellationRequested(()=>s.dispose()))}async $cancelSpeechToTextSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}async $createKeywordRecognitionSession(e,t){const i=this.providers.get(e);if(!i)return;const n=new Pe,s=new dt;this.sessions.set(t,s);const o=n.add(i.provideKeywordRecognitionSession(s.token));n.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),n.add(s.token.onCancellationRequested(()=>n.dispose()))}async $cancelKeywordRecognitionSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,i){const n=Xm.ID_POOL++;return this.providers.set(n,i),this.proxy.$registerProvider(n,t,{extension:e,displayName:e.value}),Te(()=>{this.proxy.$unregisterProvider(n),this.providers.delete(n)})}}class Pc{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new Ta("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new Ta("statusBarItem.warningForeground")]])}#e;#t;constructor(e,t,i,n,s,o=Qn.Left,a){if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new Pe,this.#e=e,this.#t=t,s&&n){this._entryId=H4(n.identifier,s);const c=i.get(this._entryId);c&&(o=c.alignLeft?Qn.Left:Qn.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(Pc.ID_GEN++);this._extension=n,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(e){if(Nn(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!Pc.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){this._command?.fromApi!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new Pe,typeof e=="string"?this._command={fromApi:e,internal:this.#t.toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:this.#t.toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,this.#e.$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=g("vs/workbench/api/common/extHostStatusBar","extensionLabel","{0} (Extension)",this._extension.displayName||this._extension.name);let i=this._color;this._backgroundColor&&(i=Pc.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const n=De.fromStrict(this._tooltip);this.#e.$setEntry(this._entryId,e,this._extension?.identifier.value,t,this._text,n,this._command?.internal,i,this._backgroundColor,this._alignment===Qn.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._disposed=!0}}class BI{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",Qn.Left,Number.MIN_VALUE),this._item.name=g("vs/workbench/api/common/extHostStatusBar","status.extensionMessage","Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new ke(()=>{const i=this._messages.indexOf(t);i>=0&&(this._messages.splice(i,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class WI{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(j.MainThreadStatusBar),this._commands=t,this._statusMessage=new BI(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,i,n){return new Pc(this._proxy,this._commands,this._existingItems,e,t,i,n)}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let n;return typeof t=="number"?n=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new ke(()=>{i.dispose(),clearTimeout(n)})}}let Ym=class extends Me{constructor(e,t,i,n){super(),this.editors=n,this.resultsChangedEmitter=this._register(new P),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new P),this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(j.MainThreadTesting),this.observer=new KI(this.proxy),this.runTracker=new qI(this.proxy,t),i.registerArgumentProcessor({processArgument:s=>{switch(s?.$mid){case 16:{const o=s,a=o.tests[o.tests.length-1].item.extId;return this.controllers.get(me.root(a))?.collection.tree.get(a)?.actual??JE(s)}case 18:{const{extId:o,message:a}=s;return{test:this.controllers.get(me.root(o))?.collection.tree.get(o)?.actual,message:uo.to(a)}}default:return s}}}),i.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await i.executeCommand("_testing.getExplorerSelection"),o=a=>{const c=this.controllers.get(me.root(a));if(c)return me.isRoot(a)?c.controller:c.collection.tree.get(a)?.actual};return{include:s?.include.map(o).filter(ys)||[],exclude:s?.exclude.map(o).filter(ys)||[]}})}createTestController(e,t,i,n){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const s=new Pe,o=s.add(new XE(t,i,this.editors));o.root.label=i;const a=new Map,c=new Set,l=this.proxy,u={items:o.root.children,get label(){return i},set label(f){i=f,o.root.label=f,l.$updateController(t,{label:i})},get refreshHandler(){return n},set refreshHandler(f){n=f,l.$updateController(t,{canRefresh:!!f})},get id(){return t},createRunProfile:(f,d,_,w,x,k)=>{let S=qh(f);for(;a.has(S);)S++;return new vy(this.proxy,a,c,this.defaultProfilesChangedEmitter.event,t,S,f,d,_,w,x,k)},createTestItem(f,d,_){return new ns(t,f,d,_)},createTestRun:(f,d,_=!0)=>this.runTracker.createTestRun(e,t,o,f,d,_),invalidateTestResults:f=>{if(f===void 0)this.proxy.$markTestRetired(void 0);else{const d=f instanceof Array?f:[f];this.proxy.$markTestRetired(d.map(_=>me.fromExtHostTestItem(_,t).toString()))}},set resolveHandler(f){o.resolveHandler=f},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}};l.$registerTestController(t,i,!!n),s.add(Te(()=>l.$unregisterTestController(t)));const h={controller:u,collection:o,profiles:a,extension:e,activeProfiles:c};return this.controllers.set(t,h),s.add(Te(()=>this.controllers.delete(t))),s.add(o.onDidGenerateDiff(f=>l.$publishDiff(t,f.map(Rl.serialize)))),u}createTestObserver(){return this.observer.checkout()}async runTests(e,t=yt.None){const i=my(e);if(!i)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const n=this.controllers.get(i.controllerId);if(!n)throw new Error("Controller not found");await this.proxy.$runTests({isUiTriggered:!1,targets:[{testIds:e.include?.map(s=>me.fromExtHostTestItem(s,n.collection.root.id).toString())??[n.collection.root.id],profileGroup:Zm[i.kind],profileId:i.profileId,controllerId:i.controllerId}],exclude:e.exclude?.map(s=>s.id)},t)}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $provideFileCoverage(e,t,i){return await this.runTracker.getCoverageReport(e,t)?.provideFileCoverage(i)??[]}async $resolveFileCoverage(e,t,i,n){return await this.runTracker.getCoverageReport(e,t)?.resolveFileCoverage(i,n)??[]}$configureRunProfile(e,t){this.controllers.get(e)?.profiles.get(t)?.configureHandler?.()}$setDefaultRunProfiles(e){const t=new Map;for(const[i,n]of Object.entries(e)){const s=this.controllers.get(i);if(!s)continue;const o=new Map,a=n.filter(l=>!s.activeProfiles.has(l)),c=[...s.activeProfiles].filter(l=>!n.includes(l));for(const l of a)o.set(l,!0),s.activeProfiles.add(l);for(const l of c)o.set(l,!1),s.activeProfiles.delete(l);o.size&&t.set(i,o)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){await this.controllers.get(e)?.controller.refreshHandler?.(t)}$publishTestResults(e){this.results=Object.freeze(e.map(t=>Kh(zp.to(t))).concat(this.results).sort((t,i)=>i.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){const i=this.controllers.get(me.fromString(e).controllerId)?.collection;i&&(await i.expand(e,t<0?1/0:t),i.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>Rl.deserialize({asCanonicalUri:i=>i},t)))}async $runControllerTests(e,t){return Promise.all(e.map(i=>this.runControllerTestRequest(i,!1,t)))}async $startContinuousRun(e,t){const i=new dt(t),n=await Promise.all(e.map(s=>this.runControllerTestRequest(s,!0,i.token)));return!t.isCancellationRequested&&!n.some(s=>s.error)&&await new Promise(s=>t.onCancellationRequested(s)),i.dispose(!0),n}async runControllerTestRequest(e,t,i){const n=this.controllers.get(e.controllerId);if(!n)return{};const{collection:s,profiles:o,extension:a}=n,c=o.get(e.profileId);if(!c)return{};const l=e.testIds.map(d=>s.tree.get(d)).filter(ys),u=e.excludeExtIds.map(d=>n.collection.tree.get(d)).filter(ys).filter(d=>l.some(_=>_.fullId.compare(d.fullId)===2));if(!l.length)return{};const h=new ku(l.some(d=>d.actual instanceof wg)?void 0:l.map(d=>d.actual),u.map(d=>d.actual),c,t),f=HS(e)&&this.runTracker.prepareForMainThreadTestRun(h,Tc.fromInternal(e,n.collection),a,i);try{return await c.runHandler(h,i),{}}catch(d){return{error:String(d)}}finally{f&&(f.hasRunningTasks&&!i.isCancellationRequested&&await ht.toPromise(f.onEnd),f.dispose())}}$cancelExtensionTestRun(e){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}};Ym=F([O(0,Ue),O(1,ze)],Ym);const VI=1e4;class zI extends Me{get hasRunningTasks(){return this.tasks.size>0}get id(){return this.dto.id}constructor(e,t,i,n,s){super(),this.dto=e,this.proxy=t,this.extension=i,this.logService=n,this.state=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new P),this.coverageEmitter=this._register(new P),this.onDidCoverage=this.coverageEmitter.event,this.onEnd=this.endEmitter.event,this.cts=this._register(new dt(s));const o=this._register(new Xo(()=>this.forciblyEndTasks(),VI));this._register(this.cts.token.onCancellationRequested(()=>o.schedule()))}cancel(){this.state===0?(this.cts.cancel(),this.state=1):this.state===1&&this.forciblyEndTasks()}createRun(e){const t=this.dto.id,i=this.dto.controllerId,n=on(),s=this.extension,o=this.coverageEmitter;let a;const c=f=>(d,..._)=>{if(u){this.logService.warn(`Setting the state of test "${d.id}" is a no-op after the run ends.`);return}this.dto.isIncluded(d)&&(this.ensureTestIsKnown(d),f(d,..._))},l=(f,d)=>{const _=d instanceof Array?d.map(uo.from):[uo.from(d)];if(f.uri&&f.range){const w={range:$.from(f.range),uri:f.uri};for(const x of _)x.location=x.location||w}this.proxy.$appendTestMessagesInRun(t,n,me.fromExtHostTestItem(f,i).toString(),_)};let u=!1;const h={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,get coverageProvider(){return a?.provider},set coverageProvider(f){N(s,"testCoverage"),a=f&&new jI(f),o.fire({taskId:n,runId:t,coverage:a})},enqueued:c(f=>{this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,i).toString(),1)}),skipped:c(f=>{this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,i).toString(),5)}),started:c(f=>{this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,i).toString(),2)}),errored:c((f,d,_)=>{l(f,d),this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,i).toString(),6,_)}),failed:c((f,d,_)=>{l(f,d),this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,i).toString(),4,_)}),passed:c((f,d)=>{this.proxy.$updateTestStateInRun(t,n,me.fromExtHostTestItem(f,this.dto.controllerId).toString(),3,d)}),appendOutput:(f,d,_)=>{u||(_&&(this.dto.isIncluded(_)?this.ensureTestIsKnown(_):_=void 0),this.proxy.$appendOutputToRun(t,n,he.fromString(f),d&&oi.from(d),_&&me.fromExtHostTestItem(_,i).toString()))},end:()=>{u||(u=!0,this.proxy.$finishedTestRunTask(t,n),this.tasks.delete(n),this.tasks.size||this.markEnded())}};return this.tasks.set(n,{run:h}),this.proxy.$startedTestRunTask(t,{id:n,name:e,running:!0}),h}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==2&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof ns))throw new Ll(e.id);if(this.sharedTestIds.has(me.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const n=tr.from(e);if(t.unshift(n),this.sharedTestIds.has(n.extId)||(this.sharedTestIds.add(n.extId),e===i))break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class qI{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.coverageReports=[]}getCoverageReport(e,t){return this.coverageReports.find(i=>i.runId===e)?.coverage.get(t)}prepareForMainThreadTestRun(e,t,i,n){return this.getTracker(e,t,i,n)}cancelRunById(e){for(const t of this.tracked.values())if(t.id===e){t.cancel();return}}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,n,s,o){const a=this.tracked.get(n);if(a)return a.createRun(s);const c=Tc.fromPublic(t,i,n,o),l=my(n);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!n.continuous,profile:l&&{group:Zm[l.kind],id:l.profileId},exclude:n.exclude?.map(h=>me.fromExtHostTestItem(h,i.root.id).toString())??[],id:c.id,include:n.include?.map(h=>me.fromExtHostTestItem(h,i.root.id).toString())??[i.root.id],persist:o});const u=this.getTracker(n,c,e);return ht.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(c.id),u.dispose()}),u.createRun(s)}getTracker(e,t,i,n){const s=new zI(t,this.proxy,i,this.logService,n);this.tracked.set(e,s);let o;const a=s.onDidCoverage(({runId:c,taskId:l,coverage:u})=>{o||(o={runId:c,coverage:new Map},this.coverageReports.unshift(o),this.coverageReports.length>US&&this.coverageReports.pop()),o.coverage.set(l,u),this.proxy.$signalCoverageAvailable(c,l,!!u)});return ht.once(s.onEnd)(()=>{this.tracked.delete(e),a.dispose()}),s}}const my=r=>{if(r.profile){if(!(r.profile instanceof vy))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return r.profile}};class Tc{static fromPublic(e,t,i,n){return new Tc(e,on(),i.include?.map(s=>me.fromExtHostTestItem(s,e).toString())??[e],i.exclude?.map(s=>me.fromExtHostTestItem(s,e).toString())??[],n,t)}static fromInternal(e,t){return new Tc(e.controllerId,e.runId,e.testIds,e.excludeExtIds,!0,t)}constructor(e,t,i,n,s,o){this.controllerId=e,this.id=t,this.isPersisted=s,this.colllection=o,this.includePrefix=i.map(a=>a+"\0"),this.excludePrefix=n.map(a=>a+"\0")}isIncluded(e){const t=me.fromExtHostTestItem(e,this.controllerId).toString()+"\0";for(const i of this.excludePrefix)if(t===i||t.startsWith(i))return!1;for(const i of this.includePrefix)if(t===i||t.startsWith(i))return!0;return!1}}class jI{constructor(e){this.provider=e}async provideFileCoverage(e){this.fileCoverage||(this.fileCoverage=(async()=>this.provider.provideFileCoverage(e))());try{return(await this.fileCoverage)?.map(Yu.fromFile)??[]}catch(t){throw this.fileCoverage=void 0,t}}async resolveFileCoverage(e,t){const i=await this.fileCoverage;let n=i?.[e];return!this.provider||!i||!n?[]:(n.detailedCoverage||(n=i[e]=await this.provider.resolveFileCoverage?.(n,t)??n),n.detailedCoverage?.map(Yu.fromDetailed)??[])}}class GI{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,tr.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=me.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map(n=>n.revived)},get updated(){return[...t].map(n=>n.revived)},get removed(){return[...i].map(n=>n.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class QI extends BS{constructor(){super(...arguments),this.changeEmitter=new P,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:tr.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new GI(this.changeEmitter)}}class KI{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:fh(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){const e=new QI({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const Ac=(r,e,t,i)=>{t?Object.assign(t,i):e.$updateTestRunConfig(r.controllerId,r.profileId,i)};class vy{#e;#t;#i;#n;#s;get label(){return this._label}set label(e){e!==this._label&&(this._label=e,Ac(this,this.#e,this.#n,{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,Ac(this,this.#e,this.#n,{supportsContinuousRun:e}))}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#t.add(this.profileId):this.#t.delete(this.profileId),Ac(this,this.#e,this.#n,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,Ac(this,this.#e,this.#n,{tag:e?Ii.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,Ac(this,this.#e,this.#n,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return ht.chain(this.#i,e=>e.map(t=>t.get(this.controllerId)?.get(this.profileId)).filter(ys))}constructor(e,t,i,n,s,o,a,c,l,u=!1,h=void 0,f=!1){this.controllerId=s,this.profileId=o,this._label=a,this.kind=c,this.runHandler=l,this._tag=h,this._supportsContinuousRun=f,this.#e=e,this.#s=t,this.#t=i,this.#i=n,t.set(o,this);const d=Zm[c];if(typeof d!="number")throw new Error(`Unknown TestRunProfile.group ${c}`);u&&i.add(o),this.#n={profileId:o,controllerId:s,tag:h?Ii.namespace(this.controllerId,h.id):null,label:a,group:d,isDefault:u,hasConfigurationHandler:!1,supportsContinuousRun:f},queueMicrotask(()=>{this.#n&&(this.#e.$publishTestRunProfile(this.#n),this.#n=void 0)})}dispose(){this.#s?.delete(this.profileId)&&(this.#s=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#n=void 0}}const Zm={[eo.Coverage]:8,[eo.Debug]:4,[eo.Run]:2};class JI{constructor(e,t){this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new P,this._onDidChangeTextEditorOptions=new P,this._onDidChangeTextEditorVisibleRanges=new P,this._onDidChangeTextEditorViewColumn=new P,this._onDidChangeActiveTextEditor=new P,this._onDidChangeVisibleTextEditors=new P,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(j.MainThreadTextEditors),this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(i=>this._onDidChangeVisibleTextEditors.fire(i)),this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(i=>this._onDidChangeActiveTextEditor.fire(i))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let n;typeof t=="number"?n={position:pt.from(t),preserveFocus:i}:typeof t=="object"?n={position:pt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?$.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:n={preserveFocus:!1};const s=await this._proxy.$tryShowTextDocument(e.uri,n),o=s&&this._extHostDocumentsAndEditors.getEditor(s);if(o)return o.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new Vg(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const n=t.selections.selections.map(mi.to);i._acceptSelections(n)}if(t.visibleRanges){const n=Mt(t.visibleRanges.map($.to));i._acceptVisibleRanges(n)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:oo.to(t.options.lineNumbers)}}),t.selections){const n=Ws.fromValue(t.selections.source),s=t.selections.selections.map(mi.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:s,kind:n})}if(t.visibleRanges){const n=Mt(t.visibleRanges.map($.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:n})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const n=pt.to(e[t]);i.value.viewColumn!==n&&(i._acceptViewColumn(n),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:n}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let e1=class{constructor(e){this._actual=new wu(Kn.Dark),this._onDidChangeActiveColorTheme=new P}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=Kn.Light;break;case"hcDark":t=Kn.HighContrast;break;case"hcLight":t=Kn.HighContrastLight;break;default:t=Kn.Dark}this._actual=new wu(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};e1=F([O(0,Ue)],e1);class XI{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(j.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,n)=>{if(i&&i.$mid===12)if(this._providers.get(i.source)&&Qe.equals(n,this._providers.get(i.source)?.extension)){const s=i.uri===void 0?void 0:b.revive(i.uri);return this._itemsBySourceAndUriMap.get(i.source)?.get(_y(s))?.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,n){return this._providers.get(e)?.provider.provideTimeline(b.revive(t),i,n)}registerTimelineProvider(e,t,i,n){const s=new Pe,o=this.convertTimelineItem(t.id,n,s).bind(this);let a;t.onDidChange&&(a=t.onDidChange(l=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...l,id:t.id}),this));const c=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(l,u,h){u?.resetCache&&(s.clear(),c.get(t.id)?.clear());const f=await t.provideTimeline(l,u,h);if(f==null)return;const d=o(l,u);return{...f,source:t.id,items:f.items.map(d)}},dispose(){for(const l of c.values())l.get(t.id)?.clear();a?.dispose(),s.dispose()}},i)}convertTimelineItem(e,t,i){return(n,s)=>{let o;if(s?.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const c=_y(n);o=a.get(c),o===void 0&&(o=new Map,a.set(c,o))}return a=>{const{iconPath:c,...l}=a,u=`${e}|${a.id??a.timestamp}`;o?.set(u,a);let h,f,d;a.iconPath&&(c instanceof Nt?d={id:c.id,color:c.color}:b.isUri(c)?(h=c,f=c):{light:h,dark:f}=c);let _;return gi.isMarkdownString(l.tooltip)?_=De.from(l.tooltip):Le(l.tooltip)?_=l.tooltip:gi.isMarkdownString(l.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),_=De.from(l.detail)):Le(l.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),_=l.detail),{...l,id:l.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,i):void 0,icon:h,iconDark:f,themeIcon:d,tooltip:_,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),Te(()=>{for(const n of this._itemsBySourceAndUriMap.values())n.get(e.id)?.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function _y(r){return r?.toString()}const YI={IconContribution:"base.contributions.icons"};var wy;(function(r){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}r.toJSONObject=e;function t(i){const n=s=>Le(s)?s:void 0;if(i&&Array.isArray(i.src)&&i.src.every(s=>Le(s.format)&&Le(s.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(s=>({format:s.format,location:b.parse(s.location)}))}}r.fromJSONObject=t})(wy||(wy={}));class ZI{constructor(){this._onDidChange=new P,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:g("vs/platform/theme/common/iconRegistry","iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:g("vs/platform/theme/common/iconRegistry","iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Ht.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const c=this.iconReferenceSchema.enum.indexOf(e);c!==-1&&(this.iconReferenceSchema.enumDescriptions[c]=i),this._onDidChange.fire()}return s}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;Ht.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${Ht.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of n.filter(o=>!Ht.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const Rc=new ZI;ri.add(YI.IconContribution,Rc);function jd(r,e,t,i){return Rc.registerIcon(r,e,t,i)}function e7(){const r=MC();for(const e in r){const t="\\"+r[e].toString(16);Rc.registerIcon(e,{fontCharacter:t})}}e7();const by="vscode://schemas/icons",yy=ri.as(sg.JSONContribution);yy.registerSchema(by,Rc.getIconSchema());const xy=new Xo(()=>yy.notifySchemaChanged(by),200);Rc.onDidChange(()=>{xy.isScheduled()||xy.schedule()}),jd("widget-close",ne.close,g("vs/platform/theme/common/iconRegistry","widgetClose","Icon for the close action in widgets.")),jd("goto-previous-location",ne.arrowUp,g("vs/platform/theme/common/iconRegistry","previousChangeIcon","Icon for goto previous editor location.")),jd("goto-next-location",ne.arrowDown,g("vs/platform/theme/common/iconRegistry","nextChangeIcon","Icon for goto next editor location.")),Ht.modify(ne.sync,"spin"),Ht.modify(ne.loading,"spin"),g("vs/workbench/common/views","views log","Views"),jd("default-view-icon",ne.window,g("vs/workbench/common/views","defaultViewIcon","Default view icon."));var Gd;(function(r){r.ViewContainersRegistry="workbench.registry.view.containers",r.ViewsRegistry="workbench.registry.view"})(Gd||(Gd={}));var Cy;(function(r){r[r.Sidebar=0]="Sidebar",r[r.Panel=1]="Panel",r[r.AuxiliaryBar=2]="AuxiliaryBar"})(Cy||(Cy={}));class t7 extends Me{constructor(){super(...arguments),this._onDidRegister=this._register(new P),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new P),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return Uc([...this.viewContainers.values()])}registerViewContainer(e,t,i){const n=this.get(e.id);if(n)return n;const s=e;return s.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},zy(this.viewContainers,t,[]).push(s),i?.isDefault&&this.defaultViewContainers.push(s),this._onDidRegister.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const i=this.viewContainers.get(t),n=i?.indexOf(e);if(n!==-1){i?.splice(n,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}}ri.add(Gd.ViewContainersRegistry,new t7);var Qd;(function(r){r.Open="2_open",r.Debug="4_debug",r.SCM="5_scm",r.More="9_more"})(Qd||(Qd={}));function i7(r,e){const t=r.group??Qd.More,i=e.group??Qd.More;return t!==i?t.localeCompare(i):(r.order??5)-(e.order??5)}class n7 extends Me{constructor(){super(...arguments),this._onViewsRegistered=this._register(new P),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new P),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new P),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new P),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new V1}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this._views.keys())if(i!==t){const n=this.removeViews(e,i);n.length&&(this.addViews(n,t),this._onDidChangeContainer.fire({views:n,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const i=(this._views.get(t)||[]).filter(n=>n.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(n=>n.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),Te(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[n,s]of t)this._viewWelcomeContents.add(e,s),i.set(n,Te(()=>{this._viewWelcomeContents.delete(e,s),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(i7)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(const n of e){if(this.getView(n.id)!==null)throw new Error(g("vs/workbench/common/views","duplicateId","A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(e,t){const i=this._views.get(t);if(!i)return[];const n=[],s=[];for(const o of i)e.includes(o)?n.push(o):s.push(o);return n.length&&(s.length?this._views.set(t,s):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),n}}ri.add(Gd.ViewsRegistry,new n7),ee("viewDescriptorService");var Sy;(function(r){r[r.Default=0]="Default",r[r.Expand=1]="Expand"})(Sy||(Sy={}));var Ey;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(Ey||(Ey={}));class En extends Error{constructor(e){super(g("vs/workbench/common/views","treeView.notRegistered","No tree view with id '{0}' registered.",e)),this.name="NoTreeViewError"}static is(e){return e.name==="NoTreeViewError"}}class r7{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}}function ky(r,e){if(Le(r))return{label:r};if(r&&typeof r=="object"&&typeof r.label=="string"){let t;return Array.isArray(r.highlights)&&(t=r.highlights.filter(i=>i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"),t=t.length?t:void 0),{label:r.label,highlights:t}}}class s7 extends Me{constructor(e,t,i){super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new r7;function n(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>n(s)?this.convertArgument(s):Array.isArray(s)&&s.length>0?s.map(o=>n(o)?this.convertArgument(o):o):s})}registerTreeDataProvider(e,t,i){const n=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>n.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const n=t.dragAndDropController?.dropMimeTypes??[],s=t.dragAndDropController?.dragMimeTypes??[],o=!!t.dragAndDropController?.handleDrag,a=!!t.dragAndDropController?.handleDrop,c=this.createExtHostTreeView(e,t,i),l={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:n,dragMimeTypes:s,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,l),h={get onDidCollapseElement(){return c.onDidCollapseElement},get onDidExpandElement(){return c.onDidExpandElement},get selection(){return c.selectedElements},get onDidChangeSelection(){return c.onDidChangeSelection},get activeItem(){return N(i,"treeViewActiveItem"),c.focusedElement},get onDidChangeActiveItem(){return N(i,"treeViewActiveItem"),c.onDidChangeActiveItem},get visible(){return c.visible},get onDidChangeVisibility(){return c.onDidChangeVisibility},get onDidChangeCheckboxState(){return c.onDidChangeCheckboxState},get message(){return c.message},set message(f){Rr(f)&&N(i,"treeViewMarkdownMessage"),c.message=f},get title(){return c.title},set title(f){c.title=f},get description(){return c.description},set description(f){c.description=f},get badge(){return c.badge},set badge(f){f!==void 0&&zf.isViewBadge(f)?c.badge={value:Math.floor(Math.abs(f.value)),tooltip:f.tooltip}:f===void 0&&(c.badge=void 0)},reveal:(f,d)=>c.reveal(f,d),dispose:async()=>{await u,this.treeViews.delete(e),c.dispose()}};return this._register(h),h}$getChildren(e,t){const i=this.treeViews.get(e);return i?i.getChildren(t):Promise.reject(new En(e))}async $handleDrop(e,t,i,n,s,o,a,c){const l=this.treeViews.get(e);if(!l)return Promise.reject(new En(e));const u=ir.toDataTransfer(i,async h=>(await this._proxy.$resolveDropFileData(e,t,h)).buffer);return a===e&&c&&await this.addAdditionalTransferItems(u,l,c,s,o),l.onDrop(u,n,s)}async addAdditionalTransferItems(e,t,i,n,s){const o=this.treeDragAndDropService.removeDragOperationTransfer(s);if(o)(await o)?.forEach((a,c)=>{a&&e.set(c,a)});else if(s&&t.handleDrag){const a=t.handleDrag(i,e,n);this.treeDragAndDropService.addDragOperationTransfer(s,a),await a}return e}async $handleDrag(e,t,i,n){const s=this.treeViews.get(e);if(!s)return Promise.reject(new En(e));const o=await this.addAdditionalTransferItems(new Pa,s,t,n,i);if(!(!o||n.isCancellationRequested))return ir.from(o)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new En(e);return t.hasResolve}$resolve(e,t,i){const n=this.treeViews.get(e);if(!n)throw new En(e);return n.resolveTreeItem(t,i)}$setExpanded(e,t,i){const n=this.treeViews.get(e);if(!n)throw new En(e);n.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const n=this.treeViews.get(e);if(!n)throw new En(e);n.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new En(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new En(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const n=this._register(new Kd(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,n),n}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}class Kd extends Me{static{this.LABEL_HANDLE_PREFIX="0"}static{this.ID_HANDLE_PREFIX="1"}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Lt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,i,n,s,o){if(super(),this.viewId=e,this.proxy=i,this.commands=n,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new P),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new P),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new P),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new P),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new P),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new P),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new P),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new dt,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const h of o.contributes.views[u])h.id===e&&(this._title=h.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>this._onDidChangeData.fire({message:!1,element:u})));let a,c;const l=ht.debounce(this._onDidChangeData.event,(u,h)=>(u||(u={message:!1,elements:[]}),h.element!==!1&&(a||(a=new Promise(f=>c=f),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(h.element)?u.elements.push(...h.element):u.elements.push(h.element)),h.message&&(u.message=!0),u),200,!0);this._register(l(({message:u,elements:h})=>{h.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const f=c;return a=null,this.refresh(h).then(()=>f())})),u&&this.proxy.$setMessage(this.viewId,De.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let i=this.getChildrenNodes(e);return i||(i=await this.fetchChildrenNodes(t)),i?i.map(n=>n.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const i=Lt(t.select)?!0:t.select,n=Lt(t.focus)?!1:t.focus,s=Lt(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(c=>c.item)},{select:i,focus:n,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:i,focus:n,expand:s})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip||(this._badge=Zu.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const i=this.getExtensionElement(e);i&&(t?this._onDidExpandElement.fire(Object.freeze({element:i})):this._onDidCollapseElement.fire(Object.freeze({element:i})))}setSelectionAndFocus(e,t){const i=!Tn(this._selectedHandles,e);this._selectedHandles=e;const n=this._focusedHandle!==t;this._focusedHandle=t,i&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),n&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async i=>{const n=this.getExtensionElement(i.treeItemHandle);return n?{extensionItem:n,treeItem:await this.dataProvider.getTreeItem(n),newState:i.newState?zi.Checked:zi.Unchecked}:Promise.resolve(void 0)}))).filter(i=>i!==void 0);t.forEach(i=>{i.treeItem.checkboxState=i.newState?zi.Checked:zi.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(i=>[i.extensionItem,i.newState])})}async handleDrag(e,t,i){const n=[];for(const s of e){const o=this.getExtensionElement(s);o&&n.push(o)}if(!(!this.dndController?.handleDrag||n.length===0))return await this.dndController.handleDrag(n,t,i),t}get hasHandleDrag(){return!!this.dndController?.handleDrag}async onDrop(e,t,i){const n=t?this.getExtensionElement(t):void 0;if(!(!n&&t||!this.dndController?.handleDrop))return Pt(()=>this.dndController?.handleDrop?this.dndController.handleDrop(n,e,i):void 0)}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const i=this.elements.get(e);if(i){const n=this.nodes.get(i);if(n){const s=await this.dataProvider.resolveTreeItem(n.extensionItem,i,t)??n.extensionItem;return this.validateTreeItem(s),n.item.tooltip=this.getTooltip(s.tooltip),n.item.command=this.getCommand(n.disposableStore,s.command),n.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(i=>this.resolveTreeNode(t,i[i.length-1]).then(n=>(i.push(n),i))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):Pt(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const i=this.nodes.get(e);return i?Promise.resolve(i):Pt(()=>this.dataProvider.getTreeItem(e)).then(n=>this.createHandle(e,n,t,!0)).then(n=>this.getChildren(t?t.item.handle:void 0).then(()=>{const s=this.getExtensionElement(n);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${n} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const i=this.getExtensionElement(e);t=i?this.nodes.get(i):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new dt(this._refreshCancellationSource.token);try{const i=e?this.nodes.get(e):void 0,n=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const s=Mt(n||[]),o=await Promise.all(Mt(s).map(c=>this.dataProvider.getTreeItem(c)));if(t.token.isCancellationRequested)return;const a=o.map((c,l)=>c?this.createAndRegisterTreeNode(s[l],c,i):null);return Mt(a)}finally{t.dispose()}}refresh(e){if(e.some(i=>!i))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new dt,this.clearAll(),this.proxy.$refresh(this.viewId);{const i=this.getHandlesToRefresh(e);if(i.length)return this.refreshHandles(i)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,i=e.map(s=>this.nodes.get(s));for(const s of i)if(s&&!t.has(s.item.handle)){let o=s;for(;o&&o.parent&&i.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&t.add(s.item.handle)}const n=[];return t.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!t.has(a.parent.item.handle))&&n.push(s)}}),n}refreshHandles(e){const t={};return Promise.all(e.map(i=>this.refreshNode(i).then(n=>{n&&(t[i]=n.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const i=this.nodes.get(t);if(i)return this.clearChildren(t),Pt(()=>this.dataProvider.getTreeItem(t)).then(n=>{if(n){const s=this.createTreeNode(t,n,i.parent);return this.updateNodeCache(t,s,i,i.parent),i.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,i){const n=this.createTreeNode(e,t,i);if(t.id&&this.elements.has(n.item.handle))throw new Error(g("vs/workbench/api/common/extHostTreeViews","treeView.duplicateElement","Element with id {0} is already registered",t.id));return this.addNodeToCache(e,n),this.addNodeToParentCache(n,i),n}getTooltip(e){return gi.isMarkdownString(e)?De.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,i,n;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,i=e.checkboxState.tooltip,n=e.checkboxState.accessibilityInformation),{isChecked:t===zi.Checked,tooltip:i,accessibilityInformation:n}}validateTreeItem(e){if(!ru.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,i){this.validateTreeItem(t);const n=this._register(new Pe),s=this.createHandle(e,t,i),o=this.getLightIconPath(t);return{item:{handle:s,parentHandle:i?i.item.handle:void 0,label:ky(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(n,t.command),contextValue:t.contextValue,icon:o,iconDark:this.getDarkIconPath(t)||o,themeIcon:this.getThemeIcon(t),collapsibleState:Lt(t.collapsibleState)?jr.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:i,children:void 0,disposableStore:n,dispose(){n.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Nt?e.iconPath:void 0}createHandle(e,{id:t,label:i,resourceUri:n},s,o){if(t)return`${Kd.ID_HANDLE_PREFIX}/${t}`;const a=ky(i),c=s?s.item.handle:Kd.LABEL_HANDLE_PREFIX;let l=a?a.label:n?Dr(n):"";l=l.indexOf("/")!==-1?l.replace("/","//"):l;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,h=this.getChildrenNodes(s)||[];let f,d=0;do{if(f=`${c}/${d}:${l}`,o||!this.elements.has(f)||u===f)break;d++}while(d<=h.length);return f}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Nt))return typeof e.iconPath=="string"||b.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Nt)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return b.isUri(e)?e:b.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,i,n){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==i.item.handle&&this.elements.delete(i.item.handle),this.addNodeToCache(e,t);const s=this.getChildrenNodes(n)||[],o=s.filter(a=>a.item.handle===i.item.handle)[0];o&&s.splice(s.indexOf(o),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}}class t1{static{this.supportedSchemes=new Set([K.http,K.https])}constructor(e){this._openers=new Map,this._proxy=e.getProxy(j.MainThreadUriOpeners)}registerExternalUriOpener(e,t,i,n){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const s=n.schemes.find(o=>!t1.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,i),this._proxy.$registerUriOpener(t,n.schemes,e,n.label),Te(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener with id: ${e}`);const s=b.revive(t);return n.canOpenExternalUri(s,i)}async $openUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener id: '${e}'`);return n.openExternalUri(b.revive(t.resolvedUri),{sourceUri:b.revive(t.sourceUri)},i)}}class i1{static{this.HandlePool=0}constructor(e){this.handles=new Ns,this.handlers=new Map,this._proxy=e.getProxy(j.MainThreadUrls)}registerUriHandler(e,t){const i=e.identifier;if(this.handles.has(i))throw new Error(`Protocol handler already registered for extension ${i}`);const n=i1.HandlePool++;return this.handles.add(i),this.handlers.set(n,t),this._proxy.$registerUriHandler(n,i,e.displayName||e.name),Te(()=>{this.handles.delete(i),this.handlers.delete(n),this._proxy.$unregisterUriHandler(n)})}$handleExternalUri(e,t){const i=this.handlers.get(e);if(!i)return Promise.resolve(void 0);try{i.handleUri(b.revive(t))}catch(n){Zi(n)}return Promise.resolve(void 0)}async createAppUri(e){return b.revive(await this._proxy.$createAppUri(e))}}class o7 extends Me{#e;#t;#i;#n;#s;#r;#a;#o;#c;#l;#u;#h;#d;constructor(e,t,i,n){super(),this.#o=void 0,this.#c=!0,this.#u=!1,this.#h=this._register(new P),this.onDidDispose=this.#h.event,this.#d=this._register(new P),this.onDidChangeViewState=this.#d.event,this.#e=e,this.#t=t,this.#n=i,this.#i=n.viewType,this.#s=n.panelOptions,this.#o=n.viewColumn,this.#r=n.title,this.#l=n.active}dispose(){this.#u||(this.#u=!0,this.#h.fire(),this.#t.$disposeWebview(this.#e),this.#n.dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),this.#n}get viewType(){return this.assertNotDisposed(),this.#i}get title(){return this.assertNotDisposed(),this.#r}set title(e){this.assertNotDisposed(),this.#r!==e&&(this.#r=e,this.#t.$setTitle(this.#e,e))}get iconPath(){return this.assertNotDisposed(),this.#a}set iconPath(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#t.$setIconPath(this.#e,b.isUri(e)?{light:e,dark:e}:e))}get options(){return this.#s}get viewColumn(){if(this.assertNotDisposed(),!(typeof this.#o=="number"&&this.#o<0))return this.#o}get active(){return this.assertNotDisposed(),this.#l}get visible(){return this.assertNotDisposed(),this.#c}_updateViewState(e){this.#u||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#l=e.active,this.#c=e.visible,this.#o=e.viewColumn,this.#d.fire({webviewPanel:this}))}reveal(e,t){this.assertNotDisposed(),this.#t.$reveal(this.#e,{viewColumn:typeof e>"u"?void 0:pt.from(e),preserveFocus:!!t})}assertNotDisposed(){if(this.#u)throw new Error("Webview is disposed")}}class n1 extends Me{static newHandle(){return on()}constructor(e,t,i){super(),this.webviews=t,this.workspace=i,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(j.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,i,n,s={}){const o=typeof n=="object"?n.viewColumn:n,a={viewColumn:pt.from(o),preserveFocus:typeof n=="object"&&!!n.preserveFocus},c=ko(e),l=n1.newHandle();this._proxy.$createWebviewPanel(Pd(e),l,t,{title:i,panelOptions:a7(s),webviewOptions:Nb(e,this.workspace,s),serializeBuffersForPostMessage:c},a);const u=this.webviews.createNewWebview(l,s,e);return this.createNewWebviewPanel(l,t,i,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((i,n)=>{const s=e[i],o=e[n];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const i of t){const n=this.getWebviewPanel(i);if(!n)continue;const s=e[i];n._updateViewState({active:s.active,visible:s.visible,viewColumn:pt.to(s.position)})}}async $onDidDisposeWebviewPanel(e){this.getWebviewPanel(e)?.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,i){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:i,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:ko(e)}),new ke(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,i,n){const s=this._serializers.get(t);if(!s)throw new Error(`No serializer found for '${t}'`);const{serializer:o,extension:a}=s,c=this.webviews.createNewWebview(e,i.webviewOptions,a),l=this.createNewWebviewPanel(e,t,i.title,n,i.panelOptions,c,i.active);await o.deserializeWebviewPanel(l,i.state)}createNewWebviewPanel(e,t,i,n,s,o,a){const c=new o7(e,this._proxy,o,{viewType:t,title:i,viewColumn:n,panelOptions:s,active:a});return this._webviewPanels.set(e,c),c}getWebviewPanel(e){return this._webviewPanels.get(e)}}function a7(r){return{enableFindWidget:r.enableFindWidget,retainContextWhenHidden:r.retainContextWhenHidden}}class c7 extends Me{#e;#t;#i;#n;#s;#r;#a;#o;#c;constructor(e,t,i,n,s,o){super(),this.#s=!1,this.#l=this._register(new P),this.onDidChangeVisibility=this.#l.event,this.#u=this._register(new P),this.onDidDispose=this.#u.event,this.#i=i,this.#a=n,this.#e=e,this.#t=t,this.#n=s,this.#r=o}dispose(){this.#s||(this.#s=!0,this.#u.fire(),this.#n.dispose(),super.dispose())}#l;#u;get title(){return this.assertNotDisposed(),this.#a}set title(e){this.assertNotDisposed(),this.#a!==e&&(this.#a=e,this.#t.$setWebviewViewTitle(this.#e,e))}get description(){return this.assertNotDisposed(),this.#o}set description(e){this.assertNotDisposed(),this.#o!==e&&(this.#o=e,this.#t.$setWebviewViewDescription(this.#e,e))}get visible(){return this.#r}get webview(){return this.#n}get viewType(){return this.#i}_setVisible(e){e===this.#r||this.#s||(this.#r=e,this.#l.fire())}get badge(){return this.assertNotDisposed(),this.#c}set badge(e){this.assertNotDisposed(),!(e?.value===this.#c?.value&&e?.tooltip===this.#c?.tooltip)&&(this.#c=Zu.from(e),this.#t.$setWebviewViewBadge(this.#e,e))}show(e){this.assertNotDisposed(),this.#t.$show(this.#e,!!e)}assertNotDisposed(){if(this.#s)throw new Error("Webview is disposed")}}class l7{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(j.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,n){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(Pd(e),t,{retainContextWhenHidden:n?.retainContextWhenHidden,serializeBuffersForPostMessage:ko(e)}),new ke(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,n,s){const o=this._viewProviders.get(t);if(!o)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:c}=o,l=this._extHostWebview.createNewWebview(e,{},c),u=new c7(e,this._proxy,t,i,l,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:n},s)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}new X("debugType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","debugType","Debug type of the active debug session. For example 'python'.")}),new X("debugConfigurationType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","debugConfigurationType","Debug type of the selected launch configuration. For example 'python'.")}),new X("debugState","inactive",{type:"string",description:g("vs/workbench/contrib/debug/common/debug","debugState","State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const u7="debugUx";new X(u7,"default",{type:"string",description:g("vs/workbench/contrib/debug/common/debug","debugUX","Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")}),new X("hasDebugged",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","hasDebugged","True when a debug session has been started at least once, false otherwise.")}),new X("inDebugMode",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","inDebugMode","True when debugging, false otherwise.")}),new X("inDebugRepl",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","inDebugRepl","True when focus is in the debug console, false otherwise.")}),new X("breakpointWidgetVisible",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointWidgetVisibile","True when breakpoint editor zone widget is visible, false otherwise.")}),new X("inBreakpointWidget",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","inBreakpointWidget","True when focus is in the breakpoint editor zone widget, false otherwise.")}),new X("breakpointsFocused",!0,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointsFocused","True when the BREAKPOINTS view is focused, false otherwise.")}),new X("watchExpressionsFocused",!0,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","watchExpressionsFocused","True when the WATCH view is focused, false otherwsie.")}),new X("watchExpressionsExist",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","watchExpressionsExist","True when at least one watch expression exists, false otherwise.")}),new X("variablesFocused",!0,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","variablesFocused","True when the VARIABLES views is focused, false otherwsie")}),new X("expressionSelected",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","expressionSelected","True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")}),new X("breakpointInputFocused",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointInputFocused","True when the input box has focus in the BREAKPOINTS view.")}),new X("callStackItemType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","callStackItemType","Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")}),new X("callStackSessionIsAttach",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","callStackSessionIsAttach","True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")}),new X("callStackItemStopped",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","callStackItemStopped","True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")}),new X("callStackSessionHasOneThread",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","callStackSessionHasOneThread","True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")}),new X("watchItemType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","watchItemType","Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")}),new X("canViewMemory",void 0,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","canViewMemory","Indicates whether the item in the view has an associated memory refrence.")}),new X("breakpointItemType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","breakpointItemType","Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")}),new X("breakpointHasModes",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointHasModes","Whether the breakpoint has multiple modes it can switch to.")}),new X("breakpointSupportsCondition",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointSupportsCondition","True when the focused breakpoint supports conditions.")}),new X("loadedScriptsSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","loadedScriptsSupported","True when the focused sessions supports the LOADED SCRIPTS view")}),new X("loadedScriptsItemType",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","loadedScriptsItemType","Represents the item type of the focused element in the LOADED SCRIPTS view.")}),new X("focusedSessionIsAttach",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","focusedSessionIsAttach","True when the focused session is 'attach'.")}),new X("focusedSessionIsNoDebug",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","focusedSessionIsNoDebug","True when the focused session is run without debugging.")}),new X("stepBackSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","stepBackSupported","True when the focused session supports 'stepBack' requests.")}),new X("restartFrameSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","restartFrameSupported","True when the focused session supports 'restartFrame' requests.")}),new X("stackFrameSupportsRestart",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","stackFrameSupportsRestart","True when the focused stack frame suppots 'restartFrame'.")}),new X("jumpToCursorSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","jumpToCursorSupported","True when the focused session supports 'jumpToCursor' request.")}),new X("stepIntoTargetsSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","stepIntoTargetsSupported","True when the focused session supports 'stepIntoTargets' request.")}),new X("breakpointsExist",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakpointsExist","True when at least one breakpoint exists.")}),new X("debuggersAvailable",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","debuggersAvailable","True when there is at least one debug extensions active.")}),new X("debugExtensionAvailable",!0,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","debugExtensionsAvailable","True when there is at least one debug extension installed and enabled.")}),new X("debugProtocolVariableMenuContext",void 0,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","debugProtocolVariableMenuContext","Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")}),new X("debugSetVariableSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","debugSetVariableSupported","True when the focused session supports 'setVariable' request.")}),new X("debugSetExpressionSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","debugSetExpressionSupported","True when the focused session supports 'setExpression' request.")}),new X("breakWhenValueChangesSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakWhenValueChangesSupported","True when the focused session supports to break when value changes.")}),new X("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakWhenValueIsAccessedSupported","True when the focused breakpoint supports to break when value is accessed.")}),new X("breakWhenValueIsReadSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","breakWhenValueIsReadSupported","True when the focused breakpoint supports to break when value is read.")}),new X("terminateDebuggeeSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","terminateDebuggeeSupported","True when the focused session supports the terminate debuggee capability.")}),new X("suspendDebuggeeSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","suspendDebuggeeSupported","True when the focused session supports the suspend debuggee capability.")}),new X("variableEvaluateNamePresent",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","variableEvaluateNamePresent","True when the focused variable has an 'evalauteName' field set.")}),new X("variableIsReadonly",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","variableIsReadonly","True when the focused variable is read-only.")}),new X("variableValue",!1,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","variableValue","Value of the variable, present for debug visualization clauses.")}),new X("variableType",!1,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","variableType","Type of the variable, present for debug visualization clauses.")}),new X("variableName",!1,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","variableName","Name of the variable, present for debug visualization clauses.")}),new X("variableLanguage",!1,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","variableLanguage","Language of the variable source, present for debug visualization clauses.")}),new X("variableExtensionId",!1,{type:"string",description:g("vs/workbench/contrib/debug/common/debug","variableExtensionId","Extension ID of the variable source, present for debug visualization clauses.")}),new X("exceptionWidgetVisible",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","exceptionWidgetVisible","True when the exception widget is visible.")}),new X("multiSessionRepl",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","multiSessionRepl","True when there is more than 1 debug console.")}),new X("multiSessionDebug",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","multiSessionDebug","True when there is more than 1 active debug session.")}),new X("disassembleRequestSupported",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","disassembleRequestSupported","True when the focused sessions supports disassemble request.")}),new X("disassemblyViewFocus",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","disassemblyViewFocus","True when the Disassembly View is focused.")}),new X("languageSupportsDisassembleRequest",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","languageSupportsDisassembleRequest","True when the language in the current editor supports disassemble request.")}),new X("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:g("vs/workbench/contrib/debug/common/debug","focusedStackFrameHasInstructionReference","True when the focused stack frame has instruction pointer reference.")}),g("vs/workbench/contrib/debug/common/debug","internalConsoleOptions","Controls when the internal Debug Console should open.");var Jd;(function(r){r[r.Initial=1]="Initial",r[r.Dynamic=2]="Dynamic"})(Jd||(Jd={}));var Dy;(function(r){r.UnverifiedBreakpoints="unverifiedBreakpoints"})(Dy||(Dy={})),ee("debugService");var Iy;(function(r){r.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:b.revive(e.iconPath.light),dark:b.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),r.serialize=e=>e})(Iy||(Iy={}));var r1;(function(r){r[r.Information=1]="Information",r[r.Warning=2]="Warning"})(r1||(r1={}));function d7(r){const e=r.get(At),t=r.get(Ds),i=r.get(gd),n=r.get(sr),s=r.get(gn),o=r.get(md),a=r.get(mn),c=r.get(hl),l=r.get(Ue),u=r.get(ug),h=r.get(hg),f=r.get(Es),d=r.get(ze),_=r.get(vg),w=r.get(bd),x=r.get(_b),k=r.get(Tg),S=r.get(fc),D=r.get(Lg);l.set(Z.ExtHostFileSystemInfo,t),l.set(Z.ExtHostLogLevelServiceShape,f),l.set(Z.ExtHostWorkspace,s),l.set(Z.ExtHostConfiguration,a),l.set(Z.ExtHostExtensionService,n),l.set(Z.ExtHostStorage,u),l.set(Z.ExtHostTunnelService,_),l.set(Z.ExtHostWindow,x),l.set(Z.ExtHostSecretState,k),l.set(Z.ExtHostTelemetry,o),l.set(Z.ExtHostEditorTabs,S),l.set(Z.ExtHostManagedSockets,D);const U=l.set(Z.ExtHostDecorations,r.get(ab)),R=l.set(Z.ExtHostDocumentsAndEditors,r.get(uc)),H=l.set(Z.ExtHostCommands,r.get(yo)),le=l.set(Z.ExtHostTerminalService,r.get(sc)),ie=l.set(Z.ExtHostDebugService,r.get(gb)),fe=l.set(Z.ExtHostSearch,r.get(mb)),we=l.set(Z.ExtHostTask,r.get(hb)),z=l.set(Z.ExtHostOutputService,r.get(ob)),B=l.set(Z.ExtHostLocalization,r.get(Rg)),J=l.set(Z.ExtHostUrls,new i1(l)),V=l.set(Z.ExtHostDocuments,new VD(l,R)),re=l.set(Z.ExtHostDocumentContentProviders,new bm(l,R,d)),de=l.set(Z.ExtHostDocumentSaveParticipant,new WD(d,V,l.getProxy(j.MainThreadBulkEdits))),oe=l.set(Z.ExtHostNotebook,new Po(l,H,R,V,i,fe)),Ke=l.set(Z.ExtHostNotebookDocuments,new CI(oe)),Je=l.set(Z.ExtHostNotebookEditors,new Hm(d,oe)),wt=l.set(Z.ExtHostNotebookKernels,new Um(l,e,oe,H,d)),Ft=l.set(Z.ExtHostNotebookRenderers,new kI(l,oe)),bt=l.set(Z.ExtHostNotebookDocumentSaveParticipant,new xI(d,oe,l.getProxy(j.MainThreadBulkEdits))),st=l.set(Z.ExtHostEditors,new JI(l,R)),lt=l.set(Z.ExtHostTreeViews,new s7(l.getProxy(j.MainThreadTreeViews),H,d)),ci=l.set(Z.ExtHostEditorInsets,new yD(l.getProxy(j.MainThreadEditorInsets),st,e.remote)),kt=l.set(Z.ExtHostDiagnostics,new wm(l,d,t,R)),Li=l.set(Z.ExtHostLanguages,new nI(l,V,H.converter,c)),_e=l.set(Z.ExtHostLanguageFeatures,new _t(l,c,V,H,kt,d,w,o)),u1=l.set(Z.ExtHostFileSystem,new Ld(l,_e)),Ji=l.set(Z.ExtHostFileSystemEventService,new XD(l,d,R)),ur=l.set(Z.ExtHostQuickOpen,AI(l,s,H)),Lc=l.set(Z.ExtHostSCM,new Km(l,H,V,d)),kn=l.set(Z.ExtHostQuickDiff,new zm(l,c)),Dn=l.set(Z.ExtHostShare,new Jm(l,c)),d1=l.set(Z.ExtHostComments,xD(l,H,V)),Yd=l.set(Z.ExtHostProgress,new PI(l.getProxy(j.MainThreadProgress))),Ne=l.set(Z.ExtHostLabelService,new tI(l)),Zd=l.set(Z.ExtHostTheming,new e1(l)),dr=l.set(Z.ExtHostAuthentication,new hD(l)),eh=l.set(Z.ExtHostTimeline,new XI(l,H)),Xi=l.set(Z.ExtHostWebviews,new AD(l,e.remote,s,d,w)),Oc=l.set(Z.ExtHostWebviewPanels,new n1(l,Xi,s)),h1=l.set(Z.ExtHostCustomEditors,new FD(l,V,h,Xi,Oc)),f1=l.set(Z.ExtHostWebviewViews,new l7(l,Xi)),hs=l.set(Z.ExtHostTesting,new Ym(l,d,H,R)),Oi=l.set(Z.ExtHostUriOpeners,new t1(l)),p1=l.set(Z.ExtHostProfileContentHandlers,new DI(l));l.set(Z.ExtHostInteractive,new ZD(l,oe,R,H,d));const g1=l.set(Z.ExtHostInlineChat,new Od(l,H,V,d)),Ao=l.set(Z.ExtHostChatProvider,new gm(l,d,dr)),m1=l.set(Z.ExtHostChatAgents2,new pm(l,d,H)),Ro=l.set(Z.ExtHostChatVariables,new mm(l)),hr=l.set(Z.ExtHostChat,new fm(l)),Lo=l.set(Z.ExtHostAiRelatedInformation,new oD(l)),th=l.set(Z.ExtHostAiEmbeddingVector,new zD(l)),Oo=l.set(Z.ExtHostIssueReporter,new eI(l)),$o=l.set(Z.ExtHostStatusBar,new WI(l,H.converter)),No=l.set(Z.ExtHostSpeech,new Xm(l)),ei=Object.values(Z);l.assertRegistered(ei);const fs=new dm(l,R),ot=new _D(l),$c=new Im(l,d),ih=new BD(l);return dD.register(H),function(E,Yi,nh){function se(m){return(v,C,q)=>{const Ie=m(Ge=>{try{v.call(C,Ge)}catch(Dt){ch(new Error(`[ExtensionListenerError] Extension '${E.identifier.value}' FAILED to handle event: ${Dt.toString()}`,{cause:Dt})),o.onExtensionError(E.identifier,Dt)}});return q?.push(Ie),Ie}}const Fe=function(){let m=!E.isUnderDevelopment;function v(){m||(d.info(`Extension '${E.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),m=!0)}return function C(q){if(Array.isArray(q))q.forEach(C);else if(typeof q=="string")v();else{const Ie=q;typeof Ie.scheme>"u"&&v(),typeof Ie.exclusive=="boolean"&&N(E,"documentFiltersExclusive")}return q}}(),v1={getSession(m,v,C){return dr.getSession(E,m,v,C)},getSessions(m,v){return N(E,"authGetSessions"),dr.getSessions(E,m,v)},async hasSession(m,v){return N(E,"authSession"),!!await dr.getSession(E,m,v,{silent:!0})},get onDidChangeSessions(){return se(dr.onDidChangeSessions)},registerAuthenticationProvider(m,v,C,q){return dr.registerAuthenticationProvider(m,v,C,q)}},_1={registerCommand(m,v,C){return H.registerCommand(!0,m,v,C,void 0,E)},registerTextEditorCommand(m,v,C){return H.registerCommand(!0,m,(...q)=>{const Ie=st.getActiveTextEditor();if(!Ie){d.warn("Cannot execute "+m+" because there is no active text editor.");return}return Ie.edit(Ge=>{v.apply(C,[Ie,Ge,...q])}).then(Ge=>{Ge||d.warn("Edits from command "+m+" were not applied.")},Ge=>{d.warn("An error occurred while running command "+m,Ge)})},void 0,void 0,E)},registerDiffInformationCommand:(m,v,C)=>(N(E,"diffCommand"),H.registerCommand(!0,m,async(...q)=>{const Ie=R.activeEditor(!0);if(!Ie){d.warn("Cannot execute "+m+" because there is no active text editor.");return}const Ge=await st.getDiffInformation(Ie.id);v.apply(C,[Ge,...q])},void 0,void 0,E)),executeCommand(m,...v){return H.executeCommand(m,...v)},getCommands(m=!1){return H.getCommands(m)}},w1={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){return e.environment.appRoot?.fsPath??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return ot.value},get shell(){return le.getDefaultShell(!1)},get onDidChangeShell(){return se(le.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return se(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return N(E,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return N(E,"telemetry"),se(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return $0(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(m,v){return O0.validateSender(m),o.instantiateLogger(E,m,v)},openExternal(m,v){return x.openUri(m,{allowTunneling:!!e.remote.authority,allowContributedOpeners:v?.allowContributedOpeners})},async asExternalUri(m){if(m.scheme===e.environment.appUriScheme)return J.createAppUri(m);try{return await x.asExternalUri(m,{allowTunneling:!!e.remote.authority})}catch(v){if($h(m,K.http)||$h(m,K.https))return m;throw v}},get remoteName(){return wf(e.remote.authority)},get remoteAuthority(){return N(E,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return d.getLevel()},get onDidChangeLogLevel(){return se(d.onDidChangeLogLevel)},registerIssueUriRequestHandler(m){return N(E,"handleIssueUri"),Oo.registerIssueUriRequestHandler(E,m)},registerIssueDataProvider(m){return N(E,"handleIssueUri"),Oo.registerIssueDataProvider(E,m)},get appQuality(){return N(E,"resolvers"),e.quality},get appCommit(){return N(E,"resolvers"),e.commit}},b1={createTestController(m,v,C){return hs.createTestController(E,m,v,C)},createTestObserver(){return N(E,"testObserver"),hs.createTestObserver()},runTests(m){return N(E,"testObserver"),hs.runTests(m)},get onDidChangeTestResults(){return N(E,"testObserver"),se(hs.onResultsChanged)},get testResults(){return N(E,"testObserver"),hs.results}},Fo=e.remote.isRemote?Kr.Workspace:Kr.UI,Mo={getExtension(m,v){Ct(E,"extensionsAny")||(v=!1);const C=Yi.mine.getExtensionDescription(m);if(C)return new ac(n,E.identifier,C,Fo,!1);if(v){const q=Yi.all.getExtensionDescription(m);if(q)return new ac(n,E.identifier,q,Fo,!0)}},get all(){const m=[];for(const v of Yi.mine.getAllExtensionDescriptions())m.push(new ac(n,E.identifier,v,Fo,!1));return m},get allAcrossExtensionHosts(){N(E,"extensionsAny");const m=new Ns(Yi.mine.getAllExtensionDescriptions().map(C=>C.identifier)),v=[];for(const C of Yi.all.getAllExtensionDescriptions()){const q=!m.has(C.identifier);v.push(new ac(n,E.identifier,C,Fo,q))}return v},get onDidChange(){return Ct(E,"extensionsAny")?se(ht.any(Yi.mine.onDidChange,Yi.all.onDidChange)):se(Yi.mine.onDidChange)}},y1={createDiagnosticCollection(m){return kt.createDiagnosticCollection(E.identifier,m)},get onDidChangeDiagnostics(){return se(kt.onDidChangeDiagnostics)},getDiagnostics:m=>kt.getDiagnostics(m),getLanguages(){return Li.getLanguages()},setTextDocumentLanguage(m,v){return Li.changeLanguage(m.uri,v)},match(m,v){const C=Hp.from(m);let q;return xb(C)&&(q=oe.notebookDocuments.find(Ie=>Ie.apiNotebook.getCells().find(Ge=>Ge.document===v))?.apiNotebook),yb(C,v.uri,v.languageId,!0,q?.uri,q?.notebookType)},registerCodeActionsProvider(m,v,C){return _e.registerCodeActionProvider(E,Fe(m),v,C)},registerDocumentPasteEditProvider(m,v,C){return N(E,"documentPaste"),_e.registerDocumentPasteEditProvider(E,Fe(m),v,C)},registerCodeLensProvider(m,v){return _e.registerCodeLensProvider(E,Fe(m),v)},registerDefinitionProvider(m,v){return _e.registerDefinitionProvider(E,Fe(m),v)},registerDeclarationProvider(m,v){return _e.registerDeclarationProvider(E,Fe(m),v)},registerImplementationProvider(m,v){return _e.registerImplementationProvider(E,Fe(m),v)},registerTypeDefinitionProvider(m,v){return _e.registerTypeDefinitionProvider(E,Fe(m),v)},registerHoverProvider(m,v){return _e.registerHoverProvider(E,Fe(m),v,E.identifier)},registerEvaluatableExpressionProvider(m,v){return _e.registerEvaluatableExpressionProvider(E,Fe(m),v,E.identifier)},registerInlineValuesProvider(m,v){return _e.registerInlineValuesProvider(E,Fe(m),v,E.identifier)},registerDocumentHighlightProvider(m,v){return _e.registerDocumentHighlightProvider(E,Fe(m),v)},registerMultiDocumentHighlightProvider(m,v){return _e.registerMultiDocumentHighlightProvider(E,Fe(m),v)},registerLinkedEditingRangeProvider(m,v){return _e.registerLinkedEditingRangeProvider(E,Fe(m),v)},registerReferenceProvider(m,v){return _e.registerReferenceProvider(E,Fe(m),v)},registerRenameProvider(m,v){return _e.registerRenameProvider(E,Fe(m),v)},registerNewSymbolNamesProvider(m,v){return N(E,"newSymbolNamesProvider"),_e.registerNewSymbolNamesProvider(E,Fe(m),v)},registerDocumentSymbolProvider(m,v,C){return _e.registerDocumentSymbolProvider(E,Fe(m),v,C)},registerWorkspaceSymbolProvider(m){return _e.registerWorkspaceSymbolProvider(E,m)},registerDocumentFormattingEditProvider(m,v){return _e.registerDocumentFormattingEditProvider(E,Fe(m),v)},registerDocumentRangeFormattingEditProvider(m,v){return _e.registerDocumentRangeFormattingEditProvider(E,Fe(m),v)},registerOnTypeFormattingEditProvider(m,v,C,...q){return _e.registerOnTypeFormattingEditProvider(E,Fe(m),v,[C].concat(q))},registerDocumentSemanticTokensProvider(m,v,C){return _e.registerDocumentSemanticTokensProvider(E,Fe(m),v,C)},registerDocumentRangeSemanticTokensProvider(m,v,C){return _e.registerDocumentRangeSemanticTokensProvider(E,Fe(m),v,C)},registerSignatureHelpProvider(m,v,C,...q){return typeof C=="object"?_e.registerSignatureHelpProvider(E,Fe(m),v,C):_e.registerSignatureHelpProvider(E,Fe(m),v,typeof C>"u"?[]:[C,...q])},registerCompletionItemProvider(m,v,...C){return _e.registerCompletionItemProvider(E,Fe(m),v,C)},registerInlineCompletionItemProvider(m,v,C){return v.handleDidShowCompletionItem&&N(E,"inlineCompletionsAdditions"),v.handleDidPartiallyAcceptCompletionItem&&N(E,"inlineCompletionsAdditions"),C&&N(E,"inlineCompletionsAdditions"),_e.registerInlineCompletionsProvider(E,Fe(m),v,C)},registerInlineEditProvider(m,v){return N(E,"inlineEdit"),_e.registerInlineEditProvider(E,Fe(m),v)},registerDocumentLinkProvider(m,v){return _e.registerDocumentLinkProvider(E,Fe(m),v)},registerColorProvider(m,v){return _e.registerColorProvider(E,Fe(m),v)},registerFoldingRangeProvider(m,v){return _e.registerFoldingRangeProvider(E,Fe(m),v)},registerSelectionRangeProvider(m,v){return _e.registerSelectionRangeProvider(E,m,v)},registerCallHierarchyProvider(m,v){return _e.registerCallHierarchyProvider(E,m,v)},registerTypeHierarchyProvider(m,v){return _e.registerTypeHierarchyProvider(E,m,v)},setLanguageConfiguration:(m,v)=>_e.setLanguageConfiguration(E,m,v),getTokenInformationAtPosition(m,v){return N(E,"tokenInformation"),Li.tokenAtPosition(m,v)},registerInlayHintsProvider(m,v){return _e.registerInlayHintsProvider(E,m,v)},createLanguageStatusItem(m,v){return Li.createLanguageStatusItem(E,m,v)},registerDocumentDropEditProvider(m,v,C){return _e.registerDocumentOnDropEditProvider(E,m,v,Ct(E,"dropMetadata")?C:void 0)}},x1={get activeTextEditor(){return st.getActiveTextEditor()},get visibleTextEditors(){return st.getVisibleTextEditors()},get activeTerminal(){return le.activeTerminal},get terminals(){return le.terminals},async showTextDocument(m,v,C){b.isUri(m)&&m.scheme===K.vscodeRemote&&!m.authority&&w.report("workspace.showTextDocument",E,"A URI of 'vscode-remote' scheme requires an authority.");const q=await(b.isUri(m)?Promise.resolve(rh.openTextDocument(m)):Promise.resolve(m));return st.showTextDocument(q,v,C)},createTextEditorDecorationType(m){return st.createTextEditorDecorationType(E,m)},onDidChangeActiveTextEditor(m,v,C){return se(st.onDidChangeActiveTextEditor)(m,v,C)},onDidChangeVisibleTextEditors(m,v,C){return se(st.onDidChangeVisibleTextEditors)(m,v,C)},onDidChangeTextEditorSelection(m,v,C){return se(st.onDidChangeTextEditorSelection)(m,v,C)},onDidChangeTextEditorOptions(m,v,C){return se(st.onDidChangeTextEditorOptions)(m,v,C)},onDidChangeTextEditorVisibleRanges(m,v,C){return se(st.onDidChangeTextEditorVisibleRanges)(m,v,C)},onDidChangeTextEditorViewColumn(m,v,C){return se(st.onDidChangeTextEditorViewColumn)(m,v,C)},onDidCloseTerminal(m,v,C){return se(le.onDidCloseTerminal)(m,v,C)},onDidOpenTerminal(m,v,C){return se(le.onDidOpenTerminal)(m,v,C)},onDidChangeActiveTerminal(m,v,C){return se(le.onDidChangeActiveTerminal)(m,v,C)},onDidChangeTerminalDimensions(m,v,C){return N(E,"terminalDimensions"),se(le.onDidChangeTerminalDimensions)(m,v,C)},onDidChangeTerminalState(m,v,C){return se(le.onDidChangeTerminalState)(m,v,C)},onDidWriteTerminalData(m,v,C){return N(E,"terminalDataWriteEvent"),se(le.onDidWriteTerminalData)(m,v,C)},onDidExecuteTerminalCommand(m,v,C){return N(E,"terminalExecuteCommandEvent"),se(le.onDidExecuteTerminalCommand)(m,v,C)},get state(){return x.getState(E)},onDidChangeWindowState(m,v,C){return se(x.onDidChangeWindowState)(m,v,C)},showInformationMessage(m,...v){return $c.showMessage(E,Ye.Info,m,v[0],v.slice(1))},showWarningMessage(m,...v){return $c.showMessage(E,Ye.Warning,m,v[0],v.slice(1))},showErrorMessage(m,...v){return $c.showMessage(E,Ye.Error,m,v[0],v.slice(1))},showQuickPick(m,v,C){return ur.showQuickPick(E,m,v,C)},showWorkspaceFolderPick(m){return ur.showWorkspaceFolderPick(m)},showInputBox(m,v){return ur.showInput(m,v)},showOpenDialog(m){return ih.showOpenDialog(E,m)},showSaveDialog(m){return ih.showSaveDialog(m)},createStatusBarItem(m,v,C){let q,Ie,Ge;return typeof m=="string"?(q=m,Ie=v,Ge=C):(Ie=m,Ge=v),$o.createStatusBarEntry(E,q,Ie,Ge)},setStatusBarMessage(m,v){return $o.setStatusBarMessage(m,v)},withScmProgress(m){return w.report("window.withScmProgress",E,"Use 'withProgress' instead."),Yd.withProgress(E,{location:qr.SourceControl},(v,C)=>m({report(q){}}))},withProgress(m,v){return Yd.withProgress(E,m,v)},createOutputChannel(m,v){return z.createOutputChannel(m,v,E)},createWebviewPanel(m,v,C,q){return Oc.createWebviewPanel(E,m,v,C,q)},createWebviewTextEditorInset(m,v,C,q){return N(E,"editorInsets"),ci.createWebviewEditorInset(m,v,C,q,E)},createTerminal(m,v,C){return typeof m=="object"?"pty"in m?le.createExtensionTerminal(m):le.createTerminalFromOptions(m):le.createTerminal(m,v,C)},registerTerminalLinkProvider(m){return le.registerLinkProvider(m)},registerTerminalProfileProvider(m,v){return le.registerProfileProvider(E,m,v)},registerTerminalQuickFixProvider(m,v){return N(E,"terminalQuickFixProvider"),le.registerTerminalQuickFixProvider(m,E.identifier.value,v)},registerTreeDataProvider(m,v){return lt.registerTreeDataProvider(m,v,E)},createTreeView(m,v){return lt.createTreeView(m,v,E)},registerWebviewPanelSerializer:(m,v)=>Oc.registerWebviewPanelSerializer(E,m,v),registerCustomEditorProvider:(m,v,C={})=>h1.registerCustomEditorProvider(E,m,v,C),registerFileDecorationProvider(m){return U.registerFileDecorationProvider(m,E)},registerUriHandler(m){return J.registerUriHandler(E,m)},createQuickPick(){return ur.createQuickPick(E)},createInputBox(){return ur.createInputBox(E)},get activeColorTheme(){return Zd.activeColorTheme},onDidChangeActiveColorTheme(m,v,C){return se(Zd.onDidChangeActiveColorTheme)(m,v,C)},registerWebviewViewProvider(m,v,C){return f1.registerWebviewViewProvider(E,m,v,C?.webviewOptions)},get activeNotebookEditor(){return oe.activeNotebookEditor},onDidChangeActiveNotebookEditor(m,v,C){return se(oe.onDidChangeActiveNotebookEditor)(m,v,C)},get visibleNotebookEditors(){return oe.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return se(oe.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(m,v,C){return se(Je.onDidChangeNotebookEditorSelection)(m,v,C)},onDidChangeNotebookEditorVisibleRanges(m,v,C){return se(Je.onDidChangeNotebookEditorVisibleRanges)(m,v,C)},showNotebookDocument(m,v){return oe.showNotebookDocument(m,v)},registerExternalUriOpener(m,v,C){return N(E,"externalUriOpener"),Oi.registerExternalUriOpener(E.identifier,m,v,C)},registerProfileContentHandler(m,v){return N(E,"profileContentHandlers"),p1.registerProfileContentHandler(E,m,v)},registerQuickDiffProvider(m,v,C,q){return N(E,"quickDiffProvider"),kn.registerQuickDiffProvider(Fe(m),v,C,q)},get tabGroups(){return S.tabGroups},registerShareProvider(m,v){return N(E,"shareProvider"),Dn.registerShareProvider(Fe(m),v)}},rh={get rootPath(){return w.report("workspace.rootPath",E,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(m){throw new vr("rootPath")},getWorkspaceFolder(m){return s.getWorkspaceFolder(m)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(m){throw new vr("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(m){throw new vr("workspaceFile")},updateWorkspaceFolders:(m,v,...C)=>s.updateWorkspaceFolders(E,m,v||0,...C),onDidChangeWorkspaceFolders:function(m,v,C){return se(s.onDidChangeWorkspace)(m,v,C)},asRelativePath:(m,v)=>s.getRelativePath(m,v),findFiles:(m,v,C,q)=>s.findFiles(m,v,C,E.identifier,q),findFiles2:(m,v,C)=>(N(E,"findFiles2"),s.findFiles2(m,v,E.identifier,C)),findTextInFiles:(m,v,C,q)=>{N(E,"findTextInFiles");let Ie,Ge;return typeof v=="object"?(Ie=v,Ge=C):(Ie={},Ge=v,q=C),s.findTextInFiles(m,Ie||{},Ge,E.identifier,q)},save:m=>s.save(m),saveAs:m=>s.saveAs(m),saveAll:m=>s.saveAll(m),applyEdit(m,v){return fs.applyWorkspaceEdit(m,E,v)},createFileSystemWatcher:(m,v,C,q)=>{let Ie;return typeof v=="boolean"?Ie={ignoreCreateEvents:!!v,ignoreChangeEvents:!!C,ignoreDeleteEvents:!!q,correlate:!1}:v&&(N(E,"createFileSystemWatcher"),Ie={...v,correlate:!0}),Ji.createFileSystemWatcher(s,E,m,Ie)},get textDocuments(){return V.getAllDocumentData().map(m=>m.document)},set textDocuments(m){throw new vr("textDocuments")},openTextDocument(m){let v;const C=m;if(typeof m=="string")v=Promise.resolve(b.file(m));else if(b.isUri(m))v=Promise.resolve(m);else if(!C||typeof C=="object")v=V.createDocumentData(C);else throw new Error("illegal argument - uriOrFileNameOrOptions");return v.then(q=>(q.scheme===K.vscodeRemote&&!q.authority&&w.report("workspace.openTextDocument",E,"A URI of 'vscode-remote' scheme requires an authority."),V.ensureDocumentData(q).then(Ie=>Ie.document)))},onDidOpenTextDocument:(m,v,C)=>se(V.onDidAddDocument)(m,v,C),onDidCloseTextDocument:(m,v,C)=>se(V.onDidRemoveDocument)(m,v,C),onDidChangeTextDocument:(m,v,C)=>se(V.onDidChangeDocument)(m,v,C),onDidSaveTextDocument:(m,v,C)=>se(V.onDidSaveDocument)(m,v,C),onWillSaveTextDocument:(m,v,C)=>se(de.getOnWillSaveTextDocumentEvent(E))(m,v,C),get notebookDocuments(){return oe.notebookDocuments.map(m=>m.apiNotebook)},async openNotebookDocument(m,v){let C;if(b.isUri(m))C=m,await oe.openNotebookDocument(m);else if(typeof m=="string")C=b.revive(await oe.createNotebookDocument({viewType:m,content:v}));else throw new Error("Invalid arguments");return oe.getNotebookDocument(C).apiNotebook},onDidSaveNotebookDocument(m,v,C){return se(Ke.onDidSaveNotebookDocument)(m,v,C)},onDidChangeNotebookDocument(m,v,C){return se(Ke.onDidChangeNotebookDocument)(m,v,C)},onWillSaveNotebookDocument(m,v,C){return se(bt.getOnWillSaveNotebookDocumentEvent(E))(m,v,C)},get onDidOpenNotebookDocument(){return se(oe.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return se(oe.onDidCloseNotebookDocument)},registerNotebookSerializer(m,v,C,q){return oe.registerNotebookSerializer(E,m,v,C,Ct(E,"notebookLiveShare")?q:void 0)},onDidChangeConfiguration:(m,v,C)=>se(nh.onDidChangeConfiguration)(m,v,C),getConfiguration(m,v){return v=arguments.length===1?void 0:v,nh.getConfiguration(m,v,E)},registerTextDocumentContentProvider(m,v){return re.registerTextDocumentContentProvider(m,v)},registerTaskProvider:(m,v)=>(w.report("window.registerTaskProvider",E,"Use the corresponding function on the 'tasks' namespace instead"),we.registerTaskProvider(E,m,v)),registerFileSystemProvider(m,v,C){return q1(u1.registerFileSystemProvider(E,m,v,C),i.addFileSystemProvider(m,v,C))},get fs(){return i.value},registerFileSearchProvider:(m,v)=>(N(E,"fileSearchProvider"),fe.registerFileSearchProvider(m,v)),registerTextSearchProvider:(m,v)=>(N(E,"textSearchProvider"),fe.registerTextSearchProvider(m,v)),registerRemoteAuthorityResolver:(m,v)=>(N(E,"resolvers"),n.registerRemoteAuthorityResolver(m,v)),registerResourceLabelFormatter:m=>(N(E,"resolvers"),Ne.$registerResourceLabelFormatter(m)),getRemoteExecServer:m=>(N(E,"resolvers"),n.getRemoteExecServer(m)),onDidCreateFiles:(m,v,C)=>se(Ji.onDidCreateFile)(m,v,C),onDidDeleteFiles:(m,v,C)=>se(Ji.onDidDeleteFile)(m,v,C),onDidRenameFiles:(m,v,C)=>se(Ji.onDidRenameFile)(m,v,C),onWillCreateFiles:(m,v,C)=>se(Ji.getOnWillCreateFileEvent(E))(m,v,C),onWillDeleteFiles:(m,v,C)=>se(Ji.getOnWillDeleteFileEvent(E))(m,v,C),onWillRenameFiles:(m,v,C)=>se(Ji.getOnWillRenameFileEvent(E))(m,v,C),openTunnel:m=>(N(E,"tunnels"),_.openTunnel(E,m).then(v=>{if(!v)throw new Error("cannot open tunnel");return v})),get tunnels(){return N(E,"tunnels"),_.getTunnels()},onDidChangeTunnels:(m,v,C)=>(N(E,"tunnels"),se(_.onDidChangeTunnels)(m,v,C)),registerPortAttributesProvider:(m,v)=>(N(E,"portsAttributes"),_.registerPortsAttributesProvider(m,v)),registerTunnelProvider:(m,v)=>(N(E,"tunnelFactory"),_.registerTunnelProvider(m,v)),registerTimelineProvider:(m,v)=>(N(E,"timeline"),eh.registerTimelineProvider(m,v,E.identifier,H.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:m=>(N(E,"workspaceTrust"),s.requestWorkspaceTrust(m)),onDidGrantWorkspaceTrust:(m,v,C)=>se(s.onDidGrantWorkspaceTrust)(m,v,C),registerEditSessionIdentityProvider:(m,v)=>(N(E,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(m,v)),onWillCreateEditSessionIdentity:(m,v,C)=>(N(E,"editSessionIdentityProvider"),se(s.getOnWillCreateEditSessionIdentityEvent(E))(m,v,C)),registerCanonicalUriProvider:(m,v)=>(N(E,"canonicalUriProvider"),s.registerCanonicalUriProvider(m,v)),getCanonicalUri:(m,v,C)=>(N(E,"canonicalUriProvider"),s.provideCanonicalUri(m,v,C))},C1={get inputBox(){return w.report("scm.inputBox",E,"Use 'SourceControl.inputBox' instead"),Lc.getLastInputBox(E)},createSourceControl(m,v,C){return Lc.createSourceControl(E,m,v,C)}},S1={createCommentController(m,v){return d1.createCommentController(E,m,v)}},Nc={get activeDebugSession(){return ie.activeDebugSession},get activeDebugConsole(){return ie.activeDebugConsole},get breakpoints(){return ie.breakpoints},get stackFrameFocus(){return ie.stackFrameFocus},registerDebugVisualizationProvider(m,v){return N(E,"debugVisualization"),ie.registerDebugVisualizationProvider(E,m,v)},registerDebugVisualizationTreeProvider(m,v){return N(E,"debugVisualization"),ie.registerDebugVisualizationTree(E,m,v)},onDidStartDebugSession(m,v,C){return se(ie.onDidStartDebugSession)(m,v,C)},onDidTerminateDebugSession(m,v,C){return se(ie.onDidTerminateDebugSession)(m,v,C)},onDidChangeActiveDebugSession(m,v,C){return se(ie.onDidChangeActiveDebugSession)(m,v,C)},onDidReceiveDebugSessionCustomEvent(m,v,C){return se(ie.onDidReceiveDebugSessionCustomEvent)(m,v,C)},onDidChangeBreakpoints(m,v,C){return se(ie.onDidChangeBreakpoints)(m,v,C)},onDidChangeStackFrameFocus(m,v,C){return N(E,"debugFocus"),se(ie.onDidChangeStackFrameFocus)(m,v,C)},registerDebugConfigurationProvider(m,v,C){return ie.registerDebugConfigurationProvider(m,v,C||Jd.Initial)},registerDebugAdapterDescriptorFactory(m,v){return ie.registerDebugAdapterDescriptorFactory(E,m,v)},registerDebugAdapterTrackerFactory(m,v){return ie.registerDebugAdapterTrackerFactory(m,v)},startDebugging(m,v,C){return!C||typeof C=="object"&&"configuration"in C?ie.startDebugging(m,v,{parentSession:C}):ie.startDebugging(m,v,C||{})},stopDebugging(m){return ie.stopDebugging(m)},addBreakpoints(m){return ie.addBreakpoints(m)},removeBreakpoints(m){return ie.removeBreakpoints(m)},asDebugSourceUri(m,v){return ie.asDebugSourceUri(m,v)}},E1={registerTaskProvider:(m,v)=>we.registerTaskProvider(E,m,v),fetchTasks:m=>we.fetchTasks(m),executeTask:m=>we.executeTask(E,m),get taskExecutions(){return we.taskExecutions},onDidStartTask:(m,v,C)=>se(we.onDidStartTask)(m,v,C),onDidEndTask:(m,v,C)=>se(we.onDidEndTask)(m,v,C),onDidStartTaskProcess:(m,v,C)=>se(we.onDidStartTaskProcess)(m,v,C),onDidEndTaskProcess:(m,v,C)=>se(we.onDidEndTaskProcess)(m,v,C)},k1={createNotebookController(m,v,C,q,Ie){return wt.createNotebookController(E,m,v,C,q,Ct(E,"notebookMessaging")?Ie:void 0)},registerNotebookCellStatusBarItemProvider:(m,v)=>oe.registerNotebookCellStatusBarItemProvider(E,m,v),createRendererMessaging(m){return Ft.createRendererMessaging(E,m)},createNotebookControllerDetectionTask(m){return N(E,"notebookKernelSource"),wt.createNotebookControllerDetectionTask(E,m)},registerKernelSourceActionProvider(m,v){return N(E,"notebookKernelSource"),wt.registerKernelSourceActionProvider(E,m,v)},onDidChangeNotebookCellExecutionState(m,v,C){return N(E,"notebookCellExecutionState"),se(wt.onDidChangeNotebookCellExecutionState)(m,v,C)}},D1={t(...m){if(typeof m[0]=="string"){const v=m.shift(),C=!m||typeof m[0]!="object"?m:m[0];return B.getMessage(E.identifier.value,{message:v,args:C})}return B.getMessage(E.identifier.value,m[0])},get bundle(){return B.getBundle(E.identifier.value)},get uri(){return B.getBundleUri(E.identifier.value)}},y={_version:1,registerInteractiveEditorSessionProvider(m,v){return N(E,"interactive"),g1.registerProvider(E,m,v)},registerInteractiveSessionProvider(m,v){return N(E,"interactive"),hr.registerChatProvider(E,m,v)},sendInteractiveRequestToProvider(m,v){return N(E,"interactive"),hr.sendInteractiveRequestToProvider(m,v)},transferChatSession(m,v){return N(E,"interactive"),hr.transferChatSession(m,v)}},I={getRelatedInformation(m,v){return N(E,"aiRelatedInformation"),Lo.getRelatedInformation(E,m,v)},registerRelatedInformationProvider(m,v){return N(E,"aiRelatedInformation"),Lo.registerRelatedInformationProvider(E,m,v)},registerEmbeddingVectorProvider(m,v){return N(E,"aiRelatedInformation"),th.registerEmbeddingVectorProvider(E,m,v)}},T={registerChatResponseProvider(m,v,C){return N(E,"chatProvider"),Ao.registerLanguageModel(E,m,v,C)},registerChatVariableResolver(m,v,C){return N(E,"chatVariableResolver"),Ro.registerVariableResolver(E,m,v,C)},registerMappedEditsProvider(m,v){return N(E,"mappedEditsProvider"),_e.registerMappedEditsProvider(E,m,v)},createChatParticipant(m,v){return N(E,"chatParticipant"),m1.createChatAgent(E,m,v)}},G={requestLanguageModelAccess(m,v){return N(E,"languageModels"),Ao.requestLanguageModelAccess(E,m,v)},get languageModels(){return N(E,"languageModels"),Ao.getLanguageModelIds()},onDidChangeLanguageModels:(m,v,C)=>(N(E,"languageModels"),Ao.onDidChangeProviders(m,v,C))},W={registerSpeechProvider(m,v){return N(E,"speech"),No.registerProvider(E.identifier,m,v)}};return{version:e.version,ai:I,authentication:v1,commands:_1,comments:S1,chat:T,debug:Nc,env:w1,extensions:Mo,interactive:y,l10n:D1,languages:y1,lm:G,notebooks:k1,scm:C1,speech:W,tasks:E1,tests:b1,window:x1,workspace:rh,Breakpoint:Qs,TerminalOutputAnchor:If,ChatResultFeedbackKind:Ha,ChatVariableLevel:fn,ChatCompletionItem:iE,CallHierarchyIncomingCall:jw,CallHierarchyItem:Pf,CallHierarchyOutgoingCall:Gw,CancellationError:mr,CancellationTokenSource:dt,CandidatePortSource:Ih,CodeAction:Ql,CodeActionKind:Ze,CodeActionTriggerKind:Ca,CodeLens:Kl,Color:zs,ColorInformation:tu,ColorPresentation:iu,ColorThemeKind:Kn,CommentMode:Jf,CommentState:Xf,CommentThreadCollapsibleState:La,CommentThreadState:Oa,CompletionItem:Yl,CompletionItemKind:ce,CompletionItemTag:Ea,CompletionList:Us,CompletionTriggerKind:Hs,ConfigurationTarget:js,CustomExecution:Vf,DebugAdapterExecutable:cu,DebugAdapterInlineImplementation:uu,DebugAdapterNamedPipeServer:lu,DebugAdapterServer:Aa,DebugConfigurationProviderTriggerKind:Jd,DebugConsoleMode:_u,DebugVisualization:K4,DecorationRangeBehavior:Wr,Diagnostic:zl,DiagnosticRelatedInformation:_a,DiagnosticSeverity:Et,DiagnosticTag:Br,Disposable:ke,DocumentHighlight:jl,DocumentHighlightKind:wa,MultiDocumentHighlight:Gl,DocumentLink:eu,DocumentSymbol:xa,EndOfLine:ki,EnvironmentVariableMutatorType:Fs,EvaluatableExpression:fu,InlineValueText:pu,InlineValueVariableLookup:gu,InlineValueEvaluatableExpression:mu,InlineCompletionTriggerKind:Ra,EventEmitter:P,ExtensionKind:Kr,ExtensionMode:Zs,ExternalUriOpenerPriority:op,FileChangeType:Ks,FileDecoration:ep,FileDecoration2:ep,FileSystemError:ft,FileType:$r,FilePermission:Ls,FoldingRange:Kf,FoldingRangeKind:dn,FunctionBreakpoint:Qr,InlineCompletionItem:$f,InlineCompletionList:Nf,Hover:ql,IndentAction:cm,Location:si,MarkdownString:gi,OverviewRulerLane:Eg,ParameterInformation:Tf,PortAutoForwardAction:cp,Position:xe,ProcessExecution:qs,ProgressLocation:qr,QuickInputButtons:$a,Range:ve,RelativePattern:Gs,Selection:un,SelectionRange:Sa,SemanticTokens:Js,SemanticTokensBuilder:Zf,SemanticTokensEdit:Jw,SemanticTokensEdits:vu,SemanticTokensLegend:Yf,ShellExecution:Vr,ShellQuoting:Wf,SignatureHelp:Rf,SignatureHelpTriggerKind:Lf,SignatureInformation:Af,SnippetString:Ur,SourceBreakpoint:Gr,StandardTokenType:Jn,StatusBarAlignment:Qn,SymbolInformation:ya,SymbolKind:Ve,SymbolTag:ba,Task:nu,TaskGroup:Ia,TaskPanelKind:Bf,TaskRevealKind:Uf,TaskScope:zr,TerminalLink:U4,TerminalQuickFixTerminalCommand:W4,TerminalQuickFixOpener:B4,TerminalLocation:Hf,TerminalProfile:V4,TerminalExitReason:Mf,TextDocumentSaveReason:Bs,TextEdit:jn,SnippetTextEdit:Hr,TextEditorCursorStyle:Ki,TextEditorLineNumbersStyle:Di,TextEditorRevealType:Zl,TextEditorSelectionChangeKind:Ws,SyntaxTokenType:Vs,TextDocumentChangeReason:Da,ThemeColor:Ta,ThemeIcon:Nt,TreeItem:ru,TreeItemCheckboxState:zi,TreeItemCollapsibleState:jr,TypeHierarchyItem:lp,UIKind:zo,Uri:b,ViewColumn:ka,WorkspaceEdit:Gn,DocumentDropEdit:qf,DocumentPasteEdit:jf,InlayHint:Xl,InlayHintLabelPart:Jl,InlayHintKind:Of,RemoteAuthorityResolverError:Vi,ResolvedAuthority:M4,ManagedResolvedAuthority:Wl,SourceControlInputBoxValidationType:Ff,ExtensionRuntime:Eu,TimelineItem:ip,NotebookRange:hn,NotebookCellKind:Jr,NotebookCellExecutionState:Ys,NotebookCellData:bu,NotebookData:Xw,NotebookRendererScript:Zw,NotebookCellStatusBarAlignment:xu,NotebookEditorRevealType:Cu,NotebookCellOutput:yu,NotebookCellOutputItem:Yw,NotebookCellStatusBarItem:J4,NotebookControllerAffinity:tp,NotebookControllerAffinity2:Su,NotebookEdit:Vl,NotebookKernelSourceAction:X4,NotebookVariablesRequestKind:Fa,PortAttributes:Z4,LinkedEditingRanges:Y4,TestResultState:np,TestRunRequest:ku,TestMessage:Du,TestTag:Ma,TestRunProfileKind:eo,TextSearchCompleteMessageType:r1,DataTransfer:Pa,DataTransferItem:su,CoveredCount:Iu,FileCoverage:sp,StatementCoverage:eE,BranchCoverage:tE,DeclarationCoverage:e0,FunctionCoverage:e0,WorkspaceTrustState:ap,LanguageStatusSeverity:Ms,QuickPickItemKind:Na,InputBoxValidationSeverity:Xs,TabInputText:up,TabInputTextDiff:dp,TabInputTextMerge:t0,TabInputCustom:hp,TabInputNotebook:fp,TabInputNotebookDiff:pp,TabInputWebview:i0,TabInputTerminal:n0,TabInputInteractiveWindow:r0,TabInputChat:s0,TelemetryTrustedValue:bf,LogLevel:Ae,EditSessionIdentityMatch:lm,InteractiveSessionVoteDirection:gp,ChatCopyKind:mp,InteractiveEditorResponseFeedbackKind:Xn,StackFrameFocus:du,ThreadFocus:hu,RelatedInformationType:yp,SpeechToTextStatus:xp,KeywordRecognitionStatus:Cp,ChatResponseMarkdownPart:Pu,ChatResponseFileTreePart:Tu,ChatResponseAnchorPart:Au,ChatResponseProgressPart:Ua,ChatResponseReferencePart:Ba,ChatResponseCommandButtonPart:vp,ChatRequestTurn:o0,ChatResponseTurn:a0,LanguageModelSystemMessage:_p,LanguageModelUserMessage:wp,LanguageModelAssistantMessage:bp,NewSymbolName:G4,NewSymbolNameTag:Qf,InlineEdit:nE,InlineEditTriggerKind:Wa}}}var Xd;let s1=class{constructor(e,t,i,n,s,o,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=i,this._extHostConfiguration=n,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),ti("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();ti("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new h7(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(o1)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(a1,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};s1=F([O(2,ol),O(3,mn),O(4,sr),O(5,At),O(6,ze)],s1);let o1=class{static{Xd=this}static{this.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(e){if(e.environment.appRoot&&Xd.aliased.size){const t=bs(this.forceForwardSlashes(e.environment.appRoot.fsPath)),i="[a-z0-9_.-]",n=`@${i}+\\/${i}+|${i}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${s}\\/)(${n})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,i,n,s]=t,o=Xd.aliased.get(n);if(o!==void 0)return console.warn(`${n} as been renamed to ${o}, please update your imports`),i+o+s}forceForwardSlashes(e){return e.replace(/\\/g,"/")}};o1=Xd=F([O(0,At)],o1);class h7{constructor(e,t,i,n,s){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=n,this._logService=s,this.nodeModuleName="vscode",this._extApiImpl=new zn}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let n=this._extApiImpl.get(i.identifier);return n||(n=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,n)),n}if(!this._defaultApiImpl){let n="";this._extensionPaths.forEach((s,o)=>n+=`	${o} -> ${s.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${n}`),this._defaultApiImpl=this._apiFactory($4,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let a1=class{constructor(e,t,i){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=i.getProxy(j.MainThreadTelemetry);const n=i.getProxy(j.MainThreadWindow);this._impl=(s,o)=>{const a=b.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?n.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?n.$openUri(a,s,{}):this.callOriginal(s,o)}}load(e,t,i){const n=this._extensionPaths.findSubstr(t);return n&&(this._extensionId=n.identifier.value,this.sendShimmingTelemetry()),this._original=i(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};a1=F([O(2,Ue)],a1);let c1=class{constructor(e,t){this._mainThreadConsole=e.getProxy(j.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const i=this,n=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){i._handleConsoleCall(e,t,n,arguments)}})}_handleConsoleCall(e,t,i,n){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:p7(n,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,i,n)}};c1=F([O(0,Ue),O(1,At)],c1);const f7=1e5;function p7(r,e){const t=[];if(r.length)for(let i=0;i<r.length;i++){let n=r[i];if(typeof n>"u")n="undefined";else if(n instanceof Error){const s=n;s.stack?n=s.stack:n=s.toString()}t.push(n)}if(e){const i=new Error().stack;i&&t.push({__$stack:i.split(`
`).slice(3).join(`
`)})}try{const i=SC(t);return i.length>f7?"Output omitted for a large object that exceeds the limits":i}catch(i){return`Output omitted for an object that cannot be inspected ('${i.toString()}')`}}let l1=class extends c1{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,i){t.apply(console,i)}};l1=F([O(0,Ue),O(1,At)],l1);class g7 extends s1{_installInterceptor(){}getModule(e,t){for(const i of this._alternatives){const n=i(e);if(n){e=n;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class m7 extends Ng{constructor(){super(...arguments),this.extensionRuntime=Eu.Webworker}async _beforeAlmostReadyToRunExtensions(){qo&&this._instaService.createInstance(l1),this._apiFactory=this._instaService.invokeFunction(d7),this._fakeModules=this._instaService.createInstance(g7,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){t=t.with({path:v7(t.path,".js")});const n=e?.identifier.value;n&&performance.mark(`code/extHost/willFetchExtensionCode/${n}`);const s=b.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),o=await fetch(s.toString(!0));if(n&&performance.mark(`code/extHost/didFetchExtensionCode/${n}`),o.status!==200)throw new Error(o.statusText);const a=await o.text(),c=`${t.toString(!0)}#vscode-extension`,l=`${a}
//# sourceURL=${c}`;let u;try{u=new Function("module","exports","require",l)}catch(_){throw console.error(n?`Loading code for extension ${n} failed: ${_.message}`:`Loading code failed: ${_.message}`),console.error(`${t.toString(!0)}${typeof _.line=="number"?` line ${_.line}`:""}${typeof _.column=="number"?` column ${_.column}`:""}`),console.error(_),_}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const h={},f={exports:h},d=_=>{const w=this._fakeModules.getModule(_,t);if(w===void 0)throw new Error(`Cannot load module '${_}'`);return w};try{return i.codeLoadingStart(),n&&performance.mark(`code/extHost/willLoadExtensionCode/${n}`),u(f,h,d),f.exports!==h?f.exports:h}finally{n&&performance.mark(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await Hn(10)}}function v7(r,e){return r.endsWith(e)?r:r+e}nt(sr,m7,0),nt(hg,fg,0);const Py=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");const Ty=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function Ay(r){return/^(file|extension-file|vscode-remote):/i.test(r)}const Ry=fetch.bind(self);function _7(r){self.fetch=async function(e,t){return e instanceof Request||Ay(String(e))&&(e=(await r(b.parse(String(e)))).toString(!0)),Ry(e,t)},self.XMLHttpRequest=class extends XMLHttpRequest{open(e,t,i,n,s){(async()=>(Ay(t.toString())&&(t=(await r(b.parse(t.toString()))).toString(!0)),super.open(e,t,i??!0,n,s)))()}}}self.importScripts=()=>{throw new Error("'importScripts' has been blocked")},self.addEventListener=()=>console.trace("'addEventListener' has been blocked"),self.AMDLoader=void 0,self.NLSLoaderPlugin=void 0,self.define=void 0,self.require=void 0,self.webkitRequestFileSystem=void 0,self.webkitRequestFileSystemSync=void 0,self.webkitResolveLocalFileSystemSyncURL=void 0,self.webkitResolveLocalFileSystemURL=void 0;function w7(r,e){if(self.Worker){const t=self.Worker;Worker=function(i,n){if(/^vscode-remote:/i.test(i.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");async function s(a){const[c,l]=await Promise.all([r(a).then(d=>d.toString(!0)),e().then(d=>Object.fromEntries(d.map(([_,w])=>[_.toString(!0),w.toString(!0)])))]),h=`(${function(_,w){function x(D){return typeof D=="string"||D instanceof URL?(D=String(D).replace(/^file:\/\//i,"vscode-file://vscode-app"),w[D]??D):D}const k=fetch.bind(self);self.fetch=function(D,U){return D instanceof Request?k(D,U):k(x(D),U)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(D,U,R,H,le){const ie=x(U);return this.notFound=ie.startsWith("extension-file:"),super.open(D,ie,R??!0,H,le)}send(D){this.notFound||super.send(D)}get status(){return this.notFound?404:super.status}};const S=importScripts.bind(self);self.importScripts=(...D)=>{S(...D.map(x))},self.importExt=D=>new Function("url","return import(url)")(x(D)),S(_)}.toString()}('${c}', ${JSON.stringify(l)}))`,f=new Blob([h],{type:"application/javascript"});return URL.createObjectURL(f)}n=n||{},n.name=`${name} -> ${n.name||Kt(i.toString())}`;class o{constructor(c,l){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=s(b.parse(c instanceof URL?c.toString():c)).then(u=>new t(u,l))}set onmessage(c){this._onmessage=c,this.workerPromise.then(l=>{l.onmessage=c},console.error)}get onmessage(){return this._onmessage}set onmessageerror(c){this._onmessageerror=c,this.workerPromise.then(l=>{l.onmessageerror=c},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(c){this._onerror=c,this.workerPromise.then(l=>{l.onerror=c},console.error)}get onerror(){return this._onerror}postMessage(c,l){this.workerPromise.then(u=>{u.postMessage(c,l)},console.error)}terminate(){this.workerPromise.then(c=>{c.terminate()},console.error)}addEventListener(c,l,u){this.workerPromise.then(h=>{h.addEventListener(c,l,u)},console.error)}removeEventListener(c,l,u){this.workerPromise.then(h=>{h.removeEventListener(c,l,u)},console.error)}dispatchEvent(c){return this.workerPromise.then(l=>{l.dispatchEvent(c)},console.error),!1}}return new o(i,n)}}else self.Worker=class extends Ak{constructor(t,i){super(Ty,t,{name:Kt(t.toString()),...i})}}}const b7=new class{constructor(){this.pid=void 0}exit(r){Py()}};class y7{constructor(){const e=new MessageChannel,t=new P;let i=!1;Ty(e.port2,[e.port2]),e.port1.onmessage=n=>{const{data:s}=n;if(!(s instanceof ArrayBuffer)){console.warn("UNKNOWN data received",s);return}const o=he.wrap(new Uint8Array(s,0,s.byteLength));if(p2(o,2)){i=!0,Ly("received terminate message from renderer");return}t.fire(o)},this.protocol={onMessage:t.event,send:n=>{if(!i){const s=n.buffer.buffer.slice(n.buffer.byteOffset,n.buffer.byteOffset+n.buffer.byteLength);e.port1.postMessage(s,[s])}}}}}function x7(r){return new Promise(e=>{const t=r.onMessage(i=>{t.dispose();const n=JSON.parse(i.toString());r.send(Q1(0)),e({protocol:r,initData:n})});r.send(Q1(1))})}let Ly=r=>Py();function C7(r){return!!r&&typeof r=="object"&&r.type==="vscode.init"&&r.data instanceof Map}function S7(){ti("code/extHost/willConnectToRenderer");const r=new y7;return{onmessage(e){C7(e)&&x7(r.protocol).then(t=>{ti("code/extHost/didWaitForInitData");const i=new Mg(t.protocol,t.initData,b7,null,e.data);_7(n=>i.asBrowserUri(n)),w7(n=>i.asBrowserUri(n),()=>i.getAllStaticBrowserUris()),Ly=n=>i.terminate(n)})}}}const E7=S7();globalThis.onmessage=r=>E7.onmessage(r.data)})();
